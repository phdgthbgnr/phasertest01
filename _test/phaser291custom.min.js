var PIXI=PIXI||{};PIXI.DisplayObject=function(){this.position=new PIXI.Point(0,0);this.scale=new PIXI.Point(1,1);this.pivot=new PIXI.Point(0,0);this.rotation=0;this.alpha=1;this.visible=true;this.hitArea=null;this.renderable=false;this.parent=null;this.worldAlpha=1;this.worldTransform=new Phaser.Matrix();this.worldPosition=new PIXI.Point(0,0);this.worldScale=new PIXI.Point(1,1);this.worldRotation=0;this.filterArea=null;this._sr=0;this._cr=1;this._bounds=new PIXI.Rectangle(0,0,0,0);this._currentBounds=null;this._mask=null;this._cacheAsBitmap=false;this._cacheIsDirty=false};PIXI.DisplayObject.prototype={constructor:PIXI.DisplayObject,destroy:function(){if(this.children){var a=this.children.length;while(a--){this.children[a].destroy()}this.children=[]}this.hitArea=null;this.parent=null;this.worldTransform=null;this.filterArea=null;this.renderable=false;this._bounds=null;this._currentBounds=null;this._mask=null;this._destroyCachedSprite()},updateTransform:function(o){if(!o&&!this.parent&&!this.game){return this}var f=this.parent;if(o){f=o}else{if(!this.parent){f=this.game.world}}var t=f.worldTransform;var j=this.worldTransform;var n,m,l,k,i,h;if(this.rotation%Phaser.Math.PI2){if(this.rotation!==this.rotationCache){this.rotationCache=this.rotation;this._sr=Math.sin(this.rotation);this._cr=Math.cos(this.rotation)}n=this._cr*this.scale.x;m=this._sr*this.scale.x;l=-this._sr*this.scale.y;k=this._cr*this.scale.y;i=this.position.x;h=this.position.y;if(this.pivot.x||this.pivot.y){i-=this.pivot.x*n+this.pivot.y*l;h-=this.pivot.x*m+this.pivot.y*k}j.a=n*t.a+m*t.c;j.b=n*t.b+m*t.d;j.c=l*t.a+k*t.c;j.d=l*t.b+k*t.d;j.tx=i*t.a+h*t.c+t.tx;j.ty=i*t.b+h*t.d+t.ty}else{n=this.scale.x;m=0;l=0;k=this.scale.y;i=this.position.x-this.pivot.x*n;h=this.position.y-this.pivot.y*k;j.a=n*t.a;j.b=n*t.b;j.c=k*t.c;j.d=k*t.d;j.tx=i*t.a+h*t.c+t.tx;j.ty=i*t.b+h*t.d+t.ty}n=j.a;m=j.b;l=j.c;k=j.d;var g=(n*k)-(m*l);if(n||m){var e=Math.sqrt((n*n)+(m*m));this.worldRotation=(m>0)?Math.acos(n/e):-Math.acos(n/e);this.worldScale.x=e;this.worldScale.y=g/e}else{if(l||k){var q=Math.sqrt((l*l)+(k*k));this.worldRotation=Phaser.Math.HALF_PI-((k>0)?Math.acos(-l/q):-Math.acos(l/q));this.worldScale.x=g/q;this.worldScale.y=q}else{this.worldScale.x=0;this.worldScale.y=0}}this.worldAlpha=this.alpha*f.worldAlpha;this.worldPosition.x=j.tx;this.worldPosition.y=j.ty;this._currentBounds=null;if(this.transformCallback){this.transformCallback.call(this.transformCallbackContext,j,t)}return this},preUpdate:function(){},generateTexture:function(b,c,e){var d=this.getLocalBounds();var a=new Phaser.RenderTexture(this.game,d.width|0,d.height|0,e,c,b);PIXI.DisplayObject._tempMatrix.tx=-d.x;PIXI.DisplayObject._tempMatrix.ty=-d.y;a.render(this,PIXI.DisplayObject._tempMatrix);return a},updateCache:function(){this._generateCachedSprite();return this},toGlobal:function(a){this.updateTransform();return this.worldTransform.apply(a)},toLocal:function(a,b){if(b){a=b.toGlobal(a)}this.updateTransform();return this.worldTransform.applyInverse(a)},_renderCachedSprite:function(a){this._cachedSprite.worldAlpha=this.worldAlpha;if(a.gl){PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite,a)}else{PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite,a)}},_generateCachedSprite:function(){this._cacheAsBitmap=false;var d=this.getLocalBounds();d.width=Math.max(1,Math.ceil(d.width));d.height=Math.max(1,Math.ceil(d.height));this.updateTransform();if(!this._cachedSprite){var c=0;if(this.texture&&this.texture.baseTexture&&PIXI._enableMultiTextureToggle){c=this.texture.baseTexture.textureIndex}var a=new Phaser.RenderTexture(this.game,d.width,d.height,undefined,undefined,undefined,undefined,c);this._cachedSprite=new PIXI.Sprite(a);this._cachedSprite.worldTransform=this.worldTransform}else{this._cachedSprite.texture.resize(d.width,d.height)}var b=this._filters;this._filters=null;this._cachedSprite.filters=b;PIXI.DisplayObject._tempMatrix.tx=-d.x;PIXI.DisplayObject._tempMatrix.ty=-d.y;this._cachedSprite.texture.render(this,PIXI.DisplayObject._tempMatrix,true);this._cachedSprite.anchor.x=-(d.x/d.width);this._cachedSprite.anchor.y=-(d.y/d.height);this._filters=b;this._cacheAsBitmap=true},_destroyCachedSprite:function(){if(!this._cachedSprite){return}this._cachedSprite.texture.destroy(true);this._cachedSprite=null}};PIXI.DisplayObject.prototype.displayObjectUpdateTransform=PIXI.DisplayObject.prototype.updateTransform;Object.defineProperties(PIXI.DisplayObject.prototype,{x:{get:function(){return this.position.x},set:function(a){this.position.x=a}},y:{get:function(){return this.position.y},set:function(a){this.position.y=a}},worldVisible:{get:function(){if(!this.visible){return false}else{var a=this.parent;if(!a){return this.visible}else{do{if(!a.visible){return false}a=a.parent}while(a)}return true}}},mask:{get:function(){return this._mask},set:function(a){if(this._mask){this._mask.isMask=false}this._mask=a;if(a){this._mask.isMask=true}}},filters:{get:function(){return this._filters},set:function(d){if(Array.isArray(d)){var c=[];for(var b=0;b<d.length;b++){var e=d[b].passes;for(var a=0;a<e.length;a++){c.push(e[a])}}this._filterBlock={target:this,filterPasses:c}}this._filters=d;if(this.blendMode&&this.blendMode===PIXI.blendModes.MULTIPLY){this.blendMode=PIXI.blendModes.NORMAL}}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(a){if(this._cacheAsBitmap===a){return}if(a){this._generateCachedSprite()}else{this._destroyCachedSprite()}this._cacheAsBitmap=a}}});PIXI.DisplayObjectContainer=function(){PIXI.DisplayObject.call(this);this.children=[];this.ignoreChildInput=false};PIXI.DisplayObjectContainer.prototype=Object.create(PIXI.DisplayObject.prototype);PIXI.DisplayObjectContainer.prototype.constructor=PIXI.DisplayObjectContainer;PIXI.DisplayObjectContainer.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};PIXI.DisplayObjectContainer.prototype.addChildAt=function(b,a){if(a>=0&&a<=this.children.length){if(b.parent){b.parent.removeChild(b)}b.parent=this;this.children.splice(a,0,b);return b}else{throw new Error(b+"addChildAt: The index "+a+" supplied is out of bounds "+this.children.length)}};PIXI.DisplayObjectContainer.prototype.swapChildren=function(d,a){if(d===a){return}var c=this.getChildIndex(d);var b=this.getChildIndex(a);if(c<0||b<0){throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.")}this.children[c]=a;this.children[b]=d};PIXI.DisplayObjectContainer.prototype.getChildIndex=function(b){var a=this.children.indexOf(b);if(a===-1){throw new Error("The supplied DisplayObject must be a child of the caller")}return a};PIXI.DisplayObjectContainer.prototype.setChildIndex=function(c,b){if(b<0||b>=this.children.length){throw new Error("The supplied index is out of bounds")}var a=this.getChildIndex(c);this.children.splice(a,1);this.children.splice(b,0,c)};PIXI.DisplayObjectContainer.prototype.getChildAt=function(a){if(a<0||a>=this.children.length){throw new Error("getChildAt: Supplied index "+a+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller")}return this.children[a]};PIXI.DisplayObjectContainer.prototype.removeChild=function(b){var a=this.children.indexOf(b);if(a===-1){return}return this.removeChildAt(a)};PIXI.DisplayObjectContainer.prototype.removeChildAt=function(a){var b=this.getChildAt(a);if(b){b.parent=undefined;this.children.splice(a,1)}return b};PIXI.DisplayObjectContainer.prototype.removeChildren=function(c,d){if(c===undefined){c=0}if(d===undefined){d=this.children.length}var a=d-c;if(a>0&&a<=d){var e=this.children.splice(c,a);for(var b=0;b<e.length;b++){var f=e[b];f.parent=undefined}return e}else{if(a===0&&this.children.length===0){return[]}else{throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")}}};PIXI.DisplayObjectContainer.prototype.updateTransform=function(){if(!this.visible){return}this.displayObjectUpdateTransform();if(this._cacheAsBitmap){return}for(var a=0;a<this.children.length;a++){this.children[a].updateTransform()}};PIXI.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=PIXI.DisplayObjectContainer.prototype.updateTransform;PIXI.DisplayObjectContainer.prototype.getBounds=function(N){var B=(N&&N instanceof PIXI.DisplayObject);var w=true;if(!B){N=this}else{if(N instanceof PIXI.DisplayObjectContainer){w=N.contains(this)}else{w=false}}var y;if(B){var t=N.worldTransform;N.worldTransform=Phaser.identityMatrix;for(y=0;y<N.children.length;y++){N.children[y].updateTransform()}}var I=Infinity;var F=Infinity;var G=-Infinity;var C=-Infinity;var E;var n;var l;var s=false;for(y=0;y<this.children.length;y++){var k=this.children[y];if(!k.visible){continue}s=true;E=this.children[y].getBounds();I=(I<E.x)?I:E.x;F=(F<E.y)?F:E.y;n=E.width+E.x;l=E.height+E.y;G=(G>n)?G:n;C=(C>l)?C:l}var m=this._bounds;if(!s){m=new PIXI.Rectangle();var r=m.x;var q=m.width+m.x;var p=m.y;var o=m.height+m.y;var u=this.worldTransform;var M=u.a;var K=u.b;var H=u.c;var D=u.d;var L=u.tx;var J=u.ty;var A=M*q+H*o+L;var h=D*o+K*q+J;var z=M*r+H*o+L;var g=D*o+K*r+J;var x=M*r+H*p+L;var f=D*p+K*r+J;var v=M*q+H*p+L;var e=D*p+K*q+J;G=A;C=h;I=A;F=h;I=z<I?z:I;I=x<I?x:I;I=v<I?v:I;F=g<F?g:F;F=f<F?f:F;F=e<F?e:F;G=z>G?z:G;G=x>G?x:G;G=v>G?v:G;C=g>C?g:C;C=f>C?f:C;C=e>C?e:C}m.x=I;m.y=F;m.width=G-I;m.height=C-F;if(B){N.worldTransform=t;for(y=0;y<N.children.length;y++){N.children[y].updateTransform()}}if(!w){var j=N.getBounds();m.x-=j.x;m.y-=j.y}return m};PIXI.DisplayObjectContainer.prototype.getLocalBounds=function(){return this.getBounds(this)};PIXI.DisplayObjectContainer.prototype.contains=function(a){if(!a){return false}else{if(a===this){return true}else{return this.contains(a.parent)}}};PIXI.DisplayObjectContainer.prototype._renderWebGL=function(b){if(!this.visible||this.alpha<=0){return}if(this._cacheAsBitmap){this._renderCachedSprite(b);return}var a;if(this._mask||this._filters){if(this._filters){b.spriteBatch.flush();b.filterManager.pushFilter(this._filterBlock)}if(this._mask){b.spriteBatch.stop();b.maskManager.pushMask(this.mask,b);b.spriteBatch.start()}for(a=0;a<this.children.length;a++){this.children[a]._renderWebGL(b)}b.spriteBatch.stop();if(this._mask){b.maskManager.popMask(this._mask,b)}if(this._filters){b.filterManager.popFilter()}b.spriteBatch.start()}else{for(a=0;a<this.children.length;a++){this.children[a]._renderWebGL(b)}}};PIXI.DisplayObjectContainer.prototype._renderCanvas=function(b){if(this.visible===false||this.alpha===0){return}if(this._cacheAsBitmap){this._renderCachedSprite(b);return}if(this._mask){b.maskManager.pushMask(this._mask,b)}for(var a=0;a<this.children.length;a++){this.children[a]._renderCanvas(b)}if(this._mask){b.maskManager.popMask(b)}};Object.defineProperty(PIXI.DisplayObjectContainer.prototype,"width",{get:function(){return this.getLocalBounds().width*this.scale.x},set:function(b){var a=this.getLocalBounds().width;if(a!==0){this.scale.x=b/a}else{this.scale.x=1}this._width=b}});Object.defineProperty(PIXI.DisplayObjectContainer.prototype,"height",{get:function(){return this.getLocalBounds().height*this.scale.y},set:function(b){var a=this.getLocalBounds().height;if(a!==0){this.scale.y=b/a}else{this.scale.y=1}this._height=b}});PIXI.Sprite=function(a){PIXI.DisplayObjectContainer.call(this);this.anchor=new PIXI.Point(PIXI.Sprite.defaultAnchor.x,PIXI.Sprite.defaultAnchor.y);this.texture=a||PIXI.Texture.emptyTexture;this._width=0;this._height=0;this.tint=16777215;this.cachedTint=-1;this.tintedTexture=null;this.blendMode=PIXI.blendModes.NORMAL;this.shader=null;this.exists=true;if(this.texture.baseTexture.hasLoaded){this.onTextureUpdate()}this.renderable=true};PIXI.Sprite.defaultAnchor={x:0,y:0};PIXI.Sprite.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);PIXI.Sprite.prototype.constructor=PIXI.Sprite;Object.defineProperty(PIXI.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(a){this.scale.x=a/this.texture.frame.width;this._width=a}});Object.defineProperty(PIXI.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(a){this.scale.y=a/this.texture.frame.height;this._height=a}});PIXI.Sprite.prototype.setTexture=function(b,a){if(a){this.texture.baseTexture.destroy()}this.texture.baseTexture.skipRender=false;this.texture=b;this.texture.valid=true;this.cachedTint=-1};PIXI.Sprite.prototype.onTextureUpdate=function(){if(this._width){this.scale.x=this._width/this.texture.frame.width}if(this._height){this.scale.y=this._height/this.texture.frame.height}};PIXI.Sprite.prototype.getBounds=function(r){var o=this.texture.frame.width;var n=this.texture.frame.height;var m=o*(1-this.anchor.x);var l=o*-this.anchor.x;var k=n*(1-this.anchor.y);var j=n*-this.anchor.y;var p=r||this.worldTransform;var E=p.a;var C=p.b;var A=p.c;var y=p.d;var F=p.tx;var D=p.ty;var z=-Infinity;var v=-Infinity;var B=Infinity;var x=Infinity;if(C===0&&A===0){if(E<0){E*=-1;var w=m;m=-l;l=-w}if(y<0){y*=-1;var w=k;k=-j;j=-w}B=E*l+F;z=E*m+F;x=y*j+D;v=y*k+D}else{var u=E*l+A*j+F;var h=y*j+C*l+D;var t=E*m+A*j+F;var g=y*j+C*m+D;var s=E*m+A*k+F;var f=y*k+C*m+D;var q=E*l+A*k+F;var e=y*k+C*l+D;B=u<B?u:B;B=t<B?t:B;B=s<B?s:B;B=q<B?q:B;x=h<x?h:x;x=g<x?g:x;x=f<x?f:x;x=e<x?e:x;z=u>z?u:z;z=t>z?t:z;z=s>z?s:z;z=q>z?q:z;v=h>v?h:v;v=g>v?g:v;v=f>v?f:v;v=e>v?e:v}var i=this._bounds;i.x=B;i.width=z-B;i.y=x;i.height=v-x;this._currentBounds=i;return i};PIXI.Sprite.prototype.getLocalBounds=function(){var a=this.worldTransform;this.worldTransform=Phaser.identityMatrix;for(var b=0;b<this.children.length;b++){this.children[b].updateTransform()}var c=this.getBounds();this.worldTransform=a;for(b=0;b<this.children.length;b++){this.children[b].updateTransform()}return c};PIXI.Sprite.prototype._renderWebGL=function(e,c){if(!this.visible||this.alpha<=0||!this.renderable){return}var a=this.worldTransform;if(c){a=c}if(this._mask||this._filters){var b=e.spriteBatch;if(this._filters){b.flush();e.filterManager.pushFilter(this._filterBlock)}if(this._mask){b.stop();e.maskManager.pushMask(this.mask,e);b.start()}b.render(this);for(var d=0;d<this.children.length;d++){this.children[d]._renderWebGL(e)}b.stop();if(this._mask){e.maskManager.popMask(this._mask,e)}if(this._filters){e.filterManager.popFilter()}b.start()}else{e.spriteBatch.render(this);for(var d=0;d<this.children.length;d++){this.children[d]._renderWebGL(e,a)}}};PIXI.Sprite.prototype._renderCanvas=function(k,p){if(!this.visible||this.alpha===0||!this.renderable||this.texture.crop.width<=0||this.texture.crop.height<=0){return}var f=this.worldTransform;if(p){f=p}if(this.blendMode!==k.currentBlendMode){k.currentBlendMode=this.blendMode;k.context.globalCompositeOperation=PIXI.blendModesCanvas[k.currentBlendMode]}if(this._mask){k.maskManager.pushMask(this._mask,k)}if(!this.texture.valid){for(var q=0;q<this.children.length;q++){this.children[q]._renderCanvas(k)}if(this._mask){k.maskManager.popMask(k)}return}var o=this.texture.baseTexture.resolution/k.resolution;k.context.globalAlpha=this.worldAlpha;if(k.smoothProperty&&k.scaleMode!==this.texture.baseTexture.scaleMode){k.scaleMode=this.texture.baseTexture.scaleMode;k.context[k.smoothProperty]=(k.scaleMode===PIXI.scaleModes.LINEAR)}var m=(this.texture.trim)?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width;var l=(this.texture.trim)?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;var x=(f.tx*k.resolution)+k.shakeX;var v=(f.ty*k.resolution)+k.shakeY;var j=this.texture.crop.width;var n=this.texture.crop.height;if(this.texture.rotated){var w=f.a;var u=f.b;var t=f.c;var s=f.d;var r=j;x=f.c*n+x;v=f.d*n+v;f.a=w*6.123233995736766e-17+-t;f.b=u*6.123233995736766e-17+-s;f.c=w+t*6.123233995736766e-17;f.d=u+s*6.123233995736766e-17;j=n;n=r}if(k.roundPixels){k.context.setTransform(f.a,f.b,f.c,f.d,x|0,v|0);m|=0;l|=0}else{k.context.setTransform(f.a,f.b,f.c,f.d,x,v)}m/=o;l/=o;if(this.tint!==16777215){if(this.texture.requiresReTint||this.cachedTint!==this.tint){this.tintedTexture=PIXI.CanvasTinter.getTintedTexture(this,this.tint);this.cachedTint=this.tint;this.texture.requiresReTint=false}k.context.drawImage(this.tintedTexture,0,0,j,n,m,l,j/o,n/o)}else{var h=this.texture.crop.x;var g=this.texture.crop.y;j=Math.floor(j);n=Math.floor(n);k.context.drawImage(this.texture.baseTexture.source,h,g,j,n,m,l,j/o,n/o)}for(var q=0;q<this.children.length;q++){this.children[q]._renderCanvas(k)}if(this._mask){k.maskManager.popMask(k)}};PIXI.initDefaultShaders=function(){};PIXI.CompileVertexShader=function(b,a){return PIXI._CompileShader(b,a,b.VERTEX_SHADER)};PIXI.CompileFragmentShader=function(b,a){return PIXI._CompileShader(b,a,b.FRAGMENT_SHADER)};PIXI._CompileShader=function(e,d,c){var b=d;if(Array.isArray(d)){b=d.join("\n")}var a=e.createShader(c);e.shaderSource(a,b);e.compileShader(a);if(!e.getShaderParameter(a,e.COMPILE_STATUS)){window.console.log(e.getShaderInfoLog(a));return null}return a};PIXI.compileProgram=function(e,a,c){var b=PIXI.CompileFragmentShader(e,c);var d=PIXI.CompileVertexShader(e,a);var f=e.createProgram();e.attachShader(f,d);e.attachShader(f,b);e.linkProgram(f);if(!e.getProgramParameter(f,e.LINK_STATUS)){window.console.log(e.getProgramInfoLog(f));window.console.log("Could not initialise shaders")}return f};PIXI.PixiShader=function(a){this._UID=Phaser._UID++;this.gl=a;this.program=null;this.fragmentSrc=null;this.textureCount=0;this.firstRun=true;this.dirty=true;this.attributes=[];this.init()};PIXI.PixiShader.prototype.constructor=PIXI.PixiShader;PIXI.PixiShader.prototype.initMultitexShader=function(){var h=this.gl;this.MAX_TEXTURES=h.getParameter(h.MAX_TEXTURE_IMAGE_UNITS);var a="\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\n";for(var d=1;d<this.MAX_TEXTURES;++d){a+="\tif (vTextureIndex == "+d+".0) {gl_FragColor = texture2D(uSamplerArray["+d+"], vTextureCoord) * vColor;return;}\n"}this.fragmentSrc=["// PixiShader Fragment Shader.","precision lowp float;","bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }","varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureIndex;","uniform sampler2D uSamplerArray["+this.MAX_TEXTURES+"];","const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);","const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);","void main(void) {",a,"   if(vTextureIndex >= "+this.MAX_TEXTURES+".0) { gl_FragColor = BLUE;return;}","   if(isnan(vTextureIndex)) { gl_FragColor = RED;return;}","}"];var c=PIXI.compileProgram(h,this.vertexSrc||PIXI.PixiShader.defaultVertexSrc,this.fragmentSrc);h.useProgram(c);this.uSamplerArray=h.getUniformLocation(c,"uSamplerArray[0]");this.projectionVector=h.getUniformLocation(c,"projectionVector");this.offsetVector=h.getUniformLocation(c,"offsetVector");this.dimensions=h.getUniformLocation(c,"dimensions");this.aVertexPosition=h.getAttribLocation(c,"aVertexPosition");this.aTextureCoord=h.getAttribLocation(c,"aTextureCoord");this.colorAttribute=h.getAttribLocation(c,"aColor");this.aTextureIndex=h.getAttribLocation(c,"aTextureIndex");var g=[];var b=h.createTexture();h.activeTexture(h.TEXTURE0);h.bindTexture(h.TEXTURE_2D,b);h.texImage2D(h.TEXTURE_2D,0,h.RGB,1,1,0,h.RGB,h.UNSIGNED_BYTE,null);for(var f=0;f<this.MAX_TEXTURES;++f){h.activeTexture(h.TEXTURE0+f);h.bindTexture(h.TEXTURE_2D,b);g.push(f)}h.activeTexture(h.TEXTURE0);h.uniform1iv(this.uSamplerArray,g);if(this.colorAttribute===-1){this.colorAttribute=2}this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute,this.aTextureIndex];for(var e in this.uniforms){this.uniforms[e].uniformLocation=h.getUniformLocation(c,e)}this.initUniforms();this.program=c};PIXI.PixiShader.prototype.initDefaultShader=function(){if(this.fragmentSrc===null){this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureIndex;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"]}var c=this.gl;var a=PIXI.compileProgram(c,this.vertexSrc||PIXI.PixiShader.defaultVertexSrc,this.fragmentSrc);c.useProgram(a);this.uSampler=c.getUniformLocation(a,"uSampler");this.projectionVector=c.getUniformLocation(a,"projectionVector");this.offsetVector=c.getUniformLocation(a,"offsetVector");this.dimensions=c.getUniformLocation(a,"dimensions");this.aVertexPosition=c.getAttribLocation(a,"aVertexPosition");this.aTextureCoord=c.getAttribLocation(a,"aTextureCoord");this.colorAttribute=c.getAttribLocation(a,"aColor");this.aTextureIndex=c.getAttribLocation(a,"aTextureIndex");if(this.colorAttribute===-1){this.colorAttribute=2}this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute,this.aTextureIndex];for(var b in this.uniforms){this.uniforms[b].uniformLocation=c.getUniformLocation(a,b)}this.initUniforms();this.program=a};PIXI.PixiShader.prototype.init=function(a){if(PIXI._enableMultiTextureToggle&&!a){this.initMultitexShader()}else{this.initDefaultShader()}};PIXI.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var d=this.gl;var a;for(var b in this.uniforms){a=this.uniforms[b];var c=a.type;if(c==="sampler2D"){a._init=false;if(a.value!==null){this.initSampler2D(a)}}else{if(c==="mat2"||c==="mat3"||c==="mat4"){a.glMatrix=true;a.glValueLength=1;if(c==="mat2"){a.glFunc=d.uniformMatrix2fv}else{if(c==="mat3"){a.glFunc=d.uniformMatrix3fv}else{if(c==="mat4"){a.glFunc=d.uniformMatrix4fv}}}}else{a.glFunc=d["uniform"+c];if(c==="2f"||c==="2i"){a.glValueLength=2}else{if(c==="3f"||c==="3i"){a.glValueLength=3}else{if(c==="4f"||c==="4i"){a.glValueLength=4}else{a.glValueLength=1}}}}}}};PIXI.PixiShader.prototype.initSampler2D=function(c){if(!c.value||!c.value.baseTexture||!c.value.baseTexture.hasLoaded){return}var h=this.gl;h.activeTexture(h.TEXTURE0+this.textureCount);h.bindTexture(h.TEXTURE_2D,c.value.baseTexture._glTextures[h.id]);if(c.textureData){var f=c.textureData;var j=(f.magFilter)?f.magFilter:h.LINEAR;var b=(f.minFilter)?f.minFilter:h.LINEAR;var g=(f.wrapS)?f.wrapS:h.CLAMP_TO_EDGE;var e=(f.wrapT)?f.wrapT:h.CLAMP_TO_EDGE;var i=(f.luminance)?h.LUMINANCE:h.RGBA;if(f.repeat){g=h.REPEAT;e=h.REPEAT}h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,!!f.flipY);if(f.width){var a=(f.width)?f.width:512;var k=(f.height)?f.height:2;var d=(f.border)?f.border:0;h.texImage2D(h.TEXTURE_2D,0,i,a,k,d,i,h.UNSIGNED_BYTE,null)}else{h.texImage2D(h.TEXTURE_2D,0,i,h.RGBA,h.UNSIGNED_BYTE,c.value.baseTexture.source)}h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,j);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,b);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,g);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,e)}h.uniform1i(c.uniformLocation,this.textureCount);c._init=true;this.textureCount++};PIXI.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var a;var c=this.gl;for(var b in this.uniforms){a=this.uniforms[b];if(a.glValueLength===1){if(a.glMatrix===true){a.glFunc.call(c,a.uniformLocation,a.transpose,a.value)}else{a.glFunc.call(c,a.uniformLocation,a.value)}}else{if(a.glValueLength===2){a.glFunc.call(c,a.uniformLocation,a.value.x,a.value.y)}else{if(a.glValueLength===3){a.glFunc.call(c,a.uniformLocation,a.value.x,a.value.y,a.value.z)}else{if(a.glValueLength===4){a.glFunc.call(c,a.uniformLocation,a.value.x,a.value.y,a.value.z,a.value.w)}else{if(a.type==="sampler2D"){if(a._init){c.activeTexture(c["TEXTURE"+this.textureCount]);if(a.value.baseTexture._dirty[c.id]){PIXI.instances[c.id].updateTexture(a.value.baseTexture)}else{c.bindTexture(c.TEXTURE_2D,a.value.baseTexture._glTextures[c.id])}c.uniform1i(a.uniformLocation,this.textureCount);this.textureCount++}else{this.initSampler2D(a)}}}}}}}};PIXI.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};PIXI.PixiShader.defaultVertexSrc=["// PixiShader Vertex Shader","// With multi-texture rendering","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","attribute float aTextureIndex;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureIndex;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   if (aTextureIndex > 0.0) gl_Position = vec4(0.0);","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","   vTextureIndex = aTextureIndex;","}"];PIXI.PixiFastShader=function(c){this._UID=Phaser._UID++;this.gl=c;this.program=null;if(PIXI._enableMultiTextureToggle){var c=this.gl;this.MAX_TEXTURES=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS);var a="\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\n";for(var b=1;b<this.MAX_TEXTURES;++b){a+="\tif (vTextureIndex == "+b+".0) { gl_FragColor = texture2D(uSamplerArray["+b+"], vTextureCoord) * vColor;return;}\n"}this.fragmentSrc=["// PixiFastShader Fragment Shader.","precision lowp float;","bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }","varying vec2 vTextureCoord;","varying float vColor;","varying float vTextureIndex;","uniform sampler2D uSamplerArray["+this.MAX_TEXTURES+"];","const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);","const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);","void main(void) {",a,"   if(vTextureIndex >= "+this.MAX_TEXTURES+".0) { gl_FragColor = BLUE;return;}","   if(isnan(vTextureIndex)) {gl_FragColor = RED;return;}","}"]}else{this.fragmentSrc=["// PixiFastShader Fragment Shader.","precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","varying float vTextureIndex;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;","}"]}this.vertexSrc=["// PixiFastShader Vertex Shader.","attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute float aTextureIndex;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","varying float vTextureIndex;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vTextureIndex = aTextureIndex;","   vColor = aColor;","}"];this.textureCount=0;this.init()};PIXI.PixiFastShader.prototype.constructor=PIXI.PixiFastShader;PIXI.PixiFastShader.prototype.init=function(){var e=this.gl;var b=PIXI.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(b);this.uSampler=PIXI._enableMultiTextureToggle?e.getUniformLocation(b,"uSamplerArray[0]"):e.getUniformLocation(b,"uSampler");if(PIXI._enableMultiTextureToggle){var d=[];var a=e.createTexture();e.activeTexture(e.TEXTURE0);e.bindTexture(e.TEXTURE_2D,a);e.texImage2D(e.TEXTURE_2D,0,e.RGB,1,1,0,e.RGB,e.UNSIGNED_BYTE,null);for(var c=0;c<this.MAX_TEXTURES;++c){e.activeTexture(e.TEXTURE0+c);e.bindTexture(e.TEXTURE_2D,a);d.push(c)}e.activeTexture(e.TEXTURE0);e.uniform1iv(this.uSampler,d)}this.projectionVector=e.getUniformLocation(b,"projectionVector");this.offsetVector=e.getUniformLocation(b,"offsetVector");this.dimensions=e.getUniformLocation(b,"dimensions");this.uMatrix=e.getUniformLocation(b,"uMatrix");this.aVertexPosition=e.getAttribLocation(b,"aVertexPosition");this.aPositionCoord=e.getAttribLocation(b,"aPositionCoord");this.aScale=e.getAttribLocation(b,"aScale");this.aRotation=e.getAttribLocation(b,"aRotation");this.aTextureCoord=e.getAttribLocation(b,"aTextureCoord");this.colorAttribute=e.getAttribLocation(b,"aColor");this.aTextureIndex=e.getAttribLocation(b,"aTextureIndex");if(this.colorAttribute===-1){this.colorAttribute=2}this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute,this.aTextureIndex];this.program=b};PIXI.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};PIXI.StripShader=function(c){this._UID=Phaser._UID++;this.gl=c;this.program=null;if(PIXI._enableMultiTextureToggle){var c=this.gl;this.MAX_TEXTURES=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS);var a="\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord);return;}\n";for(var b=1;b<this.MAX_TEXTURES;++b){a+="\tif (vTextureIndex == "+b+".0) { gl_FragColor = texture2D(uSamplerArray["+b+"], vTextureCoord) ;return;}\n"}this.fragmentSrc=["//StripShader Fragment Shader.","precision mediump float;","bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }","varying vec2 vTextureCoord;","varying float vTextureIndex;","uniform float alpha;","uniform sampler2D uSamplerArray["+this.MAX_TEXTURES+"];","const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);","const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);","void main(void) {",a,"   if(vTextureIndex >= "+this.MAX_TEXTURES+".0) { gl_FragColor = BLUE;return;}","   if(isnan(vTextureIndex)) {gl_FragColor = RED;return;}","}"]}else{this.fragmentSrc=["//StripShader Fragment Shader.","precision mediump float;","varying vec2 vTextureCoord;","varying float vTextureIndex;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","}"]}this.vertexSrc=["//StripShader Vertex Shader.","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aTextureIndex;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying float vTextureIndex;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vTextureIndex = aTextureIndex;","}"];this.init()};PIXI.StripShader.prototype.constructor=PIXI.StripShader;PIXI.StripShader.prototype.init=function(){var e=this.gl;var b=PIXI.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(b);this.uSampler=PIXI._enableMultiTextureToggle?e.getUniformLocation(b,"uSamplerArray[0]"):e.getUniformLocation(b,"uSampler");if(PIXI._enableMultiTextureToggle){var d=[];var a=e.createTexture();e.activeTexture(e.TEXTURE0);e.bindTexture(e.TEXTURE_2D,a);e.texImage2D(e.TEXTURE_2D,0,e.RGB,1,1,0,e.RGB,e.UNSIGNED_BYTE,null);for(var c=0;c<this.MAX_TEXTURES;++c){e.activeTexture(e.TEXTURE0+c);e.bindTexture(e.TEXTURE_2D,a);d.push(c)}e.activeTexture(e.TEXTURE0);e.uniform1iv(this.uSampler,d)}this.projectionVector=e.getUniformLocation(b,"projectionVector");this.offsetVector=e.getUniformLocation(b,"offsetVector");this.colorAttribute=e.getAttribLocation(b,"aColor");this.aTextureIndex=e.getAttribLocation(b,"aTextureIndex");this.aVertexPosition=e.getAttribLocation(b,"aVertexPosition");this.aTextureCoord=e.getAttribLocation(b,"aTextureCoord");this.attributes=[this.aVertexPosition,this.aTextureCoord,this.aTextureIndex];this.translationMatrix=e.getUniformLocation(b,"translationMatrix");this.alpha=e.getUniformLocation(b,"alpha");this.program=b};PIXI.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attribute=null};PIXI.PrimitiveShader=function(a){this._UID=Phaser._UID++;this.gl=a;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"];this.init()};PIXI.PrimitiveShader.prototype.constructor=PIXI.PrimitiveShader;PIXI.PrimitiveShader.prototype.init=function(){var b=this.gl;var a=PIXI.compileProgram(b,this.vertexSrc,this.fragmentSrc);b.useProgram(a);this.projectionVector=b.getUniformLocation(a,"projectionVector");this.offsetVector=b.getUniformLocation(a,"offsetVector");this.tintColor=b.getUniformLocation(a,"tint");this.flipY=b.getUniformLocation(a,"flipY");this.aVertexPosition=b.getAttribLocation(a,"aVertexPosition");this.colorAttribute=b.getAttribLocation(a,"aColor");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=b.getUniformLocation(a,"translationMatrix");this.alpha=b.getUniformLocation(a,"alpha");this.program=a};PIXI.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};PIXI.ComplexPrimitiveShader=function(a){this._UID=Phaser._UID++;this.gl=a;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","uniform float flipY;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"];this.init()};PIXI.ComplexPrimitiveShader.prototype.constructor=PIXI.ComplexPrimitiveShader;PIXI.ComplexPrimitiveShader.prototype.init=function(){var b=this.gl;var a=PIXI.compileProgram(b,this.vertexSrc,this.fragmentSrc);b.useProgram(a);this.projectionVector=b.getUniformLocation(a,"projectionVector");this.offsetVector=b.getUniformLocation(a,"offsetVector");this.tintColor=b.getUniformLocation(a,"tint");this.color=b.getUniformLocation(a,"color");this.flipY=b.getUniformLocation(a,"flipY");this.aVertexPosition=b.getAttribLocation(a,"aVertexPosition");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=b.getUniformLocation(a,"translationMatrix");this.alpha=b.getUniformLocation(a,"alpha");this.program=a};PIXI.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attribute=null};PIXI.glContexts=[];PIXI.instances=[];PIXI._enableMultiTextureToggle=false;PIXI.WebGLRenderer=function(a){this.game=a;if(!PIXI.defaultRenderer){PIXI.defaultRenderer=this}this.extensions={};this.type=Phaser.WEBGL;this.resolution=a.resolution;this.transparent=a.transparent;this.autoResize=false;this.preserveDrawingBuffer=a.preserveDrawingBuffer;this.clearBeforeRender=a.clearBeforeRender;this.width=a.width;this.height=a.height;this.view=a.canvas;this._contextOptions={alpha:this.transparent,antialias:a.antialias,premultipliedAlpha:this.transparent&&this.transparent!=="notMultiplied",stencil:true,preserveDrawingBuffer:this.preserveDrawingBuffer};this.projection=new PIXI.Point();this.offset=new PIXI.Point();this.shaderManager=new PIXI.WebGLShaderManager();this.spriteBatch=new PIXI.WebGLSpriteBatch(a);this.maskManager=new PIXI.WebGLMaskManager();this.filterManager=new PIXI.WebGLFilterManager();this.stencilManager=new PIXI.WebGLStencilManager();this.blendModeManager=new PIXI.WebGLBlendModeManager();this.renderSession={};this.currentBatchedTextures=[];this.renderSession.game=this.game;this.renderSession.gl=this.gl;this.renderSession.drawCount=0;this.renderSession.shaderManager=this.shaderManager;this.renderSession.maskManager=this.maskManager;this.renderSession.filterManager=this.filterManager;this.renderSession.blendModeManager=this.blendModeManager;this.renderSession.spriteBatch=this.spriteBatch;this.renderSession.stencilManager=this.stencilManager;this.renderSession.renderer=this;this.renderSession.resolution=this.resolution;this.renderSession.roundPixels=false;this.renderSession.maxTextureAvailableSpace=null;this.initContext();this.mapBlendModes()};PIXI.WebGLRenderer.prototype.constructor=PIXI.WebGLRenderer;PIXI.WebGLRenderer.prototype.initContext=function(){var d=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);this.gl=d;if(!d){throw new Error("This browser does not support webGL. Try using the canvas renderer")}this.maxTextures=d.getParameter(d.MAX_TEXTURE_IMAGE_UNITS);this.maxTextureSize=this.gl.getParameter(d.MAX_TEXTURE_SIZE);this.glContextId=d.id=PIXI.WebGLRenderer.glContextId++;PIXI.glContexts[this.glContextId]=d;PIXI.instances[this.glContextId]=this;d.disable(d.DEPTH_TEST);d.disable(d.CULL_FACE);d.enable(d.BLEND);this.shaderManager.setContext(d);this.spriteBatch.setContext(d);this.maskManager.setContext(d);this.filterManager.setContext(d);this.blendModeManager.setContext(d);this.stencilManager.setContext(d);this.renderSession.gl=this.gl;this.resize(this.width,this.height);this.extensions.compression={};var c=d.getExtension("WEBGL_compressed_texture_etc1")||d.getExtension("WEBKIT_WEBGL_compressed_texture_etc1");var b=d.getExtension("WEBGL_compressed_texture_pvrtc")||d.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");var a=d.getExtension("WEBGL_compressed_texture_s3tc")||d.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");if(c){this.extensions.compression.ETC1=c}if(b){this.extensions.compression.PVRTC=b}if(a){this.extensions.compression.S3TC=a}};PIXI.WebGLRenderer.prototype.setTexturePriority=function(c){if(!PIXI._enableMultiTextureToggle){console.warn("setTexturePriority error: Multi Texture support hasn't been enabled in the Phaser Game Config.");return}var k=function(i){--i;i|=i>>1;i|=i>>2;i|=i>>4;i|=i>>8;i|=i>>16;return ++i};var g=this.gl;var m=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);var d=g.getParameter(g.MAX_TEXTURE_SIZE);var h=this.game.cache._cache.image;var l=null;for(var f=0;f<this.currentBatchedTextures.length;f++){l=this.currentBatchedTextures[f];if(!(l in h)){console.warn('setTexturePriority: There is no image "%s" in the image cache.',l);continue}h[l].base.textureIndex=0}var b=(d)-k(Math.max(this.width,this.height));this.currentBatchedTextures.length=0;for(var e=0;e<c.length;++e){l=c[e];if(!(l in h)){console.warn('setTexturePriority: There is no image "%s" in the image cache.',l);continue}var a=h[l].base;b-=k(Math.max(a.width,a.height));if(b<=0){a.textureIndex=0;console.warn('setTexturePriority: Image "%s" was given textureIndex=0 because there is no available texture space (%s).',l,b)}else{a.textureIndex=(1+(e%(m-1)))}this.currentBatchedTextures.push(l)}this.renderSession.maxTextureAvailableSpace=b;return this.currentBatchedTextures};PIXI.WebGLRenderer.prototype.render=function(a){if(this.contextLost){return}var b=this.gl;b.viewport(0,0,this.width,this.height);b.bindFramebuffer(b.FRAMEBUFFER,null);if(this.game.clearBeforeRender){b.clearColor(a._bgColor.r,a._bgColor.g,a._bgColor.b,a._bgColor.a);b.clear(b.COLOR_BUFFER_BIT)}this.offset.x=this.game.camera._shake.x;this.offset.y=this.game.camera._shake.y;this.renderDisplayObject(a,this.projection)};PIXI.WebGLRenderer.prototype.renderDisplayObject=function(d,a,b,c){this.renderSession.blendModeManager.setBlendMode(PIXI.blendModes.NORMAL);this.renderSession.drawCount=0;this.renderSession.flipY=b?-1:1;this.renderSession.projection=a;this.renderSession.offset=this.offset;this.spriteBatch.begin(this.renderSession);this.filterManager.begin(this.renderSession,b);d._renderWebGL(this.renderSession,c);this.spriteBatch.end()};PIXI.WebGLRenderer.prototype.resize=function(b,a){this.width=b*this.resolution;this.height=a*this.resolution;this.view.width=this.width;this.view.height=this.height;if(this.autoResize){this.view.style.width=this.width/this.resolution+"px";this.view.style.height=this.height/this.resolution+"px"}this.gl.viewport(0,0,this.width,this.height);this.projection.x=this.width/2/this.resolution;this.projection.y=-this.height/2/this.resolution};PIXI.WebGLRenderer.prototype.updateCompressedTexture=function(b){if(!b.hasLoaded){return false}var c=this.gl;var a=b.source;if(!b._glTextures[c.id]){b._glTextures[c.id]=c.createTexture()}c.activeTexture(c.TEXTURE0+b.textureIndex);c.bindTexture(c.TEXTURE_2D,b._glTextures[c.id]);c.compressedTexImage2D(c.TEXTURE_2D,0,a.glExtensionFormat,a.width,a.height,0,a.textureData);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,b.scaleMode===PIXI.scaleModes.LINEAR?c.LINEAR:c.NEAREST);if(b.mipmap&&Phaser.Math.isPowerOfTwo(b.width,b.height)){c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,b.scaleMode===PIXI.scaleModes.LINEAR?c.LINEAR_MIPMAP_LINEAR:c.NEAREST_MIPMAP_NEAREST);c.generateMipmap(c.TEXTURE_2D)}else{c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,b.scaleMode===PIXI.scaleModes.LINEAR?c.LINEAR:c.NEAREST)}if(!b._powerOf2){c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE)}else{c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT)}b._dirty[c.id]=false;return true};PIXI.WebGLRenderer.prototype.updateTexture=function(a){if(!a.hasLoaded){return false}if(a.source.compressionAlgorithm){return this.updateCompressedTexture(a)}var b=this.gl;if(!a._glTextures[b.id]){a._glTextures[b.id]=b.createTexture()}b.activeTexture(b.TEXTURE0+a.textureIndex);b.bindTexture(b.TEXTURE_2D,a._glTextures[b.id]);b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultipliedAlpha);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a.source);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a.scaleMode===PIXI.scaleModes.LINEAR?b.LINEAR:b.NEAREST);if(a.mipmap&&Phaser.Math.isPowerOfTwo(a.width,a.height)){b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===PIXI.scaleModes.LINEAR?b.LINEAR_MIPMAP_LINEAR:b.NEAREST_MIPMAP_NEAREST);b.generateMipmap(b.TEXTURE_2D)}else{b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===PIXI.scaleModes.LINEAR?b.LINEAR:b.NEAREST)}if(!a._powerOf2){b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE)}else{b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT)}a._dirty[b.id]=false;return true};PIXI.WebGLRenderer.prototype.destroy=function(){PIXI.glContexts[this.glContextId]=null;this.projection=null;this.offset=null;this.shaderManager.destroy();this.spriteBatch.destroy();this.maskManager.destroy();this.filterManager.destroy();this.shaderManager=null;this.spriteBatch=null;this.maskManager=null;this.filterManager=null;this.gl=null;this.renderSession=null;Phaser.CanvasPool.remove(this);PIXI.instances[this.glContextId]=null;PIXI.WebGLRenderer.glContextId--};PIXI.WebGLRenderer.prototype.mapBlendModes=function(){var d=this.gl;if(!PIXI.blendModesWebGL){var a=[];var c=PIXI.blendModes;a[c.NORMAL]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.ADD]=[d.SRC_ALPHA,d.DST_ALPHA];a[c.MULTIPLY]=[d.DST_COLOR,d.ONE_MINUS_SRC_ALPHA];a[c.SCREEN]=[d.SRC_ALPHA,d.ONE];a[c.OVERLAY]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.DARKEN]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.LIGHTEN]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.COLOR_DODGE]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.COLOR_BURN]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.HARD_LIGHT]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.SOFT_LIGHT]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.DIFFERENCE]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.EXCLUSION]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.HUE]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.SATURATION]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.COLOR]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];a[c.LUMINOSITY]=[d.ONE,d.ONE_MINUS_SRC_ALPHA];PIXI.blendModesWebGL=a}};PIXI.WebGLRenderer.prototype.getMaxTextureUnit=function(){var a=this.gl;return a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS)};PIXI.enableMultiTexture=function(){PIXI._enableMultiTextureToggle=true};PIXI.WebGLRenderer.glContextId=0;PIXI.WebGLRenderer.textureArray=[];PIXI.WebGLBlendModeManager=function(){this.currentBlendMode=99999};PIXI.WebGLBlendModeManager.prototype.constructor=PIXI.WebGLBlendModeManager;PIXI.WebGLBlendModeManager.prototype.setContext=function(a){this.gl=a};PIXI.WebGLBlendModeManager.prototype.setBlendMode=function(a){if(this.currentBlendMode===a){return false}this.currentBlendMode=a;var b=PIXI.blendModesWebGL[this.currentBlendMode];if(b){this.gl.blendFunc(b[0],b[1])}return true};PIXI.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null};PIXI.WebGLMaskManager=function(){};PIXI.WebGLMaskManager.prototype.constructor=PIXI.WebGLMaskManager;PIXI.WebGLMaskManager.prototype.setContext=function(a){this.gl=a};PIXI.WebGLMaskManager.prototype.pushMask=function(b,a){var c=a.gl;if(b.dirty){PIXI.WebGLGraphics.updateGraphics(b,c)}if(b._webGL[c.id]===undefined||b._webGL[c.id].data===undefined||b._webGL[c.id].data.length===0){return}a.stencilManager.pushStencil(b,b._webGL[c.id].data[0],a)};PIXI.WebGLMaskManager.prototype.popMask=function(b,a){var c=this.gl;if(b._webGL[c.id]===undefined||b._webGL[c.id].data===undefined||b._webGL[c.id].data.length===0){return}a.stencilManager.popStencil(b,b._webGL[c.id].data[0],a)};PIXI.WebGLMaskManager.prototype.destroy=function(){this.gl=null};PIXI.WebGLStencilManager=function(){this.stencilStack=[];this.reverse=true;this.count=0};PIXI.WebGLStencilManager.prototype.setContext=function(a){this.gl=a};PIXI.WebGLStencilManager.prototype.pushStencil=function(a,d,b){var c=this.gl;this.bindGraphics(a,d,b);if(this.stencilStack.length===0){c.enable(c.STENCIL_TEST);c.clear(c.STENCIL_BUFFER_BIT);this.reverse=true;this.count=0}this.stencilStack.push(d);var e=this.count;c.colorMask(false,false,false,false);c.stencilFunc(c.ALWAYS,0,255);c.stencilOp(c.KEEP,c.KEEP,c.INVERT);if(d.mode===1){c.drawElements(c.TRIANGLE_FAN,d.indices.length-4,c.UNSIGNED_SHORT,0);if(this.reverse){c.stencilFunc(c.EQUAL,255-e,255);c.stencilOp(c.KEEP,c.KEEP,c.DECR)}else{c.stencilFunc(c.EQUAL,e,255);c.stencilOp(c.KEEP,c.KEEP,c.INCR)}c.drawElements(c.TRIANGLE_FAN,4,c.UNSIGNED_SHORT,(d.indices.length-4)*2);if(this.reverse){c.stencilFunc(c.EQUAL,255-(e+1),255)}else{c.stencilFunc(c.EQUAL,e+1,255)}this.reverse=!this.reverse}else{if(!this.reverse){c.stencilFunc(c.EQUAL,255-e,255);c.stencilOp(c.KEEP,c.KEEP,c.DECR)}else{c.stencilFunc(c.EQUAL,e,255);c.stencilOp(c.KEEP,c.KEEP,c.INCR)}c.drawElements(c.TRIANGLE_STRIP,d.indices.length,c.UNSIGNED_SHORT,0);if(!this.reverse){c.stencilFunc(c.EQUAL,255-(e+1),255)}else{c.stencilFunc(c.EQUAL,e+1,255)}}c.colorMask(true,true,true,true);c.stencilOp(c.KEEP,c.KEEP,c.KEEP);this.count++};PIXI.WebGLStencilManager.prototype.bindGraphics=function(b,g,d){this._currentGraphics=b;var f=this.gl;var a=d.projection,e=d.offset,c;if(g.mode===1){c=d.shaderManager.complexPrimitiveShader;d.shaderManager.setShader(c);f.uniform1f(c.flipY,d.flipY);f.uniformMatrix3fv(c.translationMatrix,false,b.worldTransform.toArray(true));f.uniform2f(c.projectionVector,a.x,-a.y);f.uniform2f(c.offsetVector,-e.x,-e.y);f.uniform3fv(c.tintColor,Phaser.Color.hexToRGBArray(b.tint));f.uniform3fv(c.color,g.color);f.uniform1f(c.alpha,b.worldAlpha*g.alpha);f.bindBuffer(f.ARRAY_BUFFER,g.buffer);f.vertexAttribPointer(c.aVertexPosition,2,f.FLOAT,false,4*2,0);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,g.indexBuffer)}else{c=d.shaderManager.primitiveShader;d.shaderManager.setShader(c);f.uniformMatrix3fv(c.translationMatrix,false,b.worldTransform.toArray(true));f.uniform1f(c.flipY,d.flipY);f.uniform2f(c.projectionVector,a.x,-a.y);f.uniform2f(c.offsetVector,-e.x,-e.y);f.uniform3fv(c.tintColor,Phaser.Color.hexToRGBArray(b.tint));f.uniform1f(c.alpha,b.worldAlpha);f.bindBuffer(f.ARRAY_BUFFER,g.buffer);f.vertexAttribPointer(c.aVertexPosition,2,f.FLOAT,false,4*6,0);f.vertexAttribPointer(c.colorAttribute,4,f.FLOAT,false,4*6,2*4);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,g.indexBuffer)}};PIXI.WebGLStencilManager.prototype.popStencil=function(a,d,b){var c=this.gl;this.stencilStack.pop();this.count--;if(this.stencilStack.length===0){c.disable(c.STENCIL_TEST)}else{var e=this.count;this.bindGraphics(a,d,b);c.colorMask(false,false,false,false);if(d.mode===1){this.reverse=!this.reverse;if(this.reverse){c.stencilFunc(c.EQUAL,255-(e+1),255);c.stencilOp(c.KEEP,c.KEEP,c.INCR)}else{c.stencilFunc(c.EQUAL,e+1,255);c.stencilOp(c.KEEP,c.KEEP,c.DECR)}c.drawElements(c.TRIANGLE_FAN,4,c.UNSIGNED_SHORT,(d.indices.length-4)*2);c.stencilFunc(c.ALWAYS,0,255);c.stencilOp(c.KEEP,c.KEEP,c.INVERT);c.drawElements(c.TRIANGLE_FAN,d.indices.length-4,c.UNSIGNED_SHORT,0);if(!this.reverse){c.stencilFunc(c.EQUAL,255-(e),255)}else{c.stencilFunc(c.EQUAL,e,255)}}else{if(!this.reverse){c.stencilFunc(c.EQUAL,255-(e+1),255);c.stencilOp(c.KEEP,c.KEEP,c.INCR)}else{c.stencilFunc(c.EQUAL,e+1,255);c.stencilOp(c.KEEP,c.KEEP,c.DECR)}c.drawElements(c.TRIANGLE_STRIP,d.indices.length,c.UNSIGNED_SHORT,0);if(!this.reverse){c.stencilFunc(c.EQUAL,255-(e),255)}else{c.stencilFunc(c.EQUAL,e,255)}}c.colorMask(true,true,true,true);c.stencilOp(c.KEEP,c.KEEP,c.KEEP)}};PIXI.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null;this.gl=null};PIXI.WebGLShaderManager=function(){this.maxAttibs=10;this.attribState=[];this.tempAttribState=[];for(var a=0;a<this.maxAttibs;a++){this.attribState[a]=false}this.stack=[]};PIXI.WebGLShaderManager.prototype.constructor=PIXI.WebGLShaderManager;PIXI.WebGLShaderManager.prototype.setContext=function(a){this.gl=a;this.primitiveShader=new PIXI.PrimitiveShader(a);this.complexPrimitiveShader=new PIXI.ComplexPrimitiveShader(a);this.defaultShader=new PIXI.PixiShader(a);this.fastShader=new PIXI.PixiFastShader(a);this.stripShader=new PIXI.StripShader(a);this.creatureShader=PIXI.CreatureShader?new PIXI.CreatureShader(a):null;this.setShader(this.defaultShader)};PIXI.WebGLShaderManager.prototype.setAttribs=function(d){var b;for(b=0;b<this.tempAttribState.length;b++){this.tempAttribState[b]=false}for(b=0;b<d.length;b++){var a=d[b];this.tempAttribState[a]=true}var c=this.gl;for(b=0;b<this.attribState.length;b++){if(this.attribState[b]!==this.tempAttribState[b]){this.attribState[b]=this.tempAttribState[b];if(this.tempAttribState[b]){c.enableVertexAttribArray(b)}else{c.disableVertexAttribArray(b)}}}};PIXI.WebGLShaderManager.prototype.setShader=function(a){if(this._currentId===a._UID){return false}this._currentId=a._UID;this.currentShader=a;this.gl.useProgram(a.program);this.setAttribs(a.attributes);return true};PIXI.WebGLShaderManager.prototype.destroy=function(){this.attribState=null;this.tempAttribState=null;this.primitiveShader.destroy();this.complexPrimitiveShader.destroy();this.defaultShader.destroy();this.fastShader.destroy();this.stripShader.destroy();if(this.creatureShader){this.creatureShader.destroy()}this.gl=null};PIXI.WebGLSpriteBatch=function(b){this.game=b;this.vertSize=5;this.size=2000;this.vertexSize=(4*2)+(4*2)+(4)+(4);var a=this.vertexSize*this.size*4;var e=this.size*6;this.vertices=new ArrayBuffer(a);this.positions=new Float32Array(this.vertices);this.colors=new Uint32Array(this.vertices);this.indices=new Uint16Array(e);this.lastIndexCount=0;for(var d=0,c=0;d<e;d+=6,c+=4){this.indices[d+0]=c+0;this.indices[d+1]=c+1;this.indices[d+2]=c+2;this.indices[d+3]=c+0;this.indices[d+4]=c+2;this.indices[d+5]=c+3}this.drawing=false;this.currentBatchSize=0;this.currentBaseTexture=null;this.dirty=true;this.textures=[];this.blendModes=[];this.shaders=[];this.sprites=[];this.defaultShader=null};PIXI.WebGLSpriteBatch.prototype.setContext=function(d){this.MAX_TEXTURES=d.getParameter(d.MAX_TEXTURE_IMAGE_UNITS);this.gl=d;if(PIXI._enableMultiTextureToggle){var a="\tif (vTextureIndex == 0.0) {gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\n";for(var b=1;b<this.MAX_TEXTURES;++b){a+="\tif (vTextureIndex == "+b+".0) {gl_FragColor = texture2D(uSamplerArray["+b+"], vTextureCoord) * vColor;return;}\n"}this.defaultShader=new Phaser.Filter(this.game,undefined,["//WebGLSpriteBatch Fragment Shader.","precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureIndex;","uniform sampler2D uSamplerArray["+this.MAX_TEXTURES+"];","void main(void) {",a,"\tgl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;","}"])}else{this.defaultShader=new Phaser.Filter(this.game,undefined,["//WebGLSpriteBatch Fragment Shader.","precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureIndex;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;","}"])}this.vertexBuffer=d.createBuffer();this.indexBuffer=d.createBuffer();d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,this.indexBuffer);d.bufferData(d.ELEMENT_ARRAY_BUFFER,this.indices,d.STATIC_DRAW);d.bindBuffer(d.ARRAY_BUFFER,this.vertexBuffer);d.bufferData(d.ARRAY_BUFFER,this.vertices,d.DYNAMIC_DRAW);this.currentBlendMode=99999;var c=new PIXI.PixiShader(d);c.fragmentSrc=this.defaultShader.fragmentSrc;c.uniforms={};c.init();this.defaultShader.shaders[d.id]=c};PIXI.WebGLSpriteBatch.prototype.begin=function(a){this.renderSession=a;this.shader=this.renderSession.shaderManager.defaultShader;this.start()};PIXI.WebGLSpriteBatch.prototype.end=function(){this.flush()};PIXI.WebGLSpriteBatch.prototype.render=function(n,v){var l=n.texture;var f=l.baseTexture;var h=this.gl;if(PIXI.WebGLRenderer.textureArray[f.textureIndex]!=f){this.flush();h.activeTexture(h.TEXTURE0+f.textureIndex);h.bindTexture(h.TEXTURE_2D,f._glTextures[h.id]);PIXI.WebGLRenderer.textureArray[f.textureIndex]=f}var L=n.worldTransform;if(v){L=v}if(this.currentBatchSize>=this.size){this.flush();this.currentBaseTexture=l.baseTexture}var B=l._uvs;if(!B){return}var o=n.anchor.x;var m=n.anchor.y;var z,x,t,s;if(l.trim){var e=l.trim;x=e.x-o*e.width;z=x+l.crop.width;s=e.y-m*e.height;t=s+l.crop.height}else{z=(l.frame.width)*(1-o);x=(l.frame.width)*-o;t=l.frame.height*(1-m);s=l.frame.height*-m}var I=this.currentBatchSize*this.vertexSize;var u=this.currentBatchSize*4;var C=l.baseTexture.resolution;var J=l.baseTexture.textureIndex;var O=L.a/C;var N=L.b/C;var M=L.c/C;var K=L.d/C;var H=L.tx;var G=L.ty;var p=l.crop.width;var w=l.crop.height;if(l.rotated){var E=L.a;var q=L.b;var g=L.c;var F=L.d;var y=x;var A=z;H=L.c*w+H;G=L.d*w+G;O=E*6.123233995736766e-17+-g;N=q*6.123233995736766e-17+-F;M=E+g*6.123233995736766e-17;K=q+F*6.123233995736766e-17;l._updateUvsInverted();z=t;x=s;t=A;s=y}var D=this.colors;var j=this.positions;var k=n.tint;var r=(k>>16)+(k&65280)+((k&255)<<16)+(n.worldAlpha*255<<24);if(this.renderSession.roundPixels){j[I++]=O*x+M*s+H|0;j[I++]=K*s+N*x+G|0;j[I++]=B.x0;j[I++]=B.y0;D[I++]=r;j[I++]=J;j[I++]=O*z+M*s+H|0;j[I++]=K*s+N*z+G|0;j[I++]=B.x1;j[I++]=B.y1;D[I++]=r;j[I++]=J;j[I++]=O*z+M*t+H|0;j[I++]=K*t+N*z+G|0;j[I++]=B.x2;j[I++]=B.y2;D[I++]=r;j[I++]=J;j[I++]=O*x+M*t+H|0;j[I++]=K*t+N*x+G|0;j[I++]=B.x3;j[I++]=B.y3;D[I++]=r;j[I++]=J}else{j[I++]=O*x+M*s+H;j[I++]=K*s+N*x+G;j[I++]=B.x0;j[I++]=B.y0;D[I++]=r;j[I++]=J;j[I++]=O*z+M*s+H;j[I++]=K*s+N*z+G;j[I++]=B.x1;j[I++]=B.y1;D[I++]=r;j[I++]=J;j[I++]=O*z+M*t+H;j[I++]=K*t+N*z+G;j[I++]=B.x2;j[I++]=B.y2;D[I++]=r;j[I++]=J;j[I++]=O*x+M*t+H;j[I++]=K*t+N*x+G;j[I++]=B.x3;j[I++]=B.y3;D[I++]=r;j[I++]=J}this.sprites[this.currentBatchSize++]=n};PIXI.WebGLSpriteBatch.prototype.renderTilingSprite=function(v){var t=v.tilingTexture;var r=t.baseTexture;var C=this.gl;var z=v.texture.baseTexture.textureIndex;if(PIXI.WebGLRenderer.textureArray[z]!=r){this.flush();C.activeTexture(C.TEXTURE0+z);C.bindTexture(C.TEXTURE_2D,r._glTextures[C.id]);PIXI.WebGLRenderer.textureArray[z]=r}if(this.currentBatchSize>=this.size){this.flush();this.currentBaseTexture=t.baseTexture}if(!v._uvs){v._uvs=new PIXI.TextureUvs()}var o=v._uvs;var q=t.baseTexture.width;var D=t.baseTexture.height;v.tilePosition.x%=q*v.tileScaleOffset.x;v.tilePosition.y%=D*v.tileScaleOffset.y;var F=v.tilePosition.x/(q*v.tileScaleOffset.x);var E=v.tilePosition.y/(D*v.tileScaleOffset.y);var L=(v.width/q)/(v.tileScale.x*v.tileScaleOffset.x);var I=(v.height/D)/(v.tileScale.y*v.tileScaleOffset.y);o.x0=0-F;o.y0=0-E;o.x1=(1*L)-F;o.y1=0-E;o.x2=(1*L)-F;o.y2=(1*I)-E;o.x3=0-F;o.y3=(1*I)-E;var j=v.tint;var A=(j>>16)+(j&65280)+((j&255)<<16)+(v.worldAlpha*255<<24);var l=this.positions;var n=this.colors;var x=v.width;var u=v.height;var g=v.anchor.x;var f=v.anchor.y;var s=x*(1-g);var p=x*-g;var m=u*(1-f);var k=u*-f;var B=this.currentBatchSize*this.vertexSize;var y=t.baseTexture.resolution;var e=v.worldTransform;var N=e.a/y;var K=e.b/y;var H=e.c/y;var G=e.d/y;var M=e.tx;var J=e.ty;l[B++]=N*p+H*k+M;l[B++]=G*k+K*p+J;l[B++]=o.x0;l[B++]=o.y0;n[B++]=A;l[B++]=z;l[B++]=(N*s+H*k+M);l[B++]=G*k+K*s+J;l[B++]=o.x1;l[B++]=o.y1;n[B++]=A;l[B++]=z;l[B++]=N*s+H*m+M;l[B++]=G*m+K*s+J;l[B++]=o.x2;l[B++]=o.y2;n[B++]=A;l[B++]=z;l[B++]=N*p+H*m+M;l[B++]=G*m+K*p+J;l[B++]=o.x3;l[B++]=o.y3;n[B++]=A;l[B++]=z;this.sprites[this.currentBatchSize++]=v};PIXI.WebGLSpriteBatch.prototype.flush=function(){if(this.currentBatchSize===0){return}var s=this.gl;var a;if(this.dirty){this.dirty=false;a=this.defaultShader.shaders[s.id];s.activeTexture(s.TEXTURE0);s.bindBuffer(s.ARRAY_BUFFER,this.vertexBuffer);s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var l=this.vertexSize;s.vertexAttribPointer(a.aVertexPosition,2,s.FLOAT,false,l,0);s.vertexAttribPointer(a.aTextureCoord,2,s.FLOAT,false,l,8);s.vertexAttribPointer(a.colorAttribute,4,s.UNSIGNED_BYTE,true,l,16);s.vertexAttribPointer(a.aTextureIndex,1,s.FLOAT,false,l,20)}if(this.currentBatchSize>(this.size*0.5)){s.bufferSubData(s.ARRAY_BUFFER,0,this.vertices)}else{s.bindBuffer(s.ARRAY_BUFFER,this.vertexBuffer);var g=this.positions.subarray(0,this.currentBatchSize*this.vertexSize);s.bufferSubData(s.ARRAY_BUFFER,0,g)}var q,v,f;var n=0;var e=0;var u=null;var h=this.renderSession.blendModeManager.currentBlendMode;var b=null;var d=false;var c=false;var k;var p=0;for(var t=0,r=this.currentBatchSize;t<r;t++){k=this.sprites[t];if(k.tilingTexture){q=k.tilingTexture.baseTexture}else{q=k.texture.baseTexture}v=k.blendMode;f=k.shader||this.defaultShader;d=h!==v;c=b!==f;var m=q.skipRender;if(m&&k.children.length>0){m=false}if(d||c){this.renderBatch(u,n,e);e=t;n=0;u=q;if(d){h=v;this.renderSession.blendModeManager.setBlendMode(h)}if(c){b=f;a=b.shaders[s.id];if(!a){a=new PIXI.PixiShader(s);a.fragmentSrc=b.fragmentSrc;a.uniforms=b.uniforms;a.init();b.shaders[s.id]=a}this.renderSession.shaderManager.setShader(a);if(a.dirty){a.syncUniforms()}var w=this.renderSession.projection;s.uniform2f(a.projectionVector,w.x,w.y);var o=this.renderSession.offset;s.uniform2f(a.offsetVector,o.x,o.y)}}n++}this.renderBatch(u,n,e);this.currentBatchSize=0};PIXI.WebGLSpriteBatch.prototype.renderBatch=function(b,a,d){if(a===0){return}var c=this.gl;if(b._dirty[c.id]){if(!this.renderSession.renderer.updateTexture(b)){return}}else{c.bindTexture(c.TEXTURE_2D,b._glTextures[c.id])}c.drawElements(c.TRIANGLES,a*6,c.UNSIGNED_SHORT,d*6*2);this.renderSession.drawCount++};PIXI.WebGLSpriteBatch.prototype.stop=function(){this.flush();this.dirty=true};PIXI.WebGLSpriteBatch.prototype.start=function(){this.dirty=true};PIXI.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null;this.indices=null;this.gl.deleteBuffer(this.vertexBuffer);this.gl.deleteBuffer(this.indexBuffer);this.currentBaseTexture=null;this.gl=null};PIXI.WebGLFastSpriteBatch=function(e){this.vertSize=11;this.maxSize=6000;this.size=this.maxSize;var a=this.size*4*this.vertSize;var d=this.maxSize*6;this.vertices=new Float32Array(a);this.indices=new Uint16Array(d);this.vertexBuffer=null;this.indexBuffer=null;this.lastIndexCount=0;for(var c=0,b=0;c<d;c+=6,b+=4){this.indices[c+0]=b+0;this.indices[c+1]=b+1;this.indices[c+2]=b+2;this.indices[c+3]=b+0;this.indices[c+4]=b+2;this.indices[c+5]=b+3}this.drawing=false;this.currentBatchSize=0;this.currentBaseTexture=null;this.currentBlendMode=0;this.renderSession=null;this.shader=null;this.matrix=null;this.setContext(e)};PIXI.WebGLFastSpriteBatch.prototype.constructor=PIXI.WebGLFastSpriteBatch;PIXI.WebGLFastSpriteBatch.prototype.setContext=function(a){this.gl=a;this.vertexBuffer=a.createBuffer();this.indexBuffer=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW);a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer);a.bufferData(a.ARRAY_BUFFER,this.vertices,a.DYNAMIC_DRAW)};PIXI.WebGLFastSpriteBatch.prototype.begin=function(a,b){this.renderSession=b;this.shader=this.renderSession.shaderManager.fastShader;this.matrix=a.worldTransform.toArray(true);this.start()};PIXI.WebGLFastSpriteBatch.prototype.end=function(){this.flush()};PIXI.WebGLFastSpriteBatch.prototype.render=function(a){var e=a.children;var d=e[0];if(!d.texture._uvs){return}this.currentBaseTexture=d.texture.baseTexture;if(d.blendMode!==this.renderSession.blendModeManager.currentBlendMode){this.flush();this.renderSession.blendModeManager.setBlendMode(d.blendMode)}for(var c=0,b=e.length;c<b;c++){this.renderSprite(e[c])}this.flush()};PIXI.WebGLFastSpriteBatch.prototype.renderSprite=function(m){var j=m.texture;var a=j.baseTexture;var f=this.gl;var o=m.texture.baseTexture.textureIndex;if(PIXI.WebGLRenderer.textureArray[o]!=a&&a._glTextures[f.id]&&!m.texture.baseTexture.skipRender){this.flush();f.activeTexture(f.TEXTURE0+o);f.bindTexture(f.TEXTURE_2D,a._glTextures[f.id]);PIXI.WebGLRenderer.textureArray[o]=a;if(!m.texture._uvs){return}}if(!m.visible){return}var d,i=this.vertices,b,n,g,e,l,k,h;d=m.texture._uvs;b=m.texture.frame.width;n=m.texture.frame.height;if(m.texture.trim){var c=m.texture.trim;e=c.x-m.anchor.x*c.width;g=e+m.texture.crop.width;k=c.y-m.anchor.y*c.height;l=k+m.texture.crop.height}else{g=(m.texture.frame.width)*(1-m.anchor.x);e=(m.texture.frame.width)*-m.anchor.x;l=m.texture.frame.height*(1-m.anchor.y);k=m.texture.frame.height*-m.anchor.y}h=this.currentBatchSize*4*this.vertSize;i[h++]=e;i[h++]=k;i[h++]=m.position.x;i[h++]=m.position.y;i[h++]=m.scale.x;i[h++]=m.scale.y;i[h++]=m.rotation;i[h++]=d.x0;i[h++]=d.y1;i[h++]=m.alpha;i[h++]=o;i[h++]=g;i[h++]=k;i[h++]=m.position.x;i[h++]=m.position.y;i[h++]=m.scale.x;i[h++]=m.scale.y;i[h++]=m.rotation;i[h++]=d.x1;i[h++]=d.y1;i[h++]=m.alpha;i[h++]=o;i[h++]=g;i[h++]=l;i[h++]=m.position.x;i[h++]=m.position.y;i[h++]=m.scale.x;i[h++]=m.scale.y;i[h++]=m.rotation;i[h++]=d.x2;i[h++]=d.y2;i[h++]=m.alpha;i[h++]=o;i[h++]=e;i[h++]=l;i[h++]=m.position.x;i[h++]=m.position.y;i[h++]=m.scale.x;i[h++]=m.scale.y;i[h++]=m.rotation;i[h++]=d.x3;i[h++]=d.y3;i[h++]=m.alpha;i[h++]=o;this.currentBatchSize++;if(this.currentBatchSize>=this.size){this.flush()}};PIXI.WebGLFastSpriteBatch.prototype.flush=function(){if(this.currentBatchSize===0){return}var b=this.gl;if(!this.currentBaseTexture._glTextures[b.id]){this.renderSession.renderer.updateTexture(this.currentBaseTexture,b);return}if(this.currentBatchSize>(this.size*0.5)){b.bufferSubData(b.ARRAY_BUFFER,0,this.vertices)}else{var a=this.vertices.subarray(0,this.currentBatchSize*4*this.vertSize);b.bufferSubData(b.ARRAY_BUFFER,0,a)}b.drawElements(b.TRIANGLES,this.currentBatchSize*6,b.UNSIGNED_SHORT,0);this.currentBatchSize=0;this.renderSession.drawCount++};PIXI.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()};PIXI.WebGLFastSpriteBatch.prototype.start=function(){var c=this.gl;c.activeTexture(c.TEXTURE0);c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var a=this.renderSession.projection;c.uniform2f(this.shader.projectionVector,a.x,a.y);c.uniformMatrix3fv(this.shader.uMatrix,false,this.matrix);var b=this.vertSize*4;c.vertexAttribPointer(this.shader.aVertexPosition,2,c.FLOAT,false,b,0);c.vertexAttribPointer(this.shader.aPositionCoord,2,c.FLOAT,false,b,2*4);c.vertexAttribPointer(this.shader.aScale,2,c.FLOAT,false,b,4*4);c.vertexAttribPointer(this.shader.aRotation,1,c.FLOAT,false,b,6*4);c.vertexAttribPointer(this.shader.aTextureCoord,2,c.FLOAT,false,b,7*4);c.vertexAttribPointer(this.shader.colorAttribute,1,c.FLOAT,false,b,9*4);c.vertexAttribPointer(this.shader.aTextureIndex,1,c.FLOAT,false,b,10*4)};PIXI.WebGLFilterManager=function(){this.filterStack=[];this.offsetX=0;this.offsetY=0};PIXI.WebGLFilterManager.prototype.constructor=PIXI.WebGLFilterManager;PIXI.WebGLFilterManager.prototype.setContext=function(a){this.gl=a;this.texturePool=[];this.initShaderBuffers()};PIXI.WebGLFilterManager.prototype.begin=function(c,b){this.renderSession=c;this.defaultShader=c.shaderManager.defaultShader;var a=this.renderSession.projection;this.width=a.x*2;this.height=-a.y*2;this.buffer=b};PIXI.WebGLFilterManager.prototype.pushFilter=function(b){var h=this.gl;var a=this.renderSession.projection;var g=this.renderSession.offset;b._filterArea=b.target.filterArea||b.target.getBounds();b._previous_stencil_mgr=this.renderSession.stencilManager;this.renderSession.stencilManager=new PIXI.WebGLStencilManager();this.renderSession.stencilManager.setContext(h);h.disable(h.STENCIL_TEST);this.filterStack.push(b);var c=b.filterPasses[0];this.offsetX+=b._filterArea.x;this.offsetY+=b._filterArea.y;var d=this.texturePool.pop();if(!d){d=new PIXI.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution)}else{d.resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution)}h.bindTexture(h.TEXTURE_2D,d.texture);var e=b._filterArea;var f=c.padding;e.x-=f;e.y-=f;e.width+=f*2;e.height+=f*2;if(e.x<0){e.x=0}if(e.width>this.width){e.width=this.width}if(e.y<0){e.y=0}if(e.height>this.height){e.height=this.height}h.bindFramebuffer(h.FRAMEBUFFER,d.frameBuffer);h.viewport(0,0,e.width*this.renderSession.resolution,e.height*this.renderSession.resolution);a.x=e.width/2;a.y=-e.height/2;g.x=-e.x;g.y=-e.y;h.colorMask(true,true,true,true);h.clearColor(0,0,0,0);h.clear(h.COLOR_BUFFER_BIT);b._glFilterTexture=d};PIXI.WebGLFilterManager.prototype.popFilter=function(){var n=this.gl;var k=this.filterStack.pop();var t=k._filterArea;var h=k._glFilterTexture;var u=this.renderSession.projection;var d=this.renderSession.offset;if(k.filterPasses.length>1){n.viewport(0,0,t.width*this.renderSession.resolution,t.height*this.renderSession.resolution);n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=0;this.vertexArray[1]=t.height;this.vertexArray[2]=t.width;this.vertexArray[3]=t.height;this.vertexArray[4]=0;this.vertexArray[5]=0;this.vertexArray[6]=t.width;this.vertexArray[7]=0;n.bufferSubData(n.ARRAY_BUFFER,0,this.vertexArray);n.bindBuffer(n.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=t.width/this.width;this.uvArray[5]=t.height/this.height;this.uvArray[6]=t.width/this.width;this.uvArray[7]=t.height/this.height;n.bufferSubData(n.ARRAY_BUFFER,0,this.uvArray);var p=h;var b=this.texturePool.pop();if(!b){b=new PIXI.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution)}b.resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution);n.bindFramebuffer(n.FRAMEBUFFER,b.frameBuffer);n.clear(n.COLOR_BUFFER_BIT);n.disable(n.BLEND);for(var o=0;o<k.filterPasses.length-1;o++){var c=k.filterPasses[o];n.bindFramebuffer(n.FRAMEBUFFER,b.frameBuffer);n.activeTexture(n.TEXTURE0);n.bindTexture(n.TEXTURE_2D,p.texture);this.applyFilterPass(c,t,t.width,t.height);var s=p;p=b;b=s}n.enable(n.BLEND);h=p;this.texturePool.push(b)}var g=k.filterPasses[k.filterPasses.length-1];this.offsetX-=t.x;this.offsetY-=t.y;var l=this.width;var j=this.height;var r=0;var q=0;var m=this.buffer;if(this.filterStack.length===0){n.colorMask(true,true,true,true)}else{var a=this.filterStack[this.filterStack.length-1];t=a._filterArea;l=t.width;j=t.height;r=t.x;q=t.y;m=a._glFilterTexture.frameBuffer}u.x=l/2;u.y=-j/2;d.x=r;d.y=q;t=k._filterArea;var f=t.x-r;var e=t.y-q;n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=f;this.vertexArray[1]=e+t.height;this.vertexArray[2]=f+t.width;this.vertexArray[3]=e+t.height;this.vertexArray[4]=f;this.vertexArray[5]=e;this.vertexArray[6]=f+t.width;this.vertexArray[7]=e;n.bufferSubData(n.ARRAY_BUFFER,0,this.vertexArray);n.bindBuffer(n.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=t.width/this.width;this.uvArray[5]=t.height/this.height;this.uvArray[6]=t.width/this.width;this.uvArray[7]=t.height/this.height;n.bufferSubData(n.ARRAY_BUFFER,0,this.uvArray);n.viewport(0,0,l*this.renderSession.resolution,j*this.renderSession.resolution);n.bindFramebuffer(n.FRAMEBUFFER,m);n.activeTexture(n.TEXTURE0);n.bindTexture(n.TEXTURE_2D,h.texture);if(this.renderSession.stencilManager){this.renderSession.stencilManager.destroy()}this.renderSession.stencilManager=k._previous_stencil_mgr;k._previous_stencil_mgr=null;if(this.renderSession.stencilManager.count>0){n.enable(n.STENCIL_TEST)}else{n.disable(n.STENCIL_TEST)}this.applyFilterPass(g,t,l,j);this.texturePool.push(h);k._glFilterTexture=null};PIXI.WebGLFilterManager.prototype.applyFilterPass=function(c,e,b,a){var f=this.gl;var d=c.shaders[f.id];if(!d){d=new PIXI.PixiShader(f);d.fragmentSrc=c.fragmentSrc;d.uniforms=c.uniforms;d.init(true);c.shaders[f.id]=d}this.renderSession.shaderManager.setShader(d);f.uniform2f(d.projectionVector,b/2,-a/2);f.uniform2f(d.offsetVector,0,0);if(c.uniforms.dimensions){c.uniforms.dimensions.value[0]=this.width;c.uniforms.dimensions.value[1]=this.height;c.uniforms.dimensions.value[2]=this.vertexArray[0];c.uniforms.dimensions.value[3]=this.vertexArray[5]}d.syncUniforms();f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer);f.vertexAttribPointer(d.aVertexPosition,2,f.FLOAT,false,0,0);f.bindBuffer(f.ARRAY_BUFFER,this.uvBuffer);f.vertexAttribPointer(d.aTextureCoord,2,f.FLOAT,false,0,0);f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer);f.vertexAttribPointer(d.colorAttribute,2,f.FLOAT,false,0,0);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.indexBuffer);f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0);this.renderSession.drawCount++};PIXI.WebGLFilterManager.prototype.initShaderBuffers=function(){var a=this.gl;this.vertexBuffer=a.createBuffer();this.uvBuffer=a.createBuffer();this.colorBuffer=a.createBuffer();this.indexBuffer=a.createBuffer();this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]);a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer);a.bufferData(a.ARRAY_BUFFER,this.vertexArray,a.STATIC_DRAW);this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]);a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer);a.bufferData(a.ARRAY_BUFFER,this.uvArray,a.STATIC_DRAW);this.colorArray=new Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]);a.bindBuffer(a.ARRAY_BUFFER,this.colorBuffer);a.bufferData(a.ARRAY_BUFFER,this.colorArray,a.STATIC_DRAW);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),a.STATIC_DRAW)};PIXI.WebGLFilterManager.prototype.destroy=function(){var b=this.gl;this.filterStack=null;this.offsetX=0;this.offsetY=0;for(var a=0;a<this.texturePool.length;a++){this.texturePool[a].destroy()}this.texturePool=null;b.deleteBuffer(this.vertexBuffer);b.deleteBuffer(this.uvBuffer);b.deleteBuffer(this.colorBuffer);b.deleteBuffer(this.indexBuffer)};function _CreateEmptyTexture(e,c,a,b){var d=e.createTexture();e.bindTexture(e.TEXTURE_2D,d);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,b===PIXI.scaleModes.LINEAR?e.LINEAR:e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,b===PIXI.scaleModes.LINEAR?e.LINEAR:e.NEAREST);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,c,a,0,e.RGBA,e.UNSIGNED_BYTE,null);return d}var _fbErrors={36054:"Incomplete attachment",36055:"Missing attachment",36057:"Incomplete dimensions",36061:"Framebuffer unsupported"};function _CreateFramebuffer(c,a,h,g,i){var e=c.createFramebuffer();var d=c.createRenderbuffer();var f=null;var b=0;c.activeTexture(c.TEXTURE0+i);c.bindFramebuffer(c.FRAMEBUFFER,e);c.bindRenderbuffer(c.RENDERBUFFER,d);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,this.renderBuffer);f=_CreateEmptyTexture(c,a,h,g);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,f,0);b=c.checkFramebufferStatus(c.FRAMEBUFFER);if(b!==c.FRAMEBUFFER_COMPLETE){console.error("Incomplete GL framebuffer. ",_fbErrors[b])}e.width=a;e.height=h;e.targetTexture=f;e.renderBuffer=d;return e}PIXI.FilterTexture=function(e,d,a,c,b){b=typeof b==="number"?b:0;this.gl=e;this.frameBuffer=_CreateFramebuffer(e,d,a,c||PIXI.scaleModes.DEFAULT,b);this.texture=this.frameBuffer.targetTexture;this.width=d;this.height=a;this.renderBuffer=this.frameBuffer.renderBuffer};PIXI.FilterTexture.prototype.constructor=PIXI.FilterTexture;PIXI.FilterTexture.prototype.clear=function(){var a=this.gl;a.clearColor(0,0,0,0);a.clear(a.COLOR_BUFFER_BIT)};PIXI.FilterTexture.prototype.resize=function(b,a){if(this.width===b&&this.height===a){return}this.width=b;this.height=a;var c=this.gl;c.bindTexture(c.TEXTURE_2D,this.texture);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,b,a,0,c.RGBA,c.UNSIGNED_BYTE,null);c.bindRenderbuffer(c.RENDERBUFFER,this.renderBuffer);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,b,a)};PIXI.FilterTexture.prototype.destroy=function(){var a=this.gl;a.deleteFramebuffer(this.frameBuffer);a.deleteTexture(this.texture);this.frameBuffer=null;this.texture=null};PIXI.CanvasBuffer=function(b,a){this.width=b;this.height=a;this.canvas=Phaser.CanvasPool.create(this,this.width,this.height);this.context=this.canvas.getContext("2d");this.canvas.width=b;this.canvas.height=a};PIXI.CanvasBuffer.prototype.constructor=PIXI.CanvasBuffer;PIXI.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.width,this.height)};PIXI.CanvasBuffer.prototype.resize=function(b,a){this.width=this.canvas.width=b;this.height=this.canvas.height=a};PIXI.CanvasBuffer.prototype.destroy=function(){Phaser.CanvasPool.remove(this)};PIXI.CanvasMaskManager=function(){};PIXI.CanvasMaskManager.prototype.constructor=PIXI.CanvasMaskManager;PIXI.CanvasMaskManager.prototype.pushMask=function(f,e){var d=e.context;d.save();var a=f.alpha;var c=f.worldTransform;var b=e.resolution;d.setTransform(c.a*b,c.b*b,c.c*b,c.d*b,c.tx*b,c.ty*b);PIXI.CanvasGraphics.renderGraphicsMask(f,d);d.clip();f.worldAlpha=a};PIXI.CanvasMaskManager.prototype.popMask=function(a){a.context.restore()};PIXI.CanvasTinter=function(){};PIXI.CanvasTinter.getTintedTexture=function(c,a){var b=c.tintedTexture||Phaser.CanvasPool.create(this);PIXI.CanvasTinter.tintMethod(c.texture,a,b);return b};PIXI.CanvasTinter.tintWithMultiply=function(g,b,c){var d=c.getContext("2d");var f=g.crop;var a=f.width;var e=f.height;if(g.rotated){a=e;e=f.width}if(c.width!==a||c.height!==e){c.width=a;c.height=e}d.clearRect(0,0,a,e);d.fillStyle="#"+("00000"+(b|0).toString(16)).substr(-6);d.fillRect(0,0,a,e);d.globalCompositeOperation="multiply";d.drawImage(g.baseTexture.source,f.x,f.y,a,e,0,0,a,e);d.globalCompositeOperation="destination-atop";d.drawImage(g.baseTexture.source,f.x,f.y,a,e,0,0,a,e)};PIXI.CanvasTinter.tintWithPerPixel=function(p,k,e){var d=e.getContext("2d");var m=p.crop;var s=m.width;var n=m.height;if(p.rotated){s=n;n=m.width}if(e.width!==s||e.height!==n){e.width=s;e.height=n}d.globalCompositeOperation="copy";d.drawImage(p.baseTexture.source,m.x,m.y,s,n,0,0,s,n);var c=Phaser.Color.hexToRGBArray(k);var a=c[0],o=c[1],q=c[2];var t=d.getImageData(0,0,s,n);var f=t.data;for(var l=0;l<f.length;l+=4){f[l+0]*=a;f[l+1]*=o;f[l+2]*=q;if(!PIXI.CanvasTinter.canHandleAlpha){var j=f[l+3];f[l+0]/=255/j;f[l+1]/=255/j;f[l+2]/=255/j}}d.putImageData(t,0,0)};PIXI.CanvasRenderer=function(a){this.game=a;if(!PIXI.defaultRenderer){PIXI.defaultRenderer=this}this.type=Phaser.CANVAS;this.resolution=a.resolution;this.clearBeforeRender=a.clearBeforeRender;this.transparent=a.transparent;this.autoResize=false;this.width=a.width*this.resolution;this.height=a.height*this.resolution;this.view=a.canvas;this.context=this.view.getContext("2d",{alpha:this.transparent});this.refresh=true;this.count=0;this.maskManager=new PIXI.CanvasMaskManager();this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:Phaser.Canvas.getSmoothingPrefix(this.context),roundPixels:false};this.mapBlendModes();this.resize(this.width,this.height)};PIXI.CanvasRenderer.prototype.constructor=PIXI.CanvasRenderer;PIXI.CanvasRenderer.prototype.render=function(a){this.context.setTransform(1,0,0,1,0,0);this.context.globalAlpha=1;this.renderSession.currentBlendMode=0;this.renderSession.shakeX=this.game.camera._shake.x;this.renderSession.shakeY=this.game.camera._shake.y;this.context.globalCompositeOperation="source-over";if(navigator.isCocoonJS&&this.view.screencanvas){this.context.fillStyle="black";this.context.clear()}if(this.clearBeforeRender){if(this.transparent){this.context.clearRect(0,0,this.width,this.height)}else{if(a._bgColor){this.context.fillStyle=a._bgColor.rgba;this.context.fillRect(0,0,this.width,this.height)}}}this.renderDisplayObject(a)};PIXI.CanvasRenderer.prototype.setTexturePriority=function(a){};PIXI.CanvasRenderer.prototype.destroy=function(a){if(a===undefined){a=true}if(a&&this.view.parent){this.view.parent.removeChild(this.view)}this.view=null;this.context=null;this.maskManager=null;this.renderSession=null};PIXI.CanvasRenderer.prototype.resize=function(b,a){this.width=b*this.resolution;this.height=a*this.resolution;this.view.width=this.width;this.view.height=this.height;if(this.autoResize){this.view.style.width=this.width/this.resolution+"px";this.view.style.height=this.height/this.resolution+"px"}if(this.renderSession.smoothProperty){this.context[this.renderSession.smoothProperty]=(this.renderSession.scaleMode===PIXI.scaleModes.LINEAR)}};PIXI.CanvasRenderer.prototype.renderDisplayObject=function(c,b,a){this.renderSession.context=b||this.context;this.renderSession.resolution=this.resolution;c._renderCanvas(this.renderSession,a)};PIXI.CanvasRenderer.prototype.mapBlendModes=function(){if(!PIXI.blendModesCanvas){var a=[];var c=PIXI.blendModes;var d=this.game.device.canUseMultiply;a[c.NORMAL]="source-over";a[c.ADD]="lighter";a[c.MULTIPLY]=(d)?"multiply":"source-over";a[c.SCREEN]=(d)?"screen":"source-over";a[c.OVERLAY]=(d)?"overlay":"source-over";a[c.DARKEN]=(d)?"darken":"source-over";a[c.LIGHTEN]=(d)?"lighten":"source-over";a[c.COLOR_DODGE]=(d)?"color-dodge":"source-over";a[c.COLOR_BURN]=(d)?"color-burn":"source-over";a[c.HARD_LIGHT]=(d)?"hard-light":"source-over";a[c.SOFT_LIGHT]=(d)?"soft-light":"source-over";a[c.DIFFERENCE]=(d)?"difference":"source-over";a[c.EXCLUSION]=(d)?"exclusion":"source-over";a[c.HUE]=(d)?"hue":"source-over";a[c.SATURATION]=(d)?"saturation":"source-over";a[c.COLOR]=(d)?"color":"source-over";a[c.LUMINOSITY]=(d)?"luminosity":"source-over";PIXI.blendModesCanvas=a}};PIXI.BaseTexture=function(c,b,a){this.resolution=a||1;this.width=100;this.height=100;this.scaleMode=b||PIXI.scaleModes.DEFAULT;this.hasLoaded=false;this.source=c;this.premultipliedAlpha=true;this._glTextures=[];this.mipmap=false;this.textureIndex=0;this._dirty=[true,true,true,true];if(!c){return}if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height){this.hasLoaded=true;this.width=this.source.naturalWidth||this.source.width;this.height=this.source.naturalHeight||this.source.height;this.dirty()}this.skipRender=false;this._powerOf2=false};PIXI.BaseTexture.prototype.constructor=PIXI.BaseTexture;PIXI.BaseTexture.prototype.forceLoaded=function(b,a){this.hasLoaded=true;this.width=b;this.height=a;this.dirty()};PIXI.BaseTexture.prototype.destroy=function(){if(this.source){Phaser.CanvasPool.removeByCanvas(this.source)}this.source=null;this.unloadFromGPU()};PIXI.BaseTexture.prototype.updateSourceImage=function(a){console.warn("PIXI.BaseTexture.updateSourceImage is deprecated. Use Phaser.Sprite.loadTexture instead.")};PIXI.BaseTexture.prototype.dirty=function(){for(var a=0;a<this._glTextures.length;a++){this._dirty[a]=true}};PIXI.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var b=this._glTextures.length-1;b>=0;b--){var a=this._glTextures[b];var c=PIXI.glContexts[b];if(c&&a){c.deleteTexture(a)}}this._glTextures.length=0;this.dirty()};PIXI.BaseTexture.fromCanvas=function(b,c,a){if(b.width===0){b.width=1}if(b.height===0){b.height=1}a=a||1;return new PIXI.BaseTexture(b,c,a)};PIXI.TextureSilentFail=false;PIXI.Texture=function(c,d,b,a){this.noFrame=false;if(!d){this.noFrame=true;d=new PIXI.Rectangle(0,0,1,1)}if(c instanceof PIXI.Texture){c=c.baseTexture}this.baseTexture=c;this.frame=d;this.trim=a;this.valid=false;this.isTiling=false;this.requiresUpdate=false;this.requiresReTint=false;this._uvs=null;this.width=0;this.height=0;this.crop=b||new PIXI.Rectangle(0,0,1,1);this.rotated=false;if(c.hasLoaded){if(this.noFrame){d=new PIXI.Rectangle(0,0,c.width,c.height)}this.setFrame(d)}};PIXI.Texture.prototype.constructor=PIXI.Texture;PIXI.Texture.prototype.onBaseTextureLoaded=function(){var a=this.baseTexture;if(this.noFrame){this.frame=new PIXI.Rectangle(0,0,a.width,a.height)}this.setFrame(this.frame)};PIXI.Texture.prototype.destroy=function(a){if(a){this.baseTexture.destroy()}this.valid=false};PIXI.Texture.prototype.setFrame=function(a){this.noFrame=false;this.frame=a;this.width=a.width;this.height=a.height;this.crop.x=a.x;this.crop.y=a.y;this.crop.width=a.width;this.crop.height=a.height;if(!this.trim&&(a.x+a.width>this.baseTexture.width||a.y+a.height>this.baseTexture.height)){if(!PIXI.TextureSilentFail){throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this)}this.valid=false;return}this.valid=a&&a.width&&a.height&&this.baseTexture.source&&this.baseTexture.hasLoaded;if(this.trim){this.width=this.trim.width;this.height=this.trim.height;this.frame.width=this.trim.width;this.frame.height=this.trim.height}if(this.valid){this._updateUvs()}};PIXI.Texture.prototype._updateUvs=function(){if(!this._uvs){this._uvs=new PIXI.TextureUvs()}var c=this.crop;var a=this.baseTexture.width;var b=this.baseTexture.height;this._uvs.x0=c.x/a;this._uvs.y0=c.y/b;this._uvs.x1=(c.x+c.width)/a;this._uvs.y1=c.y/b;this._uvs.x2=(c.x+c.width)/a;this._uvs.y2=(c.y+c.height)/b;this._uvs.x3=c.x/a;this._uvs.y3=(c.y+c.height)/b};PIXI.Texture.prototype._updateUvsInverted=function(){if(!this._uvs){this._uvs=new PIXI.TextureUvs()}var c=this.crop;var a=this.baseTexture.width;var b=this.baseTexture.height;this._uvs.x0=c.x/a;this._uvs.y0=c.y/b;this._uvs.x1=(c.x+c.height)/a;this._uvs.y1=c.y/b;this._uvs.x2=(c.x+c.height)/a;this._uvs.y2=(c.y+c.width)/b;this._uvs.x3=c.x/a;this._uvs.y3=(c.y+c.width)/b};PIXI.Texture.fromCanvas=function(a,b){var c=PIXI.BaseTexture.fromCanvas(a,b);return new PIXI.Texture(c)};PIXI.TextureUvs=function(){this.x0=0;this.y0=0;this.x1=0;this.y1=0;this.x2=0;this.y2=0;this.x3=0;this.y3=0};var Phaser=Phaser||{VERSION:"2.9.1",GAMES:[],AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,WEBGL_MULTI:4,NONE:0,LEFT:1,RIGHT:2,UP:3,DOWN:4,SPRITE:0,BUTTON:1,IMAGE:2,GRAPHICS:3,TEXT:4,TILESPRITE:5,BITMAPTEXT:6,GROUP:7,RENDERTEXTURE:8,TILEMAP:9,TILEMAPLAYER:10,EMITTER:11,POLYGON:12,BITMAPDATA:13,CANVAS_FILTER:14,WEBGL_FILTER:15,ELLIPSE:16,SPRITEBATCH:17,RETROFONT:18,POINTER:19,ROPE:20,CIRCLE:21,RECTANGLE:22,LINE:23,MATRIX:24,POINT:25,ROUNDEDRECTANGLE:26,CREATURE:27,VIDEO:28,PENDING_ATLAS:-1,HORIZONTAL:0,VERTICAL:1,LANDSCAPE:0,PORTRAIT:1,ANGLE_UP:270,ANGLE_DOWN:90,ANGLE_LEFT:180,ANGLE_RIGHT:0,ANGLE_NORTH_EAST:315,ANGLE_NORTH_WEST:225,ANGLE_SOUTH_EAST:45,ANGLE_SOUTH_WEST:135,TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12,blendModes:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},scaleModes:{DEFAULT:0,LINEAR:0,NEAREST:1},PIXI:PIXI||{},_UID:0};if(!Math.trunc){Math.trunc=function trunc(a){return a<0?Math.ceil(a):Math.floor(a)}}if(!Function.prototype.bind){Function.prototype.bind=(function(){var a=Array.prototype.slice;return function(b){var e=this,f=a.call(arguments,1);if(typeof e!=="function"){throw new TypeError()}function c(){var g=f.concat(a.call(arguments));e.apply(this instanceof c?this:b,g)}c.prototype=(function d(g){if(g){d.prototype=g}if(!(this instanceof d)){return new d}})(e.prototype);return c}})()}if(!Array.isArray){Array.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"}}if(!Array.prototype.forEach){Array.prototype.forEach=function(c){if(this===void 0||this===null){throw new TypeError()}var e=Object(this);var a=e.length>>>0;if(typeof c!=="function"){throw new TypeError()}var b=arguments.length>=2?arguments[1]:void 0;for(var d=0;d<a;d++){if(d in e){c.call(b,e[d],d,e)}}}}if(typeof window.Uint32Array!=="function"&&typeof window.Uint32Array!=="object"){var CheapArray=function(a){var b=new Array();window[a]=function(c){if(typeof(c)==="number"){Array.call(this,c);this.length=c;for(var d=0;d<this.length;d++){this[d]=0}}else{Array.call(this,c.length);this.length=c.length;for(var d=0;d<this.length;d++){this[d]=c[d]}}};window[a].prototype=b;window[a].constructor=window[a]};CheapArray("Float32Array");CheapArray("Uint32Array");CheapArray("Uint16Array");CheapArray("Int16Array");CheapArray("ArrayBuffer")}if(!window.console){window.console={};window.console.log=window.console.assert=function(){};window.console.warn=window.console.assert=function(){}}if(!Object.assign){Object.assign=function(e,g){if(e==null){throw new TypeError("Cannot convert undefined or null to object")}var f=Object(e);var c=Object.prototype.hasOwnProperty;for(var d=1;d<arguments.length;d++){var b=arguments[d];if(b!=null){for(var a in b){if(c.call(b,a)){f[a]=b[a]}}}}return f}}Phaser.Utils={reverseString:function(a){return a.split("").reverse().join("")},getProperty:function(e,g){var d=g.split("."),a=d.length,c=0,f=e;while(c<a){var b=d[c];if(f!=null){f=f[b];c++}else{return undefined}}return f},setProperties:function(c,b){for(var a in b){this.setProperty(c,a,b[a])}return c},setProperty:function(d,a,b){var c=a.split(".");switch(c.length){case 1:d[a]=b;break;case 2:d[c[0]][c[1]]=b;break;case 3:d[c[0]][c[1]][c[2]]=b;break;case 4:d[c[0]][c[1]][c[2]][c[3]]=b;break;default:this._setProperty(d,a,b)}},_setProperty:function(h,c,f){var g=c.split("."),a=g.length,e=0,b=h,d=g[0];if(a===1){h[c]=f}else{while(e<(a-1)){b=b[d];e++;d=g[e]}b[d]=f}return h},chanceRoll:function(a){if(a===undefined){a=50}return a>0&&(Math.random()*100<=a)},randomChoice:function(b,a){return(Math.random()<0.5)?b:a},parseDimension:function(b,d){var c=0;var a=0;if(typeof b==="string"){if(b.substr(-1)==="%"){c=parseInt(b,10)/100;if(d===0){a=window.innerWidth*c}else{a=window.innerHeight*c}}else{a=parseInt(b,10)}}else{a=b}return a},pad:function(g,a,f,b){if(a===undefined){var a=0}if(f===undefined){var f=" "}if(b===undefined){var b=3}g=g.toString();var d=0;if(a+1>=g.length){switch(b){case 1:g=new Array(a+1-g.length).join(f)+g;break;case 3:var c=Math.ceil((d=a-g.length)/2);var e=d-c;g=new Array(e+1).join(f)+g+new Array(c+1).join(f);break;default:g=g+new Array(a+1-g.length).join(f);break}}return g},isPlainObject:function(b){if(typeof(b)!=="object"||b.nodeType||b===b.window){return false}try{if(b.constructor&&!({}).hasOwnProperty.call(b.constructor.prototype,"isPrototypeOf")){return false}}catch(a){return false}return true},extend:function(){var k,c,a,b,g,h,f=arguments[0]||{},e=1,d=arguments.length,j=false;if(typeof f==="boolean"){j=f;f=arguments[1]||{};e=2}if(d===e){f=this;--e}for(;e<d;e++){if((k=arguments[e])!=null){for(c in k){a=f[c];b=k[c];if(f===b){continue}if(j&&b&&(Phaser.Utils.isPlainObject(b)||(g=Array.isArray(b)))){if(g){g=false;h=a&&Array.isArray(a)?a:[]}else{h=a&&Phaser.Utils.isPlainObject(a)?a:{}}f[c]=Phaser.Utils.extend(j,h,b)}else{if(b!==undefined){f[c]=b}}}}}return f},mixinPrototype:function(g,a,e){if(e===undefined){e=false}var d=Object.keys(a);for(var c=0;c<d.length;c++){var b=d[c];var f=a[b];if(!e&&(b in g)){continue}else{if(f&&(typeof f.get==="function"||typeof f.set==="function")){if(typeof f.clone==="function"){g[b]=f.clone()}else{Object.defineProperty(g,b,f)}}else{g[b]=f}}}},mixin:function(e,d){if(!e||typeof(e)!=="object"){return d}for(var a in e){var c=e[a];if(c.childNodes||c.cloneNode){continue}var b=typeof(e[a]);if(!e[a]||b!=="object"){d[a]=e[a]}else{if(typeof(d[a])===b){d[a]=Phaser.Utils.mixin(e[a],d[a])}else{d[a]=Phaser.Utils.mixin(e[a],new c.constructor())}}}return d}};Phaser.Circle=function(a,c,b){a=a||0;c=c||0;b=b||0;this.x=a;this.y=c;this._diameter=b;this._radius=0;if(b>0){this._radius=b*0.5}this.type=Phaser.CIRCLE};Phaser.Circle.prototype={circumference:function(){return 2*(Math.PI*this._radius)},random:function(c){if(c===undefined){c=new Phaser.Point()}var d=2*Math.PI*Math.random();var b=Math.random()+Math.random();var e=(b>1)?2-b:b;var a=e*Math.cos(d);var f=e*Math.sin(d);c.x=this.x+(a*this.radius);c.y=this.y+(f*this.radius);return c},getBounds:function(){return new Phaser.Rectangle(this.x-this.radius,this.y-this.radius,this.diameter,this.diameter)},setTo:function(a,c,b){this.x=a;this.y=c;this._diameter=b;this._radius=b*0.5;return this},copyFrom:function(a){return this.setTo(a.x,a.y,a.diameter)},copyTo:function(a){a.x=this.x;a.y=this.y;a.diameter=this._diameter;return a},distance:function(b,a){var c=Phaser.Math.distance(this.x,this.y,b.x,b.y);return a?Math.round(c):c},clone:function(a){if(a===undefined||a===null){a=new Phaser.Circle(this.x,this.y,this.diameter)}else{a.setTo(this.x,this.y,this.diameter)}return a},contains:function(a,b){return Phaser.Circle.contains(this,a,b)},circumferencePoint:function(c,b,a){return Phaser.Circle.circumferencePoint(this,c,b,a)},sample:function(b,e,a,f,c){if(!b){b=60}if(e==null){e=0}if(a==null){a=Phaser.Math.PI2}if(!c){c=[]}var d=0;while(d<b){this.circumferencePoint(Phaser.Math.linear(e,a,d/b),f,c[d]||(c[d]=new Phaser.Point()));d+=1}return c},offset:function(b,a){this.x+=b;this.y+=a;return this},offsetPoint:function(a){return this.offset(a.x,a.y)},toString:function(){return"[{Phaser.Circle (x="+this.x+" y="+this.y+" diameter="+this.diameter+" radius="+this.radius+")}]"}};Phaser.Circle.prototype.constructor=Phaser.Circle;Object.defineProperty(Phaser.Circle.prototype,"diameter",{get:function(){return this._diameter},set:function(a){if(a>0){this._diameter=a;this._radius=a*0.5}}});Object.defineProperty(Phaser.Circle.prototype,"radius",{get:function(){return this._radius},set:function(a){if(a>0){this._radius=a;this._diameter=a*2}}});Object.defineProperty(Phaser.Circle.prototype,"left",{get:function(){return this.x-this._radius},set:function(a){if(a>this.x){this._radius=0;this._diameter=0}else{this.radius=this.x-a}}});Object.defineProperty(Phaser.Circle.prototype,"right",{get:function(){return this.x+this._radius},set:function(a){if(a<this.x){this._radius=0;this._diameter=0}else{this.radius=a-this.x}}});Object.defineProperty(Phaser.Circle.prototype,"top",{get:function(){return this.y-this._radius},set:function(a){if(a>this.y){this._radius=0;this._diameter=0}else{this.radius=this.y-a}}});Object.defineProperty(Phaser.Circle.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(a){if(a<this.y){this._radius=0;this._diameter=0}else{this.radius=a-this.y}}});Object.defineProperty(Phaser.Circle.prototype,"area",{get:function(){if(this._radius>0){return Math.PI*this._radius*this._radius}else{return 0}}});Object.defineProperty(Phaser.Circle.prototype,"empty",{get:function(){return(this._diameter===0)},set:function(a){if(a===true){this.setTo(0,0,0)}}});Phaser.Circle.contains=function(d,b,f){if(d.radius>0&&b>=d.left&&b<=d.right&&f>=d.top&&f<=d.bottom){var e=(d.x-b)*(d.x-b);var c=(d.y-f)*(d.y-f);return(e+c)<=(d.radius*d.radius)}else{return false}};Phaser.Circle.equals=function(d,c){return(d.x===c.x&&d.y===c.y&&d.diameter===c.diameter)};Phaser.Circle.intersects=function(d,c){return(Phaser.Math.distance(d.x,d.y,c.x,c.y)<=(d.radius+c.radius))};Phaser.Circle.circumferencePoint=function(b,e,d,c){if(d===undefined){d=false}if(c===undefined){c=new Phaser.Point()}if(d===true){e=Phaser.Math.degToRad(e)}c.x=b.x+b.radius*Math.cos(e);c.y=b.y+b.radius*Math.sin(e);return c};Phaser.Circle.intersectsRectangle=function(l,b){var f=Math.abs(l.x-b.x-b.halfWidth);var k=b.halfWidth+l.radius;if(f>k){return false}var e=Math.abs(l.y-b.y-b.halfHeight);var i=b.halfHeight+l.radius;if(e>i){return false}if(f<=b.halfWidth||e<=b.halfHeight){return true}var g=f-b.halfWidth;var d=e-b.halfHeight;var j=g*g;var a=d*d;var h=l.radius*l.radius;return j+a<=h};Phaser.Circle.intersectsLine=function(x,r,i){var t=x.x;var s=x.y;var q=((r.end.y-r.start.y)/(r.end.x-r.start.x));var p=r.end.y-(q*r.end.x);var z=x.radius;var y=x.radius;var j=p+q*t;var v=(t*(y*y)-q*(z*z)*(p-s)+z*y*(Math.sqrt((z*z)*(q*q)+(y*y)-(j*j)-(s*s)+(2*j*s))))/((z*z)*(q*q)+(y*y));var u=(t*(y*y)-q*(z*z)*(p-s)-z*y*(Math.sqrt((z*z)*(q*q)+(y*y)-(j*j)-(s*s)+(2*j*s))))/((z*z)*(q*q)+(y*y));var g=q*v+p;var f=q*u+p;var e=new Phaser.Point(v,g);var d=new Phaser.Point(u,f);var o=r.pointOnSegment(e.x,e.y,0.01);var w=r.pointOnSegment(d.x,d.y,0.01);if(o&&w){return i?[e,d]:true}else{if(o){return i?[e]:true}else{if(w){return i?[d]:true}else{return i?[]:false}}}};PIXI.Circle=Phaser.Circle;Phaser.Ellipse=function(b,d,c,a){b=b||0;d=d||0;c=c||0;a=a||0;this.x=b;this.y=d;this.width=c;this.height=a;this.type=Phaser.ELLIPSE};Phaser.Ellipse.prototype={setTo:function(b,d,c,a){this.x=b;this.y=d;this.width=c;this.height=a;return this},getBounds:function(){return new Phaser.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},copyFrom:function(a){return this.setTo(a.x,a.y,a.width,a.height)},copyTo:function(a){a.x=this.x;a.y=this.y;a.width=this.width;a.height=this.height;return a},clone:function(a){if(a===undefined||a===null){a=new Phaser.Ellipse(this.x,this.y,this.width,this.height)}else{a.setTo(this.x,this.y,this.width,this.height)}return a},contains:function(a,b){return Phaser.Ellipse.contains(this,a,b)},random:function(a){if(a===undefined){a=new Phaser.Point()}var c=Math.random()*Math.PI*2;var b=Math.random();a.x=Math.sqrt(b)*Math.cos(c);a.y=Math.sqrt(b)*Math.sin(c);a.x=this.x+(a.x*this.width/2);a.y=this.y+(a.y*this.height/2);return a},toString:function(){return"[{Phaser.Ellipse (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")}]"}};Phaser.Ellipse.prototype.constructor=Phaser.Ellipse;Object.defineProperty(Phaser.Ellipse.prototype,"left",{get:function(){return this.x},set:function(a){this.x=a}});Object.defineProperty(Phaser.Ellipse.prototype,"right",{get:function(){return this.x+this.width},set:function(a){if(a<this.x){this.width=0}else{this.width=a-this.x}}});Object.defineProperty(Phaser.Ellipse.prototype,"top",{get:function(){return this.y},set:function(a){this.y=a}});Object.defineProperty(Phaser.Ellipse.prototype,"bottom",{get:function(){return this.y+this.height},set:function(a){if(a<this.y){this.height=0}else{this.height=a-this.y}}});Object.defineProperty(Phaser.Ellipse.prototype,"empty",{get:function(){return(this.width===0||this.height===0)},set:function(a){if(a===true){this.setTo(0,0,0,0)}}});Phaser.Ellipse.contains=function(e,c,f){if(e.width<=0||e.height<=0){return false}var d=((c-e.x)/e.width)-0.5;var b=((f-e.y)/e.height)-0.5;d*=d;b*=b;return(d+b<0.25)};Phaser.Ellipse.intersectsLine=function(w,r,i){var t=w.x;var s=w.y;var q=((r.end.y-r.start.y)/(r.end.x-r.start.x));var p=r.end.y-(q*r.end.x);var z=w.width/2;var y=w.height/2;var j=p+q*t;var v=(t*(y*y)-q*(z*z)*(p-s)+z*y*(Math.sqrt((z*z)*(q*q)+(y*y)-(j*j)-(s*s)+(2*j*s))))/((z*z)*(q*q)+(y*y));var u=(t*(y*y)-q*(z*z)*(p-s)-z*y*(Math.sqrt((z*z)*(q*q)+(y*y)-(j*j)-(s*s)+(2*j*s))))/((z*z)*(q*q)+(y*y));var g=q*v+p;var f=q*u+p;var d=new Phaser.Point(v,g);var c=new Phaser.Point(u,f);var o=r.pointOnSegment(d.x,d.y,0.01);var x=r.pointOnSegment(c.x,c.y,0.01);if(o&&x){return i?[d,c]:true}else{if(o){return i?[d]:true}else{if(x){return i?[c]:true}else{return i?[]:false}}}};PIXI.Ellipse=Phaser.Ellipse;Phaser.Line=function(b,d,a,c){b=b||0;d=d||0;a=a||0;c=c||0;this.start=new Phaser.Point(b,d);this.end=new Phaser.Point(a,c);this.type=Phaser.LINE};Phaser.Line.prototype={setTo:function(b,d,a,c){this.start.setTo(b,d);this.end.setTo(a,c);return this},fromSprite:function(b,c,a){if(a===undefined){a=false}if(a){return this.setTo(b.centerX,b.centerY,c.centerX,c.centerY)}return this.setTo(b.x,b.y,c.x,c.y)},fromAngle:function(a,d,c,b){this.start.setTo(a,d);this.end.setTo(a+(Math.cos(c)*b),d+(Math.sin(c)*b));return this},rotate:function(c,b){var a=(this.start.x+this.end.x)/2;var d=(this.start.y+this.end.y)/2;this.start.rotate(a,d,c,b);this.end.rotate(a,d,c,b);return this},rotateAround:function(a,d,c,b){this.start.rotate(a,d,c,b);this.end.rotate(a,d,c,b);return this},intersects:function(b,c,a){return Phaser.Line.intersectsPoints(this.start,this.end,b.start,b.end,c,a)},reflect:function(a){return Phaser.Line.reflect(this,a)},midPoint:function(a){if(a===undefined){a=new Phaser.Point()}a.x=(this.start.x+this.end.x)/2;a.y=(this.start.y+this.end.y)/2;return a},centerOn:function(c,f){var b=(this.start.x+this.end.x)/2;var e=(this.start.y+this.end.y)/2;var d=c-b;var a=f-e;this.start.add(d,a);this.end.add(d,a)},pointOnLine:function(a,c,b){return Phaser.Math.fuzzyEqual((a-this.start.x)*(this.end.y-this.start.y),(this.end.x-this.start.x)*(c-this.start.y),b||0)},pointOnSegment:function(b,g,f){var c=Math.min(this.start.x,this.end.x);var e=Math.max(this.start.x,this.end.x);var a=Math.min(this.start.y,this.end.y);var d=Math.max(this.start.y,this.end.y);return(this.pointOnLine(b,g,f)&&(b>=c&&b<=e)&&(g>=a&&g<=d))},random:function(a){if(a===undefined){a=new Phaser.Point()}var b=Math.random();a.x=this.start.x+b*(this.end.x-this.start.x);a.y=this.start.y+b*(this.end.y-this.start.y);return a},coordinatesOnLine:function(f,e){if(f===undefined){f=1}if(e===undefined){e=[]}var b=Math.round(this.start.x);var l=Math.round(this.start.y);var a=Math.round(this.end.x);var j=Math.round(this.end.y);var n=Math.abs(a-b);var m=Math.abs(j-l);var k=(b<a)?1:-1;var h=(l<j)?1:-1;var c=n-m;e.push([b,l]);var d=1;while(!((b===a)&&(l===j))){var g=c<<1;if(g>-m){c-=m;b+=k}if(g<n){c+=n;l+=h}if(d%f===0){e.push([b,l])}d++}return e},clone:function(a){if(a===undefined||a===null){a=new Phaser.Line(this.start.x,this.start.y,this.end.x,this.end.y)}else{a.setTo(this.start.x,this.start.y,this.end.x,this.end.y)}return a}};Object.defineProperty(Phaser.Line.prototype,"length",{get:function(){return Math.sqrt((this.end.x-this.start.x)*(this.end.x-this.start.x)+(this.end.y-this.start.y)*(this.end.y-this.start.y))}});Object.defineProperty(Phaser.Line.prototype,"angle",{get:function(){return Math.atan2(this.end.y-this.start.y,this.end.x-this.start.x)}});Object.defineProperty(Phaser.Line.prototype,"slope",{get:function(){return(this.end.y-this.start.y)/(this.end.x-this.start.x)}});Object.defineProperty(Phaser.Line.prototype,"perpSlope",{get:function(){return -((this.end.x-this.start.x)/(this.end.y-this.start.y))}});Object.defineProperty(Phaser.Line.prototype,"x",{get:function(){return Math.min(this.start.x,this.end.x)}});Object.defineProperty(Phaser.Line.prototype,"y",{get:function(){return Math.min(this.start.y,this.end.y)}});Object.defineProperty(Phaser.Line.prototype,"left",{get:function(){return Math.min(this.start.x,this.end.x)}});Object.defineProperty(Phaser.Line.prototype,"right",{get:function(){return Math.max(this.start.x,this.end.x)}});Object.defineProperty(Phaser.Line.prototype,"top",{get:function(){return Math.min(this.start.y,this.end.y)}});Object.defineProperty(Phaser.Line.prototype,"bottom",{get:function(){return Math.max(this.start.y,this.end.y)}});Object.defineProperty(Phaser.Line.prototype,"width",{get:function(){return Math.abs(this.start.x-this.end.x)}});Object.defineProperty(Phaser.Line.prototype,"height",{get:function(){return Math.abs(this.start.y-this.end.y)}});Object.defineProperty(Phaser.Line.prototype,"normalX",{get:function(){return Math.cos(this.angle-1.5707963267948966)}});Object.defineProperty(Phaser.Line.prototype,"normalY",{get:function(){return Math.sin(this.angle-1.5707963267948966)}});Object.defineProperty(Phaser.Line.prototype,"normalAngle",{get:function(){return Phaser.Math.wrap(this.angle-1.5707963267948966,-Math.PI,Math.PI)}});Phaser.Line.intersectsPoints=function(r,p,m,l,n,t){if(n===undefined){n=true}if(t===undefined){t=new Phaser.Point()}var h=p.y-r.y;var g=l.y-m.y;var q=r.x-p.x;var o=m.x-l.x;var j=(p.x*r.y)-(r.x*p.y);var i=(l.x*m.y)-(m.x*l.y);var k=(h*o)-(g*q);if(k===0){return null}t.x=((q*i)-(o*j))/k;t.y=((g*j)-(h*i))/k;if(n){var s=((l.y-m.y)*(p.x-r.x)-(l.x-m.x)*(p.y-r.y));var d=(((l.x-m.x)*(r.y-m.y))-(l.y-m.y)*(r.x-m.x))/s;var c=(((p.x-r.x)*(r.y-m.y))-((p.y-r.y)*(r.x-m.x)))/s;if(d>=0&&d<=1&&c>=0&&c<=1){return t}else{return null}}return t};Phaser.Line.intersects=function(e,d,f,c){return Phaser.Line.intersectsPoints(e.start,e.end,d.start,d.end,f,c)};Phaser.Line.intersectsRectangle=function(k,g){if(k.length===0||g.empty){return false}var d=k.start.x;var i=k.start.y;var c=k.end.x;var h=k.end.y;var f=g.x;var b=g.y;var e=g.right;var a=g.bottom;var j=0;if((d>=f&&d<=e&&i>=b&&i<=a)||(c>=f&&c<=e&&h>=b&&h<=a)){return true}if(d<f&&c>=f){j=i+(h-i)*(f-d)/(c-d);if(j>b&&j<=a){return true}}else{if(d>e&&c<=e){j=i+(h-i)*(e-d)/(c-d);if(j>=b&&j<=a){return true}}}if(i<b&&h>=b){j=d+(c-d)*(b-i)/(h-i);if(j>=f&&j<=e){return true}}else{if(i>a&&h<=a){j=d+(c-d)*(a-i)/(h-i);if(j>=f&&j<=e){return true}}}return false};Phaser.Line.intersectionWithRectangle=function(n,k,o){var m=Phaser.Line.intersectionWithRectangle;if(!o){o=new Phaser.Point()}if(!m.edges){m.edges=[new Phaser.Line(),new Phaser.Line(),new Phaser.Line(),new Phaser.Line()]}if(!m.edgeIntersection){m.edgeIntersection=new Phaser.Point()}var g=m.edges;var e=m.edgeIntersection.set(0);var j=k.x;var c=k.y;var f=k.right;var a=k.bottom;var l=Infinity;g[0].setTo(j,c,f,c);g[1].setTo(j,a,f,a);g[2].setTo(j,c,j,a);g[3].setTo(f,c,f,a);for(var d,h=0;(d=g[h]);h++){if(n.intersects(d,true,e)){var b=n.start.distance(e);if(b<l){l=b;o.copyFrom(e)}}}if(b!=null){return o}return null};Phaser.Line.reflect=function(d,c){return 2*c.normalAngle-3.141592653589793-d.angle};Phaser.Matrix=function(h,f,j,i,g,e){if(h===undefined||h===null){h=1}if(f===undefined||f===null){f=0}if(j===undefined||j===null){j=0}if(i===undefined||i===null){i=1}if(g===undefined||g===null){g=0}if(e===undefined||e===null){e=0}this.a=h;this.b=f;this.c=j;this.d=i;this.tx=g;this.ty=e;this.type=Phaser.MATRIX};Phaser.Matrix.prototype={fromArray:function(a){return this.setTo(a[0],a[1],a[3],a[4],a[2],a[5])},setTo:function(h,f,j,i,g,e){this.a=h;this.b=f;this.c=j;this.d=i;this.tx=g;this.ty=e;return this},clone:function(a){if(a===undefined||a===null){a=new Phaser.Matrix(this.a,this.b,this.c,this.d,this.tx,this.ty)}else{a.a=this.a;a.b=this.b;a.c=this.c;a.d=this.d;a.tx=this.tx;a.ty=this.ty}return a},copyTo:function(a){a.copyFrom(this);return a},copyFrom:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.d=a.d;this.tx=a.tx;this.ty=a.ty;return this},toArray:function(a,b){if(b===undefined){b=new Float32Array(9)}if(a){b[0]=this.a;b[1]=this.b;b[2]=0;b[3]=this.c;b[4]=this.d;b[5]=0;b[6]=this.tx;b[7]=this.ty;b[8]=1}else{b[0]=this.a;b[1]=this.c;b[2]=this.tx;b[3]=this.b;b[4]=this.d;b[5]=this.ty;b[6]=0;b[7]=0;b[8]=1}return b},apply:function(b,a){if(a===undefined){a=new Phaser.Point()}a.x=this.a*b.x+this.c*b.y+this.tx;a.y=this.b*b.x+this.d*b.y+this.ty;return a},applyInverse:function(e,b){if(b===undefined){b=new Phaser.Point()}var d=1/(this.a*this.d+this.c*-this.b);var a=e.x;var c=e.y;b.x=this.d*d*a+-this.c*d*c+(this.ty*this.c-this.tx*this.d)*d;b.y=this.a*d*c+-this.b*d*a+(-this.ty*this.a+this.tx*this.b)*d;return b},translate:function(a,b){this.tx+=a;this.ty+=b;return this},scale:function(a,b){this.a*=a;this.d*=b;this.c*=a;this.b*=b;this.tx*=a;this.ty*=b;return this},rotate:function(f){var e=Math.cos(f);var c=Math.sin(f);var b=this.a;var d=this.c;var a=this.tx;this.a=b*e-this.b*c;this.b=b*c+this.b*e;this.c=d*e-this.d*c;this.d=d*c+this.d*e;this.tx=a*e-this.ty*c;this.ty=a*c+this.ty*e;return this},append:function(b){var a=this.a;var c=this.b;var d=this.c;var e=this.d;this.a=b.a*a+b.b*d;this.b=b.a*c+b.b*e;this.c=b.c*a+b.d*d;this.d=b.c*c+b.d*e;this.tx=b.tx*a+b.ty*d+this.tx;this.ty=b.tx*c+b.ty*e+this.ty;return this},identity:function(){return this.setTo(1,0,0,1,0,0)}};Phaser.identityMatrix=new Phaser.Matrix();Phaser.Point=function(a,b){a=a||0;b=b||0;this.x=a;this.y=b;this.type=Phaser.POINT};Phaser.Point.prototype={copyFrom:function(a){return this.setTo(a.x,a.y)},invert:function(){return this.setTo(this.y,this.x)},setTo:function(a,b){return Phaser.Point.set(this,a,b)},set:function(a,b){return Phaser.Point.set(this,a,b)},setToPolar:function(b,a,c){if(a==null){a=1}if(c){b=Phaser.Math.degToRad(b)}return this.setTo(Math.cos(b)*a,Math.sin(b)*a)},add:function(a,b){this.x+=a;this.y+=b;return this},subtract:function(a,b){this.x-=a;this.y-=b;return this},multiply:function(a,b){this.x*=a;this.y*=b;return this},divide:function(a,b){this.x/=a;this.y/=b;return this},clampX:function(b,a){this.x=Phaser.Math.clamp(this.x,b,a);return this},clampY:function(b,a){this.y=Phaser.Math.clamp(this.y,b,a);return this},clamp:function(b,a){this.x=Phaser.Math.clamp(this.x,b,a);this.y=Phaser.Math.clamp(this.y,b,a);return this},clip:function(c){var e=c.left,d=c.top,b=c.right,a=c.bottom;if(this.x<e){this.x=e}else{if(this.x>b){this.x=b}}if(this.y<d){this.y=d}else{if(this.y>a){this.y=a}}return this},clone:function(a){if(a===undefined||a===null){a=new Phaser.Point(this.x,this.y)}else{a.setTo(this.x,this.y)}return a},copyTo:function(a){a.x=this.x;a.y=this.y;return a},distance:function(b,a){return Phaser.Point.distance(this,b,a)},equals:function(b){return b.x===this.x&&b.y===this.y},equalsXY:function(a,b){return this.x===a&&this.y===b},fuzzyEquals:function(b,c){return Phaser.Point.fuzzyEquals(this,b,c)},fuzzyEqualsXY:function(a,c,b){return Phaser.Point.fuzzyEqualsXY(this,a,c,b)},angle:function(b,c){if(c===undefined){c=false}if(c){return Phaser.Math.radToDeg(Math.atan2(b.y-this.y,b.x-this.x))}else{return Math.atan2(b.y-this.y,b.x-this.x)}},rotate:function(a,e,c,b,d){return Phaser.Point.rotate(this,a,e,c,b,d)},getMagnitude:function(){return Math.sqrt((this.x*this.x)+(this.y*this.y))},getMagnitudeSq:function(){return(this.x*this.x)+(this.y*this.y)},setMagnitude:function(a){return this.normalize().multiply(a,a)},normalize:function(){if(!this.isZero()){var a=this.getMagnitude();this.x/=a;this.y/=a}return this},limit:function(a){if(this.getMagnitudeSq()>a*a){this.setMagnitude(a)}return this},isZero:function(){return(this.x===0&&this.y===0)},dot:function(b){return((this.x*b.x)+(this.y*b.y))},cross:function(b){return((this.x*b.y)-(this.y*b.x))},perp:function(){return this.setTo(-this.y,this.x)},rperp:function(){return this.setTo(this.y,-this.x)},normalRightHand:function(){return this.setTo(this.y*-1,this.x)},floor:function(){return this.setTo(Math.floor(this.x),Math.floor(this.y))},ceil:function(){return this.setTo(Math.ceil(this.x),Math.ceil(this.y))},toString:function(){return"[{Point (x="+this.x+" y="+this.y+")}]"}};Phaser.Point.prototype.constructor=Phaser.Point;Phaser.Point.add=function(d,c,e){if(e===undefined){e=new Phaser.Point()}e.x=d.x+c.x;e.y=d.y+c.y;return e};Phaser.Point.subtract=function(d,c,e){if(e===undefined){e=new Phaser.Point()}e.x=d.x-c.x;e.y=d.y-c.y;return e};Phaser.Point.multiply=function(d,c,e){if(e===undefined){e=new Phaser.Point()}e.x=d.x*c.x;e.y=d.y*c.y;return e};Phaser.Point.divide=function(d,c,e){if(e===undefined){e=new Phaser.Point()}e.x=d.x/c.x;e.y=d.y/c.y;return e};Phaser.Point.equals=function(d,c){return d.x===c.x&&d.y===c.y};Phaser.Point.equalsXY=function(c,b,d){return c.x===b&&c.y===d};Phaser.Point.fuzzyEquals=function(d,c,e){return Phaser.Math.fuzzyEquals(d.x,c.x,e)&&Phaser.Math.fuzzyEquals(d.y,c.y,e)};Phaser.Point.fuzzyEqualsXY=function(c,b,e,d){return Phaser.Math.fuzzyEquals(c.x,b,d)&&Phaser.Math.fuzzyEquals(c.y,e,d)};Phaser.Point.angle=function(d,c){return Math.atan2(d.y-c.y,d.x-c.x)};Phaser.Point.negative=function(b,c){if(c===undefined){c=new Phaser.Point()}return c.setTo(-b.x,-b.y)};Phaser.Point.multiplyAdd=function(d,c,f,e){if(e===undefined){e=new Phaser.Point()}return e.setTo(d.x+c.x*f,d.y+c.y*f)};Phaser.Point.interpolate=function(d,c,g,e){if(e===undefined){e=new Phaser.Point()}return e.setTo(d.x+(c.x-d.x)*g,d.y+(c.y-d.y)*g)};Phaser.Point.perp=function(b,c){if(c===undefined){c=new Phaser.Point()}return c.setTo(-b.y,b.x)};Phaser.Point.rperp=function(b,c){if(c===undefined){c=new Phaser.Point()}return c.setTo(b.y,-b.x)};Phaser.Point.distance=function(d,c,e){var f=Phaser.Math.distance(d.x,d.y,c.x,c.y);return e?Math.round(f):f};Phaser.Point.project=function(d,c,e){if(e===undefined){e=new Phaser.Point()}var f=d.dot(c)/c.getMagnitudeSq();if(f!==0){e.setTo(f*c.x,f*c.y)}return e};Phaser.Point.projectUnit=function(d,c,e){if(e===undefined){e=new Phaser.Point()}var f=d.dot(c);if(f!==0){e.setTo(f*c.x,f*c.y)}return e};Phaser.Point.normalRightHand=function(b,c){if(c===undefined){c=new Phaser.Point()}return c.setTo(b.y*-1,b.x)};Phaser.Point.normalize=function(c,d){if(d===undefined){d=new Phaser.Point()}var b=c.getMagnitude();if(b!==0){d.setTo(c.x/b,c.y/b)}return d};Phaser.Point.rotate=function(j,k,i,d,f,b){if(f){d=Phaser.Math.degToRad(d)}if(b===undefined){j.subtract(k,i);var m=Math.sin(d);var h=Math.cos(d);var g=h*j.x-m*j.y;var e=m*j.x+h*j.y;j.x=g+k;j.y=e+i}else{var l=d+Math.atan2(j.y-i,j.x-k);j.x=k+b*Math.cos(l);j.y=i+b*Math.sin(l)}return j};Phaser.Point.centroid=function(c,a){if(a===undefined){a=new Phaser.Point()}if(Object.prototype.toString.call(c)!=="[object Array]"){throw new Error("Phaser.Point. Parameter 'points' must be an array")}var d=c.length;if(d<1){throw new Error("Phaser.Point. Parameter 'points' array must not be empty")}if(d===1){a.copyFrom(c[0]);return a}for(var b=0;b<d;b++){Phaser.Point.add(a,c[b],a)}a.divide(d,d);return a};Phaser.Point.parse=function(d,b,c){b=b||"x";c=c||"y";var a=new Phaser.Point();if(d[b]){a.x=parseInt(d[b],10)}if(d[c]){a.y=parseInt(d[c],10)}return a};Phaser.Point.isPoint=function(a){return(a!=null)&&(typeof a.x==="number")&&(typeof a.y==="number")};Phaser.Point.set=function(b,a,c){b.x=a||0;b.y=c||((c!==0)?b.x:0);return b};PIXI.Point=Phaser.Point;Phaser.Polygon=function(){this.area=0;this._points=[];if(arguments.length>0){this.setTo.apply(this,arguments)}this.closed=true;this.flattened=false;this.type=Phaser.POLYGON};Phaser.Polygon.prototype={toNumberArray:function(a){if(a===undefined){a=[]}for(var b=0;b<this._points.length;b++){if(typeof this._points[b]==="number"){a.push(this._points[b]);a.push(this._points[b+1]);b++}else{a.push(this._points[b].x);a.push(this._points[b].y)}}return a},flatten:function(){this._points=this.toNumberArray();this.flattened=true;return this},clone:function(a){var b=this._points.slice();if(a===undefined||a===null){a=new Phaser.Polygon(b)}else{a.setTo(b)}return a},contains:function(g,f){var c=false;if(this.flattened){for(var e=-2,d=this._points.length-2;(e+=2)<this._points.length;d=e){var b=this._points[e];var a=this._points[e+1];var k=this._points[d];var h=this._points[d+1];if(((a<=f&&f<h)||(h<=f&&f<a))&&(g<(k-b)*(f-a)/(h-a)+b)){c=!c}}}else{for(var e=-1,d=this._points.length-1;++e<this._points.length;d=e){var b=this._points[e].x;var a=this._points[e].y;var k=this._points[d].x;var h=this._points[d].y;if(((a<=f&&f<h)||(h<=f&&f<a))&&(g<(k-b)*(f-a)/(h-a)+b)){c=!c}}}return c},setTo:function(c){this.area=0;this._points=[];if(arguments.length>0){if(!Array.isArray(c)){c=Array.prototype.slice.call(arguments)}var d=Number.MAX_VALUE;for(var b=0,a=c.length;b<a;b++){if(typeof c[b]==="number"){var e=new PIXI.Point(c[b],c[b+1]);b++}else{if(Array.isArray(c[b])){var e=new PIXI.Point(c[b][0],c[b][1])}else{var e=new PIXI.Point(c[b].x,c[b].y)}}this._points.push(e);if(e.y<d){d=e.y}}this.calculateArea(d)}return this},calculateArea:function(e){var g;var f;var b;var d;for(var c=0,a=this._points.length;c<a;c++){g=this._points[c];if(c===a-1){f=this._points[0]}else{f=this._points[c+1]}b=((g.y-e)+(f.y-e))/2;d=g.x-f.x;this.area+=b*d}return this.area}};Phaser.Polygon.prototype.constructor=Phaser.Polygon;Object.defineProperty(Phaser.Polygon.prototype,"points",{get:function(){return this._points},set:function(a){if(a!=null){this.setTo(a)}else{this.setTo()}}});PIXI.Polygon=Phaser.Polygon;Phaser.Rectangle=function(b,d,c,a){b=b||0;d=d||0;c=c||0;a=a||0;this.x=b;this.y=d;this.width=c;this.height=a;this.type=Phaser.RECTANGLE};Phaser.Rectangle.prototype={offset:function(b,a){this.x+=b;this.y+=a;return this},offsetPoint:function(a){return this.offset(a.x,a.y)},setTo:function(b,d,c,a){this.x=b;this.y=d;this.width=c;this.height=a;return this},scale:function(a,b){if(b===undefined){b=a}this.width*=a;this.height*=b;return this},centerOn:function(a,b){this.centerX=a;this.centerY=b;return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y)},floorAll:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.width=Math.floor(this.width);this.height=Math.floor(this.height)},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y)},ceilAll:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height)},copyFrom:function(a){return this.setTo(a.x,a.y,a.width,a.height)},copyFromBounds:function(a){return this.setTo(a.left,a.top,a.width,a.height)},copyTo:function(a){a.x=this.x;a.y=this.y;a.width=this.width;a.height=this.height;return a},inflate:function(b,a){return Phaser.Rectangle.inflate(this,b,a)},size:function(a){return Phaser.Rectangle.size(this,a)},resize:function(b,a){this.width=b;this.height=a;return this},clone:function(a){return Phaser.Rectangle.clone(this,a)},contains:function(a,b){return Phaser.Rectangle.contains(this,a,b)},containsRect:function(a){return Phaser.Rectangle.containsRect(a,this)},equals:function(a){return Phaser.Rectangle.equals(this,a)},intersection:function(a,c){return Phaser.Rectangle.intersection(this,a,c)},intersects:function(a){return Phaser.Rectangle.intersects(this,a)},intersectsRaw:function(e,c,d,b,a){return Phaser.Rectangle.intersectsRaw(this,e,c,d,b,a)},union:function(a,c){return Phaser.Rectangle.union(this,a,c)},random:function(a){if(a===undefined){a=new Phaser.Point()}a.x=this.randomX;a.y=this.randomY;return a},getPoint:function(a,b){if(b===undefined){b=new Phaser.Point()}switch(a){default:case Phaser.TOP_LEFT:return b.set(this.x,this.y);case Phaser.TOP_CENTER:return b.set(this.centerX,this.y);case Phaser.TOP_RIGHT:return b.set(this.right,this.y);case Phaser.LEFT_CENTER:return b.set(this.x,this.centerY);case Phaser.CENTER:return b.set(this.centerX,this.centerY);case Phaser.RIGHT_CENTER:return b.set(this.right,this.centerY);case Phaser.BOTTOM_LEFT:return b.set(this.x,this.bottom);case Phaser.BOTTOM_CENTER:return b.set(this.centerX,this.bottom);case Phaser.BOTTOM_RIGHT:return b.set(this.right,this.bottom)}},sides:function(h,e,b,g){if(!arguments.length){h=new Phaser.Line();e=new Phaser.Line();b=new Phaser.Line();g=new Phaser.Line()}var c=this.x;var f=this.y;var a=this.right;var d=this.bottom;h.setTo(c,f,a,f);e.setTo(a,f,a,d);b.setTo(c,d,a,d);g.setTo(c,f,c,d);if(!arguments.length){return[h,e,b,g]}return null},toString:function(){return"[{Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+" empty="+this.empty+")}]"}};Object.defineProperty(Phaser.Rectangle.prototype,"halfWidth",{get:function(){return Math.round(this.width/2)}});Object.defineProperty(Phaser.Rectangle.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}});Object.defineProperty(Phaser.Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(a){if(a<=this.y){this.height=0}else{this.height=a-this.y}}});Object.defineProperty(Phaser.Rectangle.prototype,"bottomLeft",{get:function(){return new Phaser.Point(this.x,this.bottom)},set:function(a){this.x=a.x;this.bottom=a.y}});Object.defineProperty(Phaser.Rectangle.prototype,"bottomRight",{get:function(){return new Phaser.Point(this.right,this.bottom)},set:function(a){this.right=a.x;this.bottom=a.y}});Object.defineProperty(Phaser.Rectangle.prototype,"left",{get:function(){return this.x},set:function(a){if(a>=this.right){this.width=0}else{this.width=this.right-a}this.x=a}});Object.defineProperty(Phaser.Rectangle.prototype,"right",{get:function(){return this.x+this.width},set:function(a){if(a<=this.x){this.width=0}else{this.width=a-this.x}}});Object.defineProperty(Phaser.Rectangle.prototype,"volume",{get:function(){return this.width*this.height}});Object.defineProperty(Phaser.Rectangle.prototype,"perimeter",{get:function(){return(this.width*2)+(this.height*2)}});Object.defineProperty(Phaser.Rectangle.prototype,"centerX",{get:function(){return this.x+this.halfWidth},set:function(a){this.x=a-this.halfWidth}});Object.defineProperty(Phaser.Rectangle.prototype,"centerY",{get:function(){return this.y+this.halfHeight},set:function(a){this.y=a-this.halfHeight}});Object.defineProperty(Phaser.Rectangle.prototype,"randomX",{get:function(){return this.x+(Math.random()*this.width)}});Object.defineProperty(Phaser.Rectangle.prototype,"randomY",{get:function(){return this.y+(Math.random()*this.height)}});Object.defineProperty(Phaser.Rectangle.prototype,"top",{get:function(){return this.y},set:function(a){if(a>=this.bottom){this.height=0;this.y=a}else{this.height=(this.bottom-a)}}});Object.defineProperty(Phaser.Rectangle.prototype,"topLeft",{get:function(){return new Phaser.Point(this.x,this.y)},set:function(a){this.x=a.x;this.y=a.y}});Object.defineProperty(Phaser.Rectangle.prototype,"topRight",{get:function(){return new Phaser.Point(this.x+this.width,this.y)},set:function(a){this.right=a.x;this.y=a.y}});Object.defineProperty(Phaser.Rectangle.prototype,"empty",{get:function(){return(!this.width||!this.height)},set:function(a){if(a===true){this.setTo(0,0,0,0)}}});Phaser.Rectangle.prototype.constructor=Phaser.Rectangle;Phaser.Rectangle.inflate=function(c,d,b){c.x-=d;c.width+=2*d;c.y-=b;c.height+=2*b;return c};Phaser.Rectangle.inflatePoint=function(c,b){return Phaser.Rectangle.inflate(c,b.x,b.y)};Phaser.Rectangle.size=function(b,c){if(c===undefined||c===null){c=new Phaser.Point(b.width,b.height)}else{c.setTo(b.width,b.height)}return c};Phaser.Rectangle.clone=function(b,c){if(c===undefined||c===null){c=new Phaser.Rectangle(b.x,b.y,b.width,b.height)}else{c.setTo(b.x,b.y,b.width,b.height)}return c};Phaser.Rectangle.createFromBounds=function(b,c){if(c===undefined||c===null){c=new Phaser.Rectangle(b.x,b.y,b.width,b.height)}return c.copyFromBounds(b)};Phaser.Rectangle.contains=function(c,b,d){if(c.width<=0||c.height<=0){return false}return(b>=c.x&&b<c.right&&d>=c.y&&d<c.bottom)};Phaser.Rectangle.containsRaw=function(d,c,e,b,a,f){return(a>=d&&a<(d+e)&&f>=c&&f<(c+b))};Phaser.Rectangle.containsPoint=function(c,b){return Phaser.Rectangle.contains(c,b.x,b.y)};Phaser.Rectangle.containsRect=function(d,c){if(d.volume>c.volume){return false}return(d.x>=c.x&&d.y>=c.y&&d.right<c.right&&d.bottom<c.bottom)};Phaser.Rectangle.equals=function(d,c){return(d.x===c.x&&d.y===c.y&&d.width===c.width&&d.height===c.height)};Phaser.Rectangle.sameDimensions=function(d,c){return(d.width===c.width&&d.height===c.height)};Phaser.Rectangle.intersection=function(d,c,e){if(e===undefined){e=new Phaser.Rectangle()}if(Phaser.Rectangle.intersects(d,c)){e.x=Math.max(d.x,c.x);e.y=Math.max(d.y,c.y);e.width=Math.min(d.right,c.right)-e.x;e.height=Math.min(d.bottom,c.bottom)-e.y}return e};Phaser.Rectangle.intersects=function(d,c){if(d.width<=0||d.height<=0||c.width<=0||c.height<=0){return false}return !(d.right<c.x||d.bottom<c.y||d.x>c.right||d.y>c.bottom)};Phaser.Rectangle.intersectsRaw=function(b,g,e,f,d,c){if(c===undefined){c=0}return !(g>b.right+c||e<b.left-c||f>b.bottom+c||d<b.top-c)};Phaser.Rectangle.union=function(d,c,e){if(e===undefined){e=new Phaser.Rectangle()}return e.setTo(Math.min(d.x,c.x),Math.min(d.y,c.y),Math.max(d.right,c.right)-Math.min(d.left,c.left),Math.max(d.bottom,c.bottom)-Math.min(d.top,c.top))};Phaser.Rectangle.aabb=function(d,c){if(c===undefined){c=new Phaser.Rectangle()}var f=Number.NEGATIVE_INFINITY,b=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;d.forEach(function(g){if(g.x>f){f=g.x}if(g.x<b){b=g.x}if(g.y>e){e=g.y}if(g.y<a){a=g.y}});c.setTo(b,a,f-b,e-a);return c};PIXI.Rectangle=Phaser.Rectangle;PIXI.EmptyRectangle=new Phaser.Rectangle(0,0,0,0);Phaser.RoundedRectangle=function(c,e,d,b,a){if(c===undefined){c=0}if(e===undefined){e=0}if(d===undefined){d=0}if(b===undefined){b=0}if(a===undefined){a=20}this.x=c;this.y=e;this.width=d;this.height=b;this.radius=a||20;this.type=Phaser.ROUNDEDRECTANGLE};Phaser.RoundedRectangle.prototype={clone:function(){return new Phaser.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},contains:function(a,d){if(this.width<=0||this.height<=0){return false}var b=this.x;if(a>=b&&a<=b+this.width){var c=this.y;if(d>=c&&d<=c+this.height){return true}}return false}};Phaser.RoundedRectangle.prototype.constructor=Phaser.RoundedRectangle;PIXI.RoundedRectangle=Phaser.RoundedRectangle;Phaser.Camera=function(c,f,b,e,d,a){this.game=c;this.world=c.world;this.id=0;this.view=new Phaser.Rectangle(b,e,d,a);this.bounds=new Phaser.Rectangle(b,e,d,a);this.deadzone=null;this.visible=true;this.roundPx=true;this.atLimit={x:false,y:false};this.target=null;this.displayObject=null;this.scale=null;this.totalInView=0;this.lerp=new Phaser.Point(1,1);this.onShakeComplete=new Phaser.Signal();this.onFlashComplete=new Phaser.Signal();this.onFadeComplete=new Phaser.Signal();this.fx=null;this._targetPosition=new Phaser.Point();this._edge=0;this._position=new Phaser.Point();this._shake={intensity:0,duration:0,horizontal:false,vertical:false,shakeBounds:true,x:0,y:0};this._fxDuration=0;this._fxType=0;this._fixedView=new Phaser.Rectangle()};Phaser.Camera.FOLLOW_LOCKON=0;Phaser.Camera.FOLLOW_PLATFORMER=1;Phaser.Camera.FOLLOW_TOPDOWN=2;Phaser.Camera.FOLLOW_TOPDOWN_TIGHT=3;Phaser.Camera.SHAKE_BOTH=4;Phaser.Camera.SHAKE_HORIZONTAL=5;Phaser.Camera.SHAKE_VERTICAL=6;Phaser.Camera.ENABLE_FX=true;Phaser.Camera.prototype={boot:function(){this.displayObject=this.game.world;this.scale=this.game.world.scale;this.game.camera=this;if(Phaser.Graphics&&Phaser.Camera.ENABLE_FX){this.fx=new Phaser.Graphics(this.game);this.game.stage.addChild(this.fx)}},preUpdate:function(){this.totalInView=0},follow:function(g,e,c,b){if(e===undefined){e=Phaser.Camera.FOLLOW_LOCKON}if(c===undefined){c=1}if(b===undefined){b=1}this.target=g;this.lerp.set(c,b);var f;switch(e){case Phaser.Camera.FOLLOW_PLATFORMER:var a=this.width/8;var d=this.height/3;this.deadzone=new Phaser.Rectangle((this.width-a)/2,(this.height-d)/2-d*0.25,a,d);break;case Phaser.Camera.FOLLOW_TOPDOWN:f=Math.max(this.width,this.height)/4;this.deadzone=new Phaser.Rectangle((this.width-f)/2,(this.height-f)/2,f,f);break;case Phaser.Camera.FOLLOW_TOPDOWN_TIGHT:f=Math.max(this.width,this.height)/8;this.deadzone=new Phaser.Rectangle((this.width-f)/2,(this.height-f)/2,f,f);break;case Phaser.Camera.FOLLOW_LOCKON:this.deadzone=null;break;default:this.deadzone=null;break}},unfollow:function(){this.target=null},focusOn:function(a){this.setPosition(Math.round(a.x-this.view.halfWidth),Math.round(a.y-this.view.halfHeight))},focusOnXY:function(a,b){this.setPosition(Math.round(a-this.view.halfWidth),Math.round(b-this.view.halfHeight))},shake:function(a,e,c,d,b){if(a===undefined){a=0.05}if(e===undefined){e=500}if(c===undefined){c=true}if(d===undefined){d=Phaser.Camera.SHAKE_BOTH}if(b===undefined){b=true}if(!c&&this._shake.duration>0){return false}this._shake.intensity=a;this._shake.duration=e;this._shake.shakeBounds=b;this._shake.x=0;this._shake.y=0;this._shake.horizontal=(d===Phaser.Camera.SHAKE_BOTH||d===Phaser.Camera.SHAKE_HORIZONTAL);this._shake.vertical=(d===Phaser.Camera.SHAKE_BOTH||d===Phaser.Camera.SHAKE_VERTICAL);return true},flash:function(a,d,b,c){if(a===undefined){a=16777215}if(d===undefined){d=500}if(b===undefined){b=false}if(c===undefined){c=1}if(!this.fx||(!b&&this._fxDuration>0)){return false}this.fx.clear();this.fx.beginFill(a,c);this.fx.drawRect(0,0,this.width,this.height);this.fx.endFill();this.fx.alpha=1;this._fxDuration=d;this._fxType=0;return true},fade:function(a,d,b,c){if(a===undefined){a=0}if(d===undefined){d=500}if(b===undefined){b=false}if(c===undefined){c=1}if(!this.fx||(!b&&this._fxDuration>0)){return false}this.fx.clear();this.fx.beginFill(a,c);this.fx.drawRect(0,0,this.width,this.height);this.fx.endFill();this.fx.alpha=0;this._fxDuration=d;this._fxType=1;return true},update:function(){if(this._fxDuration>0){this.updateFX()}if(this._shake.duration>0){this.updateShake()}if(this.bounds){this.checkBounds()}if(this.roundPx){this.view.floor();this._shake.x=Math.floor(this._shake.x);this._shake.y=Math.floor(this._shake.y)}this.displayObject.position.x=-this.view.x;this.displayObject.position.y=-this.view.y},updateFX:function(){if(this._fxType===0){this.fx.alpha-=this.game.time.elapsedMS/this._fxDuration;if(this.fx.alpha<=0){this._fxDuration=0;this.fx.alpha=0;this.onFlashComplete.dispatch()}}else{this.fx.alpha+=this.game.time.elapsedMS/this._fxDuration;if(this.fx.alpha>=1){this._fxDuration=0;this.fx.alpha=1;this.onFadeComplete.dispatch()}}},updateShake:function(){this._shake.duration-=this.game.time.elapsedMS;if(this._shake.duration<=0){this.onShakeComplete.dispatch();this._shake.x=0;this._shake.y=0}else{if(this._shake.horizontal){this._shake.x=this.game.rnd.frac()*this._shake.intensity*this.view.width*2-this._shake.intensity*this.view.width}if(this._shake.vertical){this._shake.y=this.game.rnd.frac()*this._shake.intensity*this.view.height*2-this._shake.intensity*this.view.height}}},updateTarget:function(){this._targetPosition.x=this.view.x+this.target.worldPosition.x;this._targetPosition.y=this.view.y+this.target.worldPosition.y;if(this.deadzone){this._edge=this._targetPosition.x-this.view.x;if(this._edge<this.deadzone.left){this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.left,this.lerp.x)}else{if(this._edge>this.deadzone.right){this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.right,this.lerp.x)}}this._edge=this._targetPosition.y-this.view.y;if(this._edge<this.deadzone.top){this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.top,this.lerp.y)}else{if(this._edge>this.deadzone.bottom){this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.bottom,this.lerp.y)}}}else{this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.view.halfWidth,this.lerp.x);this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.view.halfHeight,this.lerp.y)}if(this.bounds){this.checkBounds()}if(this.roundPx){this.view.floor()}this.displayObject.position.x=-this.view.x;this.displayObject.position.y=-this.view.y},setBoundsToWorld:function(){if(this.bounds){this.bounds.copyFrom(this.game.world.bounds)}},checkBounds:function(){this.atLimit.x=false;this.atLimit.y=false;var b=this.view.x+this._shake.x;var c=this.view.right+this._shake.x;var a=this.view.y+this._shake.y;var d=this.view.bottom+this._shake.y;if(b<=this.bounds.x*this.scale.x){this.atLimit.x=true;this.view.x=this.bounds.x*this.scale.x;if(!this._shake.shakeBounds){this._shake.x=0}}else{if(c>=this.bounds.right*this.scale.x){this.atLimit.x=true;this.view.x=(this.bounds.right*this.scale.x)-this.width;if(!this._shake.shakeBounds){this._shake.x=0}}}if(a<=this.bounds.top*this.scale.y){this.atLimit.y=true;this.view.y=this.bounds.top*this.scale.y;if(!this._shake.shakeBounds){this._shake.y=0}}else{if(d>=this.bounds.bottom*this.scale.y){this.atLimit.y=true;this.view.y=(this.bounds.bottom*this.scale.y)-this.height;if(!this._shake.shakeBounds){this._shake.y=0}}}},setPosition:function(a,b){this.view.x=a;this.view.y=b;if(this.bounds){this.checkBounds()}},setSize:function(b,a){this.view.width=b;this.view.height=a},reset:function(){this.target=null;this.view.x=0;this.view.y=0;this._shake.duration=0;this._shake.x=0;this._shake.y=0;this.resetFX()},resetFX:function(){if(this.fx){this.fx.clear();this.fx.alpha=0}this._fxDuration=0}};Phaser.Camera.prototype.constructor=Phaser.Camera;Object.defineProperty(Phaser.Camera.prototype,"x",{get:function(){return this.view.x},set:function(a){this.view.x=a;if(this.bounds){this.checkBounds()}}});Object.defineProperty(Phaser.Camera.prototype,"y",{get:function(){return this.view.y},set:function(a){this.view.y=a;if(this.bounds){this.checkBounds()}}});Object.defineProperty(Phaser.Camera.prototype,"position",{get:function(){this._position.set(this.view.x,this.view.y);return this._position},set:function(a){if(typeof a.x!=="undefined"){this.view.x=a.x}if(typeof a.y!=="undefined"){this.view.y=a.y}if(this.bounds){this.checkBounds()}}});Object.defineProperty(Phaser.Camera.prototype,"width",{get:function(){return this.view.width},set:function(a){this.view.width=a}});Object.defineProperty(Phaser.Camera.prototype,"height",{get:function(){return this.view.height},set:function(a){this.view.height=a}});Object.defineProperty(Phaser.Camera.prototype,"shakeIntensity",{get:function(){return this._shake.intensity},set:function(a){this._shake.intensity=a}});Object.defineProperty(Phaser.Camera.prototype,"fixedView",{get:function(){this._fixedView.setTo(0,0,this.view.width,this.view.height);return this._fixedView}});Phaser.State=function(){this.game=null;this.key="";this.add=null;this.make=null;this.camera=null;this.cache=null;this.input=null;this.load=null;this.math=null;this.sound=null;this.scale=null;this.stage=null;this.state=null;this.time=null;this.tweens=null;this.world=null;this.particles=null;this.physics=null;this.rnd=null};Phaser.State.prototype={init:function(){},preload:function(){},loadUpdate:function(){},loadRender:function(){},create:function(){},update:function(){},preRender:function(){},render:function(){},resize:function(){},paused:function(){},resumed:function(){},pauseUpdate:function(){},shutdown:function(){}};Phaser.State.prototype.constructor=Phaser.State;Phaser.StateManager=function(b,a){this.game=b;this.states={};this._pendingState=null;if(typeof a!=="undefined"&&a!==null){this._pendingState=a}this._clearWorld=false;this._clearCache=false;this._created=false;this._args=[];this.current="";this.onStateChange=new Phaser.Signal();this.onInitCallback=null;this.onPreloadCallback=null;this.onCreateCallback=null;this.onUpdateCallback=null;this.onRenderCallback=null;this.onResizeCallback=null;this.onPreRenderCallback=null;this.onLoadUpdateCallback=null;this.onLoadRenderCallback=null;this.onPausedCallback=null;this.onResumedCallback=null;this.onPauseUpdateCallback=null;this.onShutDownCallback=null};Phaser.StateManager.prototype={boot:function(){this.game.onPause.add(this.pause,this);this.game.onResume.add(this.resume,this);if(this._pendingState!==null&&typeof this._pendingState!=="string"){this.add("default",this._pendingState,true)}},add:function(b,c,a){if(a===undefined){a=false}var d;if(c instanceof Phaser.State){d=c}else{if(typeof c==="object"){d=c;d.game=this.game}else{if(typeof c==="function"){d=new c(this.game)}}}this.states[b]=d;if(a){if(this.game.isBooted){this.start(b)}else{this._pendingState=b}}return d},remove:function(a){if(this.current===a){this.callbackContext=null;this.onInitCallback=null;this.onShutDownCallback=null;this.onPreloadCallback=null;this.onLoadRenderCallback=null;this.onLoadUpdateCallback=null;this.onCreateCallback=null;this.onUpdateCallback=null;this.onPreRenderCallback=null;this.onRenderCallback=null;this.onResizeCallback=null;this.onPausedCallback=null;this.onResumedCallback=null;this.onPauseUpdateCallback=null}delete this.states[a]},start:function(b,a,c){if(a===undefined){a=true}if(c===undefined){c=false}if(this.checkState(b)){this._pendingState=b;this._clearWorld=a;this._clearCache=c;if(arguments.length>3){this._args=Array.prototype.splice.call(arguments,3)}}},restart:function(a,b){if(a===undefined){a=true}if(b===undefined){b=false}this._pendingState=this.current;this._clearWorld=a;this._clearCache=b;if(arguments.length>2){this._args=Array.prototype.slice.call(arguments,2)}},dummy:function(){},preUpdate:function(){if(this._pendingState&&this.game.isBooted){var a=this.current;this.clearCurrentState();this.setCurrentState(this._pendingState);this.onStateChange.dispatch(this.current,a);if(this.current!==this._pendingState){return}else{this._pendingState=null}if(this.onPreloadCallback){this.game.load.reset(true);this.onPreloadCallback.call(this.callbackContext,this.game);if(this.game.load.totalQueuedFiles()===0&&this.game.load.totalQueuedPacks()===0){this.loadComplete()}else{this.game.load.start()}}else{this.loadComplete()}}},clearCurrentState:function(){if(this.current){if(this.onShutDownCallback){this.onShutDownCallback.call(this.callbackContext,this.game)}this.game.tweens.removeAll();this.game.camera.reset();this.game.input.reset(true);this.game.physics.clear();this.game.time.removeAll();this.game.scale.reset(this._clearWorld);if(this.game.debug){this.game.debug.reset()}if(this._clearWorld){this.game.world.shutdown();if(this._clearCache){this.game.cache.destroy()}}}},checkState:function(a){var b=this.states[a];if(b){if(b.preload||b.create||b.update||b.render){return true}else{console.warn("Invalid Phaser State object given. Must contain at least one of the required functions: preload, create, update or render");return false}}else{console.warn("Phaser.StateManager - No state found with the key: "+a);return false}},link:function(a){this.states[a].game=this.game;this.states[a].add=this.game.add;this.states[a].make=this.game.make;this.states[a].camera=this.game.camera;this.states[a].cache=this.game.cache;this.states[a].input=this.game.input;this.states[a].load=this.game.load;this.states[a].math=this.game.math;this.states[a].sound=this.game.sound;this.states[a].scale=this.game.scale;this.states[a].state=this;this.states[a].stage=this.game.stage;this.states[a].time=this.game.time;this.states[a].tweens=this.game.tweens;this.states[a].world=this.game.world;this.states[a].particles=this.game.particles;this.states[a].rnd=this.game.rnd;this.states[a].physics=this.game.physics;this.states[a].key=a},unlink:function(a){if(this.states[a]){this.states[a].game=null;this.states[a].add=null;this.states[a].make=null;this.states[a].camera=null;this.states[a].cache=null;this.states[a].input=null;this.states[a].load=null;this.states[a].math=null;this.states[a].sound=null;this.states[a].scale=null;this.states[a].state=null;this.states[a].stage=null;this.states[a].time=null;this.states[a].tweens=null;this.states[a].world=null;this.states[a].particles=null;this.states[a].rnd=null;this.states[a].physics=null}},setCurrentState:function(a){this.callbackContext=this.states[a];this.link(a);this.onInitCallback=this.states[a]["init"]||this.dummy;this.onPreloadCallback=this.states[a]["preload"]||null;this.onLoadRenderCallback=this.states[a]["loadRender"]||null;this.onLoadUpdateCallback=this.states[a]["loadUpdate"]||null;this.onCreateCallback=this.states[a]["create"]||null;this.onUpdateCallback=this.states[a]["update"]||null;this.onPreRenderCallback=this.states[a]["preRender"]||null;this.onRenderCallback=this.states[a]["render"]||null;this.onResizeCallback=this.states[a]["resize"]||null;this.onPausedCallback=this.states[a]["paused"]||null;this.onResumedCallback=this.states[a]["resumed"]||null;this.onPauseUpdateCallback=this.states[a]["pauseUpdate"]||null;this.onShutDownCallback=this.states[a]["shutdown"]||this.dummy;if(this.current!==""){this.game.physics.reset()}this.current=a;this._created=false;this.onInitCallback.apply(this.callbackContext,this._args);if(a===this._pendingState){this._args=[]}this.game._kickstart=true},getCurrentState:function(){return this.states[this.current]},loadComplete:function(){if(this._created===false&&this.onLoadUpdateCallback){this.onLoadUpdateCallback.call(this.callbackContext,this.game)}if(this._created===false&&this.onCreateCallback){this._created=true;this.onCreateCallback.call(this.callbackContext,this.game)}else{this._created=true}},pause:function(){if(this._created&&this.onPausedCallback){this.onPausedCallback.call(this.callbackContext,this.game)}},resume:function(){if(this._created&&this.onResumedCallback){this.onResumedCallback.call(this.callbackContext,this.game)}},update:function(){if(this._created){if(this.onUpdateCallback){this.onUpdateCallback.call(this.callbackContext,this.game)}}else{if(this.onLoadUpdateCallback){this.onLoadUpdateCallback.call(this.callbackContext,this.game)}}},pauseUpdate:function(){if(this._created){if(this.onPauseUpdateCallback){this.onPauseUpdateCallback.call(this.callbackContext,this.game)}}else{if(this.onLoadUpdateCallback){this.onLoadUpdateCallback.call(this.callbackContext,this.game)}}},preRender:function(a){if(this._created&&this.onPreRenderCallback){this.onPreRenderCallback.call(this.callbackContext,this.game,a)}},resize:function(b,a){if(this.onResizeCallback){this.onResizeCallback.call(this.callbackContext,b,a)}},render:function(){if(this._created){if(this.onRenderCallback){if(this.game.renderType===Phaser.CANVAS){this.game.context.save();this.game.context.setTransform(1,0,0,1,0,0);this.onRenderCallback.call(this.callbackContext,this.game);this.game.context.restore()}else{this.onRenderCallback.call(this.callbackContext,this.game)}}}else{if(this.onLoadRenderCallback){this.onLoadRenderCallback.call(this.callbackContext,this.game)}}},destroy:function(){this._clearWorld=true;this._clearCache=true;this.clearCurrentState();this.callbackContext=null;this.onInitCallback=null;this.onShutDownCallback=null;this.onPreloadCallback=null;this.onLoadRenderCallback=null;this.onLoadUpdateCallback=null;this.onCreateCallback=null;this.onUpdateCallback=null;this.onRenderCallback=null;this.onPausedCallback=null;this.onResumedCallback=null;this.onPauseUpdateCallback=null;this.game=null;this.states={};this._pendingState=null;this.current=""}};Phaser.StateManager.prototype.constructor=Phaser.StateManager;Object.defineProperty(Phaser.StateManager.prototype,"created",{get:function(){return this._created}});Phaser.Signal=function(){};Phaser.Signal.prototype={_bindings:null,_prevParams:null,memorize:false,_shouldPropagate:true,active:true,_boundDispatch:false,validateListener:function(a,b){if(typeof a!=="function"){throw new Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",b))}},_registerListener:function(f,d,e,c,a){var b=this._indexOfListener(f,e);var g;if(b!==-1){g=this._bindings[b];if(g.isOnce()!==d){throw new Error("You cannot add"+(d?"":"Once")+"() then add"+(!d?"":"Once")+"() the same listener without removing the relationship first.")}}else{g=new Phaser.SignalBinding(this,f,d,e,c,a);this._addBinding(g)}if(this.memorize&&this._prevParams){g.execute(this._prevParams)}return g},_addBinding:function(a){if(!this._bindings){this._bindings=[]}var b=this._bindings.length;do{b--}while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(b,a){if(!this._bindings){return -1}if(a===undefined){a=null}var d=this._bindings.length;var c;while(d--){c=this._bindings[d];if(c._listener===b&&c.context===a){return d}}return -1},has:function(b,a){return this._indexOfListener(b,a)!==-1},add:function(e,d,c){this.validateListener(e,"add");var a=[];if(arguments.length>3){for(var b=3;b<arguments.length;b++){a.push(arguments[b])}}return this._registerListener(e,false,d,c,a)},addOnce:function(e,d,c){this.validateListener(e,"addOnce");var a=[];if(arguments.length>3){for(var b=3;b<arguments.length;b++){a.push(arguments[b])}}return this._registerListener(e,true,d,c,a)},remove:function(c,b){this.validateListener(c,"remove");var a=this._indexOfListener(c,b);if(a!==-1){this._bindings[a]._destroy();this._bindings.splice(a,1)}return c},removeAll:function(a){if(a===undefined){a=null}if(!this._bindings){return}var b=this._bindings.length;while(b--){if(a){if(this._bindings[b].context===a){this._bindings[b]._destroy();this._bindings.splice(b,1)}}else{this._bindings[b]._destroy()}}if(!a){this._bindings.length=0}},getNumListeners:function(){return this._bindings?this._bindings.length:0},halt:function(){this._shouldPropagate=false},dispatch:function(){if(!this.active||!this._bindings){return}var a=Array.prototype.slice.call(arguments);var c=this._bindings.length;var b;if(this.memorize){this._prevParams=a}if(!c){return}b=this._bindings.slice();this._shouldPropagate=true;do{c--}while(b[c]&&this._shouldPropagate&&b[c].execute(a)!==false)},forget:function(){if(this._prevParams){this._prevParams=null}},dispose:function(){this.removeAll();this._bindings=null;if(this._prevParams){this._prevParams=null}},toString:function(){return"[Phaser.Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};Object.defineProperty(Phaser.Signal.prototype,"boundDispatch",{get:function(){var a=this;return this._boundDispatch||(this._boundDispatch=function(){return a.dispatch.apply(a,arguments)})}});Phaser.Signal.prototype.constructor=Phaser.Signal;Phaser.SignalBinding=function(f,e,c,d,b,a){this._listener=e;if(c){this._isOnce=true}if(d!=null){this.context=d}this._signal=f;if(b){this._priority=b}if(a&&a.length){this._args=a}};Phaser.SignalBinding.prototype={context:null,_isOnce:false,_priority:0,_args:null,callCount:0,active:true,params:null,execute:function(a){var c,b;if(this.active&&!!this._listener){b=this.params?this.params.concat(a):a;if(this._args){b=b.concat(this._args)}c=this._listener.apply(this.context,b);this.callCount++;if(this._isOnce){this.detach()}}return c},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return(!!this._signal&&!!this._listener)},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;delete this.context},toString:function(){return"[Phaser.SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};Phaser.SignalBinding.prototype.constructor=Phaser.SignalBinding;Phaser.Filter=function(b,a,e){this.game=b;this.type=Phaser.WEBGL_FILTER;this.passes=[this];this.shaders=[];this.dirty=true;this.padding=0;this.prevPoint=new Phaser.Point();var f=new Date();this.uniforms={resolution:{type:"2f",value:{x:256,y:256}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:0,y:0}},date:{type:"4fv",value:[f.getFullYear(),f.getMonth(),f.getDate(),f.getHours()*60*60+f.getMinutes()*60+f.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:true}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:true}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:true}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:true}}};if(a){for(var c in a){this.uniforms[c]=a[c]}}if(typeof e==="string"){e=e.split("\n")}this.fragmentSrc=e||[]};Phaser.Filter.prototype={init:function(){},setResolution:function(b,a){this.uniforms.resolution.value.x=b;this.uniforms.resolution.value.y=a},update:function(b){if(b){var a=b.x/this.game.width;var c=1-b.y/this.game.height;if(a!==this.prevPoint.x||c!==this.prevPoint.y){this.uniforms.mouse.value.x=a.toFixed(2);this.uniforms.mouse.value.y=c.toFixed(2);this.prevPoint.set(a,c)}}this.uniforms.time.value=this.game.time.totalElapsedSeconds()},addToWorld:function(c,g,d,b,a,f){if(a===undefined){a=0}if(f===undefined){f=0}if(d!==undefined&&d!==null){this.width=d}else{d=this.width}if(b!==undefined&&b!==null){this.height=b}else{b=this.height}var e=this.game.add.image(c,g,Phaser.Cache.DEFAULT);e.width=d;e.height=b;e.anchor.set(a,f);e.filters=[this];return e},syncUniforms:function(){for(var a=0;a<this.shaders.length;a++){this.shaders[a].dirty=true}},destroy:function(){this.passes.length=0;this.shaders.length=0;this.fragmentSrc.length=0;this.game=null;this.uniforms=null;this.prevPoint=null}};Phaser.Filter.prototype.constructor=Phaser.Filter;Object.defineProperty(Phaser.Filter.prototype,"width",{get:function(){return this.uniforms.resolution.value.x},set:function(a){this.uniforms.resolution.value.x=a}});Object.defineProperty(Phaser.Filter.prototype,"height",{get:function(){return this.uniforms.resolution.value.y},set:function(a){this.uniforms.resolution.value.y=a}});Phaser.Plugin=function(a,b){if(b===undefined){b=null}this.game=a;this.parent=b;this.active=false;this.visible=false;this.hasPreUpdate=false;this.hasUpdate=false;this.hasPostUpdate=false;this.hasRender=false;this.hasPostRender=false};Phaser.Plugin.prototype={preUpdate:function(){},update:function(){},render:function(){},postRender:function(){},destroy:function(){this.game=null;this.parent=null;this.active=false;this.visible=false}};Phaser.Plugin.prototype.constructor=Phaser.Plugin;Phaser.PluginManager=function(a){this.game=a;this.plugins=[];this._len=0;this._i=0};Phaser.PluginManager.prototype={add:function(c){var b=Array.prototype.slice.call(arguments,1);var a=false;if(typeof c==="function"){c=new c(this.game,this)}else{c.game=this.game;c.parent=this}if(typeof c.preUpdate==="function"){c.hasPreUpdate=true;a=true}if(typeof c.update==="function"){c.hasUpdate=true;a=true}if(typeof c.postUpdate==="function"){c.hasPostUpdate=true;a=true}if(typeof c.render==="function"){c.hasRender=true;a=true}if(typeof c.postRender==="function"){c.hasPostRender=true;a=true}if(a){if(c.hasPreUpdate||c.hasUpdate||c.hasPostUpdate){c.active=true}if(c.hasRender||c.hasPostRender){c.visible=true}this._len=this.plugins.push(c);if(typeof c.init==="function"){c.init.apply(c,b)}return c}else{return null}},remove:function(b,a){if(a===undefined){a=true}this._i=this._len;while(this._i--){if(this.plugins[this._i]===b){if(a){b.destroy()}this.plugins.splice(this._i,1);this._len--;return}}},removeAll:function(){this._i=this._len;while(this._i--){this.plugins[this._i].destroy()}this.plugins.length=0;this._len=0},preUpdate:function(){this._i=this._len;while(this._i--){if(this.plugins[this._i].active&&this.plugins[this._i].hasPreUpdate){this.plugins[this._i].preUpdate()}}},update:function(){this._i=this._len;while(this._i--){if(this.plugins[this._i].active&&this.plugins[this._i].hasUpdate){this.plugins[this._i].update()}}},postUpdate:function(){this._i=this._len;while(this._i--){if(this.plugins[this._i].active&&this.plugins[this._i].hasPostUpdate){this.plugins[this._i].postUpdate()}}},render:function(){this._i=this._len;while(this._i--){if(this.plugins[this._i].visible&&this.plugins[this._i].hasRender){this.plugins[this._i].render()}}},postRender:function(){this._i=this._len;while(this._i--){if(this.plugins[this._i].visible&&this.plugins[this._i].hasPostRender){this.plugins[this._i].postRender()}}},destroy:function(){this.removeAll();this.game=null}};Phaser.PluginManager.prototype.constructor=Phaser.PluginManager;Phaser.Stage=function(a){this.game=a;PIXI.DisplayObjectContainer.call(this);this.name="_stage_root";this.disableVisibilityChange=false;this.exists=true;this.worldTransform=new Phaser.Matrix();this.stage=this;this.currentRenderOrderID=0;this._hiddenVar="hidden";this._onChange=null;this._bgColor={r:0,g:0,b:0,a:0,color:0,rgba:"#000000"};if(!this.game.transparent){this._bgColor.a=1}if(a.config){this.parseConfig(a.config)}};Phaser.Stage.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);Phaser.Stage.prototype.constructor=Phaser.Stage;Phaser.Stage.prototype.parseConfig=function(a){if(a.disableVisibilityChange){this.disableVisibilityChange=a.disableVisibilityChange}if(a.backgroundColor){this.setBackgroundColor(a.backgroundColor)}};Phaser.Stage.prototype.boot=function(){Phaser.DOM.getOffset(this.game.canvas,this.offset);Phaser.Canvas.setUserSelect(this.game.canvas,"none");Phaser.Canvas.setTouchAction(this.game.canvas,"none");this.checkVisibility()};Phaser.Stage.prototype.preUpdate=function(){this.currentRenderOrderID=0;var a=0;while(a<this.children.length){var b=this.children[a];b.preUpdate();if(this===b.parent){a++}}};Phaser.Stage.prototype.update=function(){var a=this.children.length;while(a--){this.children[a].update()}};Phaser.Stage.prototype.postUpdate=function(){this.game.camera.update();if(this.game.camera.target){this.game.camera.target.postUpdate();this.updateTransform();this.game.camera.updateTarget()}for(var a=0;a<this.children.length;a++){this.children[a].postUpdate()}this.updateTransform()};Phaser.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var a=0;a<this.children.length;a++){this.children[a].updateTransform()}};Phaser.Stage.prototype.checkVisibility=function(){if(document.hidden!==undefined){this._hiddenVar="visibilitychange"}else{if(document.webkitHidden!==undefined){this._hiddenVar="webkitvisibilitychange"}else{if(document.mozHidden!==undefined){this._hiddenVar="mozvisibilitychange"}else{if(document.msHidden!==undefined){this._hiddenVar="msvisibilitychange"}else{this._hiddenVar=null}}}}var a=this;this._onChange=function(b){return a.visibilityChange(b)};this._onClick=function(b){if((document.hasFocus!==undefined)&&!document.hasFocus()){a.visibilityChange(b)}};if(this._hiddenVar){document.addEventListener(this._hiddenVar,this._onChange,false)}window.onblur=this._onChange;window.onfocus=this._onChange;window.onpagehide=this._onChange;window.onpageshow=this._onChange;window.addEventListener("click",this._onClick);if(this.game.device.cocoonJSApp){CocoonJS.App.onSuspended.addEventListener(function(){Phaser.Stage.prototype.visibilityChange.call(a,{type:"pause"})});CocoonJS.App.onActivated.addEventListener(function(){Phaser.Stage.prototype.visibilityChange.call(a,{type:"resume"})})}};Phaser.Stage.prototype.visibilityChange=function(a){switch(a.type){case"blur":case"pagehide":this.game.focusLoss(a);return;case"click":case"focus":case"pageshow":this.game.focusGain(a);return}if(this.disableVisibilityChange){return}if(document.hidden||document.mozHidden||document.msHidden||document.webkitHidden||a.type==="pause"){this.game.gamePaused(a)}else{this.game.gameResumed(a)}};Phaser.Stage.prototype.setBackgroundColor=function(a){if(this.game.transparent){return}Phaser.Color.valueToColor(a,this._bgColor);Phaser.Color.updateColor(this._bgColor);this._bgColor.r/=255;this._bgColor.g/=255;this._bgColor.b/=255;this._bgColor.a=1};Phaser.Stage.prototype.destroy=function(){if(this._hiddenVar){document.removeEventListener(this._hiddenVar,this._onChange,false)}window.onpagehide=null;window.onpageshow=null;window.onblur=null;window.onfocus=null;window.removeEventListener("click",this._onClick)};Object.defineProperty(Phaser.Stage.prototype,"backgroundColor",{get:function(){return this._bgColor.color},set:function(a){this.setBackgroundColor(a)}});Object.defineProperty(Phaser.Stage.prototype,"smoothed",{get:function(){return PIXI.scaleModes.DEFAULT===PIXI.scaleModes.LINEAR},set:function(a){if(a){PIXI.scaleModes.DEFAULT=PIXI.scaleModes.LINEAR}else{PIXI.scaleModes.DEFAULT=PIXI.scaleModes.NEAREST}}});Phaser.Group=function(b,e,c,a,f,d){if(a===undefined){a=false}if(f===undefined){f=false}if(d===undefined){d=Phaser.Physics.ARCADE}this.game=b;if(e===undefined){e=b.world}this.name=c||"group";this.z=0;PIXI.DisplayObjectContainer.call(this);if(a){this.game.stage.addChild(this);this.z=this.game.stage.children.length}else{if(e){e.addChild(this);this.z=e.children.length}}this.type=Phaser.GROUP;this.physicsType=Phaser.GROUP;this.alive=true;this.exists=true;this.ignoreDestroy=false;this.pendingDestroy=false;this.classType=Phaser.Sprite;this.cursor=null;this.inputEnableChildren=false;this.updateOnlyExistingChildren=false;this.onChildInputDown=new Phaser.Signal();this.onChildInputUp=new Phaser.Signal();this.onChildInputOver=new Phaser.Signal();this.onChildInputOut=new Phaser.Signal();this.enableBody=f;this.enableBodyDebug=false;this.physicsBodyType=d;this.physicsSortDirection=null;this.onDestroy=new Phaser.Signal();this.cursorIndex=0;this.fixedToCamera=false;this.cameraOffset=new Phaser.Point();this.hash=[];this._sortProperty="z"};Phaser.Group.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);Phaser.Group.prototype.constructor=Phaser.Group;Phaser.Group.RETURN_NONE=0;Phaser.Group.RETURN_TOTAL=1;Phaser.Group.RETURN_CHILD=2;Phaser.Group.RETURN_ALL=3;Phaser.Group.SORT_ASCENDING=-1;Phaser.Group.SORT_DESCENDING=1;Phaser.Group.prototype.add=function(c,a,b){if(a===undefined){a=false}if(c.parent===this){return c}if(c.body&&c.parent&&c.parent.hash){c.parent.removeFromHash(c)}if(b===undefined){c.z=this.children.length;this.addChild(c)}else{this.addChildAt(c,b);this.updateZ()}if(this.enableBody&&c.hasOwnProperty("body")&&c.body===null){this.game.physics.enable(c,this.physicsBodyType)}else{if(c.body){this.addToHash(c)}}if(this.inputEnableChildren&&(!c.input||c.inputEnabled)){c.inputEnabled=true}if(!a&&c.events){c.events.onAddedToGroup$dispatch(c,this)}if(this.cursor===null){this.cursor=c}return c};Phaser.Group.prototype.addAt=function(c,b,a){return this.add(c,a,b)};Phaser.Group.prototype.addToHash=function(b){if(b.parent===this){var a=this.hash.indexOf(b);if(a===-1){this.hash.push(b);return true}}return false};Phaser.Group.prototype.removeFromHash=function(b){if(b){var a=this.hash.indexOf(b);if(a!==-1){this.hash.splice(a,1);return true}}return false};Phaser.Group.prototype.addMultiple=function(c,a){if(c instanceof Phaser.Group){c.moveAll(this,a)}else{if(Array.isArray(c)){for(var b=0;b<c.length;b++){this.add(c[b],a)}}}return c};Phaser.Group.prototype.getAt=function(a){if(a<0||a>=this.children.length){return -1}else{return this.getChildAt(a)}};Phaser.Group.prototype.create=function(a,g,c,e,d,b){if(d===undefined){d=true}var f=new this.classType(this.game,a,g,c,e);f.exists=d;f.visible=d;f.alive=d;return this.add(f,false,b)};Phaser.Group.prototype.createMultiple=function(e,c,f,d,h,a){if(f===undefined){f=0}if(d===undefined){d=false}if(!Array.isArray(c)){c=[c]}if(!Array.isArray(f)){f=[f]}var g=this;var b=[];c.forEach(function(i){f.forEach(function(k){for(var j=0;j<e;j++){var l=g.create(0,0,i,k,d);if(h){h.call(a||l,l,j)}b.push(l)}})});return b};Phaser.Group.prototype.updateZ=function(){var a=this.children.length;while(a--){this.children[a].z=a}};Phaser.Group.prototype.align=function(b,m,d,k,j,e){if(j===undefined){j=Phaser.TOP_LEFT}if(e===undefined){e=0}if(this.children.length===0||e>this.children.length||(b===-1&&m===-1)){return false}var a=new Phaser.Rectangle(0,0,d,k);var l=(b*d);var g=(m*k);for(var f=e;f<this.children.length;f++){var c=this.children[f];if(c.alignIn){c.alignIn(a,j)}else{continue}if(b===-1){a.y+=k;if(a.y===g){a.x+=d;a.y=0}}else{if(m===-1){a.x+=d;if(a.x===l){a.x=0;a.y+=k}}else{a.x+=d;if(a.x===l){a.x=0;a.y+=k;if(a.y===g){return true}}}}}return true};Phaser.Group.prototype.resetCursor=function(a){if(a===undefined){a=0}if(a>this.children.length-1){a=0}if(this.cursor){this.cursorIndex=a;this.cursor=this.children[this.cursorIndex];return this.cursor}};Phaser.Group.prototype.next=function(){if(this.cursor){if(this.cursorIndex>=this.children.length-1){this.cursorIndex=0}else{this.cursorIndex++}this.cursor=this.children[this.cursorIndex];return this.cursor}};Phaser.Group.prototype.previous=function(){if(this.cursor){if(this.cursorIndex===0){this.cursorIndex=this.children.length-1}else{this.cursorIndex--}this.cursor=this.children[this.cursorIndex];return this.cursor}};Phaser.Group.prototype.swap=function(b,a){this.swapChildren(b,a);this.updateZ()};Phaser.Group.prototype.bringToTop=function(a){if(a.parent===this&&this.getIndex(a)<this.children.length){this.remove(a,false,true);this.add(a,true)}return a};Phaser.Group.prototype.sendToBack=function(a){if(a.parent===this&&this.getIndex(a)>0){this.remove(a,false,true);this.addAt(a,0,true)}return a};Phaser.Group.prototype.moveUp=function(e){if(e.parent===this&&this.getIndex(e)<this.children.length-1){var d=this.getIndex(e);var c=this.getAt(d+1);if(c){this.swap(e,c)}}return e};Phaser.Group.prototype.moveDown=function(e){if(e.parent===this&&this.getIndex(e)>0){var d=this.getIndex(e);var c=this.getAt(d-1);if(c){this.swap(e,c)}}return e};Phaser.Group.prototype.xy=function(b,a,c){if(b<0||b>this.children.length){return -1}else{this.getChildAt(b).x=a;this.getChildAt(b).y=c}};Phaser.Group.prototype.reverse=function(){this.children.reverse();this.updateZ()};Phaser.Group.prototype.getIndex=function(a){return this.children.indexOf(a)};Phaser.Group.prototype.getByName=function(a){for(var b=0;b<this.children.length;b++){if(this.children[b].name===a){return this.children[b]}}return null};Phaser.Group.prototype.replace=function(c,a){var b=this.getIndex(c);if(b!==-1){if(a.parent){if(a.parent instanceof Phaser.Group){a.parent.remove(a)}else{a.parent.removeChild(a)}}this.remove(c);this.addAt(a,b);return c}};Phaser.Group.prototype.hasProperty=function(c,b){var a=b.length;if(a===1&&b[0] in c){return true}else{if(a===2&&b[0] in c&&b[1] in c[b[0]]){return true}else{if(a===3&&b[0] in c&&b[1] in c[b[0]]&&b[2] in c[b[0]][b[1]]){return true}else{if(a===4&&b[0] in c&&b[1] in c[b[0]]&&b[2] in c[b[0]][b[1]]&&b[3] in c[b[0]][b[1]][b[2]]){return true}}}}return false};Phaser.Group.prototype.setProperty=function(f,c,e,b,d){if(d===undefined){d=false}b=b||0;if(!this.hasProperty(f,c)&&(!d||b>0)){return false}var a=c.length;if(a===1){if(b===0){f[c[0]]=e}else{if(b===1){f[c[0]]+=e}else{if(b===2){f[c[0]]-=e}else{if(b===3){f[c[0]]*=e}else{if(b===4){f[c[0]]/=e}}}}}}else{if(a===2){if(b===0){f[c[0]][c[1]]=e}else{if(b===1){f[c[0]][c[1]]+=e}else{if(b===2){f[c[0]][c[1]]-=e}else{if(b===3){f[c[0]][c[1]]*=e}else{if(b===4){f[c[0]][c[1]]/=e}}}}}}else{if(a===3){if(b===0){f[c[0]][c[1]][c[2]]=e}else{if(b===1){f[c[0]][c[1]][c[2]]+=e}else{if(b===2){f[c[0]][c[1]][c[2]]-=e}else{if(b===3){f[c[0]][c[1]][c[2]]*=e}else{if(b===4){f[c[0]][c[1]][c[2]]/=e}}}}}}else{if(a===4){if(b===0){f[c[0]][c[1]][c[2]][c[3]]=e}else{if(b===1){f[c[0]][c[1]][c[2]][c[3]]+=e}else{if(b===2){f[c[0]][c[1]][c[2]][c[3]]-=e}else{if(b===3){f[c[0]][c[1]][c[2]][c[3]]*=e}else{if(b===4){f[c[0]][c[1]][c[2]][c[3]]/=e}}}}}}}}}return true};Phaser.Group.prototype.checkProperty=function(e,b,d,c){if(c===undefined){c=false}if(this!==e.parent){return false}var a=Phaser.Utils.getProperty(e,b);if(((a===undefined)&&c)||(a!==d)){return false}return true};Phaser.Group.prototype.set=function(g,c,e,b,f,a,d){if(d===undefined){d=false}c=c.split(".");if(b===undefined){b=false}if(f===undefined){f=false}if((b===false||(b&&g.alive))&&(f===false||(f&&g.visible))){return this.setProperty(g,c,e,a,d)}};Phaser.Group.prototype.setAll=function(d,f,b,g,a,e){if(b===undefined){b=false}if(g===undefined){g=false}if(e===undefined){e=false}d=d.split(".");a=a||0;for(var c=0;c<this.children.length;c++){if((!b||(b&&this.children[c].alive))&&(!g||(g&&this.children[c].visible))){this.setProperty(this.children[c],d,f,a,e)}}};Phaser.Group.prototype.setAllChildren=function(d,f,b,g,a,e){if(b===undefined){b=false}if(g===undefined){g=false}if(e===undefined){e=false}a=a||0;for(var c=0;c<this.children.length;c++){if((!b||(b&&this.children[c].alive))&&(!g||(g&&this.children[c].visible))){if(this.children[c] instanceof Phaser.Group){this.children[c].setAllChildren(d,f,b,g,a,e)}else{this.setProperty(this.children[c],d.split("."),f,a,e)}}}};Phaser.Group.prototype.checkAll=function(c,e,a,f,d){if(a===undefined){a=false}if(f===undefined){f=false}if(d===undefined){d=false}for(var b=0;b<this.children.length;b++){var g=this.children[b];if((!a||(a&&g.alive))&&(!f||(f&&g.visible))){if(!this.checkProperty(g,c,e,d)){return false}}}return true};Phaser.Group.prototype.checkAny=function(c,d,a,e){if(a===undefined){a=false}if(e===undefined){e=false}for(var b=0;b<this.children.length;b++){var f=this.children[b];if((!a||(a&&f.alive))&&(!e||(e&&f.visible))){if(this.checkProperty(f,c,d)){return true}}}return false};Phaser.Group.prototype.addAll=function(c,b,a,d){this.setAll(c,b,a,d,1)};Phaser.Group.prototype.subAll=function(c,b,a,d){this.setAll(c,b,a,d,2)};Phaser.Group.prototype.multiplyAll=function(c,b,a,d){this.setAll(c,b,a,d,3)};Phaser.Group.prototype.divideAll=function(c,b,a,d){this.setAll(c,b,a,d,4)};Phaser.Group.prototype.kill=function(){this.alive=false;this.exists=false;this.visible=false};Phaser.Group.prototype.killAll=function(){this.callAllExists("kill",true)};Phaser.Group.prototype.revive=function(){this.alive=true;this.exists=true;this.visible=true};Phaser.Group.prototype.reviveAll=function(){this.callAllExists("revive",false)};Phaser.Group.prototype.resetAll=function(a,e,b,c,d){this.forEach(this.resetChild,this,d,a,e,b,c)};Phaser.Group.prototype.callAllExists=function(d,c){var a;if(arguments.length>2){a=[];for(var b=2;b<arguments.length;b++){a.push(arguments[b])}}for(var b=0;b<this.children.length;b++){if(this.children[b].exists===c&&this.children[b][d]){this.children[b][d].apply(this.children[b],a)}}};Phaser.Group.prototype.callbackFromArray=function(c,b,a){if(a===1){if(c[b[0]]){return c[b[0]]}}else{if(a===2){if(c[b[0]][b[1]]){return c[b[0]][b[1]]}}else{if(a===3){if(c[b[0]][b[1]][b[2]]){return c[b[0]][b[1]][b[2]]}}else{if(a===4){if(c[b[0]][b[1]][b[2]][b[3]]){return c[b[0]][b[1]][b[2]][b[3]]}}else{if(c[b]){return c[b]}}}}}return false};Phaser.Group.prototype.callAll=function(h,d){if(h===undefined){return}h=h.split(".");var f=h.length;if(d===undefined||d===null||d===""){d=null}else{if(typeof d==="string"){d=d.split(".");var e=d.length}}var b;if(arguments.length>2){b=[];for(var c=2;c<arguments.length;c++){b.push(arguments[c])}}var g=null;var a=null;for(var c=0;c<this.children.length;c++){g=this.callbackFromArray(this.children[c],h,f);if(d&&g){a=this.callbackFromArray(this.children[c],d,e);if(g){g.apply(a,b)}}else{if(g){g.apply(this.children[c],b)}}}};Phaser.Group.prototype.preUpdate=function(){if(this.pendingDestroy){this.destroy();return false}if(!this.exists||!this.parent.exists){this.renderOrderID=-1;return false}var a=0;while(a<this.children.length){var b=this.children[a];b.preUpdate();if(this===b.parent){a++}}return true};Phaser.Group.prototype.update=function(){var b=this.children.length;while(b--){var a=this.children.length;if(b>=a){b=a-1}var c=this.children[b];if(!this.updateOnlyExistingChildren||c.exists){c.update()}}};Phaser.Group.prototype.postUpdate=function(){if(this.fixedToCamera){this.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x;this.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y}for(var a=0;a<this.children.length;a++){this.children[a].postUpdate()}};Phaser.Group.prototype.filter=function(a,f){var b=-1;var d=this.children.length;var c=[];while(++b<d){var e=this.children[b];if(!f||(f&&e.exists)){if(a(e,b,this.children)){c.push(e)}}}return new Phaser.ArraySet(c)};Phaser.Group.prototype.forEach=function(e,a,d){if(d===undefined){d=false}if(arguments.length<=3){for(var c=0;c<this.children.length;c++){if(!d||(d&&this.children[c].exists)){e.call(a,this.children[c])}}}else{var b=[null];for(var c=3;c<arguments.length;c++){b.push(arguments[c])}for(var c=0;c<this.children.length;c++){if(!d||(d&&this.children[c].exists)){b[0]=this.children[c];e.apply(a,b)}}}};Phaser.Group.prototype.forEachExists=function(d,a){var b;if(arguments.length>2){b=[null];for(var c=2;c<arguments.length;c++){b.push(arguments[c])}}this.iterate("exists",true,Phaser.Group.RETURN_TOTAL,d,a,b)};Phaser.Group.prototype.forEachAlive=function(d,a){var b;if(arguments.length>2){b=[null];for(var c=2;c<arguments.length;c++){b.push(arguments[c])}}this.iterate("alive",true,Phaser.Group.RETURN_TOTAL,d,a,b)};Phaser.Group.prototype.forEachDead=function(d,a){var b;if(arguments.length>2){b=[null];for(var c=2;c<arguments.length;c++){b.push(arguments[c])}}this.iterate("alive",false,Phaser.Group.RETURN_TOTAL,d,a,b)};Phaser.Group.prototype.sort=function(b,a){if(this.children.length<2){return}if(b===undefined){b="z"}if(a===undefined){a=Phaser.Group.SORT_ASCENDING}this._sortProperty=b;if(a===Phaser.Group.SORT_ASCENDING){this.children.sort(this.ascendingSortHandler.bind(this))}else{this.children.sort(this.descendingSortHandler.bind(this))}this.updateZ()};Phaser.Group.prototype.customSort=function(a,b){if(this.children.length<2){return}this.children.sort(a.bind(b));this.updateZ()};Phaser.Group.prototype.ascendingSortHandler=function(d,c){if(d[this._sortProperty]<c[this._sortProperty]){return -1}else{if(d[this._sortProperty]>c[this._sortProperty]){return 1}else{if(d.z<c.z){return -1}else{return 1}}}};Phaser.Group.prototype.descendingSortHandler=function(d,c){if(d[this._sortProperty]<c[this._sortProperty]){return 1}else{if(d[this._sortProperty]>c[this._sortProperty]){return -1}else{return 0}}};Phaser.Group.prototype.iterate=function(h,g,d,j,b,e){if(this.children.length===0){if(d===Phaser.Group.RETURN_TOTAL){return 0}else{if(d===Phaser.Group.RETURN_ALL){return[]}}}var f=0;if(d===Phaser.Group.RETURN_ALL){var a=[]}for(var c=0;c<this.children.length;c++){if(this.children[c][h]===g){f++;if(j){if(e){e[0]=this.children[c];j.apply(b,e)}else{j.call(b,this.children[c])}}if(d===Phaser.Group.RETURN_CHILD){return this.children[c]}else{if(d===Phaser.Group.RETURN_ALL){a.push(this.children[c])}}}}if(d===Phaser.Group.RETURN_TOTAL){return f}else{if(d===Phaser.Group.RETURN_ALL){return a}else{return null}}};Phaser.Group.prototype.getFirst=function(a,b){return this.iterate(a,b,Phaser.Group.RETURN_CHILD)};Phaser.Group.prototype.getFirstExists=function(d,b,a,g,c,e){if(b===undefined){b=false}if(typeof d!=="boolean"){d=true}var f=this.getFirst("exists",d);return(f===null&&b)?this.create(a,g,c,e):this.resetChild(f,a,g,c,e)};Phaser.Group.prototype.getFirstAlive=function(b,a,f,c,d){if(b===undefined){b=false}var e=this.getFirst("alive",true);return(e===null&&b)?this.create(a,f,c,d):this.resetChild(e,a,f,c,d)};Phaser.Group.prototype.getFirstDead=function(b,a,f,c,d){if(b===undefined){b=false}var e=this.getFirst("alive",false);return(e===null&&b)?this.create(a,f,c,d):this.resetChild(e,a,f,c,d)};Phaser.Group.prototype.resetChild=function(e,a,d,b,c){if(e===null){return null}if(a===undefined){a=null}if(d===undefined){d=null}if(a!==null&&d!==null){e.reset(a,d)}if(b!==undefined){e.loadTexture(b,c)}return e};Phaser.Group.prototype.getTop=function(){if(this.children.length>0){return this.children[this.children.length-1]}};Phaser.Group.prototype.getBottom=function(){if(this.children.length>0){return this.children[0]}};Phaser.Group.prototype.getClosestTo=function(d,h,c){var g=Number.MAX_VALUE;var b=0;var a=null;for(var e=0;e<this.children.length;e++){var f=this.children[e];if(f.exists){b=Math.abs(Phaser.Point.distance(d,f));if(b<g&&(!h||h.call(c,f,b))){g=b;a=f}}}return a};Phaser.Group.prototype.getFurthestFrom=function(d,h,c){var g=0;var b=0;var a=null;for(var e=0;e<this.children.length;e++){var f=this.children[e];if(f.exists){b=Math.abs(Phaser.Point.distance(d,f));if(b>g&&(!h||h.call(c,f,b))){g=b;a=f}}}return a};Phaser.Group.prototype.count=function(a,b){return this.iterate(a,b,Phaser.Group.RETURN_TOTAL)};Phaser.Group.prototype.countLiving=function(){return this.count("alive",true)};Phaser.Group.prototype.countDead=function(){return this.count("alive",false)};Phaser.Group.prototype.getRandom=function(b,a){if(b===undefined){b=0}if(a===undefined){a=this.children.length}if(a===0){return null}return Phaser.ArrayUtils.getRandomItem(this.children,b,a)};Phaser.Group.prototype.getRandomExists=function(c,b){var a=this.getAll("exists",true,c,b);return this.game.rnd.pick(a)};Phaser.Group.prototype.getAll=function(e,d,f,c){if(f===undefined){f=0}if(c===undefined){c=this.children.length}var a=[];for(var b=f;b<c;b++){var g=this.children[b];if(e){if(g[e]===d){a.push(g)}}else{a.push(g)}}return a};Phaser.Group.prototype.remove=function(d,b,a){if(b===undefined){b=false}if(a===undefined){a=false}if(this.children.length===0||this.children.indexOf(d)===-1){return false}if(!a&&d.events&&!d.destroyPhase){d.events.onRemovedFromGroup$dispatch(d,this)}var c=this.removeChild(d);this.removeFromHash(d);this.updateZ();if(this.cursor===d){this.next()}if(b&&c){c.destroy(true)}return true};Phaser.Group.prototype.moveAll=function(b,a){if(a===undefined){a=false}if(this.children.length>0&&b instanceof Phaser.Group){do{b.add(this.children[0],a)}while(this.children.length>0);this.hash=[];this.cursor=null}return b};Phaser.Group.prototype.removeAll=function(c,a,b){if(c===undefined){c=false}if(a===undefined){a=false}if(b===undefined){b=false}if(this.children.length===0){return}do{if(!a&&this.children[0].events){this.children[0].events.onRemovedFromGroup$dispatch(this.children[0],this)}var d=this.removeChild(this.children[0]);this.removeFromHash(d);if(c&&d){d.destroy(true,b)}}while(this.children.length>0);this.hash=[];this.cursor=null};Phaser.Group.prototype.removeBetween=function(f,d,c,a){if(d===undefined){d=this.children.length-1}if(c===undefined){c=false}if(a===undefined){a=false}if(this.children.length===0){return}if(f>d||f<0||d>this.children.length){return false}var b=d;while(b>=f){if(!a&&this.children[b].events){this.children[b].events.onRemovedFromGroup$dispatch(this.children[b],this)}var e=this.removeChild(this.children[b]);this.removeFromHash(e);if(c&&e){e.destroy(true)}if(this.cursor===this.children[b]){this.cursor=null}b--}this.updateZ()};Phaser.Group.prototype.scatter=function(a,b){if(a==null){a=this.game.world.bounds}this.forEach(function(c){c.position.set(a.randomX,a.randomY)},null,b)};Phaser.Group.prototype.shuffle=function(){Phaser.ArrayUtils.shuffle(this.children);this.updateZ()};Phaser.Group.prototype.destroy=function(b,a){if(this.game===null||this.ignoreDestroy){return}if(b===undefined){b=true}if(a===undefined){a=false}this.onDestroy.dispatch(this,b,a);this.removeAll(b);this.cursor=null;this.filters=null;this.pendingDestroy=false;if(!a){if(this.parent){this.parent.removeChild(this)}this.game=null;this.exists=false}};Object.defineProperty(Phaser.Group.prototype,"total",{get:function(){return this.iterate("exists",true,Phaser.Group.RETURN_TOTAL)}});Object.defineProperty(Phaser.Group.prototype,"length",{get:function(){return this.children.length}});Object.defineProperty(Phaser.Group.prototype,"angle",{get:function(){return Phaser.Math.radToDeg(this.rotation)},set:function(a){this.rotation=Phaser.Math.degToRad(a)}});Object.defineProperty(Phaser.Group.prototype,"centerX",{get:function(){return this.getBounds(this.parent).centerX},set:function(b){var a=this.getBounds(this.parent);var c=this.x-a.x;this.x=(b+c)-a.halfWidth}});Object.defineProperty(Phaser.Group.prototype,"centerY",{get:function(){return this.getBounds(this.parent).centerY},set:function(b){var a=this.getBounds(this.parent);var c=this.y-a.y;this.y=(b+c)-a.halfHeight}});Object.defineProperty(Phaser.Group.prototype,"left",{get:function(){return this.getBounds(this.parent).left},set:function(b){var a=this.getBounds(this.parent);var c=this.x-a.x;this.x=b+c}});Object.defineProperty(Phaser.Group.prototype,"right",{get:function(){return this.getBounds(this.parent).right},set:function(b){var a=this.getBounds(this.parent);var c=this.x-a.x;this.x=(b+c)-a.width}});Object.defineProperty(Phaser.Group.prototype,"top",{get:function(){return this.getBounds(this.parent).top},set:function(b){var a=this.getBounds(this.parent);var c=this.y-a.y;this.y=(b+c)}});Object.defineProperty(Phaser.Group.prototype,"bottom",{get:function(){return this.getBounds(this.parent).bottom},set:function(b){var a=this.getBounds(this.parent);var c=this.y-a.y;this.y=(b+c)-a.height}});Phaser.World=function(a){Phaser.Group.call(this,a,null,"__world",false);this.bounds=new Phaser.Rectangle(0,0,a.width,a.height);this.camera=null;this._definedSize=false;this._width=a.width;this._height=a.height;this.game.state.onStateChange.add(this.stateChange,this)};Phaser.World.prototype=Object.create(Phaser.Group.prototype);Phaser.World.prototype.constructor=Phaser.World;Phaser.World.prototype.boot=function(){this.camera=new Phaser.Camera(this.game,0,0,0,this.game.width,this.game.height);this.game.stage.addChild(this);this.camera.boot()};Phaser.World.prototype.stateChange=function(){this.x=0;this.y=0;this.camera.reset()};Phaser.World.prototype.setBounds=function(b,d,c,a){this._definedSize=true;this._width=c;this._height=a;this.bounds.setTo(b,d,c,a);this.x=b;this.y=d;if(this.camera.bounds){this.camera.bounds.setTo(b,d,Math.max(c,this.game.width),Math.max(a,this.game.height))}this.game.physics.setBoundsToWorld()};Phaser.World.prototype.resize=function(b,a){if(this._definedSize){if(b<this._width){b=this._width}if(a<this._height){a=this._height}}this.bounds.width=b;this.bounds.height=a;this.game.camera.setBoundsToWorld();this.game.physics.setBoundsToWorld()};Phaser.World.prototype.shutdown=function(){this.destroy(true,true)};Phaser.World.prototype.wrap=function(d,e,b,a,c){if(e===undefined){e=0}if(b===undefined){b=false}if(a===undefined){a=true}if(c===undefined){c=true}if(!b){if(a&&d.x+e<this.bounds.x){d.x=this.bounds.right+e}else{if(a&&d.x-e>this.bounds.right){d.x=this.bounds.left-e}}if(c&&d.y+e<this.bounds.top){d.y=this.bounds.bottom+e}else{if(c&&d.y-e>this.bounds.bottom){d.y=this.bounds.top-e}}}else{d.getBounds();if(a){if((d.x+d._currentBounds.width)<this.bounds.x){d.x=this.bounds.right}else{if(d.x>this.bounds.right){d.x=this.bounds.left}}}if(c){if((d.y+d._currentBounds.height)<this.bounds.top){d.y=this.bounds.bottom}else{if(d.y>this.bounds.bottom){d.y=this.bounds.top}}}}};Object.defineProperty(Phaser.World.prototype,"width",{get:function(){return this.bounds.width},set:function(a){if(a<this.game.width){a=this.game.width}this.bounds.width=a;this._width=a;this._definedSize=true}});Object.defineProperty(Phaser.World.prototype,"height",{get:function(){return this.bounds.height},set:function(a){if(a<this.game.height){a=this.game.height}this.bounds.height=a;this._height=a;this._definedSize=true}});Object.defineProperty(Phaser.World.prototype,"centerX",{get:function(){return this.bounds.halfWidth+this.bounds.x}});Object.defineProperty(Phaser.World.prototype,"centerY",{get:function(){return this.bounds.halfHeight+this.bounds.y}});Object.defineProperty(Phaser.World.prototype,"randomX",{get:function(){if(this.bounds.x<0){return this.game.rnd.between(this.bounds.x,(this.bounds.width-Math.abs(this.bounds.x)))}else{return this.game.rnd.between(this.bounds.x,this.bounds.width)}}});Object.defineProperty(Phaser.World.prototype,"randomY",{get:function(){if(this.bounds.y<0){return this.game.rnd.between(this.bounds.y,(this.bounds.height-Math.abs(this.bounds.y)))}else{return this.game.rnd.between(this.bounds.y,this.bounds.height)}}});Phaser.Game=function(e,a,g,d,f,h,b,c){this.id=Phaser.GAMES.push(this)-1;this.config=null;this.physicsConfig=c;this.parent="";this.width=800;this.height=600;this.resolution=1;this._width=800;this._height=600;this.transparent=false;this.antialias=true;this.multiTexture=false;this.preserveDrawingBuffer=false;this.clearBeforeRender=true;this.renderer=null;this.renderType=Phaser.AUTO;this.state=null;this.isBooted=false;this.isRunning=false;this.raf=null;this.add=null;this.make=null;this.cache=null;this.input=null;this.load=null;this.math=null;this.net=null;this.scale=null;this.sound=null;this.stage=null;this.time=null;this.tweens=null;this.world=null;this.physics=null;this.plugins=null;this.rnd=null;this.device=Phaser.Device;this.camera=null;this.canvas=null;this.context=null;this.debug=null;this.particles=null;this.create=null;this.lockRender=false;this.stepping=false;this.pendingStep=false;this.stepCount=0;this.onPause=null;this.onResume=null;this.onBlur=null;this.onFocus=null;this._paused=false;this._codePaused=false;this.currentUpdateID=0;this.updatesThisFrame=1;this._deltaTime=0;this._lastCount=0;this._spiraling=0;this._kickstart=true;this.fpsProblemNotifier=new Phaser.Signal();this.forceSingleUpdate=true;this._nextFpsNotification=0;if(arguments.length===1&&typeof arguments[0]==="object"){this.parseConfig(arguments[0])}else{this.config={enableDebug:true};if(typeof e!=="undefined"){this._width=e}if(typeof a!=="undefined"){this._height=a}if(typeof g!=="undefined"){this.renderType=g}if(typeof d!=="undefined"){this.parent=d}if(typeof h!=="undefined"){this.transparent=h}if(typeof b!=="undefined"){this.antialias=b}this.rnd=new Phaser.RandomDataGenerator([(Date.now()*Math.random()).toString()]);this.state=new Phaser.StateManager(this,f)}this.device.whenReady(this.boot,this);return this};Phaser.Game.prototype={parseConfig:function(b){this.config=b;if(b.enableDebug===undefined){this.config.enableDebug=true}if(b.width){this._width=b.width}if(b.height){this._height=b.height}if(b.renderer){this.renderType=b.renderer}if(b.parent){this.parent=b.parent}if(b.transparent!==undefined){this.transparent=b.transparent}if(b.antialias!==undefined){this.antialias=b.antialias}if(b.multiTexture!==undefined){this.multiTexture=b.multiTexture}if(b.resolution){this.resolution=b.resolution}if(b.preserveDrawingBuffer!==undefined){this.preserveDrawingBuffer=b.preserveDrawingBuffer}if(b.physicsConfig){this.physicsConfig=b.physicsConfig}var a=[(Date.now()*Math.random()).toString()];if(b.seed){a=b.seed}this.rnd=new Phaser.RandomDataGenerator(a);var c=null;if(b.state){c=b.state}this.state=new Phaser.StateManager(this,c)},boot:function(){if(this.isBooted){return}this.onPause=new Phaser.Signal();this.onResume=new Phaser.Signal();this.onBlur=new Phaser.Signal();this.onFocus=new Phaser.Signal();this.isBooted=true;PIXI.game=this;this.math=Phaser.Math;this.scale=new Phaser.ScaleManager(this,this._width,this._height);this.stage=new Phaser.Stage(this);this.setUpRenderer();this.world=new Phaser.World(this);this.add=new Phaser.GameObjectFactory(this);this.make=new Phaser.GameObjectCreator(this);this.cache=new Phaser.Cache(this);this.load=new Phaser.Loader(this);this.time=new Phaser.Time(this);this.tweens=new Phaser.TweenManager(this);this.input=new Phaser.Input(this);this.sound=new Phaser.SoundManager(this);this.physics=new Phaser.Physics(this,this.physicsConfig);this.particles=new Phaser.Particles(this);this.create=new Phaser.Create(this);this.plugins=new Phaser.PluginManager(this);this.net=new Phaser.Net(this);this.time.boot();this.stage.boot();this.world.boot();this.scale.boot();this.input.boot();this.sound.boot();this.state.boot();if(this.config.enableDebug){this.debug=new Phaser.Utils.Debug(this);this.debug.boot()}else{this.debug={preUpdate:function(){},update:function(){},reset:function(){},isDisabled:true}}this.showDebugHeader();this.isRunning=true;if(this.config&&this.config.forceSetTimeOut){this.raf=new Phaser.RequestAnimationFrame(this,this.config.forceSetTimeOut)}else{this.raf=new Phaser.RequestAnimationFrame(this,false)}this._kickstart=true;if(window.focus){if(!window.PhaserGlobal||(window.PhaserGlobal&&!window.PhaserGlobal.stopFocus)){window.focus()}}if(this.cache.isReady){this.raf.start()}else{this.cache.onReady.addOnce(function(){this.raf.start()},this)}},showDebugHeader:function(){if(window.PhaserGlobal&&window.PhaserGlobal.hideBanner){return}var d=Phaser.VERSION;var g="Canvas";var b="HTML Audio";var h=1;if(this.renderType===Phaser.WEBGL){g="WebGL";h++}else{if(this.renderType===Phaser.HEADLESS){g="Headless"}}if(this.device.webAudio){b="WebAudio";h++}if(!this.device.ie){var e=["%c %c %c Phaser CE v"+d+" | Pixi.js | "+g+" | "+b+"  %c %c %c http://phaser.io %c\u2665%c\u2665%c\u2665","background: #fb8cb3","background: #d44a52","color: #ffffff; background: #871905;","background: #d44a52","background: #fb8cb3","background: #ffffff"];for(var f=0;f<3;f++){if(f<h){e.push("color: #ff2424; background: #fff")}else{e.push("color: #959595; background: #fff")}}console.log.apply(console,e)}else{if(window.console){console.log("Phaser v"+d+" | Pixi.js | "+g+" | "+b+" | http://phaser.io")}}},setUpRenderer:function(){if(this.config.canvas){this.canvas=this.config.canvas}else{this.canvas=Phaser.Canvas.create(this,this.width,this.height,this.config.canvasID,true)}if(this.config.canvasStyle){this.canvas.style=this.config.canvasStyle}else{this.canvas.style["-webkit-full-screen"]="width: 100%; height: 100%"}if(this.renderType===Phaser.HEADLESS||this.renderType===Phaser.CANVAS||(this.renderType===Phaser.AUTO&&!this.device.webGL)){if(this.device.canvas){this.renderer=new PIXI.CanvasRenderer(this);this.context=this.renderer.context;if(this.renderType===Phaser.AUTO){this.renderType=Phaser.CANVAS}}else{throw new Error("Phaser.Game - Cannot create Canvas or WebGL context, aborting.")}}else{if(this.multiTexture||this.renderType===Phaser.WEBGL_MULTI){PIXI.enableMultiTexture();this.multiTexture=true}this.renderType=Phaser.WEBGL;this.renderer=new PIXI.WebGLRenderer(this);this.context=null;this.canvas.addEventListener("webglcontextlost",this.contextLost.bind(this),false);this.canvas.addEventListener("webglcontextrestored",this.contextRestored.bind(this),false)}if(this.device.cocoonJS){this.canvas.screencanvas=(this.renderType===Phaser.CANVAS)?true:false}if(this.renderType!==Phaser.HEADLESS){this.stage.smoothed=this.antialias;Phaser.Canvas.addToDOM(this.canvas,this.parent,false);Phaser.Canvas.setTouchAction(this.canvas)}},contextLost:function(a){a.preventDefault();this.renderer.contextLost=true},contextRestored:function(){this.renderer.initContext();this.cache.clearGLTextures();this.renderer.contextLost=false},update:function(c){this.time.update(c);if(this._kickstart){this.updateLogic(this.time.desiredFpsMult);this.updateRender(this.time.slowMotion*this.time.desiredFps);this._kickstart=false;return}if(this._spiraling>1&&!this.forceSingleUpdate){if(this.time.time>this._nextFpsNotification){this._nextFpsNotification=this.time.time+10000;this.fpsProblemNotifier.dispatch()}this._deltaTime=0;this._spiraling=0;this.updateRender(this.time.slowMotion*this.time.desiredFps)}else{var a=this.time.slowMotion*1000/this.time.desiredFps;this._deltaTime+=Math.max(Math.min(a*3,this.time.elapsed),0);var b=0;this.updatesThisFrame=Math.floor(this._deltaTime/a);if(this.forceSingleUpdate){this.updatesThisFrame=Math.min(1,this.updatesThisFrame)}while(this._deltaTime>=a){this._deltaTime-=a;this.currentUpdateID=b;this.updateLogic(this.time.desiredFpsMult);b++;if(this.forceSingleUpdate&&b===1){break}else{this.time.refresh()}}if(b>this._lastCount){this._spiraling++}else{if(b<this._lastCount){this._spiraling=0}}this._lastCount=b;this.updateRender(this._deltaTime/a)}},updateLogic:function(a){if(!this._paused&&!this.pendingStep){if(this.stepping){this.pendingStep=true}this.scale.preUpdate();this.debug.preUpdate();this.camera.preUpdate();this.physics.preUpdate();this.state.preUpdate(a);this.plugins.preUpdate(a);this.stage.preUpdate();this.state.update();this.stage.update();this.tweens.update();this.sound.update();this.input.update();this.physics.update();this.plugins.update();this.stage.postUpdate();this.plugins.postUpdate()}else{this.scale.pauseUpdate();this.state.pauseUpdate(a);this.debug.preUpdate()}this.stage.updateTransform()},updateRender:function(a){if(this.lockRender){return}this.state.preRender(a);if(this.renderType!==Phaser.HEADLESS){this.renderer.render(this.stage);this.plugins.render(a);this.state.render(a)}this.plugins.postRender(a)},enableStep:function(){this.stepping=true;this.pendingStep=false;this.stepCount=0},disableStep:function(){this.stepping=false;this.pendingStep=false},step:function(){this.pendingStep=false;this.stepCount++},destroy:function(){this.raf.stop();if(this.debug.destroy){this.debug.destroy()}this.state.destroy();this.sound.destroy();this.scale.destroy();this.stage.destroy();this.input.destroy();this.physics.destroy();this.plugins.destroy();this.debug=null;this.state=null;this.sound=null;this.scale=null;this.stage=null;this.input=null;this.physics=null;this.plugins=null;this.cache=null;this.load=null;this.time=null;this.world=null;this.isBooted=false;this.renderer.destroy(false);Phaser.Canvas.removeFromDOM(this.canvas);PIXI.defaultRenderer=null;Phaser.GAMES[this.id]=null},gamePaused:function(a){if(!this._paused){this._paused=true;this.time.gamePaused();if(this.sound.muteOnPause){this.sound.setMute()}this.onPause.dispatch(a);if(this.device.cordova&&this.device.iOS){this.lockRender=true}}},gameResumed:function(a){if(this._paused&&!this._codePaused){this._paused=false;this.time.gameResumed();this.input.reset();if(this.sound.muteOnPause){this.sound.unsetMute()}this.onResume.dispatch(a);if(this.device.cordova&&this.device.iOS){this.lockRender=false}}},focusLoss:function(a){this.onBlur.dispatch(a);if(!this.stage.disableVisibilityChange){this.gamePaused(a)}},focusGain:function(a){this.onFocus.dispatch(a);if(!this.stage.disableVisibilityChange){this.gameResumed(a)}}};Phaser.Game.prototype.constructor=Phaser.Game;Object.defineProperty(Phaser.Game.prototype,"paused",{get:function(){return this._paused},set:function(a){if(a===true){if(this._paused===false){this._paused=true;this.sound.setMute();this.time.gamePaused();this.onPause.dispatch(this)}this._codePaused=true}else{if(this._paused){this._paused=false;this.input.reset();this.sound.unsetMute();this.time.gameResumed();this.onResume.dispatch(this)}this._codePaused=false}}});Phaser.Input=function(a){this.game=a;this.hitCanvas=null;this.hitContext=null;this.moveCallbacks=[];this.customCandidateHandler=null;this.customCandidateHandlerContext=null;this.pollRate=0;this.enabled=true;this.multiInputOverride=Phaser.Input.MOUSE_TOUCH_COMBINE;this.position=null;this.speed=null;this.circle=null;this.scale=null;this.maxPointers=-1;this.tapRate=200;this.doubleTapRate=300;this.holdRate=2000;this.justPressedRate=200;this.justReleasedRate=200;this.recordPointerHistory=false;this.recordRate=100;this.recordLimit=100;this.touchLockCallbacks=[];this.pointer1=null;this.pointer2=null;this.pointer3=null;this.pointer4=null;this.pointer5=null;this.pointer6=null;this.pointer7=null;this.pointer8=null;this.pointer9=null;this.pointer10=null;this.pointers=[];this.activePointer=null;this.mousePointer=null;this.mouse=null;this.keyboard=null;this.touch=null;this.mspointer=null;this.gamepad=null;this.resetLocked=false;this.onDown=null;this.onUp=null;this.onTap=null;this.onHold=null;this.minPriorityID=0;this.interactiveItems=new Phaser.ArraySet();this._localPoint=new Phaser.Point();this._pollCounter=0;this._oldPosition=null;this._x=0;this._y=0};Phaser.Input.MOUSE_OVERRIDES_TOUCH=0;Phaser.Input.TOUCH_OVERRIDES_MOUSE=1;Phaser.Input.MOUSE_TOUCH_COMBINE=2;Phaser.Input.MAX_POINTERS=10;Phaser.Input.prototype={boot:function(){this.mousePointer=new Phaser.Pointer(this.game,0,Phaser.PointerMode.CURSOR);this.addPointer();this.addPointer();this.mouse=new Phaser.Mouse(this.game);this.touch=new Phaser.Touch(this.game);this.mspointer=new Phaser.MSPointer(this.game);if(Phaser.Keyboard){this.keyboard=new Phaser.Keyboard(this.game)}if(Phaser.Gamepad){this.gamepad=new Phaser.Gamepad(this.game)}this.onDown=new Phaser.Signal();this.onUp=new Phaser.Signal();this.onTap=new Phaser.Signal();this.onHold=new Phaser.Signal();this.scale=new Phaser.Point(1,1);this.speed=new Phaser.Point();this.position=new Phaser.Point();this._oldPosition=new Phaser.Point();this.circle=new Phaser.Circle(0,0,44);this.activePointer=this.mousePointer;this.hitCanvas=Phaser.CanvasPool.create(this,1,1);this.hitContext=this.hitCanvas.getContext("2d");this.mouse.start();if(!this.game.device.mspointer){this.touch.start()}this.mspointer.start();this.mousePointer.active=true;if(this.keyboard){this.keyboard.start()}var a=this;this._onClickTrampoline=function(b){a.onClickTrampoline(b)};this.game.canvas.addEventListener("click",this._onClickTrampoline,false)},destroy:function(){this.mouse.stop();this.touch.stop();this.mspointer.stop();if(this.keyboard){this.keyboard.stop()}if(this.gamepad){this.gamepad.stop()}this.moveCallbacks=[];Phaser.CanvasPool.remove(this);this.game.canvas.removeEventListener("click",this._onClickTrampoline)},setInteractiveCandidateHandler:function(b,a){this.customCandidateHandler=b;this.customCandidateHandlerContext=a},addMoveCallback:function(b,a){this.moveCallbacks.push({callback:b,context:a})},addTouchLockCallback:function(c,b,a){if(a===undefined){a=false}this.touchLockCallbacks.push({callback:c,context:b,onEnd:a})},removeTouchLockCallback:function(c,b){var a=this.touchLockCallbacks.length;while(a--){if(this.touchLockCallbacks[a].callback===c&&this.touchLockCallbacks[a].context===b){this.touchLockCallbacks.splice(a,1);return true}}return false},executeTouchLockCallbacks:function(b,d){var c=this.touchLockCallbacks.length;while(c--){var a=this.touchLockCallbacks[c];if(a.onEnd===b&&a.callback.call(a.context,this,d)){this.touchLockCallbacks.splice(c,1)}}},deleteMoveCallback:function(c,b){var a=this.moveCallbacks.length;while(a--){if(this.moveCallbacks[a].callback===c&&this.moveCallbacks[a].context===b){this.moveCallbacks.splice(a,1);return}}},addPointer:function(){if(this.pointers.length>=Phaser.Input.MAX_POINTERS){console.warn("Phaser.Input.addPointer: Maximum limit of "+Phaser.Input.MAX_POINTERS+" pointers reached.");return null}var b=this.pointers.length+1;var a=new Phaser.Pointer(this.game,b,Phaser.PointerMode.CONTACT);this.pointers.push(a);this["pointer"+b]=a;return a},update:function(){if(this.keyboard){this.keyboard.update()}if(this.pollRate>0&&this._pollCounter<this.pollRate){this._pollCounter++;return}this.speed.x=this.position.x-this._oldPosition.x;this.speed.y=this.position.y-this._oldPosition.y;this._oldPosition.copyFrom(this.position);this.mousePointer.update();if(this.gamepad&&this.gamepad.active){this.gamepad.update()}for(var a=0;a<this.pointers.length;a++){this.pointers[a].update()}this._pollCounter=0},reset:function(b){if(!this.game.isBooted||this.resetLocked){return}if(b===undefined){b=false}this.mousePointer.reset();if(this.keyboard){this.keyboard.reset(b)}if(this.gamepad){this.gamepad.reset()}for(var a=0;a<this.pointers.length;a++){this.pointers[a].reset()}if(this.game.canvas.style.cursor!=="none"){this.game.canvas.style.cursor=""}if(b){this.onDown.dispose();this.onUp.dispose();this.onTap.dispose();this.onHold.dispose();this.onDown=new Phaser.Signal();this.onUp=new Phaser.Signal();this.onTap=new Phaser.Signal();this.onHold=new Phaser.Signal();this.moveCallbacks=[]}this._pollCounter=0},resetSpeed:function(a,b){this._oldPosition.setTo(a,b);this.speed.setTo(0,0)},startPointer:function(b){if(this.maxPointers>=0&&this.countActivePointers(this.maxPointers)>=this.maxPointers){return null}if(!this.pointer1.active){return this.pointer1.start(b)}if(!this.pointer2.active){return this.pointer2.start(b)}for(var a=2;a<this.pointers.length;a++){var c=this.pointers[a];if(!c.active){return c.start(b)}}return null},updatePointer:function(b){if(this.pointer1.active&&this.pointer1.identifier===b.identifier){return this.pointer1.move(b)}if(this.pointer2.active&&this.pointer2.identifier===b.identifier){return this.pointer2.move(b)}for(var a=2;a<this.pointers.length;a++){var c=this.pointers[a];if(c.active&&c.identifier===b.identifier){return c.move(b)}}return null},stopPointer:function(b){if(this.pointer1.active&&this.pointer1.identifier===b.identifier){return this.pointer1.stop(b)}if(this.pointer2.active&&this.pointer2.identifier===b.identifier){return this.pointer2.stop(b)}for(var a=2;a<this.pointers.length;a++){var c=this.pointers[a];if(c.active&&c.identifier===b.identifier){return c.stop(b)}}return null},countActivePointers:function(a){if(a===undefined){a=this.pointers.length}var c=a;for(var b=0;b<this.pointers.length&&c>0;b++){var d=this.pointers[b];if(d.active){c--}}return(a-c)},getPointer:function(b){if(b===undefined){b=false}for(var a=0;a<this.pointers.length;a++){var c=this.pointers[a];if(c.active===b){return c}}return null},getPointerFromIdentifier:function(a){for(var b=0;b<this.pointers.length;b++){var c=this.pointers[b];if(c.identifier===a){return c}}return null},getPointerFromId:function(b){for(var a=0;a<this.pointers.length;a++){var c=this.pointers[a];if(c.pointerId===b){return c}}return null},getLocalPosition:function(d,c,b){if(b===undefined){b=new Phaser.Point()}var a=d.worldTransform;var e=1/(a.a*a.d+a.c*-a.b);return b.setTo(a.d*e*c.x+-a.c*e*c.y+(a.ty*a.c-a.tx*a.d)*e,a.a*e*c.y+-a.b*e*c.x+(-a.ty*a.a+a.tx*a.b)*e)},hitTest:function(f,a,j){if(!f.worldVisible){return false}this.getLocalPosition(f,a,this._localPoint);j.copyFrom(this._localPoint);if(f.hitArea&&f.hitArea.contains){return(f.hitArea.contains(this._localPoint.x,this._localPoint.y))}else{if(Phaser.Creature&&f instanceof Phaser.Creature){var b=Math.abs(f.width);var h=Math.abs(f.height);var c=f.x-(b*f.anchorX);if(this.game.camera.x+a.x>=c&&this.game.camera.x+a.x<c+b){var g=f.y-(h*f.anchorY);if(this.game.camera.y+a.y>=g&&this.game.camera.y+a.y<g+h){return true}}}else{if(f instanceof Phaser.TileSprite){var b=f.width;var h=f.height;var c=-b*f.anchor.x;if(this._localPoint.x>=c&&this._localPoint.x<c+b){var g=-h*f.anchor.y;if(this._localPoint.y>=g&&this._localPoint.y<g+h){return true}}}else{if(f instanceof PIXI.Sprite){var b=f.texture.frame.width/f.texture.baseTexture.resolution;var h=f.texture.frame.height/f.texture.baseTexture.resolution;var c=-b*f.anchor.x;if(this._localPoint.x>=c&&this._localPoint.x<c+b){var g=-h*f.anchor.y;if(this._localPoint.y>=g&&this._localPoint.y<g+h){return true}}}else{if(f instanceof Phaser.Graphics){for(var e=0;e<f.graphicsData.length;e++){var d=f.graphicsData[e];if(!d.fill){continue}if(d.shape&&d.shape.contains(this._localPoint.x,this._localPoint.y)){return true}}}}}}}for(var e=0;e<f.children.length;e++){if(this.hitTest(f.children[e],a,j)){return true}}return false},onClickTrampoline:function(){this.activePointer.processClickTrampolines()}};Phaser.Input.prototype.constructor=Phaser.Input;Object.defineProperty(Phaser.Input.prototype,"x",{get:function(){return this._x},set:function(a){this._x=Math.floor(a)}});Object.defineProperty(Phaser.Input.prototype,"y",{get:function(){return this._y},set:function(a){this._y=Math.floor(a)}});Object.defineProperty(Phaser.Input.prototype,"pollLocked",{get:function(){return(this.pollRate>0&&this._pollCounter<this.pollRate)}});Object.defineProperty(Phaser.Input.prototype,"totalInactivePointers",{get:function(){return this.pointers.length-this.countActivePointers()}});Object.defineProperty(Phaser.Input.prototype,"totalActivePointers",{get:function(){return this.countActivePointers()}});Object.defineProperty(Phaser.Input.prototype,"worldX",{get:function(){return this.game.camera.view.x+this.x}});Object.defineProperty(Phaser.Input.prototype,"worldY",{get:function(){return this.game.camera.view.y+this.y}});Phaser.Mouse=function(a){this.game=a;this.input=a.input;this.callbackContext=this.game;this.mouseDownCallback=null;this.mouseUpCallback=null;this.mouseOutCallback=null;this.mouseOverCallback=null;this.mouseWheelCallback=null;this.capture=false;this.button=-1;this.wheelDelta=0;this.enabled=true;this.locked=false;this.stopOnGameOut=false;this.pointerLock=new Phaser.Signal();this.event=null;this._onMouseDown=null;this._onMouseMove=null;this._onMouseUp=null;this._onMouseOut=null;this._onMouseOver=null;this._onMouseWheel=null;this._wheelEvent=null};Phaser.Mouse.NO_BUTTON=-1;Phaser.Mouse.LEFT_BUTTON=0;Phaser.Mouse.MIDDLE_BUTTON=1;Phaser.Mouse.RIGHT_BUTTON=2;Phaser.Mouse.BACK_BUTTON=3;Phaser.Mouse.FORWARD_BUTTON=4;Phaser.Mouse.WHEEL_UP=1;Phaser.Mouse.WHEEL_DOWN=-1;Phaser.Mouse.prototype={start:function(){if(this.game.device.android&&this.game.device.chrome===false){return}if(this._onMouseDown!==null){return}var c=this;this._onMouseDown=function(d){return c.onMouseDown(d)};this._onMouseMove=function(d){return c.onMouseMove(d)};this._onMouseUp=function(d){return c.onMouseUp(d)};this._onMouseUpGlobal=function(d){return c.onMouseUpGlobal(d)};this._onMouseOutGlobal=function(d){return c.onMouseOutGlobal(d)};this._onMouseOut=function(d){return c.onMouseOut(d)};this._onMouseOver=function(d){return c.onMouseOver(d)};this._onMouseWheel=function(d){return c.onMouseWheel(d)};var b=this.game.canvas;b.addEventListener("mousedown",this._onMouseDown,true);b.addEventListener("mousemove",this._onMouseMove,true);b.addEventListener("mouseup",this._onMouseUp,true);if(!this.game.device.cocoonJS){window.addEventListener("mouseup",this._onMouseUpGlobal,true);window.addEventListener("mouseout",this._onMouseOutGlobal,true);b.addEventListener("mouseover",this._onMouseOver,true);b.addEventListener("mouseout",this._onMouseOut,true)}var a=this.game.device.wheelEvent;if(a){b.addEventListener(a,this._onMouseWheel,true);if(a==="mousewheel"){this._wheelEvent=new WheelEventProxy(-1/40,1)}else{if(a==="DOMMouseScroll"){this._wheelEvent=new WheelEventProxy(1,1)}}}},onMouseDown:function(a){this.event=a;if(this.capture){a.preventDefault()}if(this.mouseDownCallback){this.mouseDownCallback.call(this.callbackContext,a)}if(!this.input.enabled||!this.enabled){return}a.identifier=0;this.input.mousePointer.start(a)},onMouseMove:function(a){this.event=a;if(this.capture){a.preventDefault()}if(this.mouseMoveCallback){this.mouseMoveCallback.call(this.callbackContext,a)}if(!this.input.enabled||!this.enabled){return}a.identifier=0;this.input.mousePointer.move(a)},onMouseUp:function(a){this.event=a;if(this.capture){a.preventDefault()}if(this.mouseUpCallback){this.mouseUpCallback.call(this.callbackContext,a)}if(!this.input.enabled||!this.enabled){return}a.identifier=0;this.input.mousePointer.stop(a)},onMouseUpGlobal:function(a){if(!this.input.mousePointer.withinGame){if(this.mouseUpCallback){this.mouseUpCallback.call(this.callbackContext,a)}a.identifier=0;this.input.mousePointer.stop(a)}},onMouseOutGlobal:function(a){this.event=a;if(this.capture){a.preventDefault()}this.input.mousePointer.withinGame=false;if(!this.input.enabled||!this.enabled){return}this.input.mousePointer.stop(a);this.input.mousePointer.resetButtons()},onMouseOut:function(a){this.event=a;if(this.capture){a.preventDefault()}this.input.mousePointer.withinGame=false;if(this.mouseOutCallback){this.mouseOutCallback.call(this.callbackContext,a)}if(!this.input.enabled||!this.enabled){return}if(this.stopOnGameOut){a.identifier=0;this.input.mousePointer.stop(a)}},onMouseOver:function(a){this.event=a;if(this.capture){a.preventDefault()}this.input.mousePointer.withinGame=true;if(this.mouseOverCallback){this.mouseOverCallback.call(this.callbackContext,a)}},onMouseWheel:function(a){if(this._wheelEvent){a=this._wheelEvent.bindEvent(a)}this.event=a;if(this.capture){a.preventDefault()}this.wheelDelta=Phaser.Math.clamp(-a.deltaY,-1,1);if(this.mouseWheelCallback){this.mouseWheelCallback.call(this.callbackContext,a)}},requestPointerLock:function(){if(this.game.device.pointerLock){var a=this.game.canvas;a.requestPointerLock=a.requestPointerLock||a.mozRequestPointerLock||a.webkitRequestPointerLock;a.requestPointerLock();var b=this;this._pointerLockChange=function(c){return b.pointerLockChange(c)};document.addEventListener("pointerlockchange",this._pointerLockChange,true);document.addEventListener("mozpointerlockchange",this._pointerLockChange,true);document.addEventListener("webkitpointerlockchange",this._pointerLockChange,true)}},pointerLockChange:function(b){var a=this.game.canvas;if(document.pointerLockElement===a||document.mozPointerLockElement===a||document.webkitPointerLockElement===a){this.locked=true;this.pointerLock.dispatch(true,b)}else{this.locked=false;this.pointerLock.dispatch(false,b)}},releasePointerLock:function(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock;document.exitPointerLock();document.removeEventListener("pointerlockchange",this._pointerLockChange,true);document.removeEventListener("mozpointerlockchange",this._pointerLockChange,true);document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,true)},stop:function(){var b=this.game.canvas;b.removeEventListener("mousedown",this._onMouseDown,true);b.removeEventListener("mousemove",this._onMouseMove,true);b.removeEventListener("mouseup",this._onMouseUp,true);b.removeEventListener("mouseover",this._onMouseOver,true);b.removeEventListener("mouseout",this._onMouseOut,true);var a=this.game.device.wheelEvent;if(a){b.removeEventListener(a,this._onMouseWheel,true)}window.removeEventListener("mouseup",this._onMouseUpGlobal,true);window.removeEventListener("mouseout",this._onMouseOutGlobal,true);document.removeEventListener("pointerlockchange",this._pointerLockChange,true);document.removeEventListener("mozpointerlockchange",this._pointerLockChange,true);document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,true)}};Phaser.Mouse.prototype.constructor=Phaser.Mouse;function WheelEventProxy(b,a){this._scaleFactor=b;this._deltaMode=a;this.originalEvent=null}WheelEventProxy.prototype={};WheelEventProxy.prototype.constructor=WheelEventProxy;WheelEventProxy.prototype.bindEvent=function(b){if(!WheelEventProxy._stubsGenerated&&b){var a=function(d){return function(){var e=this.originalEvent[d];return typeof e!=="function"?e:e.bind(this.originalEvent)}};for(var c in b){if(!(c in WheelEventProxy.prototype)){Object.defineProperty(WheelEventProxy.prototype,c,{get:a(c)})}}WheelEventProxy._stubsGenerated=true}this.originalEvent=b;return this};Object.defineProperties(WheelEventProxy.prototype,{type:{value:"wheel"},deltaMode:{get:function(){return this._deltaMode}},deltaY:{get:function(){return(this._scaleFactor*(this.originalEvent.wheelDelta||this.originalEvent.detail))||0}},deltaX:{get:function(){return(this._scaleFactor*this.originalEvent.wheelDeltaX)||0}},deltaZ:{value:0}});Phaser.MSPointer=function(a){this.game=a;this.input=a.input;this.callbackContext=this.game;this.pointerDownCallback=null;this.pointerMoveCallback=null;this.pointerUpCallback=null;this.capture=true;this.button=-1;this.event=null;this.enabled=true;this._onMSPointerDown=null;this._onMSPointerMove=null;this._onMSPointerUp=null;this._onMSPointerUpGlobal=null;this._onMSPointerOut=null;this._onMSPointerOver=null};Phaser.MSPointer.prototype={start:function(){if(this._onMSPointerDown!==null){return}var b=this;if(this.game.device.mspointer){this._onMSPointerDown=function(c){return b.onPointerDown(c)};this._onMSPointerMove=function(c){return b.onPointerMove(c)};this._onMSPointerUp=function(c){return b.onPointerUp(c)};this._onMSPointerUpGlobal=function(c){return b.onPointerUpGlobal(c)};this._onMSPointerOut=function(c){return b.onPointerOut(c)};this._onMSPointerOver=function(c){return b.onPointerOver(c)};var a=this.game.canvas;a.addEventListener("MSPointerDown",this._onMSPointerDown,false);a.addEventListener("MSPointerMove",this._onMSPointerMove,false);a.addEventListener("MSPointerUp",this._onMSPointerUp,false);a.addEventListener("pointerdown",this._onMSPointerDown,false);a.addEventListener("pointermove",this._onMSPointerMove,false);a.addEventListener("pointerup",this._onMSPointerUp,false);a.style["-ms-content-zooming"]="none";a.style["-ms-touch-action"]="none";if(!this.game.device.cocoonJS){window.addEventListener("MSPointerUp",this._onMSPointerUpGlobal,true);a.addEventListener("MSPointerOver",this._onMSPointerOver,true);a.addEventListener("MSPointerOut",this._onMSPointerOut,true);window.addEventListener("pointerup",this._onMSPointerUpGlobal,true);a.addEventListener("pointerover",this._onMSPointerOver,true);a.addEventListener("pointerout",this._onMSPointerOut,true)}}},onPointerDown:function(a){this.game.input.executeTouchLockCallbacks(false,a);this.event=a;if(this.capture){a.preventDefault()}if(this.pointerDownCallback){this.pointerDownCallback.call(this.callbackContext,a)}if(!this.input.enabled||!this.enabled){return}a.identifier=a.pointerId;if(a.pointerType==="mouse"||a.pointerType===4){this.input.mousePointer.start(a)}else{this.input.startPointer(a)}},onPointerMove:function(a){this.event=a;if(this.capture){a.preventDefault()}if(this.pointerMoveCallback){this.pointerMoveCallback.call(this.callbackContext,a)}if(!this.input.enabled||!this.enabled){return}a.identifier=a.pointerId;if(a.pointerType==="mouse"||a.pointerType===4){this.input.mousePointer.move(a)}else{this.input.updatePointer(a)}},onPointerUp:function(a){this.game.input.executeTouchLockCallbacks(true,a);this.event=a;if(this.capture){a.preventDefault()}if(this.pointerUpCallback){this.pointerUpCallback.call(this.callbackContext,a)}if(!this.input.enabled||!this.enabled){return}a.identifier=a.pointerId;if(a.pointerType==="mouse"||a.pointerType===4){this.input.mousePointer.stop(a)}else{this.input.stopPointer(a)}},onPointerUpGlobal:function(a){if((a.pointerType==="mouse"||a.pointerType===4)&&!this.input.mousePointer.withinGame){this.onPointerUp(a)}else{var b=this.input.getPointerFromIdentifier(a.identifier);if(b&&b.withinGame){this.onPointerUp(a)}}},onPointerOut:function(a){this.event=a;if(this.capture){a.preventDefault()}if(a.pointerType==="mouse"||a.pointerType===4){this.input.mousePointer.withinGame=false}else{var b=this.input.getPointerFromIdentifier(a.identifier);if(b){b.withinGame=false}}if(this.input.mouse.mouseOutCallback){this.input.mouse.mouseOutCallback.call(this.input.mouse.callbackContext,a)}if(!this.input.enabled||!this.enabled){return}if(this.input.mouse.stopOnGameOut){a.identifier=0;if(b){b.stop(a)}else{this.input.mousePointer.stop(a)}}},onPointerOver:function(a){this.event=a;if(this.capture){a.preventDefault()}if(a.pointerType==="mouse"||a.pointerType===4){this.input.mousePointer.withinGame=true}else{var b=this.input.getPointerFromIdentifier(a.identifier);if(b){b.withinGame=true}}if(this.input.mouse.mouseOverCallback){this.input.mouse.mouseOverCallback.call(this.input.mouse.callbackContext,a)}},stop:function(){var a=this.game.canvas;a.removeEventListener("MSPointerDown",this._onMSPointerDown,false);a.removeEventListener("MSPointerMove",this._onMSPointerMove,false);a.removeEventListener("MSPointerUp",this._onMSPointerUp,false);a.removeEventListener("pointerdown",this._onMSPointerDown,false);a.removeEventListener("pointermove",this._onMSPointerMove,false);a.removeEventListener("pointerup",this._onMSPointerUp,false);window.removeEventListener("MSPointerUp",this._onMSPointerUpGlobal,true);a.removeEventListener("MSPointerOver",this._onMSPointerOver,true);a.removeEventListener("MSPointerOut",this._onMSPointerOut,true);window.removeEventListener("pointerup",this._onMSPointerUpGlobal,true);a.removeEventListener("pointerover",this._onMSPointerOver,true);a.removeEventListener("pointerout",this._onMSPointerOut,true)}};Phaser.MSPointer.prototype.constructor=Phaser.MSPointer;Phaser.DeviceButton=function(b,a){this.parent=b;this.game=b.game;this.event=null;this.isDown=false;this.isUp=true;this.timeDown=0;this.timeUp=0;this.repeats=0;this.altKey=false;this.shiftKey=false;this.ctrlKey=false;this.value=0;this.buttonCode=a;this.onDown=new Phaser.Signal();this.onUp=new Phaser.Signal();this.onFloat=new Phaser.Signal()};Phaser.DeviceButton.prototype={start:function(a,b){if(this.isDown){return}this.isDown=true;this.isUp=false;this.timeDown=this.game.time.time;this.repeats=0;this.event=a;this.value=b;if(a){this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.ctrlKey=a.ctrlKey}this.onDown.dispatch(this,b)},stop:function(a,b){if(this.isUp){return}this.isDown=false;this.isUp=true;this.timeUp=this.game.time.time;this.event=a;this.value=b;if(a){this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.ctrlKey=a.ctrlKey}this.onUp.dispatch(this,b)},startStop:function(c,a,b){if(c){this.start(a,b)}else{this.stop(a,b)}},padFloat:function(a){this.isDown=false;this.isUp=false;this.value=a;this.onFloat.dispatch(this,a)},justPressed:function(a){a=a||250;return(this.isDown&&(this.timeDown+a)>this.game.time.time)},justReleased:function(a){a=a||250;return(this.isUp&&(this.timeUp+a)>this.game.time.time)},reset:function(){this.isDown=false;this.isUp=true;this.timeDown=this.game.time.time;this.repeats=0;this.altKey=false;this.shiftKey=false;this.ctrlKey=false},destroy:function(){this.onDown.dispose();this.onUp.dispose();this.onFloat.dispose();this.parent=null;this.game=null}};Phaser.DeviceButton.prototype.constructor=Phaser.DeviceButton;Object.defineProperty(Phaser.DeviceButton.prototype,"duration",{get:function(){if(this.isUp){return -1}return this.game.time.time-this.timeDown}});Phaser.Pointer=function(a,c,b){this.game=a;this.id=c;this.type=Phaser.POINTER;this.exists=true;this.identifier=0;this.pointerId=null;this.pointerMode=b||(Phaser.PointerMode.CURSOR|Phaser.PointerMode.CONTACT);this.target=null;this.button=null;this.leftButton=new Phaser.DeviceButton(this,Phaser.Pointer.LEFT_BUTTON);this.middleButton=new Phaser.DeviceButton(this,Phaser.Pointer.MIDDLE_BUTTON);this.rightButton=new Phaser.DeviceButton(this,Phaser.Pointer.RIGHT_BUTTON);this.backButton=new Phaser.DeviceButton(this,Phaser.Pointer.BACK_BUTTON);this.forwardButton=new Phaser.DeviceButton(this,Phaser.Pointer.FORWARD_BUTTON);this.eraserButton=new Phaser.DeviceButton(this,Phaser.Pointer.ERASER_BUTTON);this._holdSent=false;this._history=[];this._nextDrop=0;this._stateReset=false;this.withinGame=false;this.clientX=-1;this.clientY=-1;this.pageX=-1;this.pageY=-1;this.screenX=-1;this.screenY=-1;this.rawMovementX=0;this.rawMovementY=0;this.movementX=0;this.movementY=0;this.x=-1;this.y=-1;this.isMouse=(c===0);this.isDown=false;this.isUp=true;this.timeDown=0;this.timeUp=0;this.previousTapTime=0;this.totalTouches=0;this.msSinceLastClick=Number.MAX_VALUE;this.targetObject=null;this.interactiveCandidates=[];this.active=false;this.dirty=false;this.position=new Phaser.Point();this.positionDown=new Phaser.Point();this.positionUp=new Phaser.Point();this.circle=new Phaser.Circle(0,0,44);this._clickTrampolines=null;this._trampolineTargetObject=null};Phaser.Pointer.NO_BUTTON=0;Phaser.Pointer.LEFT_BUTTON=1;Phaser.Pointer.RIGHT_BUTTON=2;Phaser.Pointer.MIDDLE_BUTTON=4;Phaser.Pointer.BACK_BUTTON=8;Phaser.Pointer.FORWARD_BUTTON=16;Phaser.Pointer.ERASER_BUTTON=32;Phaser.Pointer.prototype={resetButtons:function(){this.isDown=false;this.isUp=true;if(this.isMouse){this.leftButton.reset();this.middleButton.reset();this.rightButton.reset();this.backButton.reset();this.forwardButton.reset();this.eraserButton.reset()}},processButtonsDown:function(a,b){if(a===Phaser.Mouse.LEFT_BUTTON){this.leftButton.start(b)}if(a===Phaser.Mouse.RIGHT_BUTTON){this.rightButton.start(b)}if(a===Phaser.Mouse.MIDDLE_BUTTON){this.middleButton.start(b)}if(a===Phaser.Mouse.BACK_BUTTON){this.backButton.start(b)}if(a===Phaser.Mouse.FORWARD_BUTTON){this.forwardButton.start(b)}},processButtonsUp:function(a,b){if(a===Phaser.Mouse.LEFT_BUTTON){this.leftButton.stop(b)}if(a===Phaser.Mouse.RIGHT_BUTTON){this.rightButton.stop(b)}if(a===Phaser.Mouse.MIDDLE_BUTTON){this.middleButton.stop(b)}if(a===Phaser.Mouse.BACK_BUTTON){this.backButton.stop(b)}if(a===Phaser.Mouse.FORWARD_BUTTON){this.forwardButton.stop(b)}},processButtonsUpDown:function(c,b){var d=(b.type.toLowerCase().substr(-4)==="down");var a=(b.type.toLowerCase().substr(-4)==="move");if(c!==undefined){if(d&&c===1&&b.ctrlKey){c=2}this.leftButton.startStop(Phaser.Pointer.LEFT_BUTTON&c,b);this.rightButton.startStop(Phaser.Pointer.RIGHT_BUTTON&c,b);this.middleButton.startStop(Phaser.Pointer.MIDDLE_BUTTON&c,b);this.backButton.startStop(Phaser.Pointer.BACK_BUTTON&c,b);this.forwardButton.startStop(Phaser.Pointer.FORWARD_BUTTON&c,b);this.eraserButton.startStop(Phaser.Pointer.ERASER_BUTTON&c,b)}else{if(b.button!==undefined){if(d&&b.ctrlKey&&b.button===0){this.rightButton.start(b)}else{if(d){this.processButtonsDown(b.button,b)}else{if(!a){this.processButtonsUp(b.button,b)}}}}else{if(d){if(b.ctrlKey){this.rightButton.start(b)}else{this.leftButton.start(b)}}else{this.leftButton.stop(b);this.rightButton.stop(b)}}}},updateButtons:function(a){this.button=a.button;this.processButtonsUpDown(a.buttons,a);this.isUp=true;this.isDown=false;if(this.leftButton.isDown||this.rightButton.isDown||this.middleButton.isDown||this.backButton.isDown||this.forwardButton.isDown||this.eraserButton.isDown){this.isUp=false;this.isDown=true}},start:function(b){var a=this.game.input;if(b.pointerId){this.pointerId=b.pointerId}this.identifier=b.identifier;this.target=b.target;if(this.isMouse){this.updateButtons(b)}else{this.isDown=true;this.isUp=false}this.active=true;this.withinGame=true;this.dirty=false;this._history=[];this._clickTrampolines=null;this._trampolineTargetObject=null;this.msSinceLastClick=this.game.time.time-this.timeDown;this.timeDown=this.game.time.time;this._holdSent=false;this.move(b,true);this.positionDown.setTo(this.x,this.y);if(a.multiInputOverride===Phaser.Input.MOUSE_OVERRIDES_TOUCH||a.multiInputOverride===Phaser.Input.MOUSE_TOUCH_COMBINE||(a.multiInputOverride===Phaser.Input.TOUCH_OVERRIDES_MOUSE&&a.totalActivePointers===0)){a.x=this.x;a.y=this.y;a.position.setTo(this.x,this.y);a.onDown.dispatch(this,b);a.resetSpeed(this.x,this.y)}this._stateReset=false;this.totalTouches++;if(this.targetObject!==null){this.targetObject._touchedHandler(this)}return this},update:function(){var a=this.game.input;if(this.active){if(this.dirty){if(a.interactiveItems.total>0){this.processInteractiveObjects(false)}this.dirty=false}if(this._holdSent===false&&this.duration>=a.holdRate){if(a.multiInputOverride===Phaser.Input.MOUSE_OVERRIDES_TOUCH||a.multiInputOverride===Phaser.Input.MOUSE_TOUCH_COMBINE||(a.multiInputOverride===Phaser.Input.TOUCH_OVERRIDES_MOUSE&&a.totalActivePointers===0)){a.onHold.dispatch(this)}this._holdSent=true}if(a.recordPointerHistory&&this.game.time.time>=this._nextDrop){this._nextDrop=this.game.time.time+a.recordRate;this._history.push({x:this.position.x,y:this.position.y});if(this._history.length>a.recordLimit){this._history.shift()}}}},move:function(c,d){var a=this.game.input;if(a.pollLocked){return}if(d===undefined){d=false}if(c.button!==undefined){this.button=c.button}if(this.isMouse){this.updateButtons(c)}this.clientX=c.clientX;this.clientY=c.clientY;this.pageX=c.pageX;this.pageY=c.pageY;this.screenX=c.screenX;this.screenY=c.screenY;if(this.isMouse&&a.mouse.locked&&!d){this.rawMovementX=c.movementX||c.mozMovementX||c.webkitMovementX||0;this.rawMovementY=c.movementY||c.mozMovementY||c.webkitMovementY||0;this.movementX+=this.rawMovementX;this.movementY+=this.rawMovementY}this.x=(this.pageX-this.game.scale.offset.x)*a.scale.x;this.y=(this.pageY-this.game.scale.offset.y)*a.scale.y;this.position.setTo(this.x,this.y);this.circle.x=this.x;this.circle.y=this.y;if(a.multiInputOverride===Phaser.Input.MOUSE_OVERRIDES_TOUCH||a.multiInputOverride===Phaser.Input.MOUSE_TOUCH_COMBINE||(a.multiInputOverride===Phaser.Input.TOUCH_OVERRIDES_MOUSE&&a.totalActivePointers===0)){a.activePointer=this;a.x=this.x;a.y=this.y;a.position.setTo(a.x,a.y);a.circle.x=a.x;a.circle.y=a.y}this.withinGame=this.game.scale.bounds.contains(this.pageX,this.pageY);var b=a.moveCallbacks.length;while(b--){a.moveCallbacks[b].callback.call(a.moveCallbacks[b].context,this,this.x,this.y,d)}if(this.targetObject!==null&&(!this.game.paused||this.targetObject.noPause)&&this.targetObject.isDragged===true){if(this.targetObject.update(this)===false){this.targetObject=null}}else{if(a.interactiveItems.total>0){this.processInteractiveObjects(d)}}return this},processInteractiveObjects:function(e){var c=0;var b=-1;var a=null;var d=this.game.input.interactiveItems.first;this.interactiveCandidates=[];while(d){d.checked=false;if(d.validForInput(b,c,false)&&(!this.game.paused||d.sprite.noPause)){d.checked=true;if((e&&d.checkPointerDown(this,true))||(!e&&d.checkPointerOver(this,true))){c=d.sprite.renderOrderID;b=d.priorityID;a=d;this.interactiveCandidates.push(d)}}d=this.game.input.interactiveItems.next}d=this.game.input.interactiveItems.first;while(d){if(!d.checked&&d.validForInput(b,c,true)){if((e&&d.checkPointerDown(this,false))||(!e&&d.checkPointerOver(this,false))){c=d.sprite.renderOrderID;b=d.priorityID;a=d;this.interactiveCandidates.push(d)}}d=this.game.input.interactiveItems.next}if(this.game.input.customCandidateHandler){a=this.game.input.customCandidateHandler.call(this.game.input.customCandidateHandlerContext,this,this.interactiveCandidates,a)}this.swapTarget(a,false);return(this.targetObject!==null)},swapTarget:function(b,a){if(a===undefined){a=false}if(b===null){if(this.targetObject){this.targetObject._pointerOutHandler(this,a);this.targetObject=null}}else{if(this.targetObject===null){this.targetObject=b;b._pointerOverHandler(this,a)}else{if(this.targetObject===b){if(b.update(this)===false){this.targetObject=null}}else{this.targetObject._pointerOutHandler(this,a);this.targetObject=b;this.targetObject._pointerOverHandler(this,a)}}}},leave:function(a){this.withinGame=false;this.move(a,false)},stop:function(b){var a=this.game.input;if(this._stateReset&&this.withinGame){b.preventDefault();return}this.timeUp=this.game.time.time;if(a.multiInputOverride===Phaser.Input.MOUSE_OVERRIDES_TOUCH||a.multiInputOverride===Phaser.Input.MOUSE_TOUCH_COMBINE||(a.multiInputOverride===Phaser.Input.TOUCH_OVERRIDES_MOUSE&&a.totalActivePointers===0)){a.onUp.dispatch(this,b);if(this.duration>=0&&this.duration<=a.tapRate){if(this.timeUp-this.previousTapTime<a.doubleTapRate){a.onTap.dispatch(this,true)}else{a.onTap.dispatch(this,false)}this.previousTapTime=this.timeUp}}if(this.isMouse){this.updateButtons(b)}else{this.isDown=false;this.isUp=true}if(this.id>0){this.active=false}this.withinGame=this.game.scale.bounds.contains(b.pageX,b.pageY);this.pointerId=null;this.identifier=null;this.positionUp.setTo(this.x,this.y);if(this.isMouse===false){a.currentPointers--}a.interactiveItems.callAll("_releasedHandler",this);if(this._clickTrampolines){this._trampolineTargetObject=this.targetObject}this.targetObject=null;return this},justPressed:function(a){a=a||this.game.input.justPressedRate;return(this.isDown===true&&(this.timeDown+a)>this.game.time.time)},justReleased:function(a){a=a||this.game.input.justReleasedRate;return(this.isUp&&(this.timeUp+a)>this.game.time.time)},addClickTrampoline:function(b,f,a,d){if(!this.isDown){return}var e=(this._clickTrampolines=this._clickTrampolines||[]);for(var c=0;c<e.length;c++){if(e[c].name===b){e.splice(c,1);break}}e.push({name:b,targetObject:this.targetObject,callback:f,callbackContext:a,callbackArgs:d})},processClickTrampolines:function(){var c=this._clickTrampolines;if(!c){return}for(var a=0;a<c.length;a++){var b=c[a];if(b.targetObject===this._trampolineTargetObject){b.callback.apply(b.callbackContext,b.callbackArgs)}}this._clickTrampolines=null;this._trampolineTargetObject=null},reset:function(){if(this.isMouse===false){this.active=false}this.pointerId=null;this.identifier=null;this.dirty=false;this.totalTouches=0;this._holdSent=false;this._history.length=0;this._stateReset=true;this.resetButtons();if(this.targetObject){this.targetObject._releasedHandler(this)}this.targetObject=null},resetMovement:function(){this.movementX=0;this.movementY=0}};Phaser.Pointer.prototype.constructor=Phaser.Pointer;Object.defineProperty(Phaser.Pointer.prototype,"duration",{get:function(){if(this.isUp){return -1}return this.game.time.time-this.timeDown}});Object.defineProperty(Phaser.Pointer.prototype,"worldX",{get:function(){return this.game.world.camera.x+this.x}});Object.defineProperty(Phaser.Pointer.prototype,"worldY",{get:function(){return this.game.world.camera.y+this.y}});Phaser.PointerMode={CURSOR:1<<0,CONTACT:1<<1};Phaser.Touch=function(a){this.game=a;this.enabled=true;this.callbackContext=this.game;this.touchStartCallback=null;this.touchMoveCallback=null;this.touchEndCallback=null;this.touchEnterCallback=null;this.touchLeaveCallback=null;this.touchCancelCallback=null;this.preventDefault=true;this.event=null;this._onTouchStart=null;this._onTouchMove=null;this._onTouchEnd=null;this._onTouchEnter=null;this._onTouchLeave=null;this._onTouchCancel=null;this._onTouchMove=null};Phaser.Touch.prototype={start:function(){if(this._onTouchStart!==null){return}var a=this;if(this.game.device.touch){this._onTouchStart=function(b){return a.onTouchStart(b)};this._onTouchMove=function(b){return a.onTouchMove(b)};this._onTouchEnd=function(b){return a.onTouchEnd(b)};this._onTouchEnter=function(b){return a.onTouchEnter(b)};this._onTouchLeave=function(b){return a.onTouchLeave(b)};this._onTouchCancel=function(b){return a.onTouchCancel(b)};this.game.canvas.addEventListener("touchstart",this._onTouchStart,false);this.game.canvas.addEventListener("touchmove",this._onTouchMove,false);this.game.canvas.addEventListener("touchend",this._onTouchEnd,false);this.game.canvas.addEventListener("touchcancel",this._onTouchCancel,false);if(!this.game.device.cocoonJS){this.game.canvas.addEventListener("touchenter",this._onTouchEnter,false);this.game.canvas.addEventListener("touchleave",this._onTouchLeave,false)}}this.addTouchLockCallback=this.game.input.addTouchLockCallback.bind(this.game.input);this.removeTouchLockCallback=this.game.input.removeTouchLockCallback.bind(this.game.input)},consumeDocumentTouches:function(){this._documentTouchMove=function(a){a.preventDefault()};document.addEventListener("touchmove",this._documentTouchMove,false)},onTouchStart:function(b){this.game.input.executeTouchLockCallbacks(false,b);this.event=b;if(!this.game.input.enabled||!this.enabled){return}if(this.touchStartCallback){this.touchStartCallback.call(this.callbackContext,b)}if(this.preventDefault){b.preventDefault()}for(var a=0;a<b.changedTouches.length;a++){this.game.input.startPointer(b.changedTouches[a])}},onTouchCancel:function(b){this.event=b;if(this.touchCancelCallback){this.touchCancelCallback.call(this.callbackContext,b)}if(!this.game.input.enabled||!this.enabled){return}if(this.preventDefault){b.preventDefault()}for(var a=0;a<b.changedTouches.length;a++){this.game.input.stopPointer(b.changedTouches[a])}},onTouchEnter:function(a){this.event=a;if(this.touchEnterCallback){this.touchEnterCallback.call(this.callbackContext,a)}if(!this.game.input.enabled||!this.enabled){return}if(this.preventDefault){a.preventDefault()}},onTouchLeave:function(a){this.event=a;if(this.touchLeaveCallback){this.touchLeaveCallback.call(this.callbackContext,a)}if(this.preventDefault){a.preventDefault()}},onTouchMove:function(b){this.event=b;if(this.touchMoveCallback){this.touchMoveCallback.call(this.callbackContext,b)}if(this.preventDefault){b.preventDefault()}for(var a=0;a<b.changedTouches.length;a++){this.game.input.updatePointer(b.changedTouches[a])}},onTouchEnd:function(b){this.game.input.executeTouchLockCallbacks(true,b);this.event=b;if(this.touchEndCallback){this.touchEndCallback.call(this.callbackContext,b)}if(this.preventDefault){b.preventDefault()}for(var a=0;a<b.changedTouches.length;a++){this.game.input.stopPointer(b.changedTouches[a])}},stop:function(){if(this.game.device.touch){this.game.canvas.removeEventListener("touchstart",this._onTouchStart);this.game.canvas.removeEventListener("touchmove",this._onTouchMove);this.game.canvas.removeEventListener("touchend",this._onTouchEnd);this.game.canvas.removeEventListener("touchenter",this._onTouchEnter);this.game.canvas.removeEventListener("touchleave",this._onTouchLeave);this.game.canvas.removeEventListener("touchcancel",this._onTouchCancel)}}};Phaser.Touch.prototype.constructor=Phaser.Touch;Phaser.InputHandler=function(a){this.sprite=a;this.game=a.game;this.enabled=false;this.checked=false;this.priorityID=0;this.useHandCursor=false;this._setHandCursor=false;this.isDragged=false;this.allowHorizontalDrag=true;this.allowVerticalDrag=true;this.bringToTop=false;this.snapOffset=null;this.snapOnDrag=false;this.snapOnRelease=false;this.snapX=0;this.snapY=0;this.snapOffsetX=0;this.snapOffsetY=0;this.pixelPerfectOver=false;this.pixelPerfectClick=false;this.pixelPerfectAlpha=255;this.draggable=false;this.boundsRect=null;this.boundsSprite=null;this.scaleLayer=false;this.dragOffset=new Phaser.Point();this.dragFromCenter=false;this.dragStopBlocksInputUp=false;this.dragStartPoint=new Phaser.Point();this.dragDistanceThreshold=0;this.dragTimeThreshold=0;this.downPoint=new Phaser.Point();this.snapPoint=new Phaser.Point();this._dragPoint=new Phaser.Point();this._dragPhase=false;this._pendingDrag=false;this._dragTimePass=false;this._dragDistancePass=false;this._wasEnabled=false;this._tempPoint=new Phaser.Point();this._pointerData=[];this._pointerData.push({id:0,x:0,y:0,camX:0,camY:0,isDown:false,isUp:false,isOver:false,isOut:false,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:false})};Phaser.InputHandler.prototype={start:function(c,a){c=c||0;if(a===undefined){a=false}if(this.enabled===false){this.game.input.interactiveItems.add(this);this.useHandCursor=a;this.priorityID=c;for(var b=0;b<10;b++){this._pointerData[b]={id:b,x:0,y:0,isDown:false,isUp:false,isOver:false,isOut:false,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:false}}this.snapOffset=new Phaser.Point();this.enabled=true;this._wasEnabled=true}this.sprite.events.onAddedToGroup.add(this.addedToGroup,this);this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup,this);return this.sprite},addedToGroup:function(){if(this._dragPhase){return}if(this._wasEnabled&&!this.enabled){this.start()}},removedFromGroup:function(){if(this._dragPhase){return}if(this.enabled){this._wasEnabled=true;this.stop()}else{this._wasEnabled=false}},reset:function(){this.enabled=false;for(var a=0;a<10;a++){this._pointerData[a]={id:a,x:0,y:0,isDown:false,isUp:false,isOver:false,isOut:false,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:false}}},stop:function(){if(this.enabled===false){return}else{this.enabled=false;this.game.input.interactiveItems.remove(this)}},destroy:function(){if(this.sprite){if(this._setHandCursor){this.game.canvas.style.cursor="";this._setHandCursor=false}this.enabled=false;this.game.input.interactiveItems.remove(this);this._pointerData.length=0;this.boundsRect=null;this.boundsSprite=null;this.sprite=null}},validForInput:function(c,b,a){if(a===undefined){a=true}if(!this.enabled||this.sprite.scale.x===0||this.sprite.scale.y===0||this.priorityID<this.game.input.minPriorityID||(this.sprite.parent&&this.sprite.parent.ignoreChildInput)){return false}if(!a&&(this.pixelPerfectClick||this.pixelPerfectOver)){return false}if(this.priorityID>c||(this.priorityID===c&&this.sprite.renderOrderID>b)){return true}return false},isPixelPerfect:function(){return(this.pixelPerfectClick||this.pixelPerfectOver)},pointerX:function(a){a=a||0;return this._pointerData[a].x},pointerY:function(a){a=a||0;return this._pointerData[a].y},pointerDown:function(a){a=a||0;return this._pointerData[a].isDown},pointerUp:function(a){a=a||0;return this._pointerData[a].isUp},pointerTimeDown:function(a){a=a||0;return this._pointerData[a].timeDown},pointerTimeUp:function(a){a=a||0;return this._pointerData[a].timeUp},pointerOver:function(b){if(!this.enabled){return false}if(b===undefined){for(var a=0;a<10;a++){if(this._pointerData[a].isOver){return true}}return false}else{return this._pointerData[b].isOver}},pointerOut:function(b){if(!this.enabled){return false}if(b===undefined){for(var a=0;a<10;a++){if(this._pointerData[a].isOut){return true}}}else{return this._pointerData[b].isOut}},pointerTimeOver:function(a){a=a||0;return this._pointerData[a].timeOver},pointerTimeOut:function(a){a=a||0;return this._pointerData[a].timeOut},pointerDragged:function(a){a=a||0;return this._pointerData[a].isDragged},checkPointerDown:function(b,a){if(!b.isDown||!this.enabled||!this.sprite||!this.sprite.parent||!this.sprite.visible||!this.sprite.parent.visible||this.sprite.worldScale.x===0||this.sprite.worldScale.y===0){return false}if(this.game.input.hitTest(this.sprite,b,this._tempPoint)){if(a===undefined){a=false}if(!a&&this.pixelPerfectClick){return this.checkPixel(this._tempPoint.x,this._tempPoint.y)}else{return true}}return false},checkPointerOver:function(b,a){if(!this.enabled||!this.sprite||!this.sprite.parent||!this.sprite.visible||!this.sprite.parent.visible||this.sprite.worldScale.x===0||this.sprite.worldScale.y===0){return false}if(this.game.input.hitTest(this.sprite,b,this._tempPoint)){if(a===undefined){a=false}if(!a&&this.pixelPerfectOver){return this.checkPixel(this._tempPoint.x,this._tempPoint.y)}else{return true}}return false},checkPixel:function(a,d,c){if(this.sprite.texture.baseTexture.source){if(a===null&&d===null){this.game.input.getLocalPosition(this.sprite,c,this._tempPoint);var a=this._tempPoint.x;var d=this._tempPoint.y}if(this.sprite.anchor.x!==0){a-=-this.sprite.texture.frame.width*this.sprite.anchor.x}if(this.sprite.anchor.y!==0){d-=-this.sprite.texture.frame.height*this.sprite.anchor.y}a+=this.sprite.texture.frame.x;d+=this.sprite.texture.frame.y;if(this.sprite.texture.trim){a-=this.sprite.texture.trim.x;d-=this.sprite.texture.trim.y;if(a<this.sprite.texture.crop.x||a>this.sprite.texture.crop.right||d<this.sprite.texture.crop.y||d>this.sprite.texture.crop.bottom){this._dx=a;this._dy=d;return false}}this._dx=a;this._dy=d;this.game.input.hitContext.clearRect(0,0,1,1);this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source,a,d,1,1,0,0,1,1);var b=this.game.input.hitContext.getImageData(0,0,1,1);if(b.data[3]>=this.pixelPerfectAlpha){return true}}return false},update:function(a){if(this.sprite===null||this.sprite.parent===undefined){return}if(!this.enabled||!this.sprite.visible||!this.sprite.parent.visible){this._pointerOutHandler(a);return false}if(this._pendingDrag){if(!this._dragDistancePass){this._dragDistancePass=(Phaser.Math.distance(a.x,a.y,this.downPoint.x,this.downPoint.y)>=this.dragDistanceThreshold)}if(this._dragDistancePass&&this._dragTimePass){this.startDrag(a)}return true}else{if(this.draggable&&this._draggedPointerID===a.id){return this.updateDrag(a,false)}else{if(this._pointerData[a.id].isOver){if(this.checkPointerOver(a)){this._pointerData[a.id].x=a.x-this.sprite.x;this._pointerData[a.id].y=a.y-this.sprite.y;return true}else{this._pointerOutHandler(a);return false}}}}},_pointerOverHandler:function(c,a){if(this.sprite===null){return}var b=this._pointerData[c.id];if(b.isOver===false||c.dirty){var d=(b.isOver===false);b.isOver=true;b.isOut=false;b.timeOver=this.game.time.time;b.x=c.x-this.sprite.x;b.y=c.y-this.sprite.y;if(this.useHandCursor&&b.isDragged===false){this.game.canvas.style.cursor="pointer";this._setHandCursor=true}if(!a&&d&&this.sprite&&this.sprite.events){this.sprite.events.onInputOver$dispatch(this.sprite,c)}if(this.sprite.parent&&this.sprite.parent.onChildInputOver){this.sprite.parent.onChildInputOver.dispatch(this.sprite,c)}}},_pointerOutHandler:function(c,a){if(this.sprite===null){return}var b=this._pointerData[c.id];b.isOver=false;b.isOut=true;b.timeOut=this.game.time.time;if(this.useHandCursor&&b.isDragged===false){this.game.canvas.style.cursor="";this._setHandCursor=false}if(!a&&this.sprite&&this.sprite.events){this.sprite.events.onInputOut$dispatch(this.sprite,c);if(this.sprite&&this.sprite.parent&&this.sprite.parent.onChildInputOut){this.sprite.parent.onChildInputOut.dispatch(this.sprite,c)}}},_touchedHandler:function(b){if(this.sprite===null){return}var a=this._pointerData[b.id];if(!a.isDown&&a.isOver){if(this.pixelPerfectClick&&!this.checkPixel(null,null,b)){return}a.isDown=true;a.isUp=false;a.timeDown=this.game.time.time;this.downPoint.set(b.x,b.y);b.dirty=true;if(this.sprite&&this.sprite.events){this.sprite.events.onInputDown$dispatch(this.sprite,b);if(this.sprite&&this.sprite.parent&&this.sprite.parent.onChildInputDown){this.sprite.parent.onChildInputDown.dispatch(this.sprite,b)}if(this.sprite===null){return}}if(this.draggable&&this.isDragged===false){if(this.dragTimeThreshold===0&&this.dragDistanceThreshold===0){this.startDrag(b)}else{this._pendingDrag=true;this._dragDistancePass=(this.dragDistanceThreshold===0);if(this.dragTimeThreshold>0){this._dragTimePass=false;this.game.time.events.add(this.dragTimeThreshold,this.dragTimeElapsed,this,b)}else{this._dragTimePass=true}}}if(this.bringToTop){this.sprite.bringToTop()}}},dragTimeElapsed:function(a){this._dragTimePass=true;if(this._pendingDrag&&this.sprite){if(this._dragDistancePass){this.startDrag(a)}}},_releasedHandler:function(c){if(this.sprite===null){return}var a=this._pointerData[c.id];if(a.isDown&&c.isUp){a.isDown=false;a.isUp=true;a.timeUp=this.game.time.time;a.downDuration=a.timeUp-a.timeDown;var b=this.checkPointerOver(c);if(this.sprite&&this.sprite.events){if(!this.dragStopBlocksInputUp||this.dragStopBlocksInputUp&&!(this.draggable&&this.isDragged&&this._draggedPointerID===c.id)){this.sprite.events.onInputUp$dispatch(this.sprite,c,b)}if(this.sprite&&this.sprite.parent&&this.sprite.parent.onChildInputUp){this.sprite.parent.onChildInputUp.dispatch(this.sprite,c,b)}if(b){b=this.checkPointerOver(c)}}a.isOver=b;if(!b&&this.useHandCursor){this.game.canvas.style.cursor="default";this._setHandCursor=false}c.dirty=true;this._pendingDrag=false;if(this.draggable&&this.isDragged&&this._draggedPointerID===c.id){this.stopDrag(c)}}},updateDrag:function(f,b){if(b===undefined){b=false}if(f.isUp){this.stopDrag(f);return false}var e=this.globalToLocal(f);var d=e.x+this._dragPoint.x+this.dragOffset.x;var c=e.y+this._dragPoint.y+this.dragOffset.y;if(this.sprite.fixedToCamera){if(this.allowHorizontalDrag){this.sprite.cameraOffset.x=d-this.game.camera.x}if(this.allowVerticalDrag){this.sprite.cameraOffset.y=c-this.game.camera.y}if(this.boundsRect){this.checkBoundsRect()}if(this.boundsSprite){this.checkBoundsSprite()}if(this.snapOnDrag){this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-(this.snapOffsetX%this.snapX))/this.snapX)*this.snapX+(this.snapOffsetX%this.snapX);this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-(this.snapOffsetY%this.snapY))/this.snapY)*this.snapY+(this.snapOffsetY%this.snapY);this.snapPoint.set(this.sprite.cameraOffset.x,this.sprite.cameraOffset.y)}}else{var a=this.game.camera.x-this._pointerData[f.id].camX;var g=this.game.camera.y-this._pointerData[f.id].camY;if(this.allowHorizontalDrag){this.sprite.x=d+a}if(this.allowVerticalDrag){this.sprite.y=c+g}if(this.boundsRect){this.checkBoundsRect()}if(this.boundsSprite){this.checkBoundsSprite()}if(this.snapOnDrag){this.sprite.x=Math.round((this.sprite.x-(this.snapOffsetX%this.snapX))/this.snapX)*this.snapX+(this.snapOffsetX%this.snapX);this.sprite.y=Math.round((this.sprite.y-(this.snapOffsetY%this.snapY))/this.snapY)*this.snapY+(this.snapOffsetY%this.snapY);this.snapPoint.set(this.sprite.x,this.sprite.y)}}this.sprite.events.onDragUpdate.dispatch(this.sprite,f,d,c,this.snapPoint,b);return true},justOver:function(b,a){b=b||0;a=a||500;return(this._pointerData[b].isOver&&this.overDuration(b)<a)},justOut:function(b,a){b=b||0;a=a||500;return(this._pointerData[b].isOut&&(this.game.time.time-this._pointerData[b].timeOut<a))},justPressed:function(b,a){b=b||0;a=a||500;return(this._pointerData[b].isDown&&this.downDuration(b)<a)},justReleased:function(b,a){b=b||0;a=a||500;return(this._pointerData[b].isUp&&(this.game.time.time-this._pointerData[b].timeUp<a))},overDuration:function(a){a=a||0;if(this._pointerData[a].isOver){return this.game.time.time-this._pointerData[a].timeOver}return -1},downDuration:function(a){a=a||0;if(this._pointerData[a].isDown){return this.game.time.time-this._pointerData[a].timeDown}return -1},enableDrag:function(b,e,a,d,f,c){if(b===undefined){b=false}if(e===undefined){e=false}if(a===undefined){a=false}if(d===undefined){d=255}if(f===undefined){f=null}if(c===undefined){c=null}this._dragPoint=new Phaser.Point();this.draggable=true;this.bringToTop=e;this.dragOffset=new Phaser.Point();this.dragFromCenter=b;this.pixelPerfectClick=a;this.pixelPerfectAlpha=d;if(f){this.boundsRect=f}if(c){this.boundsSprite=c}},disableDrag:function(){if(this._pointerData){for(var a=0;a<10;a++){this._pointerData[a].isDragged=false}}this.draggable=false;this.isDragged=false;this._draggedPointerID=-1;this._pendingDrag=false},startDrag:function(d){var a=this.sprite.x;var f=this.sprite.y;var c=this.globalToLocal(d);this.isDragged=true;this._draggedPointerID=d.id;this._pointerData[d.id].camX=this.game.camera.x;this._pointerData[d.id].camY=this.game.camera.y;this._pointerData[d.id].isDragged=true;if(this.sprite.fixedToCamera){if(this.dragFromCenter){var b=this.sprite.getBounds();var e=this.globalToLocal(new Phaser.Point(b.centerX,b.centerY));this.sprite.cameraOffset.x=c.x+(this.sprite.cameraOffset.x-e.x);this.sprite.cameraOffset.y=c.y+(this.sprite.cameraOffset.y-e.y)}this._dragPoint.setTo(this.sprite.cameraOffset.x-d.x,this.sprite.cameraOffset.y-d.y)}else{if(this.dragFromCenter){var b=this.sprite.getBounds();var e=this.globalToLocal(new Phaser.Point(b.centerX,b.centerY));this.sprite.x=c.x+(this.sprite.x-e.x);this.sprite.y=c.y+(this.sprite.y-e.y)}this._dragPoint.setTo(this.sprite.x-c.x,this.sprite.y-c.y)}this.updateDrag(d,true);if(this.bringToTop){this._dragPhase=true;this.sprite.bringToTop()}this.dragStartPoint.set(a,f);this.sprite.events.onDragStart$dispatch(this.sprite,d,a,f);this._pendingDrag=false},globalToLocalX:function(a){if(this.scaleLayer){a-=this.game.scale.grid.boundsFluid.x;a*=this.game.scale.grid.scaleFluidInversed.x}return a},globalToLocalY:function(a){if(this.scaleLayer){a-=this.game.scale.grid.boundsFluid.y;a*=this.game.scale.grid.scaleFluidInversed.y}return a},globalToLocal:function(a){if(this.sprite.parent){return this.game.input.getLocalPosition(this.sprite.parent,{x:a.x,y:a.y})}else{return a}},stopDrag:function(a){this.isDragged=false;this._draggedPointerID=-1;this._pointerData[a.id].isDragged=false;this._dragPhase=false;this._pendingDrag=false;if(this.snapOnRelease){if(this.sprite.fixedToCamera){this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-(this.snapOffsetX%this.snapX))/this.snapX)*this.snapX+(this.snapOffsetX%this.snapX);this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-(this.snapOffsetY%this.snapY))/this.snapY)*this.snapY+(this.snapOffsetY%this.snapY)}else{this.sprite.x=Math.round((this.sprite.x-(this.snapOffsetX%this.snapX))/this.snapX)*this.snapX+(this.snapOffsetX%this.snapX);this.sprite.y=Math.round((this.sprite.y-(this.snapOffsetY%this.snapY))/this.snapY)*this.snapY+(this.snapOffsetY%this.snapY)}}this.sprite.events.onDragStop$dispatch(this.sprite,a);if(this.checkPointerOver(a)===false){this._pointerOutHandler(a)}},setDragLock:function(a,b){if(a===undefined){a=true}if(b===undefined){b=true}this.allowHorizontalDrag=a;this.allowVerticalDrag=b},enableSnap:function(d,c,b,a,f,e){if(b===undefined){b=true}if(a===undefined){a=false}if(f===undefined){f=0}if(e===undefined){e=0}this.snapX=d;this.snapY=c;this.snapOffsetX=f;this.snapOffsetY=e;this.snapOnDrag=b;this.snapOnRelease=a},disableSnap:function(){this.snapOnDrag=false;this.snapOnRelease=false},checkBoundsRect:function(){if(this.sprite.fixedToCamera){if(this.sprite.cameraOffset.x<this.boundsRect.left){this.sprite.cameraOffset.x=this.boundsRect.left}else{if((this.sprite.cameraOffset.x+this.sprite.width)>this.boundsRect.right){this.sprite.cameraOffset.x=this.boundsRect.right-this.sprite.width}}if(this.sprite.cameraOffset.y<this.boundsRect.top){this.sprite.cameraOffset.y=this.boundsRect.top}else{if((this.sprite.cameraOffset.y+this.sprite.height)>this.boundsRect.bottom){this.sprite.cameraOffset.y=this.boundsRect.bottom-this.sprite.height}}}else{if(this.sprite.left<this.boundsRect.left){this.sprite.x=this.boundsRect.x+this.sprite.offsetX}else{if(this.sprite.right>this.boundsRect.right){this.sprite.x=this.boundsRect.right-(this.sprite.width-this.sprite.offsetX)}}if(this.sprite.top<this.boundsRect.top){this.sprite.y=this.boundsRect.top+this.sprite.offsetY}else{if(this.sprite.bottom>this.boundsRect.bottom){this.sprite.y=this.boundsRect.bottom-(this.sprite.height-this.sprite.offsetY)}}}},checkBoundsSprite:function(){if(this.sprite.fixedToCamera&&this.boundsSprite.fixedToCamera){if(this.sprite.cameraOffset.x<this.boundsSprite.cameraOffset.x){this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x}else{if((this.sprite.cameraOffset.x+this.sprite.width)>(this.boundsSprite.cameraOffset.x+this.boundsSprite.width)){this.sprite.cameraOffset.x=(this.boundsSprite.cameraOffset.x+this.boundsSprite.width)-this.sprite.width}}if(this.sprite.cameraOffset.y<this.boundsSprite.cameraOffset.y){this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y}else{if((this.sprite.cameraOffset.y+this.sprite.height)>(this.boundsSprite.cameraOffset.y+this.boundsSprite.height)){this.sprite.cameraOffset.y=(this.boundsSprite.cameraOffset.y+this.boundsSprite.height)-this.sprite.height}}}else{if(this.sprite.left<this.boundsSprite.left){this.sprite.x=this.boundsSprite.left+this.sprite.offsetX}else{if(this.sprite.right>this.boundsSprite.right){this.sprite.x=this.boundsSprite.right-(this.sprite.width-this.sprite.offsetX)}}if(this.sprite.top<this.boundsSprite.top){this.sprite.y=this.boundsSprite.top+this.sprite.offsetY}else{if(this.sprite.bottom>this.boundsSprite.bottom){this.sprite.y=this.boundsSprite.bottom-(this.sprite.height-this.sprite.offsetY)}}}}};Phaser.InputHandler.prototype.constructor=Phaser.InputHandler;Phaser.Key=function(b,a){this.game=b;this._enabled=true;this.event=null;this.isDown=false;this.isUp=true;this.altKey=false;this.ctrlKey=false;this.shiftKey=false;this.timeDown=0;this.duration=0;this.timeUp=-2500;this.durationUp=-2500;this.repeats=0;this.keyCode=a;this.onDown=new Phaser.Signal();this.onHoldCallback=null;this.onHoldContext=null;this.onUp=new Phaser.Signal();this._justDown=false;this._justUp=false};Phaser.Key.prototype={update:function(){if(!this._enabled){return}if(this.isDown){this.duration=this.game.time.time-this.timeDown;this.repeats++;if(this.onHoldCallback){this.onHoldCallback.call(this.onHoldContext,this)}}else{this.durationUp=this.game.time.time-this.timeUp}},processKeyDown:function(a){if(!this._enabled){return}this.event=a;if(this.isDown){return}this.altKey=a.altKey;this.ctrlKey=a.ctrlKey;this.shiftKey=a.shiftKey;this.isDown=true;this.isUp=false;this.timeDown=this.game.time.time;this.duration=0;this.durationUp=this.game.time.time-this.timeUp;this.repeats=0;this._justDown=true;this.onDown.dispatch(this)},processKeyUp:function(a){if(!this._enabled){return}this.event=a;if(this.isUp){return}this.isDown=false;this.isUp=true;this.timeUp=this.game.time.time;this.duration=this.game.time.time-this.timeDown;this.durationUp=0;this._justUp=true;this.onUp.dispatch(this)},reset:function(a){if(a===undefined){a=true}this.isDown=false;this.isUp=true;this.timeUp=this.game.time.time;this.duration=0;this.durationUp=-2500;this._enabled=true;this._justDown=false;this._justUp=false;if(a){this.onDown.removeAll();this.onUp.removeAll();this.onHoldCallback=null;this.onHoldContext=null}},downDuration:function(a){if(a===undefined){a=50}return(this.isDown&&this.duration<a)},upDuration:function(a){if(a===undefined){a=50}return(!this.isDown&&((this.game.time.time-this.timeUp)<a))},justPressed:function(){return(this.isDown&&this.duration===0)},justReleased:function(){return(!this.isDown&&this.durationUp===0)}};Object.defineProperty(Phaser.Key.prototype,"justDown",{get:function(){var a=this._justDown;this._justDown=false;return a}});Object.defineProperty(Phaser.Key.prototype,"justUp",{get:function(){var a=this._justUp;this._justUp=false;return a}});Object.defineProperty(Phaser.Key.prototype,"enabled",{get:function(){return this._enabled},set:function(a){a=!!a;if(a!==this._enabled){if(!a){this.reset(false)}this._enabled=a}}});Phaser.Key.prototype.constructor=Phaser.Key;Phaser.Keyboard=function(a){this.game=a;this.enabled=true;this.event=null;this.pressEvent=null;this.callbackContext=this;this.onDownCallback=null;this.onPressCallback=null;this.onUpCallback=null;this._keys=[];this._capture=[];this._onKeyDown=null;this._onKeyPress=null;this._onKeyUp=null;this._i=0;this._k=0};Phaser.Keyboard.prototype={addCallbacks:function(a,b,d,c){this.callbackContext=a;if(b!==undefined&&b!==null){this.onDownCallback=b}if(d!==undefined&&d!==null){this.onUpCallback=d}if(c!==undefined&&c!==null){this.onPressCallback=c}},addKey:function(a){if(!this._keys[a]){this._keys[a]=new Phaser.Key(this.game,a);this.addKeyCapture(a)}return this._keys[a]},addKeys:function(c){var a={};for(var b in c){a[b]=this.addKey(c[b])}return a},removeKey:function(a){if(this._keys[a]){this._keys[a]=null;this.removeKeyCapture(a)}},createCursorKeys:function(){return this.addKeys({up:Phaser.KeyCode.UP,down:Phaser.KeyCode.DOWN,left:Phaser.KeyCode.LEFT,right:Phaser.KeyCode.RIGHT})},start:function(){if(this.game.device.cocoonJS){return}if(this._onKeyDown!==null){return}var a=this;this._onKeyDown=function(b){return a.processKeyDown(b)};this._onKeyUp=function(b){return a.processKeyUp(b)};this._onKeyPress=function(b){return a.processKeyPress(b)};window.addEventListener("keydown",this._onKeyDown,false);window.addEventListener("keyup",this._onKeyUp,false);window.addEventListener("keypress",this._onKeyPress,false)},stop:function(){window.removeEventListener("keydown",this._onKeyDown);window.removeEventListener("keyup",this._onKeyUp);window.removeEventListener("keypress",this._onKeyPress);this._onKeyDown=null;this._onKeyUp=null;this._onKeyPress=null},destroy:function(){this.stop();this.clearCaptures();this._keys.length=0;this._i=0},addKeyCapture:function(a){if(typeof a==="object"){for(var b in a){this._capture[a[b]]=true}}else{this._capture[a]=true}},removeKeyCapture:function(a){delete this._capture[a]},clearCaptures:function(){this._capture={}},update:function(){this._i=this._keys.length;while(this._i--){if(this._keys[this._i]){this._keys[this._i].update()}}},processKeyDown:function(b){this.event=b;if(!this.game.input.enabled||!this.enabled){return}var a=b.keyCode;if(this._capture[a]){b.preventDefault()}if(!this._keys[a]){this._keys[a]=new Phaser.Key(this.game,a)}this._keys[a].processKeyDown(b);this._k=a;if(this.onDownCallback){this.onDownCallback.call(this.callbackContext,b)}},processKeyPress:function(a){this.pressEvent=a;if(!this.game.input.enabled||!this.enabled){return}if(this.onPressCallback){this.onPressCallback.call(this.callbackContext,String.fromCharCode(a.charCode),a)}},processKeyUp:function(b){this.event=b;if(!this.game.input.enabled||!this.enabled){return}var a=b.keyCode;if(this._capture[a]){b.preventDefault()}if(!this._keys[a]){this._keys[a]=new Phaser.Key(this.game,a)}this._keys[a].processKeyUp(b);if(this.onUpCallback){this.onUpCallback.call(this.callbackContext,b)}},reset:function(b){if(b===undefined){b=true}this.event=null;var a=this._keys.length;while(a--){if(this._keys[a]){this._keys[a].reset(b)}}},downDuration:function(a,b){if(this._keys[a]){return this._keys[a].downDuration(b)}else{return null}},upDuration:function(a,b){if(this._keys[a]){return this._keys[a].upDuration(b)}else{return null}},justPressed:function(a){if(this._keys[a]){return this._keys[a].justPressed()}else{return null}},justReleased:function(a){if(this._keys[a]){return this._keys[a].justReleased()}else{return null}},isDown:function(a){if(this._keys[a]){return this._keys[a].isDown}else{return null}}};Object.defineProperty(Phaser.Keyboard.prototype,"lastChar",{get:function(){if(this.event&&this.event.charCode===32){return""}else{if(this.pressEvent){return String.fromCharCode(this.pressEvent.charCode)}else{return null}}}});Object.defineProperty(Phaser.Keyboard.prototype,"lastKey",{get:function(){return this._keys[this._k]}});Phaser.Keyboard.prototype.constructor=Phaser.Keyboard;Phaser.KeyCode={A:"A".charCodeAt(0),B:"B".charCodeAt(0),C:"C".charCodeAt(0),D:"D".charCodeAt(0),E:"E".charCodeAt(0),F:"F".charCodeAt(0),G:"G".charCodeAt(0),H:"H".charCodeAt(0),I:"I".charCodeAt(0),J:"J".charCodeAt(0),K:"K".charCodeAt(0),L:"L".charCodeAt(0),M:"M".charCodeAt(0),N:"N".charCodeAt(0),O:"O".charCodeAt(0),P:"P".charCodeAt(0),Q:"Q".charCodeAt(0),R:"R".charCodeAt(0),S:"S".charCodeAt(0),T:"T".charCodeAt(0),U:"U".charCodeAt(0),V:"V".charCodeAt(0),W:"W".charCodeAt(0),X:"X".charCodeAt(0),Y:"Y".charCodeAt(0),Z:"Z".charCodeAt(0),ZERO:"0".charCodeAt(0),ONE:"1".charCodeAt(0),TWO:"2".charCodeAt(0),THREE:"3".charCodeAt(0),FOUR:"4".charCodeAt(0),FIVE:"5".charCodeAt(0),SIX:"6".charCodeAt(0),SEVEN:"7".charCodeAt(0),EIGHT:"8".charCodeAt(0),NINE:"9".charCodeAt(0),NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_ENTER:108,NUMPAD_SUBTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,COLON:186,EQUALS:187,COMMA:188,UNDERSCORE:189,PERIOD:190,QUESTION_MARK:191,TILDE:192,OPEN_BRACKET:219,BACKWARD_SLASH:220,CLOSED_BRACKET:221,QUOTES:222,BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,CAPS_LOCK:20,ESC:27,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS:43,MINUS:44,INSERT:45,DELETE:46,HELP:47,NUM_LOCK:144};for(var key in Phaser.KeyCode){if(Phaser.KeyCode.hasOwnProperty(key)&&!key.match(/[a-z]/)){Phaser.Keyboard[key]=Phaser.KeyCode[key]}}Phaser.Component=function(){};Phaser.Component.Angle=function(){};Phaser.Component.Angle.prototype={angle:{get:function(){return Phaser.Math.wrapAngle(Phaser.Math.radToDeg(this.rotation))},set:function(a){this.rotation=Phaser.Math.degToRad(Phaser.Math.wrapAngle(a))}}};Phaser.Component.Animation=function(){};Phaser.Component.Animation.prototype={play:function(d,c,b,a){if(this.animations){return this.animations.play(d,c,b,a)}}};Phaser.Component.AutoCull=function(){};Phaser.Component.AutoCull.prototype={autoCull:false,inCamera:{get:function(){if(!this.autoCull&&!this.checkWorldBounds){this._bounds.copyFrom(this.getBounds());this._bounds.x+=this.game.camera.view.x;this._bounds.y+=this.game.camera.view.y}return this.game.world.camera.view.intersects(this._bounds)}}};Phaser.Component.Bounds=function(){};Phaser.Component.Bounds.prototype={offsetX:{get:function(){return this.anchor.x*this.width}},offsetY:{get:function(){return this.anchor.y*this.height}},centerX:{get:function(){return(this.x-this.offsetX)+(this.width*0.5)},set:function(a){this.x=(a+this.offsetX)-(this.width*0.5)}},centerY:{get:function(){return(this.y-this.offsetY)+(this.height*0.5)},set:function(a){this.y=(a+this.offsetY)-(this.height*0.5)}},left:{get:function(){return this.x-this.offsetX},set:function(a){this.x=a+this.offsetX}},right:{get:function(){return(this.x+this.width)-this.offsetX},set:function(a){this.x=a-(this.width)+this.offsetX}},top:{get:function(){return this.y-this.offsetY},set:function(a){this.y=a+this.offsetY}},bottom:{get:function(){return(this.y+this.height)-this.offsetY},set:function(a){this.y=a-(this.height)+this.offsetY}},alignIn:function(c,b,a,d){if(a===undefined){a=0}if(d===undefined){d=0}switch(b){default:case Phaser.TOP_LEFT:this.left=c.left-a;this.top=c.top-d;break;case Phaser.TOP_CENTER:this.centerX=c.centerX+a;this.top=c.top-d;break;case Phaser.TOP_RIGHT:this.right=c.right+a;this.top=c.top-d;break;case Phaser.LEFT_CENTER:this.left=c.left-a;this.centerY=c.centerY+d;break;case Phaser.CENTER:this.centerX=c.centerX+a;this.centerY=c.centerY+d;break;case Phaser.RIGHT_CENTER:this.right=c.right+a;this.centerY=c.centerY+d;break;case Phaser.BOTTOM_LEFT:this.left=c.left-a;this.bottom=c.bottom+d;break;case Phaser.BOTTOM_CENTER:this.centerX=c.centerX+a;this.bottom=c.bottom+d;break;case Phaser.BOTTOM_RIGHT:this.right=c.right+a;this.bottom=c.bottom+d;break}return this},alignTo:function(c,b,a,d){if(a===undefined){a=0}if(d===undefined){d=0}switch(b){default:case Phaser.TOP_LEFT:this.left=c.left-a;this.bottom=c.top-d;break;case Phaser.TOP_CENTER:this.centerX=c.centerX+a;this.bottom=c.top-d;break;case Phaser.TOP_RIGHT:this.right=c.right+a;this.bottom=c.top-d;break;case Phaser.LEFT_TOP:this.right=c.left-a;this.top=c.top-d;break;case Phaser.LEFT_CENTER:this.right=c.left-a;this.centerY=c.centerY+d;break;case Phaser.LEFT_BOTTOM:this.right=c.left-a;this.bottom=c.bottom+d;break;case Phaser.RIGHT_TOP:this.left=c.right+a;this.top=c.top-d;break;case Phaser.RIGHT_CENTER:this.left=c.right+a;this.centerY=c.centerY+d;break;case Phaser.RIGHT_BOTTOM:this.left=c.right+a;this.bottom=c.bottom+d;break;case Phaser.BOTTOM_LEFT:this.left=c.left-a;this.top=c.bottom+d;break;case Phaser.BOTTOM_CENTER:this.centerX=c.centerX+a;this.top=c.bottom+d;break;case Phaser.BOTTOM_RIGHT:this.right=c.right+a;this.top=c.bottom+d;break}return this}};Phaser.Group.prototype.alignIn=Phaser.Component.Bounds.prototype.alignIn;Phaser.Group.prototype.alignTo=Phaser.Component.Bounds.prototype.alignTo;Phaser.Component.BringToTop=function(){};Phaser.Component.BringToTop.prototype.bringToTop=function(){if(this.parent){this.parent.bringToTop(this)}return this};Phaser.Component.BringToTop.prototype.sendToBack=function(){if(this.parent){this.parent.sendToBack(this)}return this};Phaser.Component.BringToTop.prototype.moveUp=function(){if(this.parent){this.parent.moveUp(this)}return this};Phaser.Component.BringToTop.prototype.moveDown=function(){if(this.parent){this.parent.moveDown(this)}return this};Phaser.Component.Core=function(){};Phaser.Component.Core.skipTypeChecks=false;Phaser.Component.Core.install=function(c){Phaser.Utils.mixinPrototype(this,Phaser.Component.Core.prototype);this.components={};for(var b=0;b<c.length;b++){var d=c[b];var a=false;if(d==="Destroy"){a=true}Phaser.Utils.mixinPrototype(this,Phaser.Component[d].prototype,a);this.components[d]=true}};Phaser.Component.Core.init=function(b,a,e,c,d){if(!Phaser.Component.Core.skipTypeChecks){if(!(b instanceof Phaser.Game)){throw new Error("The value passed as the `game` argument ("+b+") is not an instance of Phaser.Game.")}if(typeof a!=="number"){console.warn("The `x` argument value (%s) should be a number.",a);a=0}if(typeof e!=="number"){console.warn("The `y` argument value (%s) should be a number.",e);e=0}}this.game=b;this.key=c;this.data={};this.position.set(a,e);this.world=new Phaser.Point(a,e);this.previousPosition=new Phaser.Point(a,e);this.events=new Phaser.Events(this);this._bounds=new Phaser.Rectangle();if(this.components.PhysicsBody){this.body=this.body}if(this.components.Animation){this.animations=new Phaser.AnimationManager(this)}if(this.components.LoadTexture&&c!==null){this.loadTexture(c,d)}if(this.components.FixedToCamera){this.cameraOffset=new Phaser.Point(a,e)}};Phaser.Component.Core.preUpdate=function(){if(this.pendingDestroy){this.destroy();return}this.previousPosition.set(this.world.x,this.world.y);this.previousRotation=this.rotation;if(!this.exists||!this.parent.exists){this.renderOrderID=-1;return false}this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty);if(this.visible){this.renderOrderID=this.game.stage.currentRenderOrderID++}if(this.animations){this.animations.update()}if(this.body){this.body.preUpdate()}this.preUpdateChildren();return true};Phaser.Component.Core.prototype={game:null,name:"",data:{},components:{},z:0,events:undefined,animations:undefined,key:"",world:null,debug:false,previousPosition:null,previousRotation:0,renderOrderID:0,fresh:true,pendingDestroy:false,_bounds:null,_exists:true,exists:{get:function(){return this._exists},set:function(a){if(a){this._exists=true;if(this.body&&this.body.type===Phaser.Physics.P2JS){this.body.addToWorld()}this.visible=true}else{this._exists=false;if(this.body&&this.body.type===Phaser.Physics.P2JS){this.body.removeFromWorld()}this.visible=false}}},preUpdateChildren:function(){var a=0;while(a<this.children.length){var b=this.children[a];b.preUpdate();if(this===b.parent){a++}}},update:function(){},postUpdate:function(){if(this.customRender){this.key.render()}if(this.components.PhysicsBody){Phaser.Component.PhysicsBody.postUpdate.call(this)}if(this.components.FixedToCamera){Phaser.Component.FixedToCamera.postUpdate.call(this)}for(var a=0;a<this.children.length;a++){this.children[a].postUpdate()}}};Phaser.Component.Crop=function(){};Phaser.Component.Crop.prototype={cropRect:null,_crop:null,crop:function(a,b){if(b===undefined){b=false}if(a){if(b&&this.cropRect!==null){this.cropRect.setTo(a.x,a.y,a.width,a.height)}else{if(b&&this.cropRect===null){this.cropRect=new Phaser.Rectangle(a.x,a.y,a.width,a.height)}else{this.cropRect=a}}this.updateCrop()}else{this._crop=null;this.cropRect=null;this.resetFrame()}},updateCrop:function(){if(!this.cropRect){return}var f=this.texture.crop.x;var e=this.texture.crop.y;var g=this.texture.crop.width;var b=this.texture.crop.height;this._crop=Phaser.Rectangle.clone(this.cropRect,this._crop);this._crop.x+=this._frame.x;this._crop.y+=this._frame.y;var a=Math.max(this._frame.x,this._crop.x);var h=Math.max(this._frame.y,this._crop.y);var c=Math.min(this._frame.right,this._crop.right)-a;var d=Math.min(this._frame.bottom,this._crop.bottom)-h;this.texture.crop.x=a;this.texture.crop.y=h;this.texture.crop.width=c;this.texture.crop.height=d;this.texture.frame.width=Math.min(c,this.cropRect.width);this.texture.frame.height=Math.min(d,this.cropRect.height);this.texture.width=this.texture.frame.width;this.texture.height=this.texture.frame.height;this.texture._updateUvs();if(this.tint!==16777215&&(f!==a||e!==h||g!==c||b!==d)){this.texture.requiresReTint=true}}};Phaser.Component.Delta=function(){};Phaser.Component.Delta.prototype={deltaX:{get:function(){return this.world.x-this.previousPosition.x}},deltaY:{get:function(){return this.world.y-this.previousPosition.y}},deltaZ:{get:function(){return this.rotation-this.previousRotation}}};Phaser.Component.Destroy=function(){};Phaser.Component.Destroy.prototype={destroyPhase:false,destroy:function(c,a){if(this.game===null||this.destroyPhase){return}if(c===undefined){c=true}if(a===undefined){a=false}this.destroyPhase=true;if(this.events){this.events.onDestroy$dispatch(this)}if(this.parent){if(this.parent instanceof Phaser.Group){this.parent.remove(this)}else{this.parent.removeChild(this)}}if(this.input){this.input.destroy()}if(this.animations){this.animations.destroy()}if(this.body){this.body.destroy()}if(this.events){this.events.destroy()}this.game.tweens.removeFrom(this);var b=this.children.length;if(c){while(b--){this.children[b].destroy(c)}}else{while(b--){this.removeChild(this.children[b])}}if(this._crop){this._crop=null;this.cropRect=null}if(this._frame){this._frame=null}if(Phaser.Video&&this.key instanceof Phaser.Video){this.key.onChangeSource.remove(this.resizeFrame,this)}if(Phaser.BitmapText&&this._glyphs){this._glyphs=[]}this.alive=false;this.exists=false;this.visible=false;this.filters=null;this.mask=null;this.game=null;this.data={};this.renderable=false;if(this.transformCallback){this.transformCallback=null;this.transformCallbackContext=null}this.hitArea=null;this.parent=null;this.stage=null;this.worldTransform=null;this.filterArea=null;this._bounds=null;this._currentBounds=null;this._mask=null;this._destroyCachedSprite();if(a){this.texture.destroy(true)}this.destroyPhase=false;this.pendingDestroy=false}};Phaser.Events=function(a){this.parent=a};Phaser.Events.prototype={destroy:function(){this._parent=null;if(this._onDestroy){this._onDestroy.dispose()}if(this._onAddedToGroup){this._onAddedToGroup.dispose()}if(this._onRemovedFromGroup){this._onRemovedFromGroup.dispose()}if(this._onKilled){this._onKilled.dispose()}if(this._onRevived){this._onRevived.dispose()}if(this._onEnterBounds){this._onEnterBounds.dispose()}if(this._onOutOfBounds){this._onOutOfBounds.dispose()}if(this._onInputOver){this._onInputOver.dispose()}if(this._onInputOut){this._onInputOut.dispose()}if(this._onInputDown){this._onInputDown.dispose()}if(this._onInputUp){this._onInputUp.dispose()}if(this._onDragStart){this._onDragStart.dispose()}if(this._onDragUpdate){this._onDragUpdate.dispose()}if(this._onDragStop){this._onDragStop.dispose()}if(this._onAnimationStart){this._onAnimationStart.dispose()}if(this._onAnimationComplete){this._onAnimationComplete.dispose()}if(this._onAnimationLoop){this._onAnimationLoop.dispose()}},onAddedToGroup:null,onRemovedFromGroup:null,onDestroy:null,onKilled:null,onRevived:null,onOutOfBounds:null,onEnterBounds:null,onInputOver:null,onInputOut:null,onInputDown:null,onInputUp:null,onDragStart:null,onDragUpdate:null,onDragStop:null,onAnimationStart:null,onAnimationComplete:null,onAnimationLoop:null};Phaser.Events.prototype.constructor=Phaser.Events;for(var prop in Phaser.Events.prototype){if(!Phaser.Events.prototype.hasOwnProperty(prop)||prop.indexOf("on")!==0||Phaser.Events.prototype[prop]!==null){continue}(function(b,a){Object.defineProperty(Phaser.Events.prototype,b,{get:function(){return this[a]||(this[a]=new Phaser.Signal())}});Phaser.Events.prototype[b+"$dispatch"]=function(){return this[a]?this[a].dispatch.apply(this[a],arguments):null}})(prop,"_"+prop)}Phaser.Component.FixedToCamera=function(){};Phaser.Component.FixedToCamera.postUpdate=function(){if(this.fixedToCamera){this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x;this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y}};Phaser.Component.FixedToCamera.prototype={_fixedToCamera:false,fixedToCamera:{get:function(){return this._fixedToCamera},set:function(a){if(a){this._fixedToCamera=true;this.cameraOffset.set(this.x,this.y)}else{this._fixedToCamera=false}}},cameraOffset:new Phaser.Point()};Phaser.Component.Health=function(){};Phaser.Component.Health.prototype={health:1,maxHealth:100,damage:function(a){if(this.alive){this.health-=a;if(this.health<=0){this.kill()}}return this},setHealth:function(a){this.health=a;if(this.health>this.maxHealth){this.health=this.maxHealth}return this},heal:function(a){if(this.alive){this.health+=a;if(this.health>this.maxHealth){this.health=this.maxHealth}}return this}};Phaser.Component.InCamera=function(){};Phaser.Component.InCamera.prototype={inCamera:{get:function(){return this.game.world.camera.view.intersects(this._bounds)}}};Phaser.Component.InputEnabled=function(){};Phaser.Component.InputEnabled.prototype={input:null,inputEnabled:{get:function(){return(this.input&&this.input.enabled)},set:function(a){if(a){if(this.input===null){this.input=new Phaser.InputHandler(this);this.input.start()}else{if(this.input&&!this.input.enabled){this.input.start()}}}else{if(this.input&&this.input.enabled){this.input.stop()}}}}};Phaser.Component.InWorld=function(){};Phaser.Component.InWorld.preUpdate=function(){if(this.autoCull||this.checkWorldBounds){this._bounds.copyFrom(this.getBounds());this._bounds.x+=this.game.camera.view.x;this._bounds.y+=this.game.camera.view.y;if(this.autoCull){if(this.game.world.camera.view.intersects(this._bounds)){this.renderable=true;this.game.world.camera.totalInView++}else{this.renderable=false;if(this.outOfCameraBoundsKill){this.kill();return false}}}if(this.checkWorldBounds){if(this._outOfBoundsFired&&this.game.world.bounds.intersects(this._bounds)){this._outOfBoundsFired=false;this.events.onEnterBounds$dispatch(this)}else{if(!this._outOfBoundsFired&&!this.game.world.bounds.intersects(this._bounds)){this._outOfBoundsFired=true;this.events.onOutOfBounds$dispatch(this);if(this.outOfBoundsKill){this.kill();return false}}}}}return true};Phaser.Component.InWorld.prototype={checkWorldBounds:false,outOfBoundsKill:false,outOfCameraBoundsKill:false,_outOfBoundsFired:false,inWorld:{get:function(){return this.game.world.bounds.intersects(this.getBounds())}}};Phaser.Component.LifeSpan=function(){};Phaser.Component.LifeSpan.preUpdate=function(){if(this.lifespan>0){this.lifespan-=this.game.time.physicsElapsedMS;if(this.lifespan<=0){this.kill();return false}}return true};Phaser.Component.LifeSpan.prototype={alive:true,lifespan:0,revive:function(a){if(a===undefined){a=100}this.alive=true;this.exists=true;this.visible=true;if(typeof this.setHealth==="function"){this.setHealth(a)}if(this.events){this.events.onRevived$dispatch(this)}return this},kill:function(){this.alive=false;this.exists=false;this.visible=false;if(this.events){this.events.onKilled$dispatch(this)}return this}};Phaser.Component.LoadTexture=function(){};Phaser.Component.LoadTexture.prototype={customRender:false,_frame:null,loadTexture:function(f,h,d){if(f===Phaser.PENDING_ATLAS){f=h;h=0}else{h=h||0}if((d||d===undefined)&&this.animations){this.animations.stop()}this.key=f;this.customRender=false;var c=this.game.cache;var a=true;var e=!this.texture.baseTexture.scaleMode;if(Phaser.RenderTexture&&f instanceof Phaser.RenderTexture){this.key=f.key;this.setTexture(f)}else{if(Phaser.BitmapData&&f instanceof Phaser.BitmapData){this.customRender=true;this.setTexture(f.texture);if(c.hasFrameData(f.key,Phaser.Cache.BITMAPDATA)){a=!this.animations.loadFrameData(c.getFrameData(f.key,Phaser.Cache.BITMAPDATA),h)}else{a=!this.animations.loadFrameData(f.frameData,0)}}else{if(Phaser.Video&&f instanceof Phaser.Video){this.customRender=true;var g=f.texture.valid;this.setTexture(f.texture);this.setFrame(f.texture.frame.clone());f.onChangeSource.add(this.resizeFrame,this);this.texture.valid=g}else{if(Phaser.Tilemap&&f instanceof Phaser.TilemapLayer){this.setTexture(PIXI.Texture.fromCanvas(f.canvas))}else{if(f instanceof PIXI.Texture){this.setTexture(f)}else{var b=c.getImage(f,true);this.key=b.key;this.setTexture(new PIXI.Texture(b.base));if(f==="__default"){this.texture.baseTexture.skipRender=true}else{this.texture.baseTexture.skipRender=false}a=!this.animations.loadFrameData(b.frameData,h)}}}}}if(a){this._frame=Phaser.Rectangle.clone(this.texture.frame)}if(!e){this.texture.baseTexture.scaleMode=1}},setFrame:function(a){this._frame=a;this.texture.frame.x=a.x;this.texture.frame.y=a.y;this.texture.frame.width=a.width;this.texture.frame.height=a.height;this.texture.crop.x=a.x;this.texture.crop.y=a.y;this.texture.crop.width=a.width;this.texture.crop.height=a.height;if(a.trimmed){if(this.texture.trim){this.texture.trim.x=a.spriteSourceSizeX;this.texture.trim.y=a.spriteSourceSizeY;this.texture.trim.width=a.sourceSizeW;this.texture.trim.height=a.sourceSizeH}else{this.texture.trim={x:a.spriteSourceSizeX,y:a.spriteSourceSizeY,width:a.sourceSizeW,height:a.sourceSizeH}}this.texture.width=a.sourceSizeW;this.texture.height=a.sourceSizeH;this.texture.frame.width=a.sourceSizeW;this.texture.frame.height=a.sourceSizeH}else{if(!a.trimmed&&this.texture.trim){this.texture.trim=null}}if(a.rotated){this.texture.rotated=true}if(this.cropRect){this.updateCrop()}this.texture.requiresReTint=true;this.texture._updateUvs();if(this.tilingTexture){this.refreshTexture=true}},resizeFrame:function(c,b,a){this.texture.frame.resize(b,a);this.texture.setFrame(this.texture.frame)},resetFrame:function(){if(this._frame){this.setFrame(this._frame)}},frame:{get:function(){return this.animations.frame},set:function(a){this.animations.frame=a}},frameName:{get:function(){return this.animations.frameName},set:function(a){this.animations.frameName=a}}};Phaser.Component.Overlap=function(){};Phaser.Component.Overlap.prototype={overlap:function(a){return Phaser.Rectangle.intersects(this.getBounds(),a.getBounds())}};Phaser.Component.PhysicsBody=function(){};Phaser.Component.PhysicsBody.preUpdate=function(){if(this.fresh&&this.exists){this.world.setTo(this.parent.position.x+this.position.x,this.parent.position.y+this.position.y);this.worldTransform.tx=this.world.x;this.worldTransform.ty=this.world.y;this.previousPosition.set(this.world.x,this.world.y);this.previousRotation=this.rotation;if(this.body){this.body.preUpdate()}this.fresh=false;this.preUpdateChildren();return false}this.previousPosition.set(this.world.x,this.world.y);this.previousRotation=this.rotation;if(!this._exists||!this.parent.exists){this.renderOrderID=-1;return false}return true};Phaser.Component.PhysicsBody.postUpdate=function(){if(this.exists&&this.body){this.body.postUpdate()}};Phaser.Component.PhysicsBody.prototype={body:null,x:{get:function(){return this.position.x},set:function(a){this.position.x=a;if(this.body&&!this.body.dirty){this.body._reset=true}}},y:{get:function(){return this.position.y},set:function(a){this.position.y=a;if(this.body&&!this.body.dirty){this.body._reset=true}}}};Phaser.Component.Reset=function(){};Phaser.Component.Reset.prototype.reset=function(a,c,b){if(b===undefined){b=1}this.world.set(a,c);this.position.set(a,c);this.fresh=true;this.exists=true;this.visible=true;this.renderable=true;if(this.components.InWorld){this._outOfBoundsFired=false}if(this.components.LifeSpan){this.alive=true;this.health=b}if(this.components.PhysicsBody){if(this.body){this.body.reset(a,c,false,false)}}return this};Phaser.Component.ScaleMinMax=function(){};Phaser.Component.ScaleMinMax.prototype={transformCallback:null,transformCallbackContext:this,scaleMin:null,scaleMax:null,checkTransform:function(a){if(this.scaleMin){if(a.a<this.scaleMin.x){a.a=this.scaleMin.x}if(a.d<this.scaleMin.y){a.d=this.scaleMin.y}}if(this.scaleMax){if(a.a>this.scaleMax.x){a.a=this.scaleMax.x}if(a.d>this.scaleMax.y){a.d=this.scaleMax.y}}},setScaleMinMax:function(a,d,c,b){if(d===undefined){d=c=b=a}else{if(c===undefined){c=b=d;d=a}}if(a===null){this.scaleMin=null}else{if(this.scaleMin){this.scaleMin.set(a,d)}else{this.scaleMin=new Phaser.Point(a,d)}}if(c===null){this.scaleMax=null}else{if(this.scaleMax){this.scaleMax.set(c,b)}else{this.scaleMax=new Phaser.Point(c,b)}}if(this.scaleMin===null){this.transformCallback=null}else{this.transformCallback=this.checkTransform;this.transformCallbackContext=this}}};Phaser.Component.Smoothed=function(){};Phaser.Component.Smoothed.prototype={smoothed:{get:function(){return !this.texture.baseTexture.scaleMode},set:function(a){if(a){if(this.texture){this.texture.baseTexture.scaleMode=0}}else{if(this.texture){this.texture.baseTexture.scaleMode=1}}}}};Phaser.GameObjectFactory=function(a){this.game=a;this.world=this.game.world};Phaser.GameObjectFactory.prototype={existing:function(a){return this.world.add(a)},weapon:function(e,b,f,d,c){var a=this.game.plugins.add(Phaser.Weapon);if(c){a.bulletClass=c}a.createBullets(e,b,f,d);return a},image:function(a,e,b,d,c){if(c===undefined){c=this.world}return c.add(new Phaser.Image(this.game,a,e,b,d))},sprite:function(a,e,b,d,c){if(c===undefined){c=this.world}return c.create(a,e,b,d)},creature:function(a,f,b,e,d){if(d===undefined){d=this.world}var c=new Phaser.Creature(this.game,a,f,b,e);d.add(c);return c},tween:function(a){return this.game.tweens.create(a)},group:function(d,b,a,e,c){return new Phaser.Group(this.game,d,b,a,e,c)},physicsGroup:function(d,c,b,a){return new Phaser.Group(this.game,c,b,a,true,d)},spriteBatch:function(c,b,a){if(c===undefined){c=null}if(b===undefined){b="group"}if(a===undefined){a=false}return new Phaser.SpriteBatch(this.game,c,b,a)},audio:function(c,d,a,b){return this.game.sound.add(c,d,a,b)},sound:function(c,d,a,b){return this.game.sound.add(c,d,a,b)},audioSprite:function(a){return this.game.sound.addSprite(a)},tileSprite:function(b,g,d,a,c,f,e){if(e===undefined){e=this.world}return e.add(new Phaser.TileSprite(this.game,b,g,d,a,c,f))},rope:function(a,f,b,e,c,d){if(d===undefined){d=this.world}return d.add(new Phaser.Rope(this.game,a,f,b,e,c))},text:function(a,e,d,b,c){if(c===undefined){c=this.world}return c.add(new Phaser.Text(this.game,a,e,d,b))},button:function(g,f,i,j,b,c,a,d,e,h){if(h===undefined){h=this.world}return h.add(new Phaser.Button(this.game,g,f,i,j,b,c,a,d,e))},graphics:function(a,c,b){if(b===undefined){b=this.world}return b.add(new Phaser.Graphics(this.game,a,c))},emitter:function(a,c,b){return this.game.particles.add(new Phaser.Particles.Arcade.Emitter(this.game,a,c,b))},retroFont:function(b,a,d,g,i,h,e,f,c){return new Phaser.RetroFont(this.game,b,a,d,g,i,h,e,f,c)},bitmapText:function(a,f,b,e,c,d){if(d===undefined){d=this.world}return d.add(new Phaser.BitmapText(this.game,a,f,b,e,c))},tilemap:function(c,e,b,d,a){return new Phaser.Tilemap(this.game,c,e,b,d,a)},renderTexture:function(d,b,c,a){if(c===undefined||c===""){c=this.game.rnd.uuid()}if(a===undefined){a=false}var e=new Phaser.RenderTexture(this.game,d,b,c);if(a){this.game.cache.addRenderTexture(c,e)}return e},video:function(b,a){return new Phaser.Video(this.game,b,a)},bitmapData:function(d,b,c,a){if(a===undefined){a=false}if(c===undefined||c===""){c=this.game.rnd.uuid()}var e=new Phaser.BitmapData(this.game,c,d,b);if(a){this.game.cache.addBitmapData(c,e)}return e},filter:function(b){var a=Array.prototype.slice.call(arguments,1);var b=new Phaser.Filter[b](this.game);b.init.apply(b,a);return b},plugin:function(a){return this.game.plugins.add(a)}};Phaser.GameObjectFactory.prototype.constructor=Phaser.GameObjectFactory;Phaser.GameObjectCreator=function(a){this.game=a;this.world=this.game.world};Phaser.GameObjectCreator.prototype={image:function(a,d,b,c){return new Phaser.Image(this.game,a,d,b,c)},sprite:function(a,d,b,c){return new Phaser.Sprite(this.game,a,d,b,c)},tween:function(a){return new Phaser.Tween(a,this.game,this.game.tweens)},group:function(d,b,a,e,c){return new Phaser.Group(this.game,d,b,a,e,c)},spriteBatch:function(c,b,a){if(b===undefined){b="group"}if(a===undefined){a=false}return new Phaser.SpriteBatch(this.game,c,b,a)},audio:function(c,d,a,b){return this.game.sound.add(c,d,a,b)},audioSprite:function(a){return this.game.sound.addSprite(a)},sound:function(c,d,a,b){return this.game.sound.add(c,d,a,b)},tileSprite:function(b,f,d,a,c,e){return new Phaser.TileSprite(this.game,b,f,d,a,c,e)},rope:function(a,e,b,d,c){return new Phaser.Rope(this.game,a,e,b,d,c)},text:function(a,d,c,b){return new Phaser.Text(this.game,a,d,c,b)},button:function(g,f,h,i,b,c,a,d,e){return new Phaser.Button(this.game,g,f,h,i,b,c,a,d,e)},graphics:function(a,b){return new Phaser.Graphics(this.game,a,b)},emitter:function(a,c,b){return new Phaser.Particles.Arcade.Emitter(this.game,a,c,b)},retroFont:function(b,a,d,g,i,h,e,f,c){return new Phaser.RetroFont(this.game,b,a,d,g,i,h,e,f,c)},bitmapText:function(a,f,b,d,c,e){return new Phaser.BitmapText(this.game,a,f,b,d,c,e)},tilemap:function(c,e,b,d,a){return new Phaser.Tilemap(this.game,c,e,b,d,a)},renderTexture:function(d,b,c,a){if(c===undefined||c===""){c=this.game.rnd.uuid()}if(a===undefined){a=false}var e=new Phaser.RenderTexture(this.game,d,b,c);if(a){this.game.cache.addRenderTexture(c,e)}return e},bitmapData:function(d,b,c,a){if(a===undefined){a=false}if(c===undefined||c===""){c=this.game.rnd.uuid()}var e=new Phaser.BitmapData(this.game,c,d,b);if(a){this.game.cache.addBitmapData(c,e)}return e},filter:function(b){var a=Array.prototype.slice.call(arguments,1);var b=new Phaser.Filter[b](this.game);b.init.apply(b,a);return b}};Phaser.GameObjectCreator.prototype.constructor=Phaser.GameObjectCreator;Phaser.Sprite=function(b,a,e,c,d){a=a||0;e=e||0;c=c||null;d=d||null;this.type=Phaser.SPRITE;this.physicsType=Phaser.SPRITE;PIXI.Sprite.call(this,Phaser.Cache.DEFAULT);Phaser.Component.Core.init.call(this,b,a,e,c,d)};Phaser.Sprite.prototype=Object.create(PIXI.Sprite.prototype);Phaser.Sprite.prototype.constructor=Phaser.Sprite;Phaser.Component.Core.install.call(Phaser.Sprite.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Delta","Destroy","FixedToCamera","Health","InCamera","InputEnabled","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","ScaleMinMax","Smoothed"]);Phaser.Sprite.prototype.preUpdatePhysics=Phaser.Component.PhysicsBody.preUpdate;Phaser.Sprite.prototype.preUpdateLifeSpan=Phaser.Component.LifeSpan.preUpdate;Phaser.Sprite.prototype.preUpdateInWorld=Phaser.Component.InWorld.preUpdate;Phaser.Sprite.prototype.preUpdateCore=Phaser.Component.Core.preUpdate;Phaser.Sprite.prototype.preUpdate=function(){if(!this.preUpdatePhysics()||!this.preUpdateLifeSpan()||!this.preUpdateInWorld()){return false}return this.preUpdateCore()};Phaser.Image=function(b,a,e,c,d){a=a||0;e=e||0;c=c||null;d=d||null;this.type=Phaser.IMAGE;PIXI.Sprite.call(this,Phaser.Cache.DEFAULT);Phaser.Component.Core.init.call(this,b,a,e,c,d)};Phaser.Image.prototype=Object.create(PIXI.Sprite.prototype);Phaser.Image.prototype.constructor=Phaser.Image;Phaser.Component.Core.install.call(Phaser.Image.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Destroy","FixedToCamera","InputEnabled","LifeSpan","LoadTexture","Overlap","Reset","ScaleMinMax","Smoothed"]);Phaser.Image.prototype.preUpdateLifeSpan=Phaser.Component.LifeSpan.preUpdate;Phaser.Image.prototype.preUpdateInWorld=Phaser.Component.InWorld.preUpdate;Phaser.Image.prototype.preUpdateCore=Phaser.Component.Core.preUpdate;Phaser.Image.prototype.preUpdate=function(){if(!this.preUpdateInWorld()||!this.preUpdateLifeSpan()){return false}return this.preUpdateCore()};Phaser.Button=function(j,g,f,h,i,b,c,a,d,e){g=g||0;f=f||0;h=h||null;i=i||null;b=b||this;Phaser.Image.call(this,j,g,f,h,a);this.type=Phaser.BUTTON;this.physicsType=Phaser.SPRITE;this._onOverFrame=null;this._onOutFrame=null;this._onDownFrame=null;this._onUpFrame=null;this.onOverSound=null;this.onOutSound=null;this.onDownSound=null;this.onUpSound=null;this.onOverSoundMarker="";this.onOutSoundMarker="";this.onDownSoundMarker="";this.onUpSoundMarker="";this.onInputOver=new Phaser.Signal();this.onInputOut=new Phaser.Signal();this.onInputDown=new Phaser.Signal();this.onInputUp=new Phaser.Signal();this.onOverMouseOnly=true;this.justReleasedPreventsOver=Phaser.PointerMode.CONTACT;this.freezeFrames=false;this.forceOut=false;this.inputEnabled=true;this.input.start(0,true);this.input.useHandCursor=true;this.setFrames(c,a,d,e);if(i!==null){this.onInputUp.add(i,b)}this.events.onInputOver.add(this.onInputOverHandler,this);this.events.onInputOut.add(this.onInputOutHandler,this);this.events.onInputDown.add(this.onInputDownHandler,this);this.events.onInputUp.add(this.onInputUpHandler,this)};Phaser.Button.prototype=Object.create(Phaser.Image.prototype);Phaser.Button.prototype.constructor=Phaser.Button;var STATE_OVER="Over";var STATE_OUT="Out";var STATE_DOWN="Down";var STATE_UP="Up";Phaser.Button.prototype.clearFrames=function(){this.setFrames(null,null,null,null)};Phaser.Button.prototype.setStateFrame=function(c,d,b){var a="_on"+c+"Frame";if(d!==null){this[a]=d;if(b){this.changeStateFrame(c)}}else{this[a]=null}};Phaser.Button.prototype.changeStateFrame=function(b){if(this.freezeFrames){return false}var a="_on"+b+"Frame";var c=this[a];if(typeof c==="string"){this.frameName=c;return true}else{if(typeof c==="number"){this.frame=c;return true}else{return false}}};Phaser.Button.prototype.setFrames=function(b,d,a,c){this.setStateFrame(STATE_OVER,b,this.input.pointerOver());this.setStateFrame(STATE_OUT,d,!this.input.pointerOver());this.setStateFrame(STATE_DOWN,a,this.input.pointerDown());this.setStateFrame(STATE_UP,c,this.input.pointerUp())};Phaser.Button.prototype.setStateSound=function(c,d,a){var e="on"+c+"Sound";var b="on"+c+"SoundMarker";if(d instanceof Phaser.Sound||d instanceof Phaser.AudioSprite){this[e]=d;this[b]=typeof a==="string"?a:""}else{this[e]=null;this[b]=""}};Phaser.Button.prototype.playStateSound=function(c){var e="on"+c+"Sound";var d=this[e];if(d){var b="on"+c+"SoundMarker";var a=this[b];d.play(a);return true}else{return false}};Phaser.Button.prototype.setSounds=function(b,f,a,e,d,h,c,g){this.setStateSound(STATE_OVER,b,f);this.setStateSound(STATE_OUT,d,h);this.setStateSound(STATE_DOWN,a,e);this.setStateSound(STATE_UP,c,g)};Phaser.Button.prototype.setOverSound=function(b,a){this.setStateSound(STATE_OVER,b,a)};Phaser.Button.prototype.setOutSound=function(b,a){this.setStateSound(STATE_OUT,b,a)};Phaser.Button.prototype.setDownSound=function(b,a){this.setStateSound(STATE_DOWN,b,a)};Phaser.Button.prototype.setUpSound=function(b,a){this.setStateSound(STATE_UP,b,a)};Phaser.Button.prototype.onInputOverHandler=function(a,b){if(b.justReleased()&&(this.justReleasedPreventsOver&b.pointerMode)===b.pointerMode){return}this.changeStateFrame(STATE_OVER);if(this.onOverMouseOnly&&!b.isMouse){return}this.playStateSound(STATE_OVER);if(this.onInputOver){this.onInputOver.dispatch(this,b)}};Phaser.Button.prototype.onInputOutHandler=function(a,b){this.changeStateFrame(STATE_OUT);this.playStateSound(STATE_OUT);if(this.onInputOut){this.onInputOut.dispatch(this,b)}};Phaser.Button.prototype.onInputDownHandler=function(a,b){this.changeStateFrame(STATE_DOWN);this.playStateSound(STATE_DOWN);if(this.onInputDown){this.onInputDown.dispatch(this,b)}};Phaser.Button.prototype.onInputUpHandler=function(a,d,c){this.playStateSound(STATE_UP);if(this.onInputUp){this.onInputUp.dispatch(this,d,c)}if(this.freezeFrames){return}if(this.forceOut===true||(this.forceOut&d.pointerMode)===d.pointerMode){this.changeStateFrame(STATE_OUT)}else{var b=this.changeStateFrame(STATE_UP);if(!b){if(c){this.changeStateFrame(STATE_OVER)}else{this.changeStateFrame(STATE_OUT)}}}};Phaser.SpriteBatch=function(b,d,c,a){if(d===undefined||d===null){d=b.world}Phaser.Group.call(this,b,d,c,a);this.type=Phaser.SPRITEBATCH;this.fastSpriteBatch=null;this.ready=false};Phaser.SpriteBatch.prototype=Object.create(Phaser.Group.prototype);Phaser.SpriteBatch.prototype.constructor=Phaser.SpriteBatch;Phaser.SpriteBatch.prototype._renderWebGL=function(a){if(!this.visible||this.alpha<=0||!this.children.length){return}if(!this.ready){this.fastSpriteBatch=new PIXI.WebGLFastSpriteBatch(a.gl);this.ready=true}if(this.fastSpriteBatch.gl!==a.gl){this.fastSpriteBatch.setContext(a.gl)}a.spriteBatch.stop();a.shaderManager.setShader(a.shaderManager.fastShader);this.fastSpriteBatch.begin(this,a);this.fastSpriteBatch.render(this);a.spriteBatch.start()};Phaser.SpriteBatch.prototype._renderCanvas=function(l){if(!this.visible||this.alpha<=0||!this.children.length){return}var a=l.context;a.globalAlpha=this.worldAlpha;this.displayObjectUpdateTransform();var d=this.worldTransform;var k=true;for(var g=0;g<this.children.length;g++){var b=this.children[g];if(!b.visible){continue}var j=b.texture;var c=j.frame;a.globalAlpha=this.worldAlpha*b.alpha;if(b.rotation%(Math.PI*2)===0){if(k){a.setTransform(d.a,d.b,d.c,d.d,d.tx,d.ty);k=false}a.drawImage(j.baseTexture.source,c.x,c.y,c.width,c.height,((b.anchor.x)*(-c.width*b.scale.x)+b.position.x+0.5+l.shakeX)|0,((b.anchor.y)*(-c.height*b.scale.y)+b.position.y+0.5+l.shakeY)|0,c.width*b.scale.x,c.height*b.scale.y)}else{if(!k){k=true}b.displayObjectUpdateTransform();var h=b.worldTransform;var f=(h.tx*l.resolution)+l.shakeX;var e=(h.ty*l.resolution)+l.shakeY;if(l.roundPixels){a.setTransform(h.a,h.b,h.c,h.d,f|0,e|0)}else{a.setTransform(h.a,h.b,h.c,h.d,f,e)}a.drawImage(j.baseTexture.source,c.x,c.y,c.width,c.height,((b.anchor.x)*(-c.width)+0.5)|0,((b.anchor.y)*(-c.height)+0.5)|0,c.width,c.height)}}};Phaser.BitmapData=function(b,d,e,a,c){if(e===undefined||e===0){e=256}if(a===undefined||a===0){a=256}if(c===undefined){c=false}this.game=b;this.key=d;this.width=e;this.height=a;this.canvas=Phaser.Canvas.create(this,e,a,null,c);this.context=this.canvas.getContext("2d",{alpha:true});this.ctx=this.context;this.smoothProperty=(b.renderType===Phaser.CANVAS)?b.renderer.renderSession.smoothProperty:Phaser.Canvas.getSmoothingPrefix(this.context);this.imageData=this.context.getImageData(0,0,e,a);this.data=null;if(this.imageData){this.data=this.imageData.data}this.pixels=null;if(this.data){if(this.imageData.data.buffer){this.buffer=this.imageData.data.buffer;this.pixels=new Uint32Array(this.buffer)}else{if(window.ArrayBuffer){this.buffer=new ArrayBuffer(this.imageData.data.length);this.pixels=new Uint32Array(this.buffer)}else{this.pixels=this.imageData.data}}}this.baseTexture=new PIXI.BaseTexture(this.canvas,null,this.game.resolution);this.texture=new PIXI.Texture(this.baseTexture);this.frameData=new Phaser.FrameData();this.textureFrame=this.frameData.addFrame(new Phaser.Frame(0,0,0,e,a,"bitmapData"));this.texture.frame=this.textureFrame;this.type=Phaser.BITMAPDATA;this.disableTextureUpload=false;this.dirty=false;this.cls=this.clear;this._image=null;this._pos=new Phaser.Point();this._size=new Phaser.Point();this._scale=new Phaser.Point();this._rotate=0;this._alpha={prev:1,current:1};this._anchor=new Phaser.Point();this._tempR=0;this._tempG=0;this._tempB=0;this._circle=new Phaser.Circle();this._swapCanvas=undefined};Phaser.BitmapData.prototype={move:function(a,c,b){if(a!==0){this.moveH(a,b)}if(c!==0){this.moveV(c,b)}return this},moveH:function(i,e){if(e===undefined){e=true}if(this._swapCanvas===undefined){this._swapCanvas=Phaser.CanvasPool.create(this,this.width,this.height)}var g=this._swapCanvas;var b=g.getContext("2d");var d=this.height;var f=this.canvas;b.clearRect(0,0,this.width,this.height);if(i<0){i=Math.abs(i);var a=this.width-i;if(e){b.drawImage(f,0,0,i,d,a,0,i,d)}b.drawImage(f,i,0,a,d,0,0,a,d)}else{var a=this.width-i;if(e){b.drawImage(f,a,0,i,d,0,0,i,d)}b.drawImage(f,0,0,a,d,i,0,a,d)}this.clear();return this.copy(this._swapCanvas)},moveV:function(i,e){if(e===undefined){e=true}if(this._swapCanvas===undefined){this._swapCanvas=Phaser.CanvasPool.create(this,this.width,this.height)}var g=this._swapCanvas;var b=g.getContext("2d");var a=this.width;var f=this.canvas;b.clearRect(0,0,this.width,this.height);if(i<0){i=Math.abs(i);var d=this.height-i;if(e){b.drawImage(f,0,0,a,i,0,d,a,i)}b.drawImage(f,0,i,a,d,0,0,a,d)}else{var d=this.height-i;if(e){b.drawImage(f,0,d,a,i,0,0,a,i)}b.drawImage(f,0,0,a,d,0,i,a,d)}this.clear();return this.copy(this._swapCanvas)},add:function(a){if(Array.isArray(a)){for(var b=0;b<a.length;b++){if(a[b]["loadTexture"]){a[b].loadTexture(this)}}}else{a.loadTexture(this)}return this},load:function(a){if(typeof a==="string"){a=this.game.cache.getImage(a)}if(a){this.resize(a.width,a.height);this.cls()}else{return}this.draw(a);this.update();return this},clear:function(b,d,c,a){if(b===undefined){b=0}if(d===undefined){d=0}if(c===undefined){c=this.width}if(a===undefined){a=this.height}this.context.clearRect(b,d,c,a);this.dirty=true;return this},fill:function(f,e,c,d){if(d===undefined){d=1}this.context.fillStyle="rgba("+f+","+e+","+c+","+d+")";this.context.fillRect(0,0,this.width,this.height);this.dirty=true;return this},generateTexture:function(c,f,b){var a=this.game.cache;var e=new Image();if(f){e.onload=function(){var h=a.addImage(c,"",e);var g=new PIXI.Texture(h.base);f.call(b||null,g);e.onload=null}}e.src=this.canvas.toDataURL("image/png");if(!f){var d=a.addImage(c,"",e);return new PIXI.Texture(d.base)}return null},resize:function(b,a){if(b!==this.width||a!==this.height){this.width=b;this.height=a;this.canvas.width=b;this.canvas.height=a;if(this._swapCanvas!==undefined){this._swapCanvas.width=b;this._swapCanvas.height=a}this.baseTexture.width=b;this.baseTexture.height=a;this.textureFrame.width=b;this.textureFrame.height=a;this.texture.width=b;this.texture.height=a;this.texture.crop.width=b;this.texture.crop.height=a;this.update();this.dirty=true}return this},update:function(b,d,c,a){if(b===undefined){b=0}if(d===undefined){d=0}if(c===undefined){c=Math.max(1,this.width)}if(a===undefined){a=Math.max(1,this.height)}this.imageData=this.context.getImageData(b,d,c,a);this.data=this.imageData.data;if(this.imageData.data.buffer){this.buffer=this.imageData.data.buffer;this.pixels=new Uint32Array(this.buffer)}else{if(window.ArrayBuffer){this.buffer=new ArrayBuffer(this.imageData.data.length);this.pixels=new Uint32Array(this.buffer)}else{this.pixels=this.imageData.data}}return this},processPixelRGB:function(l,d,j,i,c,m){if(j===undefined){j=0}if(i===undefined){i=0}if(c===undefined){c=this.width}if(m===undefined){m=this.height}var k=j+c;var g=i+m;var b=Phaser.Color.createColor();var n={r:0,g:0,b:0,a:0};var a=false;for(var e=i;e<g;e++){for(var f=j;f<k;f++){Phaser.Color.unpackPixel(this.getPixel32(f,e),b);n=l.call(d,b,f,e);if(n!==false&&n!==null&&n!==undefined){this.setPixel32(f,e,n.r,n.g,n.b,n.a,false);a=true}}}if(a){this.context.putImageData(this.imageData,0,0);this.dirty=true}return this},processPixel:function(l,d,j,i,c,m){if(j===undefined){j=0}if(i===undefined){i=0}if(c===undefined){c=this.width}if(m===undefined){m=this.height}var k=j+c;var g=i+m;var b=0;var n=0;var a=false;for(var e=i;e<g;e++){for(var f=j;f<k;f++){b=this.getPixel32(f,e);n=l.call(d,b,f,e);if(n!==b){this.pixels[e*this.width+f]=n;a=true}}}if(a){this.context.putImageData(this.imageData,0,0);this.dirty=true}return this},replaceRGB:function(f,b,o,d,e,q,l,c,k){var n=0;var j=0;var p=this.width;var g=this.height;var a=Phaser.Color.packPixel(f,b,o,d);if(k!==undefined&&k instanceof Phaser.Rectangle){n=k.x;j=k.y;p=k.width;g=k.height}for(var i=0;i<g;i++){for(var m=0;m<p;m++){if(this.getPixel32(n+m,j+i)===a){this.setPixel32(n+m,j+i,e,q,l,c,false)}}}this.context.putImageData(this.imageData,0,0);this.dirty=true;return this},setHSL:function(d,k,b,f){var j=d||d===0;var c=k||k===0;var g=b||b===0;if(!j&&!c&&!g){return}if(f===undefined){f=new Phaser.Rectangle(0,0,this.width,this.height)}var a=Phaser.Color.createColor();for(var e=f.y;e<f.bottom;e++){for(var i=f.x;i<f.right;i++){Phaser.Color.unpackPixel(this.getPixel32(i,e),a,true);if(j){a.h=d}if(c){a.s=k}if(g){a.l=b}Phaser.Color.HSLtoRGB(a.h,a.s,a.l,a);this.setPixel32(i,e,a.r,a.g,a.b,a.a,false)}}this.context.putImageData(this.imageData,0,0);this.dirty=true;return this},shiftHSL:function(e,d,b,f){if(e===undefined||e===null){e=false}if(d===undefined||d===null){d=false}if(b===undefined||b===null){b=false}if(!e&&!d&&!b){return}if(f===undefined){f=new Phaser.Rectangle(0,0,this.width,this.height)}var c=Phaser.Color.createColor();for(var g=f.y;g<f.bottom;g++){for(var a=f.x;a<f.right;a++){Phaser.Color.unpackPixel(this.getPixel32(a,g),c,true);if(e){c.h=this.game.math.wrap(c.h+e,0,1)}if(d){c.s=this.game.math.clamp(c.s+d,0,1)}if(b){c.l=this.game.math.clamp(c.l+b,0,1)}Phaser.Color.HSLtoRGB(c.h,c.s,c.l,c);this.setPixel32(a,g,c.r,c.g,c.b,c.a,false)}}this.context.putImageData(this.imageData,0,0);this.dirty=true;return this},setPixel32:function(b,g,f,d,a,e,c){if(c===undefined){c=true}if(b>=0&&b<=this.width&&g>=0&&g<=this.height){if(Phaser.Device.LITTLE_ENDIAN){this.pixels[g*this.width+b]=(e<<24)|(a<<16)|(d<<8)|f}else{this.pixels[g*this.width+b]=(f<<24)|(d<<16)|(a<<8)|e}if(c){this.context.putImageData(this.imageData,0,0);this.dirty=true}}return this},setPixel:function(b,f,e,d,a,c){return this.setPixel32(b,f,e,d,a,255,c)},getPixel:function(a,d,c){if(!c){c=Phaser.Color.createColor()}var b=~~(a+(d*this.width));b*=4;c.r=this.data[b];c.g=this.data[++b];c.b=this.data[++b];c.a=this.data[++b];return c},getPixel32:function(a,b){if(a>=0&&a<=this.width&&b>=0&&b<=this.height){return this.pixels[b*this.width+a]}},getPixelRGB:function(a,e,d,b,c){return Phaser.Color.unpackPixel(this.getPixel32(a,e),d,b,c)},getPixels:function(a){return this.context.getImageData(a.x,a.y,a.width,a.height)},getFirstPixel:function(e){if(e===undefined){e=0}var d=Phaser.Color.createColor();var a=0;var f=0;var c=1;var b=false;if(e===1){c=-1;f=this.height}else{if(e===3){c=-1;a=this.width}}do{Phaser.Color.unpackPixel(this.getPixel32(a,f),d);if(e===0||e===1){a++;if(a===this.width){a=0;f+=c;if(f>=this.height||f<=0){b=true}}}else{if(e===2||e===3){f++;if(f===this.height){f=0;a+=c;if(a>=this.width||a<=0){b=true}}}}}while(d.a===0&&!b);d.x=a;d.y=f;return d},getBounds:function(a){if(a===undefined){a=new Phaser.Rectangle()}a.x=this.getFirstPixel(2).x;if(a.x===this.width){return a.setTo(0,0,0,0)}a.y=this.getFirstPixel(0).y;a.width=(this.getFirstPixel(3).x-a.x)+1;a.height=(this.getFirstPixel(1).y-a.y)+1;return a},addToWorld:function(b,g,a,f,d,c){d=d||1;c=c||1;var e=this.game.add.image(b,g,this);e.anchor.set(a,f);e.scale.set(d,c);return e},copy:function(j,f,e,i,h,q,p,g,l,m,b,a,o,n,c,r,d){if(j===undefined||j===null){j=this}if(j instanceof Phaser.RenderTexture){j=j.getCanvas()}this._image=j;if(j instanceof Phaser.Sprite||j instanceof Phaser.Image||j instanceof Phaser.Text||j instanceof PIXI.Sprite){this._pos.set(j.texture.crop.x,j.texture.crop.y);this._size.set(j.texture.crop.width,j.texture.crop.height);this._scale.set(j.scale.x,j.scale.y);this._anchor.set(j.anchor.x,j.anchor.y);this._rotate=j.rotation;this._alpha.current=j.alpha;if(j.texture instanceof Phaser.RenderTexture){this._image=j.texture.getCanvas()}else{this._image=j.texture.baseTexture.source}if(q===undefined||q===null){q=j.x}if(p===undefined||p===null){p=j.y}if(j.texture.trim){q+=j.texture.trim.x-j.anchor.x*j.texture.trim.width;p+=j.texture.trim.y-j.anchor.y*j.texture.trim.height}if(j.tint!==16777215){if(j.cachedTint!==j.tint){j.cachedTint=j.tint;j.tintedTexture=PIXI.CanvasTinter.getTintedTexture(j,j.tint)}this._image=j.tintedTexture;this._pos.set(0)}}else{this._pos.set(0);this._scale.set(1);this._anchor.set(0);this._rotate=0;this._alpha.current=1;if(j instanceof Phaser.BitmapData){this._image=j.canvas}else{if(typeof j==="string"){j=this.game.cache.getImage(j);if(j===null){return}else{this._image=j}}}this._size.set(this._image.width,this._image.height)}if(f===undefined||f===null){f=0}if(e===undefined||e===null){e=0}if(i){this._size.x=i}if(h){this._size.y=h}if(q===undefined||q===null){q=f}if(p===undefined||p===null){p=e}if(g===undefined||g===null){g=this._size.x}if(l===undefined||l===null){l=this._size.y}if(typeof m==="number"){this._rotate=m}if(typeof b==="number"){this._anchor.x=b}if(typeof a==="number"){this._anchor.y=a}if(typeof o==="number"){this._scale.x=o}if(typeof n==="number"){this._scale.y=n}if(typeof c==="number"){this._alpha.current=c}if(r===undefined){r=null}if(d===undefined){d=false}if(this._alpha.current<=0||this._scale.x===0||this._scale.y===0||this._size.x===0||this._size.y===0){return}var k=this.context;this._alpha.prev=k.globalAlpha;k.save();k.globalAlpha=this._alpha.current;if(r){this.op=r}if(d){q|=0;p|=0}k.translate(q,p);k.scale(this._scale.x,this._scale.y);k.rotate(this._rotate);k.drawImage(this._image,this._pos.x+f,this._pos.y+e,this._size.x,this._size.y,-g*this._anchor.x,-l*this._anchor.y,g,l);k.restore();k.globalAlpha=this._alpha.prev;this.dirty=true;return this},copyTransform:function(g,f,e){if(f===undefined){f=null}if(e===undefined){e=false}if(!g.hasOwnProperty("worldTransform")||!g.worldVisible||g.worldAlpha===0){return this}var b=g.worldTransform;this._pos.set(g.texture.crop.x,g.texture.crop.y);this._size.set(g.texture.crop.width,g.texture.crop.height);if(b.a===0||b.d===0||this._size.x===0||this._size.y===0){return this}if(g.texture instanceof Phaser.RenderTexture){this._image=g.texture.getCanvas()}else{this._image=g.texture.baseTexture.source}var d=b.tx;var a=b.ty;if(g.texture.trim){d+=g.texture.trim.x-g.anchor.x*g.texture.trim.width;a+=g.texture.trim.y-g.anchor.y*g.texture.trim.height}if(g.tint!==16777215){if(g.cachedTint!==g.tint){g.cachedTint=g.tint;g.tintedTexture=PIXI.CanvasTinter.getTintedTexture(g,g.tint)}this._image=g.tintedTexture;this._pos.set(0)}if(e){d|=0;a|=0}var c=this.context;this._alpha.prev=c.globalAlpha;c.save();c.globalAlpha=this._alpha.current;if(f){this.op=f}c[this.smoothProperty]=(g.texture.baseTexture.scaleMode===PIXI.scaleModes.LINEAR);c.setTransform(b.a,b.b,b.c,b.d,d,a);c.drawImage(this._image,this._pos.x,this._pos.y,this._size.x,this._size.y,-this._size.x*g.anchor.x,-this._size.y*g.anchor.y,this._size.x,this._size.y);c.restore();c.globalAlpha=this._alpha.prev;this.dirty=true;return this},copyRect:function(e,d,a,g,f,c,b){return this.copy(e,d.x,d.y,d.width,d.height,a,g,d.width,d.height,0,0,0,1,1,f,c,b)},draw:function(f,b,g,e,a,d,c){return this.copy(f,null,null,null,null,b,g,e,a,null,null,null,null,null,null,d,c)},drawGroup:function(c,b,a){if(c.total>0){c.forEachExists(this.drawGroupProxy,this,b,a)}return this},drawGroupProxy:function(d,c,b){if(d.hasOwnProperty("texture")){this.copyTransform(d,c,b)}if(d.type===Phaser.GROUP&&d.exists){this.drawGroup(d,c,b)}else{if(d.hasOwnProperty("children")&&d.children.length>0){for(var a=0;a<d.children.length;a++){if(d.children[a].exists){this.copyTransform(d.children[a],c,b)}}}}},drawFull:function(d,c,b){if(d.worldVisible===false||d.worldAlpha===0||(d.hasOwnProperty("exists")&&d.exists===false)){return this}if(d.type!==Phaser.GROUP&&d.type!==Phaser.EMITTER&&d.type!==Phaser.BITMAPTEXT){if(d.type===Phaser.GRAPHICS){var e=d.getBounds();this.ctx.save();this.ctx.translate(e.x,e.y);PIXI.CanvasGraphics.renderGraphics(d,this.ctx);this.ctx.restore()}else{this.copy(d,null,null,null,null,d.worldPosition.x,d.worldPosition.y,null,null,d.worldRotation,null,null,d.worldScale.x,d.worldScale.y,d.worldAlpha,c,b)}}if(d.children){for(var a=0;a<d.children.length;a++){this.drawFull(d.children[a],c,b)}}return this},shadow:function(c,d,a,e){var b=this.context;if(c===undefined||c===null){b.shadowColor="rgba(0,0,0,0)"}else{b.shadowColor=c;b.shadowBlur=d||5;b.shadowOffsetX=a||10;b.shadowOffsetY=e||10}return this},alphaMask:function(d,a,b,c){if(c===undefined||c===null){this.draw(a).blendSourceAtop()}else{this.draw(a,c.x,c.y,c.width,c.height).blendSourceAtop()}if(b===undefined||b===null){this.draw(d).blendReset()}else{this.draw(d,b.x,b.y,b.width,b.height).blendReset()}return this},extract:function(i,c,f,j,k,d,e,l,h){if(k===undefined){k=255}if(d===undefined){d=false}if(e===undefined){e=c}if(l===undefined){l=f}if(h===undefined){h=j}if(d){i.resize(this.width,this.height)}this.processPixelRGB(function(b,a,g){if(b.r===c&&b.g===f&&b.b===j){i.setPixel32(a,g,e,l,h,k,false)}return false},this);i.context.putImageData(i.imageData,0,0);i.dirty=true;return i},rect:function(b,e,d,a,c){if(typeof c!=="undefined"){this.context.fillStyle=c}this.context.fillRect(b,e,d,a);return this},text:function(f,a,h,d,c,g){if(a===undefined){a=0}if(h===undefined){h=0}if(d===undefined){d="14px Courier"}if(c===undefined){c="rgb(255,255,255)"}if(g===undefined){g=true}var b=this.context;var e=b.font;b.font=d;if(g){b.fillStyle="rgb(0,0,0)";b.fillText(f,a+1,h+1)}b.fillStyle=c;b.fillText(f,a,h);b.font=e;return this},circle:function(b,e,a,d){var c=this.context;if(d!==undefined){c.fillStyle=d}c.beginPath();c.arc(b,e,a,0,Math.PI*2,false);c.closePath();c.fill();return this},line:function(d,g,c,e,b,f){if(b===undefined){b="#fff"}if(f===undefined){f=1}var a=this.context;a.beginPath();a.moveTo(d,g);a.lineTo(c,e);a.lineWidth=f;a.strokeStyle=b;a.stroke();a.closePath();return this},textureLine:function(b,e,d){if(d===undefined){d="repeat-x"}if(typeof e==="string"){e=this.game.cache.getImage(e);if(!e){return}}var c=b.length;if(d==="no-repeat"&&c>e.width){c=e.width}var a=this.context;a.fillStyle=a.createPattern(e,d);this._circle=new Phaser.Circle(b.start.x,b.start.y,e.height);this._circle.circumferencePoint(b.angle-1.5707963267948966,false,this._pos);a.save();a.translate(this._pos.x,this._pos.y);a.rotate(b.angle);a.fillRect(0,0,c,e.height);a.restore();this.dirty=true;return this},render:function(){if(!this.disableTextureUpload&&this.dirty){this.baseTexture.dirty();this.dirty=false}return this},destroy:function(){this.frameData.destroy();this.texture.destroy(true);Phaser.CanvasPool.remove(this)},blendReset:function(){this.op="source-over";return this},blendSourceOver:function(){this.op="source-over";return this},blendSourceIn:function(){this.op="source-in";return this},blendSourceOut:function(){this.op="source-out";return this},blendSourceAtop:function(){this.op="source-atop";return this},blendDestinationOver:function(){this.op="destination-over";return this},blendDestinationIn:function(){this.op="destination-in";return this},blendDestinationOut:function(){this.op="destination-out";return this},blendDestinationAtop:function(){this.op="destination-atop";return this},blendXor:function(){this.op="xor";return this},blendAdd:function(){this.op="lighter";return this},blendMultiply:function(){this.op="multiply";return this},blendScreen:function(){this.op="screen";return this},blendOverlay:function(){this.op="overlay";return this},blendDarken:function(){this.op="darken";return this},blendLighten:function(){this.op="lighten";return this},blendColorDodge:function(){this.op="color-dodge";return this},blendColorBurn:function(){this.op="color-burn";return this},blendHardLight:function(){this.op="hard-light";return this},blendSoftLight:function(){this.op="soft-light";return this},blendDifference:function(){this.op="difference";return this},blendExclusion:function(){this.op="exclusion";return this},blendHue:function(){this.op="hue";return this},blendSaturation:function(){this.op="saturation";return this},blendColor:function(){this.op="color";return this},blendLuminosity:function(){this.op="luminosity";return this},copyBitmapData:function(d,a,f){d.update();for(var c=0,e;c<d.height;c++){e=(f+c)*this.width+a;for(var b=0;b<d.width;b++){this.pixels[e+b]=d.pixels[c*d.width+b]}}return this}};Object.defineProperty(Phaser.BitmapData.prototype,"smoothed",{get:function(){Phaser.Canvas.getSmoothingEnabled(this.context)},set:function(a){Phaser.Canvas.setSmoothingEnabled(this.context,a)}});Object.defineProperty(Phaser.BitmapData.prototype,"op",{get:function(){return this.context.globalCompositeOperation},set:function(a){this.context.globalCompositeOperation=a}});Phaser.BitmapData.getTransform=function(f,e,c,a,d,b){if(typeof f!=="number"){f=0}if(typeof e!=="number"){e=0}if(typeof c!=="number"){c=1}if(typeof a!=="number"){a=1}if(typeof d!=="number"){d=0}if(typeof b!=="number"){b=0}return{sx:c,sy:a,scaleX:c,scaleY:a,skewX:d,skewY:b,translateX:f,translateY:e,tx:f,ty:e}};Phaser.BitmapData.prototype.constructor=Phaser.BitmapData;Phaser.EarCut={};Phaser.EarCut.Triangulate=function(h,m,j){j=j||2;var k=m&&m.length,f=k?m[0]*j:h.length,l=Phaser.EarCut.linkedList(h,0,f,j,true),d=[];if(!l){return d}var e,c,b,a,o,n,p;if(k){l=Phaser.EarCut.eliminateHoles(h,m,l,j)}if(h.length>80*j){e=b=h[0];c=a=h[1];for(var g=j;g<f;g+=j){o=h[g];n=h[g+1];if(o<e){e=o}if(n<c){c=n}if(o>b){b=o}if(n>a){a=n}}p=Math.max(b-e,a-c)}Phaser.EarCut.earcutLinked(l,d,j,e,c,p);return d};Phaser.EarCut.linkedList=function(e,b,c,g,a){var h=0,f,d,k;for(f=b,d=c-g;f<c;f+=g){h+=(e[d]-e[f])*(e[f+1]+e[d+1]);d=f}if(a===(h>0)){for(f=b;f<c;f+=g){k=Phaser.EarCut.insertNode(f,e[f],e[f+1],k)}}else{for(f=c-g;f>=b;f-=g){k=Phaser.EarCut.insertNode(f,e[f],e[f+1],k)}}return k};Phaser.EarCut.filterPoints=function(d,a){if(!d){return d}if(!a){a=d}var c=d,b;do{b=false;if(!c.steiner&&(Phaser.EarCut.equals(c,c.next)||Phaser.EarCut.area(c.prev,c,c.next)===0)){Phaser.EarCut.removeNode(c);c=a=c.prev;if(c===c.next){return null}b=true}else{c=c.next}}while(b||c!==a);return a};Phaser.EarCut.earcutLinked=function(b,d,g,e,a,j,i){if(!b){return}if(!i&&j){Phaser.EarCut.indexCurve(b,e,a,j)}var h=b,c,f;while(b.prev!==b.next){c=b.prev;f=b.next;if(j?Phaser.EarCut.isEarHashed(b,e,a,j):Phaser.EarCut.isEar(b)){d.push(c.i/g);d.push(b.i/g);d.push(f.i/g);Phaser.EarCut.removeNode(b);b=f.next;h=f.next;continue}b=f;if(b===h){if(!i){Phaser.EarCut.earcutLinked(Phaser.EarCut.filterPoints(b),d,g,e,a,j,1)}else{if(i===1){b=Phaser.EarCut.cureLocalIntersections(b,d,g);Phaser.EarCut.earcutLinked(b,d,g,e,a,j,2)}else{if(i===2){Phaser.EarCut.splitEarcut(b,d,g,e,a,j)}}}break}}};Phaser.EarCut.isEar=function(f){var e=f.prev,d=f,h=f.next;if(Phaser.EarCut.area(e,d,h)>=0){return false}var g=f.next.next;while(g!==f.prev){if(Phaser.EarCut.pointInTriangle(e.x,e.y,d.x,d.y,h.x,h.y,g.x,g.y)&&Phaser.EarCut.area(g.prev,g,g.next)>=0){return false}g=g.next}return true};Phaser.EarCut.isEarHashed=function(i,j,h,q){var m=i.prev,l=i,k=i.next;if(Phaser.EarCut.area(m,l,k)>=0){return false}var r=m.x<l.x?(m.x<k.x?m.x:k.x):(l.x<k.x?l.x:k.x),n=m.y<l.y?(m.y<k.y?m.y:k.y):(l.y<k.y?l.y:k.y),g=m.x>l.x?(m.x>k.x?m.x:k.x):(l.x>k.x?l.x:k.x),f=m.y>l.y?(m.y>k.y?m.y:k.y):(l.y>k.y?l.y:k.y);var e=Phaser.EarCut.zOrder(r,n,j,h,q),o=Phaser.EarCut.zOrder(g,f,j,h,q);var d=i.nextZ;while(d&&d.z<=o){if(d!==i.prev&&d!==i.next&&Phaser.EarCut.pointInTriangle(m.x,m.y,l.x,l.y,k.x,k.y,d.x,d.y)&&Phaser.EarCut.area(d.prev,d,d.next)>=0){return false}d=d.nextZ}d=i.prevZ;while(d&&d.z>=e){if(d!==i.prev&&d!==i.next&&Phaser.EarCut.pointInTriangle(m.x,m.y,l.x,l.y,k.x,k.y,d.x,d.y)&&Phaser.EarCut.area(d.prev,d,d.next)>=0){return false}d=d.prevZ}return true};Phaser.EarCut.cureLocalIntersections=function(h,e,g){var f=h;do{var d=f.prev,c=f.next.next;if(Phaser.EarCut.intersects(d,f,f.next,c)&&Phaser.EarCut.locallyInside(d,c)&&Phaser.EarCut.locallyInside(c,d)){e.push(d.i/g);e.push(f.i/g);e.push(c.i/g);Phaser.EarCut.removeNode(f);Phaser.EarCut.removeNode(f.next);f=h=c}f=f.next}while(f!==h);return f};Phaser.EarCut.splitEarcut=function(d,f,h,g,e,l){var k=d;do{var j=k.next.next;while(j!==k.prev){if(k.i!==j.i&&Phaser.EarCut.isValidDiagonal(k,j)){var i=Phaser.EarCut.splitPolygon(k,j);k=Phaser.EarCut.filterPoints(k,k.next);i=Phaser.EarCut.filterPoints(i,i.next);Phaser.EarCut.earcutLinked(k,f,h,g,e,l);Phaser.EarCut.earcutLinked(i,f,h,g,e,l);return}j=j.next}k=k.next}while(k!==d)};Phaser.EarCut.eliminateHoles=function(c,k,f,e){var g=[],d,h,a,b,j;for(d=0,h=k.length;d<h;d++){a=k[d]*e;b=d<h-1?k[d+1]*e:c.length;j=Phaser.EarCut.linkedList(c,a,b,e,false);if(j===j.next){j.steiner=true}g.push(Phaser.EarCut.getLeftmost(j))}g.sort(compareX);for(d=0;d<g.length;d++){Phaser.EarCut.eliminateHole(g[d],f);f=Phaser.EarCut.filterPoints(f,f.next)}return f};Phaser.EarCut.compareX=function(d,c){return d.x-c.x};Phaser.EarCut.eliminateHole=function(d,c){c=Phaser.EarCut.findHoleBridge(d,c);if(c){var a=Phaser.EarCut.splitPolygon(c,d);Phaser.EarCut.filterPoints(a,a.next)}};Phaser.EarCut.findHoleBridge=function(a,e){var b=e,g=a.x,f=a.y,d=-Infinity,c;do{if(f<=b.y&&f>=b.next.y){var j=b.x+(f-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(j<=g&&j>d){d=j;c=b.x<b.next.x?b:b.next}}b=b.next}while(b!==e);if(!c){return null}if(a.x===c.x){return c.prev}var i=c,k=Infinity,h;b=c.next;while(b!==i){if(g>=b.x&&b.x>=c.x&&Phaser.EarCut.pointInTriangle(f<c.y?g:d,f,c.x,c.y,f<c.y?d:g,f,b.x,b.y)){h=Math.abs(f-b.y)/(g-b.x);if((h<k||(h===k&&b.x>c.x))&&Phaser.EarCut.locallyInside(b,a)){c=b;k=h}}b=b.next}return c};Phaser.EarCut.indexCurve=function(e,a,d,b){var c=e;do{if(c.z===null){c.z=Phaser.EarCut.zOrder(c.x,c.y,a,d,b)}c.prevZ=c.prev;c.nextZ=c.next;c=c.next}while(c!==e);c.prevZ.nextZ=null;c.prevZ=null;Phaser.EarCut.sortLinked(c)};Phaser.EarCut.sortLinked=function(h){var d,c,b,g,j,a,k,f,l=1;do{c=h;h=null;j=null;a=0;while(c){a++;b=c;k=0;for(d=0;d<l;d++){k++;b=b.nextZ;if(!b){break}}f=l;while(k>0||(f>0&&b)){if(k===0){g=b;b=b.nextZ;f--}else{if(f===0||!b){g=c;c=c.nextZ;k--}else{if(c.z<=b.z){g=c;c=c.nextZ;k--}else{g=b;b=b.nextZ;f--}}}if(j){j.nextZ=g}else{h=g}g.prevZ=j;j=g}c=b}j.nextZ=null;l*=2}while(a>1);return h};Phaser.EarCut.zOrder=function(b,e,a,d,c){b=32767*(b-a)/c;e=32767*(e-d)/c;b=(b|(b<<8))&16711935;b=(b|(b<<4))&252645135;b=(b|(b<<2))&858993459;b=(b|(b<<1))&1431655765;e=(e|(e<<8))&16711935;e=(e|(e<<4))&252645135;e=(e|(e<<2))&858993459;e=(e|(e<<1))&1431655765;return b|(e<<1)};Phaser.EarCut.getLeftmost=function(c){var b=c,a=c;do{if(b.x<a.x){a=b}b=b.next}while(b!==c);return a};Phaser.EarCut.pointInTriangle=function(e,d,g,f,a,h,c,b){return(a-c)*(d-b)-(e-c)*(h-b)>=0&&(e-c)*(f-b)-(g-c)*(d-b)>=0&&(g-c)*(h-b)-(a-c)*(f-b)>=0};Phaser.EarCut.isValidDiagonal=function(d,c){return Phaser.EarCut.equals(d,c)||d.next.i!==c.i&&d.prev.i!==c.i&&!Phaser.EarCut.intersectsPolygon(d,c)&&Phaser.EarCut.locallyInside(d,c)&&Phaser.EarCut.locallyInside(c,d)&&Phaser.EarCut.middleInside(d,c)};Phaser.EarCut.area=function(c,b,a){return(b.y-c.y)*(a.x-b.x)-(b.x-c.x)*(a.y-b.y)};Phaser.EarCut.equals=function(b,a){return b.x===a.x&&b.y===a.y};Phaser.EarCut.intersects=function(c,a,b,d){return Phaser.EarCut.area(c,a,b)>0!==Phaser.EarCut.area(c,a,d)>0&&Phaser.EarCut.area(b,d,c)>0!==Phaser.EarCut.area(b,d,a)>0};Phaser.EarCut.intersectsPolygon=function(d,c){var e=d;do{if(e.i!==d.i&&e.next.i!==d.i&&e.i!==c.i&&e.next.i!==c.i&&Phaser.EarCut.intersects(e,e.next,d,c)){return true}e=e.next}while(e!==d);return false};Phaser.EarCut.locallyInside=function(d,c){return Phaser.EarCut.area(d.prev,d,d.next)<0?Phaser.EarCut.area(d,c,d.next)>=0&&Phaser.EarCut.area(d,d.prev,c)>=0:Phaser.EarCut.area(d,c,d.prev)<0||Phaser.EarCut.area(d,d.next,c)<0};Phaser.EarCut.middleInside=function(e,d){var h=e,c=false,g=(e.x+d.x)/2,f=(e.y+d.y)/2;do{if(((h.y>f)!==(h.next.y>f))&&(g<(h.next.x-h.x)*(f-h.y)/(h.next.y-h.y)+h.x)){c=!c}h=h.next}while(h!==e);return c};Phaser.EarCut.splitPolygon=function(e,d){var c=new Phaser.EarCut.Node(e.i,e.x,e.y),f=new Phaser.EarCut.Node(d.i,d.x,d.y),h=e.next,g=d.prev;e.next=d;d.prev=e;c.next=h;h.prev=c;f.next=c;c.prev=f;g.next=f;f.prev=g;return f};Phaser.EarCut.insertNode=function(b,a,e,c){var d=new Phaser.EarCut.Node(b,a,e);if(!c){d.prev=d;d.next=d}else{d.next=c.next;d.prev=c;c.next.prev=d;c.next=d}return d};Phaser.EarCut.removeNode=function(a){a.next.prev=a.prev;a.prev.next=a.next;if(a.prevZ){a.prevZ.nextZ=a.nextZ}if(a.nextZ){a.nextZ.prevZ=a.prevZ}};Phaser.EarCut.Node=function(b,a,c){this.i=b;this.x=a;this.y=c;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false};PIXI.WebGLGraphics=function(){};PIXI.WebGLGraphics.stencilBufferLimit=6;PIXI.WebGLGraphics.renderGraphics=function(h,j){var c=j.gl;var f=j.projection,a=j.offset,e=j.shaderManager.primitiveShader,d;if(h.dirty){PIXI.WebGLGraphics.updateGraphics(h,c)}var g=h._webGL[c.id];if(!g){return}for(var b=0;b<g.data.length;b++){if(g.data[b].mode===1){d=g.data[b];j.stencilManager.pushStencil(h,d,j);c.drawElements(c.TRIANGLE_FAN,4,c.UNSIGNED_SHORT,(d.indices.length-4)*2);j.stencilManager.popStencil(h,d,j)}else{d=g.data[b];j.shaderManager.setShader(e);e=j.shaderManager.primitiveShader;c.uniformMatrix3fv(e.translationMatrix,false,h.worldTransform.toArray(true));c.uniform1f(e.flipY,1);c.uniform2f(e.projectionVector,f.x,-f.y);c.uniform2f(e.offsetVector,-a.x,-a.y);c.uniform3fv(e.tintColor,Phaser.Color.hexToRGBArray(h.tint));c.uniform1f(e.alpha,h.worldAlpha);c.bindBuffer(c.ARRAY_BUFFER,d.buffer);c.vertexAttribPointer(e.aVertexPosition,2,c.FLOAT,false,4*6,0);c.vertexAttribPointer(e.colorAttribute,4,c.FLOAT,false,4*6,2*4);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,d.indexBuffer);c.drawElements(c.TRIANGLE_STRIP,d.indices.length,c.UNSIGNED_SHORT,0)}}};PIXI.WebGLGraphics.updateGraphics=function(a,g){var e=a._webGL[g.id];if(!e){e=a._webGL[g.id]={lastIndex:0,data:[],gl:g}}a.dirty=false;var b;if(a.clearDirty){a.clearDirty=false;for(b=0;b<e.data.length;b++){var h=e.data[b];h.reset();PIXI.WebGLGraphics.graphicsDataPool.push(h)}e.data=[];e.lastIndex=0}var f;for(b=e.lastIndex;b<a.graphicsData.length;b++){var d=a.graphicsData[b];if(d.type===Phaser.POLYGON){d.points=d.shape.points.slice();if(d.shape.closed){if(d.points[0]!==d.points[d.points.length-2]||d.points[1]!==d.points[d.points.length-1]){d.points.push(d.points[0],d.points[1])}}if(d.fill){if(d.points.length>=PIXI.WebGLGraphics.stencilBufferLimit){if(d.points.length<PIXI.WebGLGraphics.stencilBufferLimit*2){f=PIXI.WebGLGraphics.switchMode(e,0);var c=PIXI.WebGLGraphics.buildPoly(d,f);if(!c){f=PIXI.WebGLGraphics.switchMode(e,1);PIXI.WebGLGraphics.buildComplexPoly(d,f)}}else{f=PIXI.WebGLGraphics.switchMode(e,1);PIXI.WebGLGraphics.buildComplexPoly(d,f)}}}if(d.lineWidth>0){f=PIXI.WebGLGraphics.switchMode(e,0);PIXI.WebGLGraphics.buildLine(d,f)}}else{f=PIXI.WebGLGraphics.switchMode(e,0);if(d.type===Phaser.RECTANGLE){PIXI.WebGLGraphics.buildRectangle(d,f)}else{if(d.type===Phaser.CIRCLE||d.type===Phaser.ELLIPSE){PIXI.WebGLGraphics.buildCircle(d,f)}else{if(d.type===Phaser.ROUNDEDRECTANGLE){PIXI.WebGLGraphics.buildRoundedRectangle(d,f)}}}}e.lastIndex++}for(b=0;b<e.data.length;b++){f=e.data[b];if(f.dirty){f.upload()}}};PIXI.WebGLGraphics.switchMode=function(b,a){var c;if(!b.data.length){c=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(b.gl);c.mode=a;b.data.push(c)}else{c=b.data[b.data.length-1];if(c.mode!==a||a===1){c=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(b.gl);c.mode=a;b.data.push(c)}}c.dirty=true;return c};PIXI.WebGLGraphics.buildRectangle=function(s,h){var e=s.shape;var n=e.x;var m=e.y;var c=e.width;var q=e.height;if(s.fill){var f=Phaser.Color.hexToRGBArray(s.fillColor);var d=s.fillAlpha;var a=f[0]*d;var i=f[1]*d;var l=f[2]*d;var o=h.points;var p=h.indices;var k=o.length/6;o.push(n,m);o.push(a,i,l,d);o.push(n+c,m);o.push(a,i,l,d);o.push(n,m+q);o.push(a,i,l,d);o.push(n+c,m+q);o.push(a,i,l,d);p.push(k,k,k+1,k+2,k+3,k+3)}if(s.lineWidth){var j=s.points;s.points=[n,m,n+c,m,n+c,m+q,n,m+q,n,m];PIXI.WebGLGraphics.buildLine(s,h);s.points=j}};PIXI.WebGLGraphics.buildRoundedRectangle=function(l,z){var a=l.shape;var k=a.x;var j=a.y;var p=a.width;var o=a.height;var d=a.radius;var m=[];m.push(k,j+d);m=m.concat(PIXI.WebGLGraphics.quadraticBezierCurve(k,j+o-d,k,j+o,k+d,j+o));m=m.concat(PIXI.WebGLGraphics.quadraticBezierCurve(k+p-d,j+o,k+p,j+o,k+p,j+o-d));m=m.concat(PIXI.WebGLGraphics.quadraticBezierCurve(k+p,j+d,k+p,j,k+p-d,j));m=m.concat(PIXI.WebGLGraphics.quadraticBezierCurve(k+d,j,k,j,k,j+d));if(l.fill){var s=Phaser.Color.hexToRGBArray(l.fillColor);var e=l.fillAlpha;var n=s[0]*e;var u=s[1]*e;var v=s[2]*e;var w=z.points;var f=z.indices;var c=w.length/6;var q=Phaser.EarCut.Triangulate(m,null,2);var t=0;for(t=0;t<q.length;t+=3){f.push(q[t]+c);f.push(q[t]+c);f.push(q[t+1]+c);f.push(q[t+2]+c);f.push(q[t+2]+c)}for(t=0;t<m.length;t++){w.push(m[t],m[++t],n,u,v,e)}}if(l.lineWidth){var h=l.points;l.points=m;PIXI.WebGLGraphics.buildLine(l,z);l.points=h}};PIXI.WebGLGraphics.quadraticBezierCurve=function(q,l,o,g,r,m){var b,h,t,f,p,k,c=20,s=[];function a(n,j,i){var u=j-n;return n+(u*i)}var d=0;for(var e=0;e<=c;e++){d=e/c;b=a(q,o,d);h=a(l,g,d);t=a(o,r,d);f=a(g,m,d);p=a(b,t,d);k=a(h,f,d);s.push(p,k)}return s};PIXI.WebGLGraphics.buildCircle=function(j,w){var s=j.shape;var h=s.x;var f=s.y;var n;var m;if(j.type===Phaser.CIRCLE){n=s.radius;m=s.radius}else{n=s.width;m=s.height}var k=40;var t=(Math.PI*2)/k;var p=0;if(j.fill){var o=Phaser.Color.hexToRGBArray(j.fillColor);var c=j.fillAlpha;var l=o[0]*c;var q=o[1]*c;var u=o[2]*c;var v=w.points;var d=w.indices;var a=v.length/6;d.push(a);for(p=0;p<k+1;p++){v.push(h,f,l,q,u,c);v.push(h+Math.sin(t*p)*n,f+Math.cos(t*p)*m,l,q,u,c);d.push(a++,a++)}d.push(a-1)}if(j.lineWidth){var e=j.points;j.points=[];for(p=0;p<k+1;p++){j.points.push(h+Math.sin(t*p)*n,f+Math.cos(t*p)*m)}PIXI.WebGLGraphics.buildLine(j,w);j.points=e}};PIXI.WebGLGraphics.buildLine=function(R,B){var N=0;var E=R.points;if(E.length===0){return}if(R.lineWidth%2){for(N=0;N<E.length;N++){E[N]+=0.5}}var s=new PIXI.Point(E[0],E[1]);var k=new PIXI.Point(E[E.length-2],E[E.length-1]);if(s.x===k.x&&s.y===k.y){E=E.slice();E.pop();E.pop();k=new PIXI.Point(E[E.length-2],E[E.length-1]);var u=k.x+(s.x-k.x)*0.5;var q=k.y+(s.y-k.y)*0.5;E.unshift(u,q);E.push(u,q)}var O=B.points;var h=B.indices;var t=E.length/2;var p=E.length;var Q=O.length/6;var a=R.lineWidth/2;var D=Phaser.Color.hexToRGBArray(R.lineColor);var M=R.lineAlpha;var J=D[0]*M;var P=D[1]*M;var S=D[2]*M;var o,n,G,F,y,x,f,e;var I,H,w,v,d,c;var L,C,m,K,A,l;var T,z,j;G=E[0];F=E[1];y=E[2];x=E[3];I=-(F-x);H=G-y;j=Math.sqrt(I*I+H*H);I/=j;H/=j;I*=a;H*=a;O.push(G-I,F-H,J,P,S,M);O.push(G+I,F+H,J,P,S,M);for(N=1;N<t-1;N++){G=E[(N-1)*2];F=E[(N-1)*2+1];y=E[(N)*2];x=E[(N)*2+1];f=E[(N+1)*2];e=E[(N+1)*2+1];I=-(F-x);H=G-y;j=Math.sqrt(I*I+H*H);I/=j;H/=j;I*=a;H*=a;w=-(x-e);v=y-f;j=Math.sqrt(w*w+v*v);w/=j;v/=j;w*=a;v*=a;L=(-H+F)-(-H+x);C=(-I+y)-(-I+G);m=(-I+G)*(-H+x)-(-I+y)*(-H+F);K=(-v+e)-(-v+x);A=(-w+y)-(-w+f);l=(-w+f)*(-v+x)-(-w+y)*(-v+e);T=L*A-K*C;if(Math.abs(T)<0.1){T+=10.1;O.push(y-I,x-H,J,P,S,M);O.push(y+I,x+H,J,P,S,M);continue}o=(C*l-A*m)/T;n=(K*m-L*l)/T;z=(o-y)*(o-y)+(n-x)+(n-x);if(z>140*140){d=I-w;c=H-v;j=Math.sqrt(d*d+c*c);d/=j;c/=j;d*=a;c*=a;O.push(y-d,x-c);O.push(J,P,S,M);O.push(y+d,x+c);O.push(J,P,S,M);O.push(y-d,x-c);O.push(J,P,S,M);p++}else{O.push(o,n);O.push(J,P,S,M);O.push(y-(o-y),x-(n-x));O.push(J,P,S,M)}}G=E[(t-2)*2];F=E[(t-2)*2+1];y=E[(t-1)*2];x=E[(t-1)*2+1];I=-(F-x);H=G-y;j=Math.sqrt(I*I+H*H);I/=j;H/=j;I*=a;H*=a;O.push(y-I,x-H);O.push(J,P,S,M);O.push(y+I,x+H);O.push(J,P,S,M);h.push(Q);for(N=0;N<p;N++){h.push(Q++)}h.push(Q-1)};PIXI.WebGLGraphics.buildComplexPoly=function(m,g){var k=m.points.slice();if(k.length<6){return}var l=g.indices;g.points=k;g.alpha=m.fillAlpha;g.color=Phaser.Color.hexToRGBArray(m.fillColor);var e=Infinity;var b=-Infinity;var d=Infinity;var a=-Infinity;var j,h;for(var f=0;f<k.length;f+=2){j=k[f];h=k[f+1];e=j<e?j:e;b=j>b?j:b;d=h<d?h:d;a=h>a?h:a}k.push(e,d,b,d,b,a,e,a);var c=k.length/2;for(f=0;f<c;f++){l.push(f)}};PIXI.WebGLGraphics.buildPoly=function(q,j){var o=q.points;if(o.length<6){return}var n=j.points;var p=j.indices;var c=o.length/2;var f=Phaser.Color.hexToRGBArray(q.fillColor);var e=q.fillAlpha;var a=f[0]*e;var k=f[1]*e;var m=f[2]*e;var d=Phaser.EarCut.Triangulate(o,null,2);if(!d){return false}var l=n.length/6;var h=0;for(h=0;h<d.length;h+=3){p.push(d[h]+l);p.push(d[h]+l);p.push(d[h+1]+l);p.push(d[h+2]+l);p.push(d[h+2]+l)}for(h=0;h<c;h++){n.push(o[h*2],o[h*2+1],a,k,m,e)}return true};PIXI.WebGLGraphics.graphicsDataPool=[];PIXI.WebGLGraphicsData=function(a){this.gl=a;this.color=[0,0,0];this.points=[];this.indices=[];this.buffer=a.createBuffer();this.indexBuffer=a.createBuffer();this.mode=1;this.alpha=1;this.dirty=true};PIXI.WebGLGraphicsData.prototype.reset=function(){this.points=[];this.indices=[]};PIXI.WebGLGraphicsData.prototype.upload=function(){var a=this.gl;this.glPoints=new Float32Array(this.points);a.bindBuffer(a.ARRAY_BUFFER,this.buffer);a.bufferData(a.ARRAY_BUFFER,this.glPoints,a.STATIC_DRAW);this.glIndicies=new Uint16Array(this.indices);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.glIndicies,a.STATIC_DRAW);this.dirty=false};PIXI.CanvasGraphics=function(){};PIXI.CanvasGraphics.renderGraphics=function(E,d){var z=E.worldAlpha;if(E.dirty){this.updateGraphicsTint(E);E.dirty=false}for(var C=0;C<E.graphicsData.length;C++){var G=E.graphicsData[C];var c=G.shape;var l=G._fillTint;var b=G._lineTint;d.lineWidth=G.lineWidth;if(G.type===Phaser.POLYGON){d.beginPath();var B=c.points;d.moveTo(B[0],B[1]);for(var A=1;A<B.length/2;A++){d.lineTo(B[A*2],B[A*2+1])}if(c.closed){d.lineTo(B[0],B[1])}if(B[0]===B[B.length-2]&&B[1]===B[B.length-1]){d.closePath()}if(G.fill){d.globalAlpha=G.fillAlpha*z;d.fillStyle="#"+("00000"+(l|0).toString(16)).substr(-6);d.fill()}if(G.lineWidth){d.globalAlpha=G.lineAlpha*z;d.strokeStyle="#"+("00000"+(b|0).toString(16)).substr(-6);d.stroke()}}else{if(G.type===Phaser.RECTANGLE){if(G.fillColor||G.fillColor===0){d.globalAlpha=G.fillAlpha*z;d.fillStyle="#"+("00000"+(l|0).toString(16)).substr(-6);d.fillRect(c.x,c.y,c.width,c.height)}if(G.lineWidth){d.globalAlpha=G.lineAlpha*z;d.strokeStyle="#"+("00000"+(b|0).toString(16)).substr(-6);d.strokeRect(c.x,c.y,c.width,c.height)}}else{if(G.type===Phaser.CIRCLE){d.beginPath();d.arc(c.x,c.y,c.radius,0,2*Math.PI);d.closePath();if(G.fill){d.globalAlpha=G.fillAlpha*z;d.fillStyle="#"+("00000"+(l|0).toString(16)).substr(-6);d.fill()}if(G.lineWidth){d.globalAlpha=G.lineAlpha*z;d.strokeStyle="#"+("00000"+(b|0).toString(16)).substr(-6);d.stroke()}}else{if(G.type===Phaser.ELLIPSE){var q=c.width*2;var D=c.height*2;var p=c.x-q/2;var o=c.y-D/2;d.beginPath();var r=0.5522848,k=(q/2)*r,f=(D/2)*r,v=p+q,a=o+D,s=p+q/2,F=o+D/2;d.moveTo(p,F);d.bezierCurveTo(p,F-f,s-k,o,s,o);d.bezierCurveTo(s+k,o,v,F-f,v,F);d.bezierCurveTo(v,F+f,s+k,a,s,a);d.bezierCurveTo(s-k,a,p,F+f,p,F);d.closePath();if(G.fill){d.globalAlpha=G.fillAlpha*z;d.fillStyle="#"+("00000"+(l|0).toString(16)).substr(-6);d.fill()}if(G.lineWidth){d.globalAlpha=G.lineAlpha*z;d.strokeStyle="#"+("00000"+(b|0).toString(16)).substr(-6);d.stroke()}}else{if(G.type===Phaser.ROUNDEDRECTANGLE){var m=c.x;var g=c.y;var u=c.width;var t=c.height;var e=c.radius;var n=Math.min(u,t)/2|0;e=e>n?n:e;d.beginPath();d.moveTo(m,g+e);d.lineTo(m,g+t-e);d.quadraticCurveTo(m,g+t,m+e,g+t);d.lineTo(m+u-e,g+t);d.quadraticCurveTo(m+u,g+t,m+u,g+t-e);d.lineTo(m+u,g+e);d.quadraticCurveTo(m+u,g,m+u-e,g);d.lineTo(m+e,g);d.quadraticCurveTo(m,g,m,g+e);d.closePath();if(G.fillColor||G.fillColor===0){d.globalAlpha=G.fillAlpha*z;d.fillStyle="#"+("00000"+(l|0).toString(16)).substr(-6);d.fill()}if(G.lineWidth){d.globalAlpha=G.lineAlpha*z;d.strokeStyle="#"+("00000"+(b|0).toString(16)).substr(-6);d.stroke()}}}}}}}};PIXI.CanvasGraphics.renderGraphicsMask=function(C,c){var A=C.graphicsData.length;if(A===0){return}c.beginPath();for(var z=0;z<A;z++){var E=C.graphicsData[z];var b=E.shape;if(E.type===Phaser.POLYGON){var v=b.points;c.moveTo(v[0],v[1]);for(var u=1;u<v.length/2;u++){c.lineTo(v[u*2],v[u*2+1])}if(v[0]===v[v.length-2]&&v[1]===v[v.length-1]){c.closePath()}}else{if(E.type===Phaser.RECTANGLE){c.rect(b.x,b.y,b.width,b.height);c.closePath()}else{if(E.type===Phaser.CIRCLE){c.arc(b.x,b.y,b.radius,0,2*Math.PI);c.closePath()}else{if(E.type===Phaser.ELLIPSE){var o=b.width*2;var B=b.height*2;var n=b.x-o/2;var m=b.y-B/2;var p=0.5522848,g=(o/2)*p,e=(B/2)*p,t=n+o,a=m+B,q=n+o/2,D=m+B/2;c.moveTo(n,D);c.bezierCurveTo(n,D-e,q-g,m,q,m);c.bezierCurveTo(q+g,m,t,D-e,t,D);c.bezierCurveTo(t,D+e,q+g,a,q,a);c.bezierCurveTo(q-g,a,n,D+e,n,D);c.closePath()}else{if(E.type===Phaser.ROUNDEDRECTANGLE){var k=b.x;var f=b.y;var s=b.width;var r=b.height;var d=b.radius;var l=Math.min(s,r)/2|0;d=d>l?l:d;c.moveTo(k,f+d);c.lineTo(k,f+r-d);c.quadraticCurveTo(k,f+r,k+d,f+r);c.lineTo(k+s-d,f+r);c.quadraticCurveTo(k+s,f+r,k+s,f+r-d);c.lineTo(k+s,f+d);c.quadraticCurveTo(k+s,f,k+s-d,f);c.lineTo(k+d,f);c.quadraticCurveTo(k,f,k,f+d);c.closePath()}}}}}}};PIXI.CanvasGraphics.updateGraphicsTint=function(c){if(c.tint===16777215){return}var b=(c.tint>>16&255)/255;var a=(c.tint>>8&255)/255;var f=(c.tint&255)/255;for(var d=0;d<c.graphicsData.length;d++){var e=c.graphicsData[d];var h=e.fillColor|0;var g=e.lineColor|0;e._fillTint=(((h>>16&255)/255*b*255<<16)+((h>>8&255)/255*a*255<<8)+(h&255)/255*f*255);e._lineTint=(((g>>16&255)/255*b*255<<16)+((g>>8&255)/255*a*255<<8)+(g&255)/255*f*255)}};Phaser.GraphicsData=function(a,f,c,g,d,e,b){this.lineWidth=a;this.lineColor=f;this.lineAlpha=c;this._lineTint=f;this.fillColor=g;this.fillAlpha=d;this._fillTint=g;this.fill=e;this.shape=b;this.type=b.type};Phaser.GraphicsData.prototype.constructor=Phaser.GraphicsData;Phaser.GraphicsData.prototype.clone=function(){return new Phaser.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)};Phaser.Graphics=function(b,a,c){if(a===undefined){a=0}if(c===undefined){c=0}this.type=Phaser.GRAPHICS;this.physicsType=Phaser.SPRITE;this.anchor=new Phaser.Point();PIXI.DisplayObjectContainer.call(this);this.renderable=true;this.fillAlpha=1;this.lineWidth=0;this.lineColor=0;this.graphicsData=[];this.tint=16777215;this.blendMode=PIXI.blendModes.NORMAL;this.currentPath=null;this._webGL=[];this.isMask=false;this.boundsPadding=0;this._localBounds=new Phaser.Rectangle(0,0,1,1);this.dirty=true;this._boundsDirty=false;this.webGLDirty=false;this.cachedSpriteDirty=false;Phaser.Component.Core.init.call(this,b,a,c,"",null)};Phaser.Graphics.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);Phaser.Graphics.prototype.constructor=Phaser.Graphics;Phaser.Component.Core.install.call(Phaser.Graphics.prototype,["Angle","AutoCull","Bounds","Destroy","FixedToCamera","InputEnabled","InWorld","LifeSpan","PhysicsBody","Reset"]);Phaser.Graphics.prototype.preUpdatePhysics=Phaser.Component.PhysicsBody.preUpdate;Phaser.Graphics.prototype.preUpdateLifeSpan=Phaser.Component.LifeSpan.preUpdate;Phaser.Graphics.prototype.preUpdateInWorld=Phaser.Component.InWorld.preUpdate;Phaser.Graphics.prototype.preUpdateCore=Phaser.Component.Core.preUpdate;Phaser.Graphics.prototype.preUpdate=function(){if(!this.preUpdatePhysics()||!this.preUpdateLifeSpan()||!this.preUpdateInWorld()){return false}return this.preUpdateCore()};Phaser.Graphics.prototype.postUpdate=function(){Phaser.Component.PhysicsBody.postUpdate.call(this);Phaser.Component.FixedToCamera.postUpdate.call(this);if(this._boundsDirty){this.updateLocalBounds();this._boundsDirty=false}for(var a=0;a<this.children.length;a++){this.children[a].postUpdate()}};Phaser.Graphics.prototype.destroy=function(a){this.clear();Phaser.Component.Destroy.prototype.destroy.call(this,a)};Phaser.Graphics.prototype.drawTriangle=function(c,b){if(b===undefined){b=false}var g=new Phaser.Polygon(c);if(b){var e=new Phaser.Point(this.game.camera.x-c[0].x,this.game.camera.y-c[0].y);var d=new Phaser.Point(c[1].x-c[0].x,c[1].y-c[0].y);var a=new Phaser.Point(c[1].x-c[2].x,c[1].y-c[2].y);var f=a.cross(d);if(e.dot(f)>0){this.drawPolygon(g)}}else{this.drawPolygon(g)}};Phaser.Graphics.prototype.drawTriangles=function(c,h,a){if(a===undefined){a=false}var g=new Phaser.Point();var e=new Phaser.Point();var b=new Phaser.Point();var f=[];var d;if(!h){if(c[0] instanceof Phaser.Point){for(d=0;d<c.length/3;d++){this.drawTriangle([c[d*3],c[d*3+1],c[d*3+2]],a)}}else{for(d=0;d<c.length/6;d++){g.x=c[d*6+0];g.y=c[d*6+1];e.x=c[d*6+2];e.y=c[d*6+3];b.x=c[d*6+4];b.y=c[d*6+5];this.drawTriangle([g,e,b],a)}}}else{if(c[0] instanceof Phaser.Point){for(d=0;d<h.length/3;d++){f.push(c[h[d*3]]);f.push(c[h[d*3+1]]);f.push(c[h[d*3+2]]);if(f.length===3){this.drawTriangle(f,a);f=[]}}}else{for(d=0;d<h.length;d++){g.x=c[h[d]*2];g.y=c[h[d]*2+1];f.push(g.copyTo({}));if(f.length===3){this.drawTriangle(f,a);f=[]}}}}};Phaser.Graphics.prototype.lineStyle=function(a,b,c){this.lineWidth=a||0;this.lineColor=b||0;this.lineAlpha=(c===undefined)?1:c;if(this.currentPath){if(this.currentPath.shape.points.length){this.drawShape(new Phaser.Polygon(this.currentPath.shape.points.slice(-2)))}else{this.currentPath.lineWidth=this.lineWidth;this.currentPath.lineColor=this.lineColor;this.currentPath.lineAlpha=this.lineAlpha}}return this};Phaser.Graphics.prototype.moveTo=function(a,b){this.drawShape(new Phaser.Polygon([a,b]));return this};Phaser.Graphics.prototype.lineTo=function(a,b){if(!this.currentPath){this.moveTo(0,0)}this.currentPath.shape.points.push(a,b);this.dirty=true;this._boundsDirty=true;return this};Phaser.Graphics.prototype.quadraticCurveTo=function(k,e,m,h){if(this.currentPath){if(this.currentPath.shape.points.length===0){this.currentPath.shape.points=[0,0]}}else{this.moveTo(0,0)}var a,f,b=20,o=this.currentPath.shape.points;if(o.length===0){this.moveTo(0,0)}var l=o[o.length-2];var g=o[o.length-1];var c=0;for(var d=1;d<=b;++d){c=d/b;a=l+((k-l)*c);f=g+((e-g)*c);o.push(a+(((k+((m-k)*c))-a)*c),f+(((e+((h-e)*c))-f)*c))}this.dirty=true;this._boundsDirty=true;return this};Phaser.Graphics.prototype.bezierCurveTo=function(q,l,p,f,s,o){if(this.currentPath){if(this.currentPath.shape.points.length===0){this.currentPath.shape.points=[0,0]}}else{this.moveTo(0,0)}var d=20,b,c,a,k,h,t=this.currentPath.shape.points;var r=t[t.length-2];var m=t[t.length-1];var e=0;for(var g=1;g<=d;++g){e=g/d;b=(1-e);c=b*b;a=c*b;k=e*e;h=k*e;t.push(a*r+3*c*e*q+3*b*k*p+h*s,a*m+3*c*e*l+3*b*k*f+h*o)}this.dirty=true;this._boundsDirty=true;return this};Phaser.Graphics.prototype.arcTo=function(w,g,v,e,h){if(this.currentPath){if(this.currentPath.shape.points.length===0){this.currentPath.shape.points.push(w,g)}}else{this.moveTo(w,g)}var t=this.currentPath.shape.points,o=t[t.length-2],m=t[t.length-1],B=m-g,j=o-w,A=e-g,i=v-w,u=Math.abs(B*i-j*A);if(u<1e-8||h===0){if(t[t.length-2]!==w||t[t.length-1]!==g){t.push(w,g)}}else{var z=B*B+j*j,q=A*A+i*i,b=B*A+j*i,l=h*Math.sqrt(z)/u,k=h*Math.sqrt(q)/u,c=l*b/z,a=k*b/q,f=l*i+k*j,d=l*A+k*B,p=j*(k+c),n=B*(k+c),y=i*(l+a),x=A*(l+a),s=Math.atan2(n-d,p-f),r=Math.atan2(x-d,y-f);this.arc(f+w,d+g,h,s,r,j*A>i*B)}this.dirty=true;this._boundsDirty=true;return this};Phaser.Graphics.prototype.arc=function(d,b,e,q,n,a,o){if(q===n){return this}if(a===undefined){a=false}if(o===undefined){o=40}if(!a&&n<=q){n+=Math.PI*2}else{if(a&&q<=n){q+=Math.PI*2}}var j=a?(q-n)*-1:(n-q);var m=Math.ceil(Math.abs(j)/(Math.PI*2))*o;if(j===0){return this}var x=d+Math.cos(q)*e;var v=b+Math.sin(q)*e;if(a&&this.filling){this.moveTo(d,b)}else{this.moveTo(x,v)}var u=this.currentPath.shape.points;var f=j/(m*2);var l=f*2;var p=Math.cos(f);var r=Math.sin(f);var z=m-1;var g=(z%1)/z;for(var t=0;t<=z;t++){var k=t+g*t;var w=((f)+q+(l*k));var y=Math.cos(w);var h=-Math.sin(w);u.push(((p*y)+(r*h))*e+d,((p*-h)+(r*y))*e+b)}this.dirty=true;this._boundsDirty=true;return this};Phaser.Graphics.prototype.beginFill=function(a,b){this.filling=true;this.fillColor=a||0;this.fillAlpha=(b===undefined)?1:b;if(this.currentPath){if(this.currentPath.shape.points.length<=2){this.currentPath.fill=this.filling;this.currentPath.fillColor=this.fillColor;this.currentPath.fillAlpha=this.fillAlpha}}return this};Phaser.Graphics.prototype.endFill=function(){this.filling=false;this.fillColor=null;this.fillAlpha=1;return this};Phaser.Graphics.prototype.drawRect=function(b,d,c,a){this.drawShape(new Phaser.Rectangle(b,d,c,a));return this};Phaser.Graphics.prototype.drawRoundedRect=function(c,e,d,b,a){this.drawShape(new Phaser.RoundedRectangle(c,e,d,b,a));return this};Phaser.Graphics.prototype.drawCircle=function(a,c,b){this.drawShape(new Phaser.Circle(a,c,b));return this};Phaser.Graphics.prototype.drawEllipse=function(b,d,c,a){this.drawShape(new Phaser.Ellipse(b,d,c,a));return this};Phaser.Graphics.prototype.drawPolygon=function(c){if(c instanceof Phaser.Polygon){c=c.points}var b=c;if(!Array.isArray(b)){b=new Array(arguments.length);for(var a=0;a<b.length;++a){b[a]=arguments[a]}}this.drawShape(new Phaser.Polygon(b));return this};Phaser.Graphics.prototype.clear=function(){this.lineWidth=0;this.filling=false;this.dirty=true;this._boundsDirty=true;this.clearDirty=true;this.graphicsData=[];this.updateLocalBounds();return this};Phaser.Graphics.prototype.generateTexture=function(a,c,f){if(a===undefined){a=1}if(c===undefined){c=PIXI.scaleModes.DEFAULT}if(f===undefined){f=0}var e=this.getBounds();e.width+=f;e.height+=f;var b=new PIXI.CanvasBuffer(e.width*a,e.height*a);var d=PIXI.Texture.fromCanvas(b.canvas,c);d.baseTexture.resolution=a;b.context.scale(a,a);b.context.translate(-e.x,-e.y);PIXI.CanvasGraphics.renderGraphics(this,b.context);return d};Phaser.Graphics.prototype._renderWebGL=function(b){if(this.visible===false||this.alpha===0||this.isMask===true){return}if(this._cacheAsBitmap){if(this.dirty||this.cachedSpriteDirty){this._generateCachedSprite();this.updateCachedSpriteTexture();this.cachedSpriteDirty=false;this.dirty=false}this._cachedSprite.worldAlpha=this.worldAlpha;PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite,b);return}else{b.spriteBatch.stop();b.blendModeManager.setBlendMode(this.blendMode);if(this._mask){b.maskManager.pushMask(this._mask,b)}if(this._filters){b.filterManager.pushFilter(this._filterBlock)}if(this.blendMode!==b.spriteBatch.currentBlendMode){b.spriteBatch.currentBlendMode=this.blendMode;var c=PIXI.blendModesWebGL[b.spriteBatch.currentBlendMode];b.spriteBatch.gl.blendFunc(c[0],c[1])}if(this.webGLDirty){this.dirty=true;this.webGLDirty=false}PIXI.WebGLGraphics.renderGraphics(this,b);if(this.children.length){b.spriteBatch.start();for(var a=0;a<this.children.length;a++){this.children[a]._renderWebGL(b)}b.spriteBatch.stop()}if(this._filters){b.filterManager.popFilter()}if(this._mask){b.maskManager.popMask(this.mask,b)}b.drawCount++;b.spriteBatch.start()}};Phaser.Graphics.prototype._renderCanvas=function(g){if(this.visible===false||this.alpha===0||this.isMask===true){return}if(this._prevTint!==this.tint){this.dirty=true;this._prevTint=this.tint}if(this._cacheAsBitmap){if(this.dirty||this.cachedSpriteDirty){this._generateCachedSprite();this.updateCachedSpriteTexture();this.cachedSpriteDirty=false;this.dirty=false}this._cachedSprite.alpha=this.alpha;PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite,g);return}else{var f=g.context;var d=this.worldTransform;if(this.blendMode!==g.currentBlendMode){g.currentBlendMode=this.blendMode;f.globalCompositeOperation=PIXI.blendModesCanvas[g.currentBlendMode]}if(this._mask){g.maskManager.pushMask(this._mask,g)}var c=g.resolution;var b=(d.tx*g.resolution)+g.shakeX;var a=(d.ty*g.resolution)+g.shakeY;f.setTransform(d.a*c,d.b*c,d.c*c,d.d*c,b,a);PIXI.CanvasGraphics.renderGraphics(this,f);for(var e=0;e<this.children.length;e++){this.children[e]._renderCanvas(g)}if(this._mask){g.maskManager.popMask(g)}}};Phaser.Graphics.prototype.getBounds=function(p){if(this._currentBounds){return this._currentBounds}if(!this.renderable){return Phaser.EmptyRectangle}if(this.dirty){this.updateLocalBounds();this.webGLDirty=true;this.cachedSpriteDirty=true;this.dirty=false}var i=this._localBounds;var m=i.x;var l=i.width+i.x;var k=i.y;var j=i.height+i.y;var n=p||this.worldTransform;var B=n.a;var z=n.b;var y=n.c;var w=n.d;var C=n.tx;var A=n.ty;var s=B*l+y*j+C;var h=w*j+z*l+A;var r=B*m+y*j+C;var g=w*j+z*m+A;var q=B*m+y*k+C;var f=w*k+z*m+A;var o=B*l+y*k+C;var e=w*k+z*l+A;var v=s;var t=h;var x=s;var u=h;x=r<x?r:x;x=q<x?q:x;x=o<x?o:x;u=g<u?g:u;u=f<u?f:u;u=e<u?e:u;v=r>v?r:v;v=q>v?q:v;v=o>v?o:v;t=g>t?g:t;t=f>t?f:t;t=e>t?e:t;this._bounds.x=x;this._bounds.width=v-x;this._bounds.y=u;this._bounds.height=t-u;this._currentBounds=this._bounds;return this._currentBounds};Phaser.Graphics.prototype.getLocalBounds=function(){var a=this.worldTransform;this.worldTransform=Phaser.identityMatrix;for(var b=0;b<this.children.length;b++){this.children[b].updateTransform()}var c=this.getBounds();this.worldTransform=a;for(b=0;b<this.children.length;b++){this.children[b].updateTransform()}return c};Phaser.Graphics.prototype.containsPoint=function(a,d){if(d===undefined){d=new Phaser.Point()}this.worldTransform.applyInverse(a,d);var e=this.graphicsData;for(var b=0;b<e.length;b++){var c=e[b];if(!c.fill){continue}if(c.shape){if(c.shape.contains(d.x,d.y)){return true}}}return false};Phaser.Graphics.prototype.updateLocalBounds=function(){var d=Infinity;var b=-Infinity;var c=Infinity;var a=-Infinity;if(this.graphicsData.length){var m,s,q,o,r,k;for(var g=0;g<this.graphicsData.length;g++){var f=this.graphicsData[g];var n=f.type;var l=f.lineWidth;m=f.shape;if(n===Phaser.RECTANGLE||n===Phaser.ROUNDEDRECTANGLE){q=m.x-l/2;o=m.y-l/2;r=m.width+l;k=m.height+l;d=q<d?q:d;b=q+r>b?q+r:b;c=o<c?o:c;a=o+k>a?o+k:a}else{if(n===Phaser.CIRCLE){q=m.x;o=m.y;r=m.radius+l/2;k=m.radius+l/2;d=q-r<d?q-r:d;b=q+r>b?q+r:b;c=o-k<c?o-k:c;a=o+k>a?o+k:a}else{if(n===Phaser.ELLIPSE){q=m.x;o=m.y;r=m.width+l/2;k=m.height+l/2;d=q-r<d?q-r:d;b=q+r>b?q+r:b;c=o-k<c?o-k:c;a=o+k>a?o+k:a}else{s=m.points;for(var e=0;e<s.length;e++){if(s[e] instanceof Phaser.Point){q=s[e].x;o=s[e].y}else{q=s[e];o=s[e+1];if(e<s.length-1){e++}}d=q-l<d?q-l:d;b=q+l>b?q+l:b;c=o-l<c?o-l:c;a=o+l>a?o+l:a}}}}}}else{d=0;b=0;c=0;a=0}var p=this.boundsPadding;this._localBounds.x=d-p;this._localBounds.width=(b-d)+p*2;this._localBounds.y=c-p;this._localBounds.height=(a-c)+p*2};Phaser.Graphics.prototype._generateCachedSprite=function(){var c=this.getLocalBounds();if(!this._cachedSprite){var a=new PIXI.CanvasBuffer(c.width,c.height);var b=PIXI.Texture.fromCanvas(a.canvas);this._cachedSprite=new PIXI.Sprite(b);this._cachedSprite.buffer=a;this._cachedSprite.worldTransform=this.worldTransform}else{this._cachedSprite.buffer.resize(c.width,c.height)}this._cachedSprite.anchor.x=-(c.x/c.width);this._cachedSprite.anchor.y=-(c.y/c.height);this._cachedSprite.buffer.context.translate(-c.x,-c.y);this.worldAlpha=1;PIXI.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context);this._cachedSprite.alpha=this.alpha};Phaser.Graphics.prototype.updateCachedSpriteTexture=function(){var c=this._cachedSprite;var b=c.texture;var a=c.buffer.canvas;b.baseTexture.width=a.width;b.baseTexture.height=a.height;b.crop.width=b.frame.width=a.width;b.crop.height=b.frame.height=a.height;c._width=a.width;c._height=a.height;b.baseTexture.dirty()};Phaser.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(true);this._cachedSprite=null};Phaser.Graphics.prototype.drawShape=function(a){if(this.currentPath){if(this.currentPath.shape.points.length<=2){this.graphicsData.pop()}}this.currentPath=null;if(a instanceof Phaser.Polygon){a=a.clone();a.flatten()}var b=new Phaser.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,a);this.graphicsData.push(b);if(b.type===Phaser.POLYGON){b.shape.closed=this.filling;this.currentPath=b}this.dirty=true;this._boundsDirty=true;return b};Object.defineProperty(Phaser.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(a){this._cacheAsBitmap=a;if(this._cacheAsBitmap){this._generateCachedSprite()}else{this.destroyCachedSprite()}this.dirty=true;this.webGLDirty=true}});Phaser.RenderTexture=function(g,a,h,e,f,b,d,i){if(a===undefined){a=100}if(h===undefined){h=100}if(e===undefined){e=""}if(f===undefined){f=Phaser.scaleModes.DEFAULT}if(b===undefined){b=1}if(d===undefined){d=PIXI.defaultRenderer}if(i===undefined){i=0}this.game=g;this.key=e;this.type=Phaser.RENDERTEXTURE;this._tempMatrix=new Phaser.Matrix();this.width=a;this.height=h;this.resolution=b;this.frame=new Phaser.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution);this.crop=this.frame.clone();this.baseTexture=new PIXI.BaseTexture();this.baseTexture.width=this.width*this.resolution;this.baseTexture.height=this.height*this.resolution;this.baseTexture._glTextures=[];this.baseTexture.resolution=this.resolution;this.baseTexture.scaleMode=f;this.baseTexture.hasLoaded=true;PIXI.Texture.call(this,this.baseTexture,this.frame.clone());this.renderer=d;if(this.renderer.type===Phaser.WEBGL){var c=this.renderer.gl;this.baseTexture.textureIndex=i;this.baseTexture._dirty[c.id]=false;this.textureBuffer=new PIXI.FilterTexture(c,this.width,this.height,this.baseTexture.scaleMode,i);this.baseTexture._glTextures[c.id]=this.textureBuffer.texture;this.projection=new Phaser.Point(this.width*0.5,-this.height*0.5)}else{this.textureBuffer=new PIXI.CanvasBuffer(this.width*this.resolution,this.height*this.resolution);this.baseTexture.source=this.textureBuffer.canvas}this.valid=true;this.tempMatrix=new Phaser.Matrix();this._updateUvs()};Phaser.RenderTexture.prototype=Object.create(PIXI.Texture.prototype);Phaser.RenderTexture.prototype.constructor=Phaser.RenderTexture;Phaser.RenderTexture.prototype.renderXY=function(c,b,d,a){c.updateTransform();this._tempMatrix.copyFrom(c.worldTransform);this._tempMatrix.tx=b;this._tempMatrix.ty=d;if(this.renderer.type===Phaser.WEBGL){this._renderWebGL(c,this._tempMatrix,a)}else{this._renderCanvas(c,this._tempMatrix,a)}};Phaser.RenderTexture.prototype.renderRawXY=function(c,b,d,a){this._tempMatrix.identity().translate(b,d);if(this.renderer.type===Phaser.WEBGL){this._renderWebGL(c,this._tempMatrix,a)}else{this._renderCanvas(c,this._tempMatrix,a)}};Phaser.RenderTexture.prototype.render=function(c,b,a){if(b===undefined||b===null){this._tempMatrix.copyFrom(c.worldTransform)}else{this._tempMatrix.copyFrom(b)}if(this.renderer.type===Phaser.WEBGL){this._renderWebGL(c,this._tempMatrix,a)}else{this._renderCanvas(c,this._tempMatrix,a)}};Phaser.RenderTexture.prototype.resize=function(c,a,b){if(c===this.width&&a===this.height){return}this.valid=(c>0&&a>0);this.width=c;this.height=a;this.frame.width=this.crop.width=c*this.resolution;this.frame.height=this.crop.height=a*this.resolution;if(b){this.baseTexture.width=this.width*this.resolution;this.baseTexture.height=this.height*this.resolution}if(this.renderer.type===Phaser.WEBGL){this.projection.x=this.width/2;this.projection.y=-this.height/2}if(!this.valid){return}this.textureBuffer.resize(this.width,this.height)};Phaser.RenderTexture.prototype.clear=function(){if(!this.valid){return}if(this.renderer.type===Phaser.WEBGL){this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer)}this.textureBuffer.clear()};Phaser.RenderTexture.prototype._renderWebGL=function(f,c,b){if(!this.valid||f.alpha===0){return}var a=f.worldTransform;a.identity();a.translate(0,this.projection.y*2);if(c){a.append(c)}a.scale(1,-1);for(var d=0;d<f.children.length;d++){f.children[d].updateTransform()}var e=this.renderer.gl;e.viewport(0,0,this.width*this.resolution,this.height*this.resolution);e.bindFramebuffer(e.FRAMEBUFFER,this.textureBuffer.frameBuffer);if(b){this.textureBuffer.clear()}this.renderer.spriteBatch.dirty=true;this.renderer.renderDisplayObject(f,this.projection,this.textureBuffer.frameBuffer,c);this.renderer.spriteBatch.dirty=true;e.bindFramebuffer(e.FRAMEBUFFER,null)};Phaser.RenderTexture.prototype._renderCanvas=function(f,c,b){if(!this.valid||f.alpha===0){return}var a=f.worldTransform;a.identity();if(c){a.append(c)}for(var d=0;d<f.children.length;d++){f.children[d].updateTransform()}if(b){this.textureBuffer.clear()}var e=this.renderer.resolution;this.renderer.resolution=this.resolution;this.renderer.renderDisplayObject(f,this.textureBuffer.context,c);this.renderer.resolution=e};Phaser.RenderTexture.prototype.getImage=function(){var a=new Image();a.src=this.getBase64();return a};Phaser.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()};Phaser.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===Phaser.WEBGL){var f=this.renderer.gl;var d=this.textureBuffer.width;var a=this.textureBuffer.height;var b=new Uint8Array(4*d*a);f.bindFramebuffer(f.FRAMEBUFFER,this.textureBuffer.frameBuffer);f.readPixels(0,0,d,a,f.RGBA,f.UNSIGNED_BYTE,b);f.bindFramebuffer(f.FRAMEBUFFER,null);var e=new PIXI.CanvasBuffer(d,a);var c=e.context.getImageData(0,0,d,a);c.data.set(b);e.context.putImageData(c,0,0);return e.canvas}else{return this.textureBuffer.canvas}};Phaser.Text=function(b,a,e,d,c){a=a||0;e=e||0;if(d===undefined||d===null){d=""}else{d=d.toString()}c=Phaser.Utils.extend({},c);this.type=Phaser.TEXT;this.physicsType=Phaser.SPRITE;this.padding=new Phaser.Point();this.textBounds=null;this.canvas=Phaser.CanvasPool.create(this);this.context=this.canvas.getContext("2d");this.colors=[];this.strokeColors=[];this.fontStyles=[];this.fontWeights=[];this.autoRound=false;this.useAdvancedWrap=false;this.splitRegExp=/(?:\r\n|\r|\n)/;this.characterLimitSize=-1;this.characterLimitSuffix="";this._res=b.renderer.resolution;this._text=d;this._fontComponents=null;this._lineSpacing=0;this._charCount=0;this._width=0;this._height=0;Phaser.Sprite.call(this,b,a,e,PIXI.Texture.fromCanvas(this.canvas));this.setStyle(c);if(d!==""){this.updateText()}};Phaser.Text.prototype=Object.create(Phaser.Sprite.prototype);Phaser.Text.prototype.constructor=Phaser.Text;Phaser.Text.prototype.preUpdate=function(){if(!this.preUpdatePhysics()||!this.preUpdateLifeSpan()||!this.preUpdateInWorld()){return false}return this.preUpdateCore()};Phaser.Text.prototype.update=function(){};Phaser.Text.prototype.destroy=function(a){this.texture.destroy(true);Phaser.Component.Destroy.prototype.destroy.call(this,a)};Phaser.Text.prototype.setShadow=function(a,f,b,c,e,d){if(a===undefined){a=0}if(f===undefined){f=0}if(b===undefined){b="rgba(0, 0, 0, 1)"}if(c===undefined){c=0}if(e===undefined){e=true}if(d===undefined){d=true}this.style.shadowOffsetX=a;this.style.shadowOffsetY=f;this.style.shadowColor=b;this.style.shadowBlur=c;this.style.shadowStroke=e;this.style.shadowFill=d;this.dirty=true;return this};Phaser.Text.prototype.setStyle=function(a,d){if(d===undefined){d=false}var c=Object.assign({},a);c.font=a.font||"bold 20pt Arial";c.backgroundColor=a.backgroundColor||null;c.fill=a.fill||"black";c.align=(a.align||"left").toLowerCase();c.boundsAlignH=(a.boundsAlignH||"left").toLowerCase();c.boundsAlignV=(a.boundsAlignV||"top").toLowerCase();c.stroke=a.stroke||"black";c.strokeThickness=Number(a.strokeThickness)||0;c.wordWrap=a.wordWrap||false;c.wordWrapWidth=a.wordWrapWidth||100;c.maxLines=a.maxLines||0;c.shadowOffsetX=a.shadowOffsetX||0;c.shadowOffsetY=a.shadowOffsetY||0;c.shadowColor=a.shadowColor||"rgba(0,0,0,0)";c.shadowBlur=a.shadowBlur||0;c.tabs=a.tabs||0;var b=this.fontToComponents(c.font);if(c.fontStyle){b.fontStyle=c.fontStyle}if(c.fontVariant){b.fontVariant=c.fontVariant}if(c.fontWeight){b.fontWeight=c.fontWeight}if(c.fontSize){if(typeof c.fontSize==="number"){c.fontSize=c.fontSize+"px"}b.fontSize=c.fontSize}this._fontComponents=b;c.font=this.componentsToFont(this._fontComponents);this.style=c;this.dirty=true;if(d){this.updateText()}return this};Phaser.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this._res;this.context.font=this.style.font;var o=this.text;if(this.characterLimitSize>-1&&this.characterLimitSize<o.length){o=this.text.substring(0,this.characterLimitSize)+this.characterLimitSuffix}if(this.style.wordWrap){o=this.runWordWrap(this.text)}var b=o.split(this.splitRegExp);var r=this.style.tabs;var u=[];var p=0;var h=this.determineFontProperties(this.style.font);var j=b.length;if(this.style.maxLines>0&&this.style.maxLines<b.length){j=this.style.maxLines}this._charCount=0;for(var q=0;q<j;q++){if(r===0){var a=this.style.strokeThickness+this.padding.x;if(this.colors.length>0||this.strokeColors.length>0||this.fontWeights.length>0||this.fontStyles.length>0){a+=this.measureLine(b[q])}else{a+=this.context.measureText(b[q]).width}if(this.style.wordWrap){a-=this.context.measureText(" ").width}}else{var l=b[q].split(/(?:\t)/);var a=this.padding.x+this.style.strokeThickness;if(Array.isArray(r)){var d=0;for(var t=0;t<l.length;t++){var k=0;if(this.colors.length>0||this.strokeColors.length>0||this.fontWeights.length>0||this.fontStyles.length>0){k=this.measureLine(l[t])}else{k=Math.ceil(this.context.measureText(l[t]).width)}if(t>0){d+=r[t-1]}a=d+k}}else{for(var t=0;t<l.length;t++){if(this.colors.length>0||this.strokeColors.length>0||this.fontWeights.length>0||this.fontStyles.length>0){a+=this.measureLine(l[t])}else{a+=Math.ceil(this.context.measureText(l[t]).width)}var m=this.game.math.snapToCeil(a,r)-a;a+=m}}}u[q]=Math.ceil(a);p=Math.max(p,u[q])}this.canvas.width=p*this._res;var e=h.fontSize+this.style.strokeThickness+this.padding.y;var n=e*j;var s=this._lineSpacing;if(s<0&&Math.abs(s)>e){s=-e}if(s!==0){n+=(s>0)?s*b.length:s*(b.length-1)}this.canvas.height=n*this._res;this.context.scale(this._res,this._res);if(navigator.isCocoonJS){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}if(this.style.backgroundColor){this.context.fillStyle=this.style.backgroundColor;this.context.fillRect(0,0,this.canvas.width,this.canvas.height)}this.context.fillStyle=this.style.fill;this.context.font=this.style.font;this.context.strokeStyle=this.style.stroke;this.context.textBaseline="alphabetic";this.context.lineWidth=this.style.strokeThickness;this.context.lineCap="round";this.context.lineJoin="round";var g;var f;this._charCount=0;for(q=0;q<j;q++){g=this.style.strokeThickness/2;f=(this.style.strokeThickness/2+q*e)+h.ascent;if(q>0){f+=(s*q)}if(this.style.align==="right"){g+=p-u[q]}else{if(this.style.align==="center"){g+=(p-u[q])/2}}if(this.autoRound){g=Math.round(g);f=Math.round(f)}if(this.colors.length>0||this.strokeColors.length>0||this.fontWeights.length>0||this.fontStyles.length>0){this.updateLine(b[q],g,f)}else{if(this.style.stroke&&this.style.strokeThickness){this.updateShadow(this.style.shadowStroke);if(r===0){this.context.strokeText(b[q],g,f)}else{this.renderTabLine(b[q],g,f,false)}}if(this.style.fill){this.updateShadow(this.style.shadowFill);if(r===0){this.context.fillText(b[q],g,f)}else{this.renderTabLine(b[q],g,f,true)}}}}this.updateTexture();this.dirty=false};Phaser.Text.prototype.renderTabLine=function(k,g,e,j){var i=k.split(/(?:\t)/);var f=this.style.tabs;var b=0;if(Array.isArray(f)){var a=0;for(var d=0;d<i.length;d++){if(d>0){a+=f[d-1]}b=g+a;if(j){this.context.fillText(i[d],b,e)}else{this.context.strokeText(i[d],b,e)}}}else{for(var d=0;d<i.length;d++){var h=Math.ceil(this.context.measureText(i[d]).width);b=this.game.math.snapToCeil(g,f);if(j){this.context.fillText(i[d],b,e)}else{this.context.strokeText(i[d],b,e)}g=b+h}}};Phaser.Text.prototype.updateShadow=function(a){if(a){this.context.shadowOffsetX=this.style.shadowOffsetX;this.context.shadowOffsetY=this.style.shadowOffsetY;this.context.shadowColor=this.style.shadowColor;this.context.shadowBlur=this.style.shadowBlur}else{this.context.shadowOffsetX=0;this.context.shadowOffsetY=0;this.context.shadowColor=0;this.context.shadowBlur=0}};Phaser.Text.prototype.measureLine=function(b){var a=0;for(var c=0;c<b.length;c++){var e=b[c];if(this.fontWeights.length>0||this.fontStyles.length>0){var d=this.fontToComponents(this.context.font);if(this.fontStyles[this._charCount]){d.fontStyle=this.fontStyles[this._charCount]}if(this.fontWeights[this._charCount]){d.fontWeight=this.fontWeights[this._charCount]}this.context.font=this.componentsToFont(d)}if(this.style.stroke&&this.style.strokeThickness){if(this.strokeColors[this._charCount]){this.context.strokeStyle=this.strokeColors[this._charCount]}this.updateShadow(this.style.shadowStroke)}if(this.style.fill){if(this.colors[this._charCount]){this.context.fillStyle=this.colors[this._charCount]}this.updateShadow(this.style.shadowFill)}a+=this.context.measureText(e).width;this._charCount++}return Math.ceil(a)};Phaser.Text.prototype.updateLine=function(b,a,f){for(var c=0;c<b.length;c++){var e=b[c];if(this.fontWeights.length>0||this.fontStyles.length>0){var d=this.fontToComponents(this.context.font);if(this.fontStyles[this._charCount]){d.fontStyle=this.fontStyles[this._charCount]}if(this.fontWeights[this._charCount]){d.fontWeight=this.fontWeights[this._charCount]}this.context.font=this.componentsToFont(d)}if(this.style.stroke&&this.style.strokeThickness){if(this.strokeColors[this._charCount]){this.context.strokeStyle=this.strokeColors[this._charCount]}this.updateShadow(this.style.shadowStroke);this.context.strokeText(e,a,f)}if(this.style.fill){if(this.colors[this._charCount]){this.context.fillStyle=this.colors[this._charCount]}this.updateShadow(this.style.shadowFill);this.context.fillText(e,a,f)}a+=this.context.measureText(e).width;this._charCount++}};Phaser.Text.prototype.clearColors=function(){this.colors=[];this.strokeColors=[];this.dirty=true;return this};Phaser.Text.prototype.clearFontValues=function(){this.fontStyles=[];this.fontWeights=[];this.dirty=true;return this};Phaser.Text.prototype.addColor=function(b,a){this.colors[a]=b;this.dirty=true;return this};Phaser.Text.prototype.addStrokeColor=function(b,a){this.strokeColors[a]=b;this.dirty=true;return this};Phaser.Text.prototype.addFontStyle=function(b,a){this.fontStyles[a]=b;this.dirty=true;return this};Phaser.Text.prototype.addFontWeight=function(b,a){this.fontWeights[a]=b;this.dirty=true;return this};Phaser.Text.prototype.precalculateWordWrap=function(b){this.texture.baseTexture.resolution=this._res;this.context.font=this.style.font;var a=this.runWordWrap(b);return a.split(/(?:\r\n|\r|\n)/)};Phaser.Text.prototype.runWordWrap=function(a){if(this.useAdvancedWrap){return this.advancedWordWrap(a)}else{return this.basicWordWrap(a)}};Phaser.Text.prototype.advancedWordWrap=function(m){var d=this.context;var n=this.style.wordWrapWidth;var g="";var c=m.replace(/ +/gi," ").split(/\r?\n/gi);var t=c.length;for(var r=0;r<t;r++){var h=c[r];var s="";h=h.replace(/^ *|\s*$/gi,"");var b=d.measureText(h).width;if(b<n){g+=h+"\n";continue}var p=n;var o=h.split(" ");for(var q=0;q<o.length;q++){var u=o[q];var a=u+" ";var v=d.measureText(a).width;if(v>p){if(q===0){var e=a;while(e.length){e=e.slice(0,-1);v=d.measureText(e).width;if(v<=p){break}}if(!e.length){throw new Error("This text's wordWrapWidth setting is less than a single character!")}var k=u.substr(e.length);o[q]=k;s+=e}var f=(o[q].length)?q:q+1;var l=o.slice(f).join(" ").replace(/[ \n]*$/gi,"");c[r+1]=l+" "+(c[r+1]||"");t=c.length;break}else{s+=a;p-=v}}g+=s.replace(/[ \n]*$/gi,"")+"\n"}g=g.replace(/[\s|\n]*$/gi,"");return g};Phaser.Text.prototype.basicWordWrap=function(f){var k="";var h=f.split("\n");for(var c=0;c<h.length;c++){var b=this.style.wordWrapWidth;var e=h[c].split(" ");for(var a=0;a<e.length;a++){var g=this.context.measureText(e[a]).width;var d=g+this.context.measureText(" ").width;if(d>b){if(a>0){k+="\n"}k+=e[a]+" ";b=this.style.wordWrapWidth-g}else{b-=d;k+=e[a]+" "}}if(c<h.length-1){k+="\n"}}return k};Phaser.Text.prototype.updateFont=function(b){var a=this.componentsToFont(b);if(this.style.font!==a){this.style.font=a;this.dirty=true;if(this.parent){this.updateTransform()}}};Phaser.Text.prototype.fontToComponents=function(b){var a=b.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);if(a){var c=a[5].trim();if(!/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(c)&&!/['",]/.exec(c)){c="'"+c+"'"}return{font:b,fontStyle:a[1]||"normal",fontVariant:a[2]||"normal",fontWeight:a[3]||"normal",fontSize:a[4]||"medium",fontFamily:c}}else{console.warn("Phaser.Text - unparsable CSS font: "+b);return{font:b}}};Phaser.Text.prototype.componentsToFont=function(b){var c=[];var a;a=b.fontStyle;if(a&&a!=="normal"){c.push(a)}a=b.fontVariant;if(a&&a!=="normal"){c.push(a)}a=b.fontWeight;if(a&&a!=="normal"){c.push(a)}a=b.fontSize;if(a&&a!=="medium"){c.push(a)}a=b.fontFamily;if(a){c.push(a)}if(!c.length){c.push(b.font)}return c.join(" ")};Phaser.Text.prototype.setText=function(b,a){if(a===undefined){a=false}this.text=b.toString()||"";if(a){this.updateText()}else{this.dirty=true}return this};Phaser.Text.prototype.parseList=function(c){if(!Array.isArray(c)){return this}else{var b="";for(var a=0;a<c.length;a++){if(Array.isArray(c[a])){b+=c[a].join("\t");if(a<c.length-1){b+="\n"}}else{b+=c[a];if(a<c.length-1){b+="\t"}}}}this.text=b;this.dirty=true;return this};Phaser.Text.prototype.setTextBounds=function(b,d,c,a){if(b===undefined){this.textBounds=null}else{if(!this.textBounds){this.textBounds=new Phaser.Rectangle(b,d,c,a)}else{this.textBounds.setTo(b,d,c,a)}if(this.style.wordWrapWidth>c){this.style.wordWrapWidth=c}}this.updateTexture();return this};Phaser.Text.prototype.updateTexture=function(){var e=this.texture.baseTexture;var d=this.texture.crop;var f=this.texture.frame;var b=this.canvas.width;var c=this.canvas.height;e.width=b;e.height=c;d.width=b;d.height=c;f.width=b;f.height=c;this.texture.width=b;this.texture.height=c;this._width=b;this._height=c;if(this.textBounds){var a=this.textBounds.x;var g=this.textBounds.y;if(this.style.boundsAlignH==="right"){a+=this.textBounds.width-this.canvas.width/this.resolution}else{if(this.style.boundsAlignH==="center"){a+=this.textBounds.halfWidth-(this.canvas.width/this.resolution/2)}}if(this.style.boundsAlignV==="bottom"){g+=this.textBounds.height-this.canvas.height/this.resolution}else{if(this.style.boundsAlignV==="middle"){g+=this.textBounds.halfHeight-(this.canvas.height/this.resolution/2)}}this.pivot.x=-a;this.pivot.y=-g}this.renderable=(b!==0&&c!==0);this.texture.requiresReTint=true;this.texture.baseTexture.dirty()};Phaser.Text.prototype._renderWebGL=function(a){if(this.dirty){this.updateText();this.dirty=false}PIXI.Sprite.prototype._renderWebGL.call(this,a)};Phaser.Text.prototype._renderCanvas=function(a){if(this.dirty){this.updateText();this.dirty=false}PIXI.Sprite.prototype._renderCanvas.call(this,a)};Phaser.Text.prototype.determineFontProperties=function(f){var k=Phaser.Text.fontPropertiesCache[f];if(!k){k={};var c=Phaser.Text.fontPropertiesCanvas;var b=Phaser.Text.fontPropertiesContext;b.font=f;var a=Math.ceil(b.measureText("|Mq").width);var h=Math.ceil(b.measureText("|Mq").width);var o=2*h;h=h*1.4|0;c.width=a;c.height=o;b.fillStyle="#f00";b.fillRect(0,0,a,o);b.font=f;b.textBaseline="alphabetic";b.fillStyle="#000";b.fillText("|Mq",0,h);if(!b.getImageData(0,0,a,o)){k.ascent=h;k.descent=h+6;k.fontSize=k.ascent+k.descent;Phaser.Text.fontPropertiesCache[f]=k;return k}var l=b.getImageData(0,0,a,o).data;var d=l.length;var p=a*4;var g,e;var n=0;var m=false;for(g=0;g<h;g++){for(e=0;e<p;e+=4){if(l[n+e]!==255){m=true;break}}if(!m){n+=p}else{break}}k.ascent=h-g;n=d-p;m=false;for(g=o;g>h;g--){for(e=0;e<p;e+=4){if(l[n+e]!==255){m=true;break}}if(!m){n-=p}else{break}}k.descent=g-h;k.descent+=6;k.fontSize=k.ascent+k.descent;Phaser.Text.fontPropertiesCache[f]=k}return k};Phaser.Text.prototype.getBounds=function(a){if(this.dirty){this.updateText();this.dirty=false}return PIXI.Sprite.prototype.getBounds.call(this,a)};Phaser.Text.prototype.setCharacterLimit=function(b,a){this.characterLimitSuffix=(a===undefined)?"":a;this.characterLimitSize=b;this.updateText()};Object.defineProperty(Phaser.Text.prototype,"text",{get:function(){return this._text},set:function(a){if(a!==this._text){this._text=a.toString()||"";this.dirty=true;if(this.parent){this.updateTransform()}}}});Object.defineProperty(Phaser.Text.prototype,"cssFont",{get:function(){return this.componentsToFont(this._fontComponents)},set:function(a){a=a||"bold 20pt Arial";this._fontComponents=this.fontToComponents(a);this.updateFont(this._fontComponents)}});Object.defineProperty(Phaser.Text.prototype,"font",{get:function(){return this._fontComponents.fontFamily},set:function(a){a=a||"Arial";a=a.trim();if(!/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(a)&&!/['",]/.exec(a)){a="'"+a+"'"}this._fontComponents.fontFamily=a;this.updateFont(this._fontComponents)}});Object.defineProperty(Phaser.Text.prototype,"fontSize",{get:function(){var a=this._fontComponents.fontSize;if(a&&/(?:^0$|px$)/.exec(a)){return parseInt(a,10)}else{return a}},set:function(a){a=a||"0";if(typeof a==="number"){a=a+"px"}this._fontComponents.fontSize=a;this.updateFont(this._fontComponents)}});Object.defineProperty(Phaser.Text.prototype,"fontWeight",{get:function(){return this._fontComponents.fontWeight||"normal"},set:function(a){a=a||"normal";this._fontComponents.fontWeight=a;this.updateFont(this._fontComponents)}});Object.defineProperty(Phaser.Text.prototype,"fontStyle",{get:function(){return this._fontComponents.fontStyle||"normal"},set:function(a){a=a||"normal";this._fontComponents.fontStyle=a;this.updateFont(this._fontComponents)}});Object.defineProperty(Phaser.Text.prototype,"fontVariant",{get:function(){return this._fontComponents.fontVariant||"normal"},set:function(a){a=a||"normal";this._fontComponents.fontVariant=a;this.updateFont(this._fontComponents)}});Object.defineProperty(Phaser.Text.prototype,"fill",{get:function(){return this.style.fill},set:function(a){if(a!==this.style.fill){this.style.fill=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"align",{get:function(){return this.style.align},set:function(a){a=a.toLowerCase();if(a!==this.style.align){this.style.align=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"resolution",{get:function(){return this._res},set:function(a){if(a!==this._res){this._res=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"tabs",{get:function(){return this.style.tabs},set:function(a){if(a!==this.style.tabs){this.style.tabs=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"boundsAlignH",{get:function(){return this.style.boundsAlignH},set:function(a){a=a.toLowerCase();if(a!==this.style.boundsAlignH){this.style.boundsAlignH=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"boundsAlignV",{get:function(){return this.style.boundsAlignV},set:function(a){a=a.toLowerCase();if(a!==this.style.boundsAlignV){this.style.boundsAlignV=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"stroke",{get:function(){return this.style.stroke},set:function(a){if(a!==this.style.stroke){this.style.stroke=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"strokeThickness",{get:function(){return this.style.strokeThickness},set:function(a){if(a!==this.style.strokeThickness){this.style.strokeThickness=Number(a);this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"wordWrap",{get:function(){return this.style.wordWrap},set:function(a){if(a!==this.style.wordWrap){this.style.wordWrap=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"wordWrapWidth",{get:function(){return this.style.wordWrapWidth},set:function(a){if(a!==this.style.wordWrapWidth){this.style.wordWrapWidth=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(a){if(a!==this._lineSpacing){this._lineSpacing=parseFloat(a);this.dirty=true;if(this.parent){this.updateTransform()}}}});Object.defineProperty(Phaser.Text.prototype,"shadowOffsetX",{get:function(){return this.style.shadowOffsetX},set:function(a){if(a!==this.style.shadowOffsetX){this.style.shadowOffsetX=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"shadowOffsetY",{get:function(){return this.style.shadowOffsetY},set:function(a){if(a!==this.style.shadowOffsetY){this.style.shadowOffsetY=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"shadowColor",{get:function(){return this.style.shadowColor},set:function(a){if(a!==this.style.shadowColor){this.style.shadowColor=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"shadowBlur",{get:function(){return this.style.shadowBlur},set:function(a){if(a!==this.style.shadowBlur){this.style.shadowBlur=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"shadowStroke",{get:function(){return this.style.shadowStroke},set:function(a){if(a!==this.style.shadowStroke){this.style.shadowStroke=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"shadowFill",{get:function(){return this.style.shadowFill},set:function(a){if(a!==this.style.shadowFill){this.style.shadowFill=a;this.dirty=true}}});Object.defineProperty(Phaser.Text.prototype,"width",{get:function(){if(this.dirty){this.updateText();this.dirty=false}return this.scale.x*(this.texture.frame.width/this.resolution)},set:function(a){this.scale.x=a/this.texture.frame.width;this._width=a}});Object.defineProperty(Phaser.Text.prototype,"height",{get:function(){if(this.dirty){this.updateText();this.dirty=false}return this.scale.y*(this.texture.frame.height/this.resolution)},set:function(a){this.scale.y=a/this.texture.frame.height;this._height=a}});Phaser.Text.fontPropertiesCache={};Phaser.Text.fontPropertiesCanvas=document.createElement("canvas");Phaser.Text.fontPropertiesContext=Phaser.Text.fontPropertiesCanvas.getContext("2d");Phaser.BitmapText=function(c,a,g,b,e,d,f){a=a||0;g=g||0;b=b||"";e=e||"";d=d||32;f=f||"left";PIXI.DisplayObjectContainer.call(this);this.type=Phaser.BITMAPTEXT;this.physicsType=Phaser.SPRITE;this.textWidth=0;this.textHeight=0;this.anchor=new Phaser.Point();this._prevAnchor=new Phaser.Point();this._glyphs=[];this._maxWidth=0;this._text=e.toString()||"";this._data=c.cache.getBitmapFont(b);this._font=b;this._fontSize=d;this._align=f;this._tint=16777215;this.updateText();this.dirty=false;Phaser.Component.Core.init.call(this,c,a,g,"",null)};Phaser.BitmapText.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);Phaser.BitmapText.prototype.constructor=Phaser.BitmapText;Phaser.Component.Core.install.call(Phaser.BitmapText.prototype,["Angle","AutoCull","Bounds","Destroy","FixedToCamera","InputEnabled","InWorld","LifeSpan","PhysicsBody","Reset"]);Phaser.BitmapText.prototype.preUpdatePhysics=Phaser.Component.PhysicsBody.preUpdate;Phaser.BitmapText.prototype.preUpdateLifeSpan=Phaser.Component.LifeSpan.preUpdate;Phaser.BitmapText.prototype.preUpdateInWorld=Phaser.Component.InWorld.preUpdate;Phaser.BitmapText.prototype.preUpdateCore=Phaser.Component.Core.preUpdate;Phaser.BitmapText.prototype.preUpdate=function(){if(!this.preUpdatePhysics()||!this.preUpdateLifeSpan()||!this.preUpdateInWorld()){return false}return this.preUpdateCore()};Phaser.BitmapText.prototype.postUpdate=function(){Phaser.Component.PhysicsBody.postUpdate.call(this);Phaser.Component.FixedToCamera.postUpdate.call(this);if(this.body&&this.body.type===Phaser.Physics.ARCADE){if((this.textWidth!==this.body.sourceWidth)||(this.textHeight!==this.body.sourceHeight)){this.body.setSize(this.textWidth,this.textHeight)}}};Phaser.BitmapText.prototype.setText=function(a){this.text=a};Phaser.BitmapText.prototype.scanLine=function(g,d,q){var m=0;var n=0;var r=-1;var a=0;var j=null;var o=(this._maxWidth>0)?this._maxWidth:null;var l=[];for(var f=0;f<q.length;f++){var e=(f===q.length-1)?true:false;if(/(?:\r\n|\r|\n)/.test(q.charAt(f))){return{width:n,text:q.substr(0,f),end:e,chars:l}}else{var p=q.charCodeAt(f);var b=g.chars[p];var k=0;if(b===undefined){p=32;b=g.chars[p]}var h=(j&&b.kerning[j])?b.kerning[j]:0;if(/(\s)/.test(q.charAt(f))){r=f;a=n}k=(h+b.texture.width+b.xOffset)*d;if(o&&((n+k)>=o)&&r>-1){return{width:a||n,text:q.substr(0,f-(f-r)),end:false,chars:l}}else{n+=(b.xAdvance+h)*d;l.push(m+(b.xOffset+h)*d);m+=(b.xAdvance+h)*d;j=p}}}return{width:n,text:q,end:e,chars:l}};Phaser.BitmapText.prototype.cleanText=function(g,a){if(a===undefined){a=""}var d=this._data.font;if(!d){return""}var h=/\r\n|\n\r|\n|\r/g;var j=g.replace(h,"\n").split("\n");for(var e=0;e<j.length;e++){var b="";var k=j[e];for(var f=0;f<k.length;f++){if(d.chars[k.charCodeAt(f)]){b=b.concat(k[f])}else{b=b.concat(a)}}j[e]=b}return j.join("\n")};Phaser.BitmapText.prototype.updateText=function(){var f=this._data.font;if(!f){return}var n=this.text;var d=this._fontSize/f.size;var q=[];var l=0;this.textWidth=0;do{var r=this.scanLine(f,d,n);r.y=l;q.push(r);if(r.width>this.textWidth){this.textWidth=r.width}l+=(f.lineHeight*d);n=n.substr(r.text.length+1)}while(r.end===false);this.textHeight=l;var o=0;var j=0;var a=this.textWidth*this.anchor.x;var p=this.textHeight*this.anchor.y;for(var e=0;e<q.length;e++){var r=q[e];if(this._align==="right"){j=this.textWidth-r.width}else{if(this._align==="center"){j=(this.textWidth-r.width)/2}}for(var k=0;k<r.text.length;k++){var m=r.text.charCodeAt(k);var b=f.chars[m];if(b===undefined){m=32;b=f.chars[m]}var h=this._glyphs[o];if(h){h.texture=b.texture}else{h=new PIXI.Sprite(b.texture);h.name=r.text[k];this._glyphs.push(h)}h.position.x=(r.chars[k]+j)-a;h.position.y=(r.y+(b.yOffset*d))-p;h.scale.set(d);h.tint=this.tint;h.texture.requiresReTint=true;h.cachedTint=16777215;if(!h.parent){this.addChild(h)}o++}}for(e=o;e<this._glyphs.length;e++){this.removeChild(this._glyphs[e])}};Phaser.BitmapText.prototype.purgeGlyphs=function(){var a=this._glyphs.length;var c=[];for(var b=0;b<this._glyphs.length;b++){if(this._glyphs[b].parent!==this){this._glyphs[b].destroy()}else{c.push(this._glyphs[b])}}this._glyphs=[];this._glyphs=c;this.updateText();return a-c.length};Phaser.BitmapText.prototype.updateTransform=function(){if(this.dirty||!this.anchor.equals(this._prevAnchor)){this.updateText();this.dirty=false;this._prevAnchor.copyFrom(this.anchor)}PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)};Object.defineProperty(Phaser.BitmapText.prototype,"align",{get:function(){return this._align},set:function(a){if(a!==this._align&&(a==="left"||a==="center"||a==="right")){this._align=a;this.updateText()}}});Object.defineProperty(Phaser.BitmapText.prototype,"tint",{get:function(){return this._tint},set:function(a){if(a!==this._tint){this._tint=a;this.updateText()}}});Object.defineProperty(Phaser.BitmapText.prototype,"font",{get:function(){return this._font},set:function(a){if(a!==this._font){this._font=a.trim();this._data=this.game.cache.getBitmapFont(this._font);this.updateText()}}});Object.defineProperty(Phaser.BitmapText.prototype,"fontSize",{get:function(){return this._fontSize},set:function(a){a=parseInt(a,10);if(a!==this._fontSize&&a>0){this._fontSize=a;this.updateText()}}});Object.defineProperty(Phaser.BitmapText.prototype,"text",{get:function(){return this._text},set:function(a){if(a!==this._text){this._text=a.toString()||"";this.updateText()}}});Object.defineProperty(Phaser.BitmapText.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(a){if(a!==this._maxWidth){this._maxWidth=a;this.updateText()}}});Object.defineProperty(Phaser.BitmapText.prototype,"smoothed",{get:function(){return !this._data.base.scaleMode},set:function(a){if(a){this._data.base.scaleMode=0}else{this._data.base.scaleMode=1}}});Phaser.TileSprite=function(){};Phaser.CanvasPool={create:function(f,e,b){var a=Phaser.CanvasPool.getFirst();var d;if(a===-1){var c={parent:f,canvas:document.createElement("canvas")};Phaser.CanvasPool.pool.push(c);d=c.canvas}else{Phaser.CanvasPool.pool[a].parent=f;d=Phaser.CanvasPool.pool[a].canvas}if(e!==undefined){d.width=e;d.height=b}return d},getFirst:function(){var b=Phaser.CanvasPool.pool;for(var a=0;a<b.length;a++){if(!b[a].parent){return a}}return -1},remove:function(c){var b=Phaser.CanvasPool.pool;for(var a=0;a<b.length;a++){if(b[a].parent===c){b[a].parent=null;b[a].canvas.width=1;b[a].canvas.height=1}}},removeByCanvas:function(a){var c=Phaser.CanvasPool.pool;for(var b=0;b<c.length;b++){if(c[b].canvas===a){c[b].parent=null;c[b].canvas.width=1;c[b].canvas.height=1}}},getTotal:function(){var b=Phaser.CanvasPool.pool;var d=0;for(var a=0;a<b.length;a++){if(b[a].parent){d++}}return d},getFree:function(){var b=Phaser.CanvasPool.pool;var d=0;for(var a=0;a<b.length;a++){if(!b[a].parent){d++}}return d},log:function(){console.log("CanvasPool: %s used, %s free, %s total",this.getTotal(),this.getFree(),this.pool.length)}};Phaser.CanvasPool.pool=[];Object.defineProperty(Phaser.CanvasPool,"length",{get:function(){return this.pool.length}});Phaser.Device=function(){this.deviceReadyAt=0;this.initialized=false;this.desktop=false;this.iOS=false;this.iOSVersion=0;this.cocoonJS=false;this.cocoonJSApp=false;this.cordova=false;this.node=false;this.nodeWebkit=false;this.electron=false;this.ejecta=false;this.crosswalk=false;this.android=false;this.chromeOS=false;this.linux=false;this.macOS=false;this.windows=false;this.windowsPhone=false;this.canvas=false;this.canvasBitBltShift=null;this.canHandleAlpha=false;this.canUseMultiply=false;this.webGL=false;this.file=false;this.fileSystem=false;this.localStorage=false;this.worker=false;this.css3D=false;this.pointerLock=false;this.typedArray=false;this.vibration=false;this.getUserMedia=true;this.quirksMode=false;this.touch=false;this.mspointer=false;this.wheelEvent=null;this.arora=false;this.chrome=false;this.chromeVersion=0;this.epiphany=false;this.firefox=false;this.firefoxVersion=0;this.ie=false;this.ieVersion=0;this.trident=false;this.tridentVersion=0;this.edge=false;this.mobileSafari=false;this.midori=false;this.opera=false;this.safari=false;this.safariVersion=0;this.webApp=false;this.silk=false;this.audioData=false;this.webAudio=false;this.ogg=false;this.opus=false;this.mp3=false;this.wav=false;this.m4a=false;this.webm=false;this.dolby=false;this.oggVideo=false;this.h264Video=false;this.mp4Video=false;this.webmVideo=false;this.vp9Video=false;this.hlsVideo=false;this.iPhone=false;this.iPhone4=false;this.iPad=false;this.pixelRatio=0;this.littleEndian=false;this.LITTLE_ENDIAN=false;this.support32bit=false;this.fullscreen=false;this.requestFullscreen="";this.cancelFullscreen="";this.fullscreenKeyboard=false};Phaser.Device=new Phaser.Device();Phaser.Device.onInitialized=new Phaser.Signal();Phaser.Device.whenReady=function(f,c,b){var d=this._readyCheck;if(this.deviceReadyAt||!d){f.call(c,this)}else{if(d._monitor||b){d._queue=d._queue||[];d._queue.push([f,c])}else{d._monitor=d.bind(this);d._queue=d._queue||[];d._queue.push([f,c]);var e=typeof window.cordova!=="undefined";var a=navigator.isCocoonJS;if(document.readyState==="complete"||document.readyState==="interactive"){window.setTimeout(d._monitor,0)}else{if(e&&!a){document.addEventListener("deviceready",d._monitor,false)}else{document.addEventListener("DOMContentLoaded",d._monitor,false);window.addEventListener("load",d._monitor,false)}}}}};Phaser.Device._readyCheck=function(){var b=this._readyCheck;if(!document.body){window.setTimeout(b._monitor,20)}else{if(!this.deviceReadyAt){this.deviceReadyAt=Date.now();document.removeEventListener("deviceready",b._monitor);document.removeEventListener("DOMContentLoaded",b._monitor);window.removeEventListener("load",b._monitor);this._initialize();this.initialized=true;this.onInitialized.dispatch(this);var c;while((c=b._queue.shift())){var d=c[0];var a=c[1];d.call(a,this)}this._readyCheck=null;this._initialize=null;this.onInitialized=null}}};Phaser.Device._initialize=function(){var d=this;function c(){var o=navigator.userAgent;if(/Playstation Vita/.test(o)){d.vita=true}else{if(/Kindle/.test(o)||/\bKF[A-Z][A-Z]+/.test(o)||/Silk.*Mobile Safari/.test(o)){d.kindle=true}else{if(/Android/.test(o)){d.android=true}else{if(/CrOS/.test(o)){d.chromeOS=true}else{if(/iP[ao]d|iPhone/i.test(o)){d.iOS=true;(navigator.appVersion).match(/OS (\d+)/);d.iOSVersion=parseInt(RegExp.$1,10)}else{if(/Linux/.test(o)){d.linux=true}else{if(/Mac OS/.test(o)){d.macOS=true}else{if(/Windows/.test(o)){d.windows=true}}}}}}}}if(/Windows Phone/i.test(o)||/IEMobile/i.test(o)){d.android=false;d.iOS=false;d.macOS=false;d.windows=true;d.windowsPhone=true}var n=/Silk/.test(o);if(d.windows||d.macOS||(d.linux&&!n)||d.chromeOS){d.desktop=true}if(d.windowsPhone||((/Windows NT/i.test(o))&&(/Touch/i.test(o)))){d.desktop=false}}function g(){var o=Phaser.CanvasPool.create(this,6,1);var q=o.getContext("2d");q.fillStyle="rgba(10, 20, 30, 0.5)";q.fillRect(0,0,1,1);var p=q.getImageData(0,0,1,1);if(p){q.putImageData(p,1,0);var n=q.getImageData(1,0,1,1);d.canHandleAlpha=(n.data[0]===p.data[0]&&n.data[1]===p.data[1]&&n.data[2]===p.data[2]&&n.data[3]===p.data[3])}q.globalCompositeOperation="multiply";d.canUseMultiply=(q.globalCompositeOperation==="multiply");Phaser.CanvasPool.removeByCanvas(o);PIXI.CanvasTinter.tintMethod=(d.canUseMultiply)?PIXI.CanvasTinter.tintWithMultiply:PIXI.CanvasTinter.tintWithPerPixel}function m(){d.canvas=!!window.CanvasRenderingContext2D||d.cocoonJS;try{d.localStorage=!!localStorage.getItem}catch(n){d.localStorage=false}d.file=!!window.File&&!!window.FileReader&&!!window.FileList&&!!window.Blob;d.fileSystem=!!window.requestFileSystem;d.webGL=(function(){try{var o=document.createElement("canvas");o.screencanvas=false;return !!window.WebGLRenderingContext&&(o.getContext("webgl")||o.getContext("experimental-webgl"))}catch(p){return false}})();d.webGL=!!d.webGL;d.worker=!!window.Worker;d.pointerLock="pointerLockElement" in document||"mozPointerLockElement" in document||"webkitPointerLockElement" in document;d.quirksMode=(document.compatMode==="CSS1Compat")?false:true;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia;window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL;d.getUserMedia=d.getUserMedia&&!!navigator.getUserMedia&&!!window.URL;if(d.firefox&&d.firefoxVersion<21){d.getUserMedia=false}if(!d.iOS&&(d.ie||d.firefox||d.chrome)){d.canvasBitBltShift=true}if(d.safari||d.mobileSafari){d.canvasBitBltShift=false}}function l(){if("ontouchstart" in document.documentElement||(window.navigator.maxTouchPoints&&window.navigator.maxTouchPoints>=1)){d.touch=true}if(window.PointerEvent||window.MSPointerEvent||window.navigator.msPointerEnabled||window.navigator.pointerEnabled){d.mspointer=true}if(!d.cocoonJS){if("onwheel" in window||(d.ie&&"WheelEvent" in window)){d.wheelEvent="wheel"}else{if("onmousewheel" in window){d.wheelEvent="mousewheel"}else{if(d.firefox&&"MouseScrollEvent" in window){d.wheelEvent="DOMMouseScroll"}}}}}function j(){var o=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","msRequestFullscreen","msRequestFullScreen","mozRequestFullScreen","mozRequestFullscreen"];var q=document.createElement("div");for(var p=0;p<o.length;p++){if(q[o[p]]){d.fullscreen=true;d.requestFullscreen=o[p];break}}var n=["cancelFullScreen","exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","msCancelFullScreen","msExitFullscreen","mozCancelFullScreen","mozExitFullscreen"];if(d.fullscreen){for(var p=0;p<n.length;p++){if(document[n[p]]){d.cancelFullscreen=n[p];break}}}if(window.Element&&Element.ALLOW_KEYBOARD_INPUT){d.fullscreenKeyboard=true}}function k(){var o=navigator.userAgent;if(/Arora/.test(o)){d.arora=true}else{if(/Edge\/\d+/.test(o)){d.edge=true}else{if(/Chrome\/(\d+)/.test(o)&&!d.windowsPhone){d.chrome=true;d.chromeVersion=parseInt(RegExp.$1,10)}else{if(/Epiphany/.test(o)){d.epiphany=true}else{if(/Firefox\D+(\d+)/.test(o)){d.firefox=true;d.firefoxVersion=parseInt(RegExp.$1,10)}else{if(/AppleWebKit/.test(o)&&d.iOS){d.mobileSafari=true}else{if(/MSIE (\d+\.\d+);/.test(o)){d.ie=true;d.ieVersion=parseInt(RegExp.$1,10)}else{if(/Midori/.test(o)){d.midori=true}else{if(/Opera/.test(o)){d.opera=true}else{if(/Safari\/(\d+)/.test(o)&&!d.windowsPhone){d.safari=true;if(/Version\/(\d+)\./.test(o)){d.safariVersion=parseInt(RegExp.$1,10)}}else{if(/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(o)){d.ie=true;d.trident=true;d.tridentVersion=parseInt(RegExp.$1,10);d.ieVersion=parseInt(RegExp.$3,10)}}}}}}}}}}}if(/Silk/.test(o)){d.silk=true}if(navigator.standalone){d.webApp=true}if(typeof window.cordova!=="undefined"){d.cordova=true}if(typeof process!=="undefined"&&typeof require!=="undefined"){d.node=true}if(d.node&&typeof process.versions==="object"){d.nodeWebkit=!!process.versions["node-webkit"];d.electron=!!process.versions.electron}if(navigator.isCocoonJS){d.cocoonJS=true}if(d.cocoonJS){try{d.cocoonJSApp=(typeof CocoonJS!=="undefined")}catch(n){d.cocoonJSApp=false}}if(typeof window.ejecta!=="undefined"){d.ejecta=true}if(/Crosswalk/.test(o)){d.crosswalk=true}}function e(){var o=document.createElement("video");var n=false;try{if(n=!!o.canPlayType){if(o.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")){d.oggVideo=true}if(o.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")){d.h264Video=true;d.mp4Video=true}if(o.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")){d.webmVideo=true}if(o.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")){d.vp9Video=true}if(o.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")){d.hlsVideo=true}}}catch(p){}}function i(){d.audioData=!!(window.Audio);d.webAudio=!!(window.AudioContext||window.webkitAudioContext);var r=document.createElement("audio");var n=false;try{if(n=!!r.canPlayType){if(r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")){d.ogg=true}if(r.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||r.canPlayType("audio/opus;").replace(/^no$/,"")){d.opus=true}if(r.canPlayType("audio/mpeg;").replace(/^no$/,"")){d.mp3=true}if(r.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")){d.wav=true}if(r.canPlayType("audio/x-m4a;")||r.canPlayType("audio/aac;").replace(/^no$/,"")){d.m4a=true}if(r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")){d.webm=true}if(r.canPlayType('audio/mp4;codecs="ec-3"')!==""){if(d.edge){d.dolby=true}else{if(d.safari&&d.safariVersion>=9){if(/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var o=parseInt(RegExp.$1,10);var p=parseInt(RegExp.$2,10);if((o===10&&p>=11)||o>10){d.dolby=true}}}}}}}catch(q){}}function h(){var o=new ArrayBuffer(4);var n=new Uint8Array(o);var p=new Uint32Array(o);n[0]=161;n[1]=178;n[2]=195;n[3]=212;if(p[0]===3569595041){return true}if(p[0]===2712847316){return false}else{return null}}function f(){if(Uint8ClampedArray===undefined){return false}var o=Phaser.CanvasPool.create(this,1,1);var n=o.getContext("2d");if(!n){return false}var p=n.createImageData(1,1);Phaser.CanvasPool.remove(this);return p.data instanceof Uint8ClampedArray}function a(){d.pixelRatio=window.devicePixelRatio||1;d.iPhone=navigator.userAgent.toLowerCase().indexOf("iphone")!==-1;d.iPhone4=(d.pixelRatio===2&&d.iPhone);d.iPad=navigator.userAgent.toLowerCase().indexOf("ipad")!==-1;if(typeof Int8Array!=="undefined"){d.typedArray=true}else{d.typedArray=false}if(typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined"&&typeof Uint32Array!=="undefined"){d.littleEndian=h();d.LITTLE_ENDIAN=d.littleEndian}d.support32bit=(typeof ArrayBuffer!=="undefined"&&typeof Uint8ClampedArray!=="undefined"&&typeof Int32Array!=="undefined"&&d.littleEndian!==null&&f());navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate;if(navigator.vibrate){d.vibration=true}}function b(){var p=document.createElement("p");var q;var o={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(p,null);for(var n in o){if(p.style[n]!==undefined){p.style[n]="translate3d(1px,1px,1px)";q=window.getComputedStyle(p).getPropertyValue(o[n])}}document.body.removeChild(p);d.css3D=(q!==undefined&&q.length>0&&q!=="none")}c();k();i();e();b();a();m();g();j();l()};Phaser.Device.canPlayAudio=function(a){if(a==="mp3"&&this.mp3){return true}else{if(a==="ogg"&&(this.ogg||this.opus)){return true}else{if(a==="m4a"&&this.m4a){return true}else{if(a==="opus"&&this.opus){return true}else{if(a==="wav"&&this.wav){return true}else{if(a==="webm"&&this.webm){return true}else{if(a==="mp4"&&this.dolby){return true}}}}}}}return false};Phaser.Device.canPlayVideo=function(a){if(a==="webm"&&(this.webmVideo||this.vp9Video)){return true}else{if(a==="mp4"&&(this.mp4Video||this.h264Video)){return true}else{if((a==="ogg"||a==="ogv")&&this.oggVideo){return true}else{if(a==="mpeg"&&this.hlsVideo){return true}}}}return false};Phaser.Device.needsTouchUnlock=function(){return !!(!this.cocoonJS&&(this.iOS||this.android)||(window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock))};Phaser.Device.isConsoleOpen=function(){console.warn("Phaser.Device.isConsoleOpen is deprecated and will be removed.");return false};Phaser.Device.isAndroidStockBrowser=function(){var a=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);return a&&a[1]<537};Phaser.Canvas={create:function(e,d,a,f,c){d=d||256;a=a||256;var b=(c)?document.createElement("canvas"):Phaser.CanvasPool.create(e,d,a);if(typeof f==="string"&&f!==""){b.id=f}b.width=d;b.height=a;b.style.display="block";return b},setBackgroundColor:function(b,a){a=a||"rgb(0,0,0)";b.style.backgroundColor=a;return b},setTouchAction:function(a,b){b=b||"none";a.style.msTouchAction=b;a.style["ms-touch-action"]=b;a.style["touch-action"]=b;return a},setUserSelect:function(a,b){b=b||"none";a.style["-webkit-touch-callout"]=b;a.style["-webkit-user-select"]=b;a.style["-khtml-user-select"]=b;a.style["-moz-user-select"]=b;a.style["-ms-user-select"]=b;a.style["user-select"]=b;a.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)";return a},addToDOM:function(a,b,d){var c;if(d===undefined){d=true}if(b){if(typeof b==="string"){c=document.getElementById(b)}else{if(typeof b==="object"&&b.nodeType===1){c=b}}}if(!c){c=document.body}if(d&&c.style){c.style.overflow="hidden"}c.appendChild(a);return a},removeFromDOM:function(a){if(a.parentNode){a.parentNode.removeChild(a)}},setTransform:function(e,g,f,c,a,d,b){e.setTransform(c,d,b,a,g,f);return e},setSmoothingEnabled:function(a,c){var b=Phaser.Canvas.getSmoothingPrefix(a);if(b){a[b]=c}return a},getSmoothingPrefix:function(a){var d=["i","webkitI","msI","mozI","oI"];for(var c in d){var b=d[c]+"mageSmoothingEnabled";if(b in a){return b}}return null},getSmoothingEnabled:function(a){var b=Phaser.Canvas.getSmoothingPrefix(a);if(b){return a[b]}},setImageRenderingCrisp:function(a){var c=["optimizeSpeed","crisp-edges","-moz-crisp-edges","-webkit-optimize-contrast","optimize-contrast","pixelated"];for(var b=0;b<c.length;b++){a.style["image-rendering"]=c[b]}a.style.msInterpolationMode="nearest-neighbor";return a},setImageRenderingBicubic:function(a){a.style["image-rendering"]="auto";a.style.msInterpolationMode="bicubic";return a}};Phaser.RequestAnimationFrame=function(b,c){if(c===undefined){c=false}this.game=b;this.isRunning=false;this.forceSetTimeOut=c;var d=["ms","moz","webkit","o"];for(var a=0;a<d.length&&!window.requestAnimationFrame;a++){window.requestAnimationFrame=window[d[a]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[d[a]+"CancelAnimationFrame"]||window[d[a]+"CancelRequestAnimationFrame"]}this._isSetTimeOut=false;this._onLoop=null;this._timeOutID=null};Phaser.RequestAnimationFrame.prototype={start:function(){this.isRunning=true;var a=this;if(!window.requestAnimationFrame||this.forceSetTimeOut){this._isSetTimeOut=true;this._onLoop=function(){return a.updateSetTimeout()};this._timeOutID=window.setTimeout(this._onLoop,0)}else{this._isSetTimeOut=false;this._onLoop=function(b){return a.updateRAF(b)};this._timeOutID=window.requestAnimationFrame(this._onLoop)}},updateRAF:function(a){if(this.isRunning){this.game.update(Math.floor(a));this._timeOutID=window.requestAnimationFrame(this._onLoop)}},updateSetTimeout:function(){if(this.isRunning){this.game.update(Date.now());this._timeOutID=window.setTimeout(this._onLoop,this.game.time.timeToCall)}},stop:function(){if(this._isSetTimeOut){clearTimeout(this._timeOutID)}else{window.cancelAnimationFrame(this._timeOutID)}this.isRunning=false},isSetTimeOut:function(){return this._isSetTimeOut},isRAF:function(){return(this._isSetTimeOut===false)}};Phaser.RequestAnimationFrame.prototype.constructor=Phaser.RequestAnimationFrame;Phaser.Math={PI2:Math.PI*2,HALF_PI:Math.PI*0.5,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,degToRad:function(a){return a*Phaser.Math.DEG_TO_RAD},radToDeg:function(a){return a*Phaser.Math.RAD_TO_DEG},getNextPowerOfTwo:function(b){if(b>0&&(b&(b-1))===0){return b}else{var a=1;while(a<b){a<<=1}return a}},isPowerOfTwo:function(b,a){return(b>0&&(b&(b-1))===0&&a>0&&(a&(a-1))===0)},random:function(c,a){if(c===undefined){c=0}if(a===undefined){a=1}if(c===a){return c}if(c>a){var b=c;c=a;a=b}return(Math.random()*(a-c)+c)},between:function(c,a){if(c===undefined){c=0}if(a===undefined){a=1}if(c===a){return c}if(c>a){var b=c;c=a;a=b}c=Math.ceil(c);a=Math.floor(a);return Math.floor(Math.random()*(a-c+1))+c},fuzzyEqual:function(d,c,e){if(e===undefined){e=0.0001}return Math.abs(d-c)<e},fuzzyLessThan:function(d,c,e){if(e===undefined){e=0.0001}return d<c+e},fuzzyGreaterThan:function(d,c,e){if(e===undefined){e=0.0001}return d>c-e},fuzzyCeil:function(a,b){if(b===undefined){b=0.0001}return Math.ceil(a-b)},fuzzyFloor:function(a,b){if(b===undefined){b=0.0001}return Math.floor(a+b)},average:function(){var c=0;var a=arguments.length;for(var b=0;b<a;b++){c+=(+arguments[b])}return c/a},shear:function(a){return a%1},snapTo:function(a,c,b){if(b===undefined){b=0}if(c===0){return a}a-=b;a=c*Math.round(a/c);return b+a},snapToFloor:function(a,c,b){if(b===undefined){b=0}if(c===0){return a}a-=b;a=c*Math.floor(a/c);return b+a},snapToCeil:function(a,c,b){if(b===undefined){b=0}if(c===0){return a}a-=b;a=c*Math.ceil(a/c);return b+a},roundTo:function(c,a,b){if(a===undefined){a=0}if(b===undefined){b=10}var d=Math.pow(b,-a);return Math.round(c*d)/d},floorTo:function(c,a,b){if(a===undefined){a=0}if(b===undefined){b=10}var d=Math.pow(b,-a);return Math.floor(c*d)/d},ceilTo:function(c,a,b){if(a===undefined){a=0}if(b===undefined){b=10}var d=Math.pow(b,-a);return Math.ceil(c*d)/d},rotateToAngle:function(b,c,a){if(a===undefined){a=0.05}if(b===c){return b}if(Math.abs(c-b)<=a||Math.abs(c-b)>=(Phaser.Math.PI2-a)){b=c}else{if(Math.abs(c-b)>Math.PI){if(c<b){c+=Phaser.Math.PI2}else{c-=Phaser.Math.PI2}}if(c>b){b+=a}else{if(c<b){b-=a}}}return b},getShortestAngle:function(c,a){var d=a-c;if(d===0){return 0}var b=Math.floor((d-(-180))/360);return d-(b*360)},angleBetween:function(b,d,a,c){return Math.atan2(c-d,a-b)},angleBetweenY:function(b,d,a,c){return Math.atan2(a-b,c-d)},angleBetweenPoints:function(b,a){return Math.atan2(a.y-b.y,a.x-b.x)},angleBetweenPointsY:function(b,a){return Math.atan2(a.x-b.x,a.y-b.y)},reverseAngle:function(a){return this.normalizeAngle(a+Math.PI,true)},normalizeAngle:function(a){a=a%(2*Math.PI);return a>=0?a:a+2*Math.PI},maxAdd:function(c,b,a){return Math.min(c+b,a)},minSub:function(c,b,a){return Math.max(c-b,a)},wrap:function(e,d,b){var c=b-d;if(c<=0){return 0}var a=(e-d)%c;if(a<0){a+=c}return a+d},wrapValue:function(c,b,a){var d;c=Math.abs(c);b=Math.abs(b);a=Math.abs(a);d=(c+b)%a;return d},isOdd:function(a){return !!(a&1)},isEven:function(a){return !(a&1)},min:function(){if(arguments.length===1&&typeof arguments[0]==="object"){var d=arguments[0]}else{var d=arguments}for(var c=1,b=0,a=d.length;c<a;c++){if(d[c]<d[b]){b=c}}return d[b]},max:function(){if(arguments.length===1&&typeof arguments[0]==="object"){var d=arguments[0]}else{var d=arguments}for(var c=1,b=0,a=d.length;c<a;c++){if(d[c]>d[b]){b=c}}return d[b]},minProperty:function(e){if(arguments.length===2&&typeof arguments[1]==="object"){var d=arguments[1]}else{var d=arguments.slice(1)}for(var c=1,b=0,a=d.length;c<a;c++){if(d[c][e]<d[b][e]){b=c}}return d[b][e]},maxProperty:function(e){if(arguments.length===2&&typeof arguments[1]==="object"){var d=arguments[1]}else{var d=arguments.slice(1)}for(var c=1,b=0,a=d.length;c<a;c++){if(d[c][e]>d[b][e]){b=c}}return d[b][e]},wrapAngle:function(b,a){return a?this.wrap(b,-Math.PI,Math.PI):this.wrap(b,-180,180)},linearInterpolation:function(c,b){var a=c.length-1;var e=a*b;var d=Math.floor(e);if(b<0){return this.linear(c[0],c[1],e)}if(b>1){return this.linear(c[a],c[a-1],a-e)}return this.linear(c[d],c[d+1>a?a:d+1],e-d)},bezierInterpolation:function(d,c){var a=0;var f=d.length-1;for(var e=0;e<=f;e++){a+=Math.pow(1-c,f-e)*Math.pow(c,e)*d[e]*this.bernstein(f,e)}return a},catmullRomInterpolation:function(c,b){var a=c.length-1;var e=a*b;var d=Math.floor(e);if(c[0]===c[a]){if(b<0){d=Math.floor(e=a*(1+b))}return this.catmullRom(c[(d-1+a)%a],c[d],c[(d+1)%a],c[(d+2)%a],e-d)}else{if(b<0){return c[0]-(this.catmullRom(c[0],c[0],c[1],c[1],-e)-c[0])}if(b>1){return c[a]-(this.catmullRom(c[a],c[a],c[a-1],c[a-1],e-a)-c[a])}return this.catmullRom(c[d?d-1:0],c[d],c[a<d+1?a:d+1],c[a<d+2?a:d+2],e-d)}},linear:function(c,b,a){return(b-c)*a+c},bernstein:function(b,a){return this.factorial(b)/this.factorial(a)/this.factorial(b-a)},factorial:function(b){if(b===0){return 1}var a=b;while(--b){a*=b}return a},catmullRom:function(h,g,e,d,i){var f=(e-h)*0.5,c=(d-g)*0.5,b=i*i,a=i*b;return(2*g-2*e+f+c)*a+(-3*g+3*e-2*f-c)*b+f*i+g},difference:function(d,c){return Math.abs(d-c)},roundAwayFromZero:function(a){return(a>0)?Math.ceil(a):Math.floor(a)},sinCosGenerator:function(a,i,b,g){if(i===undefined){i=1}if(b===undefined){b=1}if(g===undefined){g=1}var h=i;var k=b;var e=g*Math.PI/a;var d=[];var j=[];for(var f=0;f<a;f++){k-=h*e;h+=k*e;d[f]=k;j[f]=h}return{sin:j,cos:d,length:a}},hypot:function(d,c){return Math.sqrt(d*d+c*c)},distance:function(d,f,c,e){var b=d-c;var a=f-e;return Math.sqrt(b*b+a*a)},distanceSq:function(d,f,c,e){var b=d-c;var a=f-e;return b*b+a*a},distancePow:function(b,d,a,c,e){if(e===undefined){e=2}return Math.sqrt(Math.pow(a-b,e)+Math.pow(c-d,e))},clamp:function(b,c,a){if(b<c){return c}else{if(a<b){return a}else{return b}}},clampBottom:function(b,c){return b<c?c:b},within:function(d,c,e){return(Math.abs(d-c)<=e)},mapLinear:function(b,c,a,e,d){return e+(b-c)*(d-e)/(a-c)},smoothstep:function(b,c,a){b=Math.max(0,Math.min(1,(b-c)/(a-c)));return b*b*(3-2*b)},smootherstep:function(b,c,a){b=Math.max(0,Math.min(1,(b-c)/(a-c)));return b*b*b*(b*(b*6-15)+10)},sign:function(a){return(a<0)?-1:((a>0)?1:0)},percent:function(d,c,e){if(e===undefined){e=0}if(d>c||e>c){return 1}else{if(d<e||e>d){return 0}else{return(d-e)/c}}}};Phaser.RandomDataGenerator=function(a){if(a===undefined){a=[]}this.c=1;this.s0=0;this.s1=0;this.s2=0;if(typeof a==="string"){this.state(a)}else{this.sow(a)}};Phaser.RandomDataGenerator.prototype={rnd:function(){var a=2091639*this.s0+this.c*2.3283064365386963e-10;this.c=a|0;this.s0=this.s1;this.s1=this.s2;this.s2=a-this.c;return this.s2},sow:function(b){this.s0=this.hash(" ");this.s1=this.hash(this.s0);this.s2=this.hash(this.s1);this.c=1;if(!b){return}for(var c=0;c<b.length&&(b[c]!=null);c++){var a=b[c];this.s0-=this.hash(a);this.s0+=~~(this.s0<0);this.s1-=this.hash(a);this.s1+=~~(this.s1<0);this.s2-=this.hash(a);this.s2+=~~(this.s2<0)}},hash:function(c){var b,a,d;d=4022871197;c=c.toString();for(a=0;a<c.length;a++){d+=c.charCodeAt(a);b=0.02519603282416938*d;d=b>>>0;b-=d;b*=d;d=b>>>0;b-=d;d+=b*4294967296}return(d>>>0)*2.3283064365386963e-10},integer:function(){return this.rnd.apply(this)*4294967296},frac:function(){return this.rnd.apply(this)+(this.rnd.apply(this)*2097152|0)*1.1102230246251565e-16},real:function(){return this.integer()+this.frac()},integerInRange:function(b,a){return Math.floor(this.realInRange(0,a-b+1)+b)},between:function(b,a){return this.integerInRange(b,a)},realInRange:function(b,a){return this.frac()*(a-b)+b},normal:function(){return 1-2*this.frac()},uuid:function(){var d="";var c="";for(c=d="";d++<36;c+=~d%5|d*3&4?(d^15?8^this.frac()*(d^20?16:4):4).toString(16):"-"){}return c},pick:function(a){return a[this.integerInRange(0,a.length-1)]},sign:function(){return this.pick([-1,1])},weightedPick:function(a){return a[~~(Math.pow(this.frac(),2)*(a.length-1)+0.5)]},timestamp:function(b,a){return this.realInRange(b||946684800000,a||1577862000000)},angle:function(){return this.integerInRange(-180,180)},state:function(a){if(typeof a==="string"&&a.match(/^!rnd/)){a=a.split(",");this.c=parseFloat(a[1]);this.s0=parseFloat(a[2]);this.s1=parseFloat(a[3]);this.s2=parseFloat(a[4])}return["!rnd",this.c,this.s0,this.s1,this.s2].join(",")}};Phaser.RandomDataGenerator.prototype.constructor=Phaser.RandomDataGenerator;Phaser.QuadTree=function(b,g,e,a,d,c,f){this.maxObjects=10;this.maxLevels=4;this.level=0;this.bounds={};this.objects=[];this.nodes=[];this._empty=[];this.reset(b,g,e,a,d,c,f)};Phaser.QuadTree.prototype={reset:function(b,g,e,a,d,c,f){this.maxObjects=d||10;this.maxLevels=c||4;this.level=f||0;this.bounds={x:Math.round(b),y:Math.round(g),width:e,height:a,subWidth:Math.floor(e/2),subHeight:Math.floor(a/2),right:Math.round(b)+Math.floor(e/2),bottom:Math.round(g)+Math.floor(a/2)};this.objects.length=0;this.nodes.length=0},populate:function(a){a.forEach(this.populateHandler,this,true)},populateHandler:function(a){if(a.body&&a.exists){this.insert(a.body)}},split:function(){this.nodes[0]=new Phaser.QuadTree(this.bounds.right,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,(this.level+1));this.nodes[1]=new Phaser.QuadTree(this.bounds.x,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,(this.level+1));this.nodes[2]=new Phaser.QuadTree(this.bounds.x,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,(this.level+1));this.nodes[3]=new Phaser.QuadTree(this.bounds.right,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,(this.level+1))},insert:function(a){var c=0;var b;if(this.nodes[0]!=null){b=this.getIndex(a);if(b!==-1){this.nodes[b].insert(a);return}}this.objects.push(a);if(this.objects.length>this.maxObjects&&this.level<this.maxLevels){if(this.nodes[0]==null){this.split()}while(c<this.objects.length){b=this.getIndex(this.objects[c]);if(b!==-1){this.nodes[b].insert(this.objects.splice(c,1)[0])}else{c++}}}},getIndex:function(b){var a=-1;if(b.x<this.bounds.right&&b.right<this.bounds.right){if(b.y<this.bounds.bottom&&b.bottom<this.bounds.bottom){a=1}else{if(b.y>this.bounds.bottom){a=2}}}else{if(b.x>this.bounds.right){if(b.y<this.bounds.bottom&&b.bottom<this.bounds.bottom){a=0}else{if(b.y>this.bounds.bottom){a=3}}}}return a},retrieve:function(b){if(b instanceof Phaser.Rectangle){var c=this.objects;var a=this.getIndex(b)}else{if(!b.body){return this._empty}var c=this.objects;var a=this.getIndex(b.body)}if(this.nodes[0]){if(a!==-1){c=c.concat(this.nodes[a].retrieve(b))}else{c=c.concat(this.nodes[0].retrieve(b));c=c.concat(this.nodes[1].retrieve(b));c=c.concat(this.nodes[2].retrieve(b));c=c.concat(this.nodes[3].retrieve(b))}}return c},clear:function(){this.objects.length=0;var a=this.nodes.length;while(a--){this.nodes[a].clear();this.nodes.splice(a,1)}this.nodes.length=0}};Phaser.QuadTree.prototype.constructor=Phaser.QuadTree;var netNoop=function(){};Phaser.Net=netNoop;Phaser.Net.prototype={isDisabled:true,getHostName:netNoop,checkDomainName:netNoop,updateQueryString:netNoop,getQueryString:netNoop,decodeURI:netNoop};Phaser.Net.prototype.constructor=Phaser.Net;Phaser.TweenManager=function(a){this.game=a;this.frameBased=false;this._tweens=[];this._add=[];this.easeMap={Power0:Phaser.Easing.Power0,Power1:Phaser.Easing.Power1,Power2:Phaser.Easing.Power2,Power3:Phaser.Easing.Power3,Power4:Phaser.Easing.Power4,Linear:Phaser.Easing.Linear.None,Quad:Phaser.Easing.Quadratic.Out,Cubic:Phaser.Easing.Cubic.Out,Quart:Phaser.Easing.Quartic.Out,Quint:Phaser.Easing.Quintic.Out,Sine:Phaser.Easing.Sinusoidal.Out,Expo:Phaser.Easing.Exponential.Out,Circ:Phaser.Easing.Circular.Out,Elastic:Phaser.Easing.Elastic.Out,Back:Phaser.Easing.Back.Out,Bounce:Phaser.Easing.Bounce.Out,"Quad.easeIn":Phaser.Easing.Quadratic.In,"Cubic.easeIn":Phaser.Easing.Cubic.In,"Quart.easeIn":Phaser.Easing.Quartic.In,"Quint.easeIn":Phaser.Easing.Quintic.In,"Sine.easeIn":Phaser.Easing.Sinusoidal.In,"Expo.easeIn":Phaser.Easing.Exponential.In,"Circ.easeIn":Phaser.Easing.Circular.In,"Elastic.easeIn":Phaser.Easing.Elastic.In,"Back.easeIn":Phaser.Easing.Back.In,"Bounce.easeIn":Phaser.Easing.Bounce.In,"Quad.easeOut":Phaser.Easing.Quadratic.Out,"Cubic.easeOut":Phaser.Easing.Cubic.Out,"Quart.easeOut":Phaser.Easing.Quartic.Out,"Quint.easeOut":Phaser.Easing.Quintic.Out,"Sine.easeOut":Phaser.Easing.Sinusoidal.Out,"Expo.easeOut":Phaser.Easing.Exponential.Out,"Circ.easeOut":Phaser.Easing.Circular.Out,"Elastic.easeOut":Phaser.Easing.Elastic.Out,"Back.easeOut":Phaser.Easing.Back.Out,"Bounce.easeOut":Phaser.Easing.Bounce.Out,"Quad.easeInOut":Phaser.Easing.Quadratic.InOut,"Cubic.easeInOut":Phaser.Easing.Cubic.InOut,"Quart.easeInOut":Phaser.Easing.Quartic.InOut,"Quint.easeInOut":Phaser.Easing.Quintic.InOut,"Sine.easeInOut":Phaser.Easing.Sinusoidal.InOut,"Expo.easeInOut":Phaser.Easing.Exponential.InOut,"Circ.easeInOut":Phaser.Easing.Circular.InOut,"Elastic.easeInOut":Phaser.Easing.Elastic.InOut,"Back.easeInOut":Phaser.Easing.Back.InOut,"Bounce.easeInOut":Phaser.Easing.Bounce.InOut};this.game.onPause.add(this._pauseAll,this);this.game.onResume.add(this._resumeAll,this)};Phaser.TweenManager.prototype={getAll:function(){return this._tweens},removeAll:function(){for(var a=0;a<this._tweens.length;a++){this._tweens[a].pendingDelete=true}this._add=[]},removeFrom:function(d,c){if(c===undefined){c=true}var b;var a;if(Array.isArray(d)){for(b=0,a=d.length;b<a;b++){this.removeFrom(d[b])}}else{if(d.type===Phaser.GROUP&&c){for(var b=0,a=d.children.length;b<a;b++){this.removeFrom(d.children[b])}}else{for(b=0,a=this._tweens.length;b<a;b++){if(d===this._tweens[b].target){this.remove(this._tweens[b])}}for(b=0,a=this._add.length;b<a;b++){if(d===this._add[b].target){this.remove(this._add[b])}}}}},add:function(a){a._manager=this;this._add.push(a)},create:function(a){return new Phaser.Tween(a,this.game,this)},remove:function(b){var a=this._tweens.indexOf(b);if(a!==-1){this._tweens[a].pendingDelete=true}else{a=this._add.indexOf(b);if(a!==-1){this._add[a].pendingDelete=true}}},update:function(){var c=this._add.length;var b=this._tweens.length;if(b===0&&c===0){return false}var a=0;while(a<b){if(this._tweens[a].update(this.game.time.time)){a++}else{this._tweens.splice(a,1);b--}}if(c>0){this._tweens=this._tweens.concat(this._add);this._add.length=0}return true},isTweening:function(a){return this._tweens.some(function(b){return b.target===a})},_pauseAll:function(){for(var a=this._tweens.length-1;a>=0;a--){this._tweens[a]._pause()}},_resumeAll:function(){for(var a=this._tweens.length-1;a>=0;a--){this._tweens[a]._resume()}},pauseAll:function(){for(var a=this._tweens.length-1;a>=0;a--){this._tweens[a].pause()}},resumeAll:function(){for(var a=this._tweens.length-1;a>=0;a--){this._tweens[a].resume(true)}}};Phaser.TweenManager.prototype.constructor=Phaser.TweenManager;Phaser.Tween=function(c,a,b){this.game=a;this.target=c;this.manager=b;this.timeline=[];this.reverse=false;this.timeScale=1;this.repeatCounter=0;this.pendingDelete=false;this.onStart=new Phaser.Signal();this.onLoop=new Phaser.Signal();this.onRepeat=new Phaser.Signal();this.onChildComplete=new Phaser.Signal();this.onComplete=new Phaser.Signal();this.isRunning=false;this.current=0;this.properties={};this.chainedTween=null;this.isPaused=false;this.frameBased=b.frameBased;this._onUpdateCallback=null;this._onUpdateCallbackContext=null;this._pausedTime=0;this._codePaused=false;this._hasStarted=false};Phaser.Tween.updateColor=function(a){Phaser.Color.updateColor(a.target)};Phaser.Tween.prototype={to:function(c,f,g,b,a,e,d){if(f===undefined||f<=0){f=1000}if(g===undefined||g===null){g=Phaser.Easing.Default}if(b===undefined){b=false}if(a===undefined){a=0}if(e===undefined){e=0}if(d===undefined){d=false}if(typeof g==="string"&&this.manager.easeMap[g]){g=this.manager.easeMap[g]}if(this.isRunning){console.warn("Phaser.Tween.to cannot be called after Tween.start");return this}this.timeline.push(new Phaser.TweenData(this).to(c,f,g,a,e,d));if(b){this.start()}return this},from:function(c,f,g,b,a,e,d){if(f===undefined){f=1000}if(g===undefined||g===null){g=Phaser.Easing.Default}if(b===undefined){b=false}if(a===undefined){a=0}if(e===undefined){e=0}if(d===undefined){d=false}if(typeof g==="string"&&this.manager.easeMap[g]){g=this.manager.easeMap[g]}if(this.isRunning){console.warn("Phaser.Tween.from cannot be called after Tween.start");return this}this.timeline.push(new Phaser.TweenData(this).from(c,f,g,a,e,d));if(b){this.start()}return this},start:function(a){if(a===undefined){a=0}if(this.game===null||this.target===null||this.timeline.length===0||this.isRunning){return this}for(var b=0;b<this.timeline.length;b++){for(var c in this.timeline[b].vEnd){this.properties[c]=this.target[c]||0;if(!Array.isArray(this.properties[c])){this.properties[c]*=1}}}for(var b=0;b<this.timeline.length;b++){this.timeline[b].loadValues()}this.manager.add(this);this.isRunning=true;if(a<0||a>this.timeline.length-1){a=0}this.current=a;this.timeline[this.current].start();return this},stop:function(a){if(a===undefined){a=false}this.isRunning=false;this._onUpdateCallback=null;this._onUpdateCallbackContext=null;if(a){this.onComplete.dispatch(this.target,this);this._hasStarted=false;if(this.chainedTween){this.chainedTween.start()}}this.manager.remove(this);return this},updateTweenData:function(d,c,a){if(this.timeline.length===0){return this}if(a===undefined){a=0}if(a===-1){for(var b=0;b<this.timeline.length;b++){this.timeline[b][d]=c}}else{this.timeline[a][d]=c}return this},delay:function(b,a){return this.updateTweenData("delay",b,a)},repeat:function(b,c,a){if(c===undefined){c=0}this.updateTweenData("repeatCounter",b,a);return this.updateTweenData("repeatDelay",c,a)},repeatDelay:function(b,a){return this.updateTweenData("repeatDelay",b,a)},yoyo:function(b,c,a){if(c===undefined){c=0}this.updateTweenData("yoyo",b,a);return this.updateTweenData("yoyoDelay",c,a)},yoyoDelay:function(b,a){return this.updateTweenData("yoyoDelay",b,a)},easing:function(b,a){if(typeof b==="string"&&this.manager.easeMap[b]){b=this.manager.easeMap[b]}return this.updateTweenData("easingFunction",b,a)},interpolation:function(a,c,b){if(c===undefined){c=Phaser.Math}this.updateTweenData("interpolationFunction",a,b);return this.updateTweenData("interpolationContext",c,b)},repeatAll:function(a){if(a===undefined){a=0}this.repeatCounter=a;return this},chain:function(){var a=arguments.length;while(a--){if(a>0){arguments[a-1].chainedTween=arguments[a]}else{this.chainedTween=arguments[a]}}return this},loop:function(a){if(a===undefined){a=true}this.repeatCounter=(a)?-1:0;return this},onUpdateCallback:function(b,a){this._onUpdateCallback=b;this._onUpdateCallbackContext=a;return this},pause:function(){this.isPaused=true;this._codePaused=true;this._pausedTime=this.game.time.time},_pause:function(){if(!this._codePaused){this.isPaused=true;this._pausedTime=this.game.time.time}},resume:function(){if(this.isPaused){this.isPaused=false;this._codePaused=false;for(var a=0;a<this.timeline.length;a++){if(!this.timeline[a].isRunning){this.timeline[a].startTime+=(this.game.time.time-this._pausedTime)}}}},_resume:function(){if(this._codePaused){return}else{this.resume()}},update:function(c){if(this.pendingDelete||!this.target){return false}if(this.isPaused){return true}var b=this.timeline[this.current].update(c);if(b===Phaser.TweenData.PENDING){return true}else{if(b===Phaser.TweenData.RUNNING){if(!this._hasStarted){this.onStart.dispatch(this.target,this);this._hasStarted=true}if(this._onUpdateCallback!==null){this._onUpdateCallback.call(this._onUpdateCallbackContext,this,this.timeline[this.current].value,this.timeline[this.current])}return this.isRunning}else{if(b===Phaser.TweenData.LOOPED){if(this.timeline[this.current].repeatCounter===-1){this.onLoop.dispatch(this.target,this)}else{this.onRepeat.dispatch(this.target,this)}return true}else{if(b===Phaser.TweenData.COMPLETE){var a=false;if(this.reverse){this.current--;if(this.current<0){this.current=this.timeline.length-1;a=true}}else{this.current++;if(this.current===this.timeline.length){this.current=0;a=true}}if(a){if(this.repeatCounter===-1){this.timeline[this.current].start();this.onLoop.dispatch(this.target,this);return true}else{if(this.repeatCounter>0){this.repeatCounter--;this.timeline[this.current].start();this.onRepeat.dispatch(this.target,this);return true}else{this.isRunning=false;this.onComplete.dispatch(this.target,this);this._hasStarted=false;if(this.chainedTween){this.chainedTween.start()}return false}}}else{this.onChildComplete.dispatch(this.target,this);this.timeline[this.current].start();return true}}}}}},generateData:function(a,d){if(this.game===null||this.target===null){return null}if(a===undefined){a=60}if(d===undefined){d=[]}for(var b=0;b<this.timeline.length;b++){for(var c in this.timeline[b].vEnd){this.properties[c]=this.target[c]||0;if(!Array.isArray(this.properties[c])){this.properties[c]*=1}}}for(var b=0;b<this.timeline.length;b++){this.timeline[b].loadValues()}for(var b=0;b<this.timeline.length;b++){d=d.concat(this.timeline[b].generateData(a))}return d}};Object.defineProperty(Phaser.Tween.prototype,"totalDuration",{get:function(){var b=0;for(var a=0;a<this.timeline.length;a++){b+=this.timeline[a].duration}return b}});Phaser.Tween.prototype.constructor=Phaser.Tween;Phaser.TweenData=function(a){this.parent=a;this.game=a.game;this.vStart={};this.vStartCache={};this.vEnd={};this.vEndCache={};this.duration=1000;this.percent=0;this.value=0;this.repeatCounter=0;this.repeatDelay=0;this.repeatTotal=0;this.interpolate=false;this.yoyo=false;this.yoyoDelay=0;this.inReverse=false;this.delay=0;this.dt=0;this.startTime=null;this.easingFunction=Phaser.Easing.Default;this.interpolationFunction=Phaser.Math.linearInterpolation;this.interpolationContext=Phaser.Math;this.isRunning=false;this.isFrom=false};Phaser.TweenData.PENDING=0;Phaser.TweenData.RUNNING=1;Phaser.TweenData.LOOPED=2;Phaser.TweenData.COMPLETE=3;Phaser.TweenData.prototype={to:function(b,e,f,a,d,c){this.vEnd=b;this.duration=e;this.easingFunction=f;this.delay=a;this.repeatTotal=d;this.yoyo=c;this.isFrom=false;return this},from:function(b,e,f,a,d,c){this.vEnd=b;this.duration=e;this.easingFunction=f;this.delay=a;this.repeatTotal=d;this.yoyo=c;this.isFrom=true;return this},start:function(){this.startTime=this.game.time.time+this.delay;if(this.parent.reverse){this.dt=this.duration}else{this.dt=0}if(this.delay>0){this.isRunning=false}else{this.isRunning=true}if(this.isFrom){for(var a in this.vStartCache){this.vStart[a]=this.vEndCache[a];this.vEnd[a]=this.vStartCache[a];this.parent.target[a]=this.vStart[a]}}this.value=0;this.yoyoCounter=0;this.repeatCounter=this.repeatTotal;return this},loadValues:function(){for(var a in this.parent.properties){this.vStart[a]=this.parent.properties[a];if(Array.isArray(this.vEnd[a])){if(this.vEnd[a].length===0){continue}if(this.percent===0){this.vEnd[a]=[this.vStart[a]].concat(this.vEnd[a])}}if(typeof this.vEnd[a]!=="undefined"){if(typeof this.vEnd[a]==="string"){this.vEnd[a]=this.vStart[a]+parseFloat(this.vEnd[a],10)}this.parent.properties[a]=this.vEnd[a]}else{this.vEnd[a]=this.vStart[a]}this.vStartCache[a]=this.vStart[a];this.vEndCache[a]=this.vEnd[a]}return this},update:function(d){if(!this.isRunning){if(d>=this.startTime){this.isRunning=true}else{return Phaser.TweenData.PENDING}}else{if(d<this.startTime){return Phaser.TweenData.RUNNING}}var b=(this.parent.frameBased)?this.game.time.physicsElapsedMS:this.game.time.elapsedMS;if(this.parent.reverse){this.dt-=b*this.parent.timeScale;this.dt=Math.max(this.dt,0)}else{this.dt+=b*this.parent.timeScale;this.dt=Math.min(this.dt,this.duration)}this.percent=this.dt/this.duration;this.value=this.easingFunction(this.percent);for(var c in this.vEnd){var e=this.vStart[c];var a=this.vEnd[c];if(Array.isArray(a)){this.parent.target[c]=this.interpolationFunction.call(this.interpolationContext,a,this.value)}else{this.parent.target[c]=e+((a-e)*this.value)}}if((!this.parent.reverse&&this.percent===1)||(this.parent.reverse&&this.percent===0)){return this.repeat()}return Phaser.TweenData.RUNNING},generateData:function(i){if(this.parent.reverse){this.dt=this.duration}else{this.dt=0}var g=[];var c=false;var d=(1/i)*1000;do{if(this.parent.reverse){this.dt-=d;this.dt=Math.max(this.dt,0)}else{this.dt+=d;this.dt=Math.min(this.dt,this.duration)}this.percent=this.dt/this.duration;this.value=this.easingFunction(this.percent);var a={};for(var h in this.vEnd){var b=this.vStart[h];var e=this.vEnd[h];if(Array.isArray(e)){a[h]=this.interpolationFunction.call(this.interpolationContext,e,this.value)}else{a[h]=b+((e-b)*this.value)}}g.push(a);if((!this.parent.reverse&&this.percent===1)||(this.parent.reverse&&this.percent===0)){c=true}}while(!c);if(this.yoyo){var f=g.slice();f.reverse();g=g.concat(f)}return g},repeat:function(){if(this.yoyo){if(this.inReverse&&this.repeatCounter===0){for(var a in this.vStartCache){this.vStart[a]=this.vStartCache[a];this.vEnd[a]=this.vEndCache[a]}this.inReverse=false;return Phaser.TweenData.COMPLETE}this.inReverse=!this.inReverse}else{if(this.repeatCounter===0){return Phaser.TweenData.COMPLETE}}if(this.inReverse){for(var a in this.vStartCache){this.vStart[a]=this.vEndCache[a];this.vEnd[a]=this.vStartCache[a]}}else{for(var a in this.vStartCache){this.vStart[a]=this.vStartCache[a];this.vEnd[a]=this.vEndCache[a]}if(this.repeatCounter>0){this.repeatCounter--}}this.startTime=this.game.time.time;if(this.yoyo&&this.inReverse){this.startTime+=this.yoyoDelay}else{if(!this.inReverse){this.startTime+=this.repeatDelay}}if(this.parent.reverse){this.dt=this.duration}else{this.dt=0}return Phaser.TweenData.LOOPED}};Phaser.TweenData.prototype.constructor=Phaser.TweenData;Phaser.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){if((a*=2)<1){return 0.5*a*a}return -0.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return --a*a*a+1},InOut:function(a){if((a*=2)<1){return 0.5*a*a*a}return 0.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1-(--a*a*a*a)},InOut:function(a){if((a*=2)<1){return 0.5*a*a*a*a}return -0.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return --a*a*a*a*a+1},InOut:function(a){if((a*=2)<1){return 0.5*a*a*a*a*a}return 0.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){if(a===0){return 0}if(a===1){return 1}return 1-Math.cos(a*Math.PI/2)},Out:function(a){if(a===0){return 0}if(a===1){return 1}return Math.sin(a*Math.PI/2)},InOut:function(a){if(a===0){return 0}if(a===1){return 1}return 0.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return a===0?0:Math.pow(1024,a-1)},Out:function(a){return a===1?1:1-Math.pow(2,-10*a)},InOut:function(a){if(a===0){return 0}if(a===1){return 1}if((a*=2)<1){return 0.5*Math.pow(1024,a-1)}return 0.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1-(--a*a))},InOut:function(a){if((a*=2)<1){return -0.5*(Math.sqrt(1-a*a)-1)}return 0.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(c){var d,b=0.1,e=0.4;if(c===0){return 0}if(c===1){return 1}if(!b||b<1){b=1;d=e/4}else{d=e*Math.asin(1/b)/(2*Math.PI)}return -(b*Math.pow(2,10*(c-=1))*Math.sin((c-d)*(2*Math.PI)/e))},Out:function(c){var d,b=0.1,e=0.4;if(c===0){return 0}if(c===1){return 1}if(!b||b<1){b=1;d=e/4}else{d=e*Math.asin(1/b)/(2*Math.PI)}return(b*Math.pow(2,-10*c)*Math.sin((c-d)*(2*Math.PI)/e)+1)},InOut:function(c){var d,b=0.1,e=0.4;if(c===0){return 0}if(c===1){return 1}if(!b||b<1){b=1;d=e/4}else{d=e*Math.asin(1/b)/(2*Math.PI)}if((c*=2)<1){return -0.5*(b*Math.pow(2,10*(c-=1))*Math.sin((c-d)*(2*Math.PI)/e))}return b*Math.pow(2,-10*(c-=1))*Math.sin((c-d)*(2*Math.PI)/e)*0.5+1}},Back:{In:function(a){var b=1.70158;return a*a*((b+1)*a-b)},Out:function(a){var b=1.70158;return --a*a*((b+1)*a+b)+1},InOut:function(a){var b=1.70158*1.525;if((a*=2)<1){return 0.5*(a*a*((b+1)*a-b))}return 0.5*((a-=2)*a*((b+1)*a+b)+2)}},Bounce:{In:function(a){return 1-Phaser.Easing.Bounce.Out(1-a)},Out:function(a){if(a<(1/2.75)){return 7.5625*a*a}else{if(a<(2/2.75)){return 7.5625*(a-=(1.5/2.75))*a+0.75}else{if(a<(2.5/2.75)){return 7.5625*(a-=(2.25/2.75))*a+0.9375}else{return 7.5625*(a-=(2.625/2.75))*a+0.984375}}}},InOut:function(a){if(a<0.5){return Phaser.Easing.Bounce.In(a*2)*0.5}return Phaser.Easing.Bounce.Out(a*2-1)*0.5+0.5}}};Phaser.Easing.Default=Phaser.Easing.Linear.None;Phaser.Easing.Power0=Phaser.Easing.Linear.None;Phaser.Easing.Power1=Phaser.Easing.Quadratic.Out;Phaser.Easing.Power2=Phaser.Easing.Cubic.Out;Phaser.Easing.Power3=Phaser.Easing.Quartic.Out;Phaser.Easing.Power4=Phaser.Easing.Quintic.Out;Phaser.Time=function(a){this.game=a;this.time=0;this.prevTime=0;this.now=0;this.elapsed=0;this.elapsedMS=0;this.physicsElapsed=1/60;this.physicsElapsedMS=(1/60)*1000;this.desiredFpsMult=1/60;this._desiredFps=60;this.suggestedFps=this.desiredFps;this.slowMotion=1;this.advancedTiming=false;this.frames=0;this.fps=0;this.fpsMin=1000;this.fpsMax=0;this.msMin=1000;this.msMax=0;this.pauseDuration=0;this.timeToCall=0;this.timeExpected=0;this.events=new Phaser.Timer(this.game,false);this._frameCount=0;this._elapsedAccumulator=0;this._started=0;this._timeLastSecond=0;this._pauseStarted=0;this._justResumed=false;this._timers=[]};Phaser.Time.prototype={boot:function(){this._started=Date.now();this.time=Date.now();this.events.start();this.timeExpected=this.time},add:function(a){this._timers.push(a);return a},create:function(a){if(a===undefined){a=true}var b=new Phaser.Timer(this.game,a);this._timers.push(b);return b},removeAll:function(){for(var a=0;a<this._timers.length;a++){this._timers[a].destroy()}this._timers=[];this.events.removeAll()},refresh:function(){var a=this.time;this.time=Date.now();this.elapsedMS=this.time-a},update:function(b){var a=this.time;this.time=Date.now();this.elapsedMS=this.time-a;this.prevTime=this.now;this.now=b;this.elapsed=this.now-this.prevTime;if(this.game.raf._isSetTimeOut){this.timeToCall=Math.floor(Math.max(0,(1000/this._desiredFps)-(this.timeExpected-b)));this.timeExpected=b+this.timeToCall}if(this.advancedTiming){this.updateAdvancedTiming()}if(!this.game.paused){this.events.update(this.time);if(this._timers.length){this.updateTimers()}}},updateTimers:function(){var b=0;var a=this._timers.length;while(b<a){if(this._timers[b].update(this.time)){b++}else{this._timers.splice(b,1);a--}}},updateAdvancedTiming:function(){this._frameCount++;this._elapsedAccumulator+=this.elapsed;if(this._frameCount>=this._desiredFps*2){this.suggestedFps=Math.floor(200/(this._elapsedAccumulator/this._frameCount))*5;this._frameCount=0;this._elapsedAccumulator=0}this.msMin=Math.min(this.msMin,this.elapsed);this.msMax=Math.max(this.msMax,this.elapsed);this.frames++;if(this.now>this._timeLastSecond+1000){this.fps=Math.round((this.frames*1000)/(this.now-this._timeLastSecond));this.fpsMin=Math.min(this.fpsMin,this.fps);this.fpsMax=Math.max(this.fpsMax,this.fps);this._timeLastSecond=this.now;this.frames=0}},gamePaused:function(){this._pauseStarted=Date.now();this.events.pause();var a=this._timers.length;while(a--){this._timers[a]._pause()}},gameResumed:function(){this.time=Date.now();this.pauseDuration=this.time-this._pauseStarted;this.events.resume();var a=this._timers.length;while(a--){this._timers[a]._resume()}},totalElapsedSeconds:function(){return(this.time-this._started)*0.001},elapsedSince:function(a){return this.time-a},elapsedSecondsSince:function(a){return(this.time-a)*0.001},reset:function(){this._started=this.time;this.removeAll()}};Object.defineProperty(Phaser.Time.prototype,"desiredFps",{get:function(){return this._desiredFps},set:function(a){this._desiredFps=a;this.physicsElapsed=1/a;this.physicsElapsedMS=this.physicsElapsed*1000;this.desiredFpsMult=1/a}});Phaser.Time.prototype.constructor=Phaser.Time;Phaser.Timer=function(a,b){if(b===undefined){b=true}this.game=a;this.running=false;this.autoDestroy=b;this.expired=false;this.elapsed=0;this.events=[];this.onComplete=new Phaser.Signal();this.nextTick=0;this.timeCap=1000;this.paused=false;this._codePaused=false;this._started=0;this._pauseStarted=0;this._pauseTotal=0;this._now=Date.now();this._len=0;this._marked=0;this._i=0;this._diff=0;this._newTick=0};Phaser.Timer.MINUTE=60000;Phaser.Timer.SECOND=1000;Phaser.Timer.HALF=500;Phaser.Timer.QUARTER=250;Phaser.Timer.prototype={create:function(e,a,c,h,b,d){e=Math.round(e);var f=e;if(this._now===0){f+=this.game.time.time}else{f+=this._now}var g=new Phaser.TimerEvent(this,e,f,c,a,h,b,d);this.events.push(g);this.order();this.expired=false;return g},add:function(b,c,a){return this.create(b,false,0,c,a,Array.prototype.slice.call(arguments,3))},repeat:function(c,b,d,a){return this.create(c,false,b,d,a,Array.prototype.slice.call(arguments,4))},loop:function(b,c,a){return this.create(b,true,0,c,a,Array.prototype.slice.call(arguments,3))},start:function(a){if(this.running){return}this._started=this.game.time.time+(a||0);this.running=true;for(var b=0;b<this.events.length;b++){this.events[b].tick=this.events[b].delay+this._started}},stop:function(a){this.running=false;if(a===undefined){a=true}if(a){this.events.length=0}},remove:function(b){for(var a=0;a<this.events.length;a++){if(this.events[a]===b){this.events[a].pendingDelete=true;return true}}return false},order:function(){if(this.events.length>0){this.events.sort(this.sortHandler);this.nextTick=this.events[0].tick}},sortHandler:function(d,c){if(d.tick<c.tick){return -1}else{if(d.tick>c.tick){return 1}}return 0},clearPendingEvents:function(){this._i=this.events.length;while(this._i--){if(this.events[this._i].pendingDelete){this.events.splice(this._i,1)}}this._len=this.events.length;this._i=0},update:function(b){if(this.paused){return true}this.elapsed=b-this._now;this._now=b;if(this.elapsed>this.timeCap){this.adjustEvents(b-this.elapsed)}this._marked=0;this.clearPendingEvents();if(this.running&&this._now>=this.nextTick&&this._len>0){while(this._i<this._len&&this.running){var a=this.events[this._i];if(this._now>=a.tick&&!a.pendingDelete){this._newTick=(this._now+a.delay)-(this._now-a.tick);if(this._newTick<0){this._newTick=this._now+a.delay}if(a.loop===true){a.tick=this._newTick;a.callback.apply(a.callbackContext,a.args)}else{if(a.repeatCount>0){a.repeatCount--;a.tick=this._newTick;a.callback.apply(a.callbackContext,a.args)}else{this._marked++;a.pendingDelete=true;a.callback.apply(a.callbackContext,a.args)}}this._i++}else{break}}if(this.events.length>this._marked){this.order()}else{this.expired=true;this.onComplete.dispatch(this)}}if(this.expired&&this.autoDestroy){return false}else{return true}},pause:function(){if(!this.running){return}this._codePaused=true;if(this.paused){return}this._pauseStarted=this.game.time.time;this.paused=true},_pause:function(){if(this.paused||!this.running){return}this._pauseStarted=this.game.time.time;this.paused=true},adjustEvents:function(e){for(var b=0;b<this.events.length;b++){if(!this.events[b].pendingDelete){var a=this.events[b].tick-e;if(a<0){a=0}this.events[b].tick=this._now+a}}var c=this.nextTick-e;if(c<0){this.nextTick=this._now}else{this.nextTick=this._now+c}},resume:function(){if(!this.paused){return}var a=this.game.time.time;this._pauseTotal+=a-this._now;this._now=a;this.adjustEvents(this._pauseStarted);this.paused=false;this._codePaused=false},_resume:function(){if(this._codePaused){return}else{this.resume()}},removeAll:function(){this.onComplete.removeAll();this.events.length=0;this._len=0;this._i=0},destroy:function(){this.onComplete.removeAll();this.running=false;this.expired=true;this.events=[];this._len=0;this._i=0}};Object.defineProperty(Phaser.Timer.prototype,"next",{get:function(){return this.nextTick}});Object.defineProperty(Phaser.Timer.prototype,"duration",{get:function(){if(this.running&&this.nextTick>this._now){return this.nextTick-this._now}else{return 0}}});Object.defineProperty(Phaser.Timer.prototype,"length",{get:function(){return this.events.length}});Object.defineProperty(Phaser.Timer.prototype,"ms",{get:function(){if(this.running){return this._now-this._started-this._pauseTotal}else{return 0}}});Object.defineProperty(Phaser.Timer.prototype,"seconds",{get:function(){if(this.running){return this.ms*0.001}else{return 0}}});Phaser.Timer.prototype.constructor=Phaser.Timer;Phaser.TimerEvent=function(h,e,f,c,a,g,b,d){this.timer=h;this.delay=e;this.tick=f;this.repeatCount=c-1;this.loop=a;this.callback=g;this.callbackContext=b;this.args=d;this.pendingDelete=false};Phaser.TimerEvent.prototype.constructor=Phaser.TimerEvent;Phaser.AnimationManager=function(a){this.sprite=a;this.game=a.game;this.currentFrame=null;this.currentAnim=null;this.updateIfVisible=true;this.isLoaded=false;this._frameData=null;this._anims={};this._outputFrames=[]};Phaser.AnimationManager.prototype={loadFrameData:function(a,c){if(a===undefined){return false}if(this.isLoaded){for(var b in this._anims){this._anims[b].updateFrameData(a)}}this._frameData=a;if(c===undefined||c===null){this.frame=0}else{if(typeof c==="string"){this.frameName=c}else{this.frame=c}}this.isLoaded=true;return true},copyFrameData:function(a,c){this._frameData=a.clone();if(this.isLoaded){for(var b in this._anims){this._anims[b].updateFrameData(this._frameData)}}if(c===undefined||c===null){this.frame=0}else{if(typeof c==="string"){this.frameName=c}else{this.frame=c}}this.isLoaded=true;return true},add:function(d,e,c,b,a){e=e||[];c=c||60;if(b===undefined){b=false}if(a===undefined){if(e&&typeof e[0]==="number"){a=true}else{a=false}}this._outputFrames=[];this._frameData.getFrameIndexes(e,a,this._outputFrames);this._anims[d]=new Phaser.Animation(this.game,this.sprite,d,this._frameData,this._outputFrames,c,b);this.currentAnim=this._anims[d];if(this.sprite.tilingTexture){this.sprite.refreshTexture=true}return this._anims[d]},validateFrames:function(c,a){if(a===undefined){a=true}for(var b=0;b<c.length;b++){if(a===true){if(c[b]>this._frameData.total){return false}}else{if(this._frameData.checkFrameName(c[b])===false){return false}}}return true},play:function(d,c,b,a){if(this._anims[d]){if(this.currentAnim===this._anims[d]){if(this.currentAnim.isPlaying===false){this.currentAnim.paused=false;return this.currentAnim.play(c,b,a)}return this.currentAnim}else{if(this.currentAnim&&this.currentAnim.isPlaying){this.currentAnim.stop()}this.currentAnim=this._anims[d];this.currentAnim.paused=false;this.currentFrame=this.currentAnim.currentFrame;return this.currentAnim.play(c,b,a)}}},stop:function(b,a){if(a===undefined){a=false}if(this.currentAnim&&(typeof b!=="string"||b===this.currentAnim.name)){this.currentAnim.stop(a)}},update:function(){if(this.updateIfVisible&&!this.sprite.visible){return false}if(this.currentAnim&&this.currentAnim.update()){this.currentFrame=this.currentAnim.currentFrame;return true}return false},next:function(a){if(this.currentAnim){this.currentAnim.next(a);this.currentFrame=this.currentAnim.currentFrame}},previous:function(a){if(this.currentAnim){this.currentAnim.previous(a);this.currentFrame=this.currentAnim.currentFrame}},getAnimation:function(a){if(typeof a==="string"){if(this._anims[a]){return this._anims[a]}}return null},refreshFrame:function(){},destroy:function(){var a=null;for(var a in this._anims){if(this._anims.hasOwnProperty(a)){this._anims[a].destroy()}}this._anims={};this._outputFrames=[];this._frameData=null;this.currentAnim=null;this.currentFrame=null;this.sprite=null;this.game=null}};Phaser.AnimationManager.prototype.constructor=Phaser.AnimationManager;Object.defineProperty(Phaser.AnimationManager.prototype,"frameData",{get:function(){return this._frameData}});Object.defineProperty(Phaser.AnimationManager.prototype,"frameTotal",{get:function(){return this._frameData.total}});Object.defineProperty(Phaser.AnimationManager.prototype,"paused",{get:function(){return this.currentAnim.isPaused},set:function(a){this.currentAnim.paused=a}});Object.defineProperty(Phaser.AnimationManager.prototype,"name",{get:function(){if(this.currentAnim){return this.currentAnim.name}}});Object.defineProperty(Phaser.AnimationManager.prototype,"frame",{get:function(){if(this.currentFrame){return this.currentFrame.index}},set:function(b){var a;if(typeof b==="number"&&this._frameData&&(a=this._frameData.getFrame(b))){this.currentFrame=a;this.sprite.setFrame(this.currentFrame)}}});Object.defineProperty(Phaser.AnimationManager.prototype,"frameName",{get:function(){if(this.currentFrame){return this.currentFrame.name}},set:function(b){var a;if(typeof b==="string"&&this._frameData&&(a=this._frameData.getFrameByName(b))){this.currentFrame=a;this._frameIndex=this.currentFrame.index;this.sprite.setFrame(this.currentFrame)}else{console.warn("Cannot set frameName: "+b)}}});Phaser.Animation=function(b,f,d,e,g,c,a){if(a===undefined){a=false}this.game=b;this._parent=f;this._frameData=e;this.name=d;this._frames=[];this._frames=this._frames.concat(g);this.delay=1000/c;this.loop=a;this.loopCount=0;this.killOnComplete=false;this.isFinished=false;this.isPlaying=false;this.isPaused=false;this._pauseStartTime=0;this._frameIndex=0;this._frameDiff=0;this._frameSkip=1;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this.onStart=new Phaser.Signal();this.onUpdate=null;this.onComplete=new Phaser.Signal();this.onLoop=new Phaser.Signal();this.isReversed=false;this.game.onPause.add(this.onPause,this);this.game.onResume.add(this.onResume,this)};Phaser.Animation.prototype={play:function(c,b,a){if(typeof c==="number"){this.delay=1000/c}if(typeof b==="boolean"){this.loop=b}if(typeof a!=="undefined"){this.killOnComplete=a}this.isPlaying=true;this.isFinished=false;this.paused=false;this.loopCount=0;this._timeLastFrame=this.game.time.time;this._timeNextFrame=this.game.time.time+this.delay;this._frameIndex=this.isReversed?this._frames.length-1:0;this.updateCurrentFrame(false,true);this._parent.events.onAnimationStart$dispatch(this._parent,this);this.onStart.dispatch(this._parent,this);this._parent.animations.currentAnim=this;this._parent.animations.currentFrame=this.currentFrame;return this},restart:function(){this.isPlaying=true;this.isFinished=false;this.paused=false;this.loopCount=0;this._timeLastFrame=this.game.time.time;this._timeNextFrame=this.game.time.time+this.delay;this._frameIndex=0;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this._parent.setFrame(this.currentFrame);this._parent.animations.currentAnim=this;this._parent.animations.currentFrame=this.currentFrame;this.onStart.dispatch(this._parent,this)},reverse:function(){this.reversed=!this.reversed;return this},reverseOnce:function(){this.onComplete.addOnce(this.reverse,this);return this.reverse()},setFrame:function(c,a){var e;if(a===undefined){a=false}if(typeof c==="string"){for(var b=0;b<this._frames.length;b++){if(this._frameData.getFrame(this._frames[b]).name===c){e=b}}}else{if(typeof c==="number"){if(a){e=c}else{for(var b=0;b<this._frames.length;b++){if(this._frames[b]===c){e=b}}}}}if(e){var d=this.isReversed?-1:1;this._frameIndex=e-d;this._timeNextFrame=this.game.time.time;this.update()}},stop:function(a,b){if(a===undefined){a=false}if(b===undefined){b=false}this.isPlaying=false;this.isFinished=true;this.paused=false;if(a){this.currentFrame=this._frameData.getFrame(this._frames[0]);this._parent.setFrame(this.currentFrame)}if(b){this._parent.events.onAnimationComplete$dispatch(this._parent,this);this.onComplete.dispatch(this._parent,this)}},onPause:function(){if(this.isPlaying){this._frameDiff=this._timeNextFrame-this.game.time.time}},onResume:function(){if(this.isPlaying){this._timeNextFrame=this.game.time.time+this._frameDiff}},update:function(){if(this.isPaused){return false}if(this.isPlaying&&this.game.time.time>=this._timeNextFrame){this._frameSkip=1;this._frameDiff=this.game.time.time-this._timeNextFrame;this._timeLastFrame=this.game.time.time;if(this._frameDiff>this.delay){this._frameSkip=Math.floor(this._frameDiff/this.delay);this._frameDiff-=(this._frameSkip*this.delay)}else{this._frameDiff=0}this._timeNextFrame=this.game.time.time+(this.delay-this._frameDiff);if(this.isReversed){this._frameIndex-=this._frameSkip}else{this._frameIndex+=this._frameSkip}if(!this.isReversed&&this._frameIndex>=this._frames.length||this.isReversed&&this._frameIndex<=-1){if(this.loop){this._frameIndex=Math.abs(this._frameIndex)%this._frames.length;if(this.isReversed){this._frameIndex=this._frames.length-1-this._frameIndex}this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);if(this.currentFrame){this._parent.setFrame(this.currentFrame)}this.loopCount++;this._parent.events.onAnimationLoop$dispatch(this._parent,this);this.onLoop.dispatch(this._parent,this);if(this.onUpdate){this.onUpdate.dispatch(this,this.currentFrame);return !!this._frameData}else{return true}}else{this.complete();return false}}else{return this.updateCurrentFrame(true)}}return false},updateCurrentFrame:function(c,b){if(b===undefined){b=false}if(!this._frameData){return false}var a=this.currentFrame.index;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);if(this.currentFrame&&(b||(!b&&a!==this.currentFrame.index))){this._parent.setFrame(this.currentFrame)}if(this.onUpdate&&c){this.onUpdate.dispatch(this,this.currentFrame);return !!this._frameData}else{return true}},next:function(a){if(a===undefined){a=1}var b=this._frameIndex+a;if(b>=this._frames.length){if(this.loop){b%=this._frames.length}else{b=this._frames.length-1}}if(b!==this._frameIndex){this._frameIndex=b;this.updateCurrentFrame(true)}},previous:function(a){if(a===undefined){a=1}var b=this._frameIndex-a;if(b<0){if(this.loop){b=this._frames.length+b}else{b++}}if(b!==this._frameIndex){this._frameIndex=b;this.updateCurrentFrame(true)}},updateFrameData:function(a){this._frameData=a;this.currentFrame=this._frameData?this._frameData.getFrame(this._frames[this._frameIndex%this._frames.length]):null},destroy:function(){if(!this._frameData){return}this.game.onPause.remove(this.onPause,this);this.game.onResume.remove(this.onResume,this);this.game=null;this._parent=null;this._frames=null;this._frameData=null;this.currentFrame=null;this.isPlaying=false;this.onStart.dispose();this.onLoop.dispose();this.onComplete.dispose();if(this.onUpdate){this.onUpdate.dispose()}},complete:function(){this._frameIndex=this._frames.length-1;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this.isPlaying=false;this.isFinished=true;this.paused=false;this._parent.events.onAnimationComplete$dispatch(this._parent,this);this.onComplete.dispatch(this._parent,this);if(this.killOnComplete){this._parent.kill()}}};Phaser.Animation.prototype.constructor=Phaser.Animation;Object.defineProperty(Phaser.Animation.prototype,"paused",{get:function(){return this.isPaused},set:function(a){this.isPaused=a;if(a){this._pauseStartTime=this.game.time.time}else{if(this.isPlaying){this._timeNextFrame=this.game.time.time+this.delay}}}});Object.defineProperty(Phaser.Animation.prototype,"reversed",{get:function(){return this.isReversed},set:function(a){this.isReversed=a}});Object.defineProperty(Phaser.Animation.prototype,"frameTotal",{get:function(){return this._frames.length}});Object.defineProperty(Phaser.Animation.prototype,"frame",{get:function(){if(this.currentFrame!==null){return this.currentFrame.index}else{return this._frameIndex}},set:function(a){this.currentFrame=this._frameData.getFrame(this._frames[a]);if(this.currentFrame!==null){this._frameIndex=a;this._parent.setFrame(this.currentFrame);if(this.onUpdate){this.onUpdate.dispatch(this,this.currentFrame)}}}});Object.defineProperty(Phaser.Animation.prototype,"speed",{get:function(){return 1000/this.delay},set:function(a){if(a>0){this.delay=1000/a}}});Object.defineProperty(Phaser.Animation.prototype,"enableUpdate",{get:function(){return(this.onUpdate!==null)},set:function(a){if(a&&this.onUpdate===null){this.onUpdate=new Phaser.Signal()}else{if(!a&&this.onUpdate!==null){this.onUpdate.dispose();this.onUpdate=null}}}});Phaser.Animation.generateFrameNames=function(e,h,c,f,d){if(f===undefined){f=""}var a=[];var g="";if(h<c){for(var b=h;b<=c;b++){if(typeof d==="number"){g=Phaser.Utils.pad(b.toString(),d,"0",1)}else{g=b.toString()}g=e+g+f;a.push(g)}}else{for(var b=h;b>=c;b--){if(typeof d==="number"){g=Phaser.Utils.pad(b.toString(),d,"0",1)}else{g=b.toString()}g=e+g+f;a.push(g)}}return a};Phaser.Frame=function(d,b,f,e,a,c){this.index=d;this.x=b;this.y=f;this.width=e;this.height=a;if(this.width===0||this.height===0){console.warn('Phaser.Frame: Frame "'+this.name+'" has a width or height of zero')}this.name=c;this.centerX=Math.floor(e/2);this.centerY=Math.floor(a/2);this.distance=Phaser.Math.distance(0,0,e,a);this.rotated=false;this.trimmed=false;this.sourceSizeW=e;this.sourceSizeH=a;this.spriteSourceSizeX=0;this.spriteSourceSizeY=0;this.spriteSourceSizeW=0;this.spriteSourceSizeH=0;this.right=this.x+this.width;this.bottom=this.y+this.height};Phaser.Frame.prototype={resize:function(b,a){this.width=b;this.height=a;this.centerX=Math.floor(b/2);this.centerY=Math.floor(a/2);this.distance=Phaser.Math.distance(0,0,b,a);this.sourceSizeW=b;this.sourceSizeH=a;this.right=this.x+b;this.bottom=this.y+a},setTrim:function(e,d,g,b,a,c,f){this.trimmed=e;if(e){this.sourceSizeW=d;this.sourceSizeH=g;this.centerX=Math.floor(d/2);this.centerY=Math.floor(g/2);this.spriteSourceSizeX=b;this.spriteSourceSizeY=a;this.spriteSourceSizeW=c;this.spriteSourceSizeH=f}},clone:function(){var a=new Phaser.Frame(this.index,this.x,this.y,this.width,this.height,this.name);for(var b in this){if(this.hasOwnProperty(b)){a[b]=this[b]}}return a},getRect:function(a){if(a===undefined){a=new Phaser.Rectangle(this.x,this.y,this.width,this.height)}else{a.setTo(this.x,this.y,this.width,this.height)}return a}};Phaser.Frame.prototype.constructor=Phaser.Frame;Phaser.FrameData=function(){this._frames=[];this._frameNames=[]};Phaser.FrameData.prototype={addFrame:function(a){a.index=this._frames.length;this._frames.push(a);if(a.name!==""){this._frameNames[a.name]=a.index}return a},getFrame:function(a){if(a>=this._frames.length){a=0}return this._frames[a]},getFrameByName:function(a){if(typeof this._frameNames[a]==="number"){return this._frames[this._frameNames[a]]}return null},checkFrameName:function(a){if(this._frameNames[a]==null){return false}return true},clone:function(){var a=new Phaser.FrameData();for(var b=0;b<this._frames.length;b++){a._frames.push(this._frames[b].clone())}for(var c in this._frameNames){if(this._frameNames.hasOwnProperty(c)){a._frameNames.push(this._frameNames[c])}}return a},getFrameRange:function(d,a,b){if(b===undefined){b=[]}for(var c=d;c<=a;c++){b.push(this._frames[c])}return b},getFrames:function(d,a,b){if(a===undefined){a=true}if(b===undefined){b=[]}if(d===undefined||d.length===0){for(var c=0;c<this._frames.length;c++){b.push(this._frames[c])}}else{for(var c=0;c<d.length;c++){if(a){b.push(this.getFrame(d[c]))}else{b.push(this.getFrameByName(d[c]))}}}return b},getFrameIndexes:function(d,a,b){if(a===undefined){a=true}if(b===undefined){b=[]}if(d===undefined||d.length===0){for(var c=0;c<this._frames.length;c++){b.push(this._frames[c].index)}}else{for(var c=0;c<d.length;c++){if(a&&this._frames[d[c]]){b.push(this._frames[d[c]].index)}else{if(this.getFrameByName(d[c])){b.push(this.getFrameByName(d[c]).index)}}}}return b},destroy:function(){this._frames=null;this._frameNames=null}};Phaser.FrameData.prototype.constructor=Phaser.FrameData;Object.defineProperty(Phaser.FrameData.prototype,"total",{get:function(){return this._frames.length}});Phaser.AnimationParser={spriteSheet:function(o,q,l,e,n,h,c,b){if(n===undefined){n=-1}if(h===undefined){h=0}if(c===undefined){c=0}if(b===undefined){b=0}var s=q;if(typeof q==="string"){s=o.cache.getImage(q)}if(s===null){return null}var k=s.width;var j=s.height;if(l<=0){l=Math.floor(-k/Math.min(-1,l))}if(e<=0){e=Math.floor(-j/Math.min(-1,e))}var d=Math.floor((k-h)/(l+c));var a=Math.floor((j-h)/(e+c));var r=d*a;if(b>r||b<-r){console.warn("Phaser.AnimationParser.spriteSheet: skipFrames = "+b.toString()+" is larger than total sprite number "+r.toString());return null}if(b<0){b=r+b}if(n!==-1){r=b+n}if(k===0||j===0||k<l||j<e||r===0){console.warn("Phaser.AnimationParser.spriteSheet: '"+q+"'s width/height zero or width/height < given frameWidth/frameHeight");return null}var p=new Phaser.FrameData();var g=h;var f=h;for(var m=0;m<r;m++){p.addFrame(new Phaser.Frame(m,g,f,l,e,""));g+=l+c;if(g+l>k){g=h;f+=e+c}}return p},JSONData:function(a,c){if(!c.frames){console.warn("Phaser.AnimationParser.JSONData: Invalid Texture Atlas JSON given, missing 'frames' array");console.log(c);return}var d=new Phaser.FrameData();var e=c.frames;var f;for(var b=0;b<e.length;b++){f=d.addFrame(new Phaser.Frame(b,e[b].frame.x,e[b].frame.y,e[b].frame.w,e[b].frame.h,e[b].filename));if(e[b].trimmed){f.setTrim(e[b].trimmed,e[b].sourceSize.w,e[b].sourceSize.h,e[b].spriteSourceSize.x,e[b].spriteSourceSize.y,e[b].spriteSourceSize.w,e[b].spriteSourceSize.h)}if(e[b].rotated){f.rotated=true}}return d},JSONDataPyxel:function(g,h){var a=["layers","tilewidth","tileheight","tileswide","tileshigh"];a.forEach(function(i){if(!h[i]){console.warn('Phaser.AnimationParser.JSONDataPyxel: Invalid Pyxel Tilemap JSON given, missing "'+i+'" key.');console.log(h);return}});if(h.layers.length!==1){console.warn("Phaser.AnimationParser.JSONDataPyxel: Too many layers, this parser only supports flat Tilemaps.");console.log(h);return}var d=new Phaser.FrameData();var b=h.tileheight;var j=h.tilewidth;var f=h.layers[0]["tiles"];var e;for(var c=0;c<f.length;c++){e=d.addFrame(new Phaser.Frame(c,f[c].x,f[c].y,j,b,"frame_"+c));e.setTrim(false)}return d},JSONDataHash:function(a,d){if(!d.frames){console.warn("Phaser.AnimationParser.JSONDataHash: Invalid Texture Atlas JSON given, missing 'frames' object");console.log(d);return}var e=new Phaser.FrameData();var f=d.frames;var g;var c=0;for(var b in f){g=e.addFrame(new Phaser.Frame(c,f[b].frame.x,f[b].frame.y,f[b].frame.w,f[b].frame.h,b));if(f[b].trimmed){g.setTrim(f[b].trimmed,f[b].sourceSize.w,f[b].sourceSize.h,f[b].spriteSourceSize.x,f[b].spriteSourceSize.y,f[b].spriteSourceSize.w,f[b].spriteSourceSize.h)}if(f[b].rotated){g.rotated=true}c++}return e},XMLData:function(q,h){if(!h.getElementsByTagName("TextureAtlas")){console.warn("Phaser.AnimationParser.XMLData: Invalid Texture Atlas XML given, missing <TextureAtlas> tag");return}var f=new Phaser.FrameData();var j=h.getElementsByTagName("SubTexture");var g;var a;var c;var n;var l;var b;var p;var o;var m;var k;var d;for(var e=0;e<j.length;e++){c=j[e].attributes;a=c.name.value;n=parseInt(c.x.value,10);l=parseInt(c.y.value,10);b=parseInt(c.width.value,10);p=parseInt(c.height.value,10);o=null;m=null;if(c.frameX){o=Math.abs(parseInt(c.frameX.value,10));m=Math.abs(parseInt(c.frameY.value,10));k=parseInt(c.frameWidth.value,10);d=parseInt(c.frameHeight.value,10)}g=f.addFrame(new Phaser.Frame(e,n,l,b,p,a));if(o!==null||m!==null){g.setTrim(true,b,p,o,m,k,d)}}return f}};Phaser.Cache=function(a){this.game=a;this.autoResolveURL=false;this._cache={canvas:{},image:{},texture:{},sound:{},video:{},text:{},json:{},xml:{},physics:{},tilemap:{},binary:{},bitmapData:{},bitmapFont:{},shader:{},renderTexture:{},compressedTexture:{}};this._urlMap={};this._urlResolver=new Image();this._urlTemp=null;this.onSoundUnlock=new Phaser.Signal();this._cacheMap=[];this._cacheMap[Phaser.Cache.CANVAS]=this._cache.canvas;this._cacheMap[Phaser.Cache.IMAGE]=this._cache.image;this._cacheMap[Phaser.Cache.TEXTURE]=this._cache.texture;this._cacheMap[Phaser.Cache.SOUND]=this._cache.sound;this._cacheMap[Phaser.Cache.TEXT]=this._cache.text;this._cacheMap[Phaser.Cache.PHYSICS]=this._cache.physics;this._cacheMap[Phaser.Cache.TILEMAP]=this._cache.tilemap;this._cacheMap[Phaser.Cache.BINARY]=this._cache.binary;this._cacheMap[Phaser.Cache.BITMAPDATA]=this._cache.bitmapData;this._cacheMap[Phaser.Cache.BITMAPFONT]=this._cache.bitmapFont;this._cacheMap[Phaser.Cache.JSON]=this._cache.json;this._cacheMap[Phaser.Cache.XML]=this._cache.xml;this._cacheMap[Phaser.Cache.VIDEO]=this._cache.video;this._cacheMap[Phaser.Cache.SHADER]=this._cache.shader;this._cacheMap[Phaser.Cache.RENDER_TEXTURE]=this._cache.renderTexture;this._pendingCount=0;this.onReady=new Phaser.Signal();this._addImages()};Phaser.Cache.CANVAS=1;Phaser.Cache.IMAGE=2;Phaser.Cache.TEXTURE=3;Phaser.Cache.SOUND=4;Phaser.Cache.TEXT=5;Phaser.Cache.PHYSICS=6;Phaser.Cache.TILEMAP=7;Phaser.Cache.BINARY=8;Phaser.Cache.BITMAPDATA=9;Phaser.Cache.BITMAPFONT=10;Phaser.Cache.JSON=11;Phaser.Cache.XML=12;Phaser.Cache.VIDEO=13;Phaser.Cache.SHADER=14;Phaser.Cache.RENDER_TEXTURE=15;Phaser.Cache.DEFAULT=null;Phaser.Cache.DEFAULT_KEY="__default";Phaser.Cache.DEFAULT_SRC="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==";Phaser.Cache.MISSING=null;Phaser.Cache.MISSING_KEY="__missing";Phaser.Cache.MISSING_SRC="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==";Phaser.Cache.READY_TIMEOUT=1000;Phaser.Cache.prototype={addCompressedTextureMetaData:function(b,a,f,c){if(this.checkImageKey(b)){this.removeImage(b)}var e=(f in Phaser.LoaderParser)?Phaser.LoaderParser[f](c):c;var d={key:b,url:a,data:e,base:new PIXI.BaseTexture(e,null,this.game.resolution),frame:new Phaser.Frame(0,0,0,e.width,e.height,b),frameData:new Phaser.FrameData(),fileFormat:f};d.frameData.addFrame(new Phaser.Frame(0,0,0,e.width,e.height,a));this._cache.image[b]=d;this._resolveURL(a,d);return d},addCanvas:function(c,a,b){if(b===undefined){b=a.getContext("2d")}this._cache.canvas[c]={canvas:a,context:b}},addImage:function(c,b,d){if(this.checkImageKey(c)){this.removeImage(c)}if(d.complete===false){console.warn('Phaser.Cache.addImage: Image "'+c+"\" hasn't been retrieved yet")}var a={key:c,url:b,data:d,base:new PIXI.BaseTexture(d,null,this.game.resolution),frame:new Phaser.Frame(0,0,0,d.width,d.height,c),frameData:new Phaser.FrameData()};a.frameData.addFrame(new Phaser.Frame(0,0,0,d.width,d.height,b));this._cache.image[c]=a;this._resolveURL(b,a);if(c==="__default"){Phaser.Cache.DEFAULT=new PIXI.Texture(a.base)}else{if(c==="__missing"){Phaser.Cache.MISSING=new PIXI.Texture(a.base)}}return a},addImageAsync:function(c,d,e){var b=this;var a=new Image();a.onload=function(){e.call(this,b.addImage(c,null,a));b._removePending();a.onload=null};this._addPending();a.src=d},addDefaultImage:function(){this.addImageAsync(Phaser.Cache.DEFAULT_KEY,Phaser.Cache.DEFAULT_SRC,function(a){a.base.skipRender=true;Phaser.Cache.DEFAULT=new PIXI.Texture(a.base)})},addMissingImage:function(){this.addImageAsync(Phaser.Cache.MISSING_KEY,Phaser.Cache.MISSING_SRC,function(a){Phaser.Cache.MISSING=new PIXI.Texture(a.base)})},addSound:function(d,c,f,b,e){if(b===undefined){b=true;e=false}if(e===undefined){b=false;e=true}var a=false;if(e){a=true}this._cache.sound[d]={url:c,data:f,isDecoding:false,decoded:a,webAudio:b,audioTag:e,locked:this.game.sound.touchLocked};this._resolveURL(c,this._cache.sound[d])},addText:function(b,a,c){this._cache.text[b]={url:a,data:c};this._resolveURL(a,this._cache.text[b])},addPhysicsData:function(b,a,c,d){this._cache.physics[b]={url:a,data:c,format:d};this._resolveURL(a,this._cache.physics[b])},addTilemap:function(b,a,d,c){this._cache.tilemap[b]={url:a,data:d,format:c};this._resolveURL(a,this._cache.tilemap[b])},addBinary:function(b,a){this._cache.binary[b]=a},addBitmapData:function(a,c,b){c.key=a;if(b===undefined){b=new Phaser.FrameData();b.addFrame(c.textureFrame)}this._cache.bitmapData[a]={data:c,frameData:b};return c},addBitmapFont:function(d,c,g,b,a,f,e){var h={url:c,data:g,font:null,base:new PIXI.BaseTexture(g,null,this.game.resolution)};if(f===undefined){f=0}if(e===undefined){e=0}if(a==="json"){h.font=Phaser.LoaderParser.jsonBitmapFont(b,h.base,f,e,false,this.game.resolution)}else{h.font=Phaser.LoaderParser.xmlBitmapFont(b,h.base,f,e,false,this.game.resolution)}this._cache.bitmapFont[d]=h;this._resolveURL(c,h)},addBitmapFontFromAtlas:function(j,b,e,f,i,h,g){var a=this.getFrameByName(b,e);if(!a){return}var d={font:null,base:this.getBaseTexture(b),frame:a};if(h===undefined){h=0}if(g===undefined){g=0}var c;if(i==="json"){c=this.getJSON(f);d.font=Phaser.LoaderParser.jsonBitmapFont(c,d.base,h,g,a,this.game.resolution)}else{c=this.getXML(f);d.font=Phaser.LoaderParser.xmlBitmapFont(c,d.base,h,g,a,this.game.resolution)}this._cache.bitmapFont[j]=d},addJSON:function(b,a,c){this._cache.json[b]={url:a,data:c};this._resolveURL(a,this._cache.json[b])},addXML:function(b,a,c){this._cache.xml[b]={url:a,data:c};this._resolveURL(a,this._cache.xml[b])},addVideo:function(c,b,d,a){this._cache.video[c]={url:b,data:d,isBlob:a,locked:true};this._resolveURL(b,this._cache.video[c])},addShader:function(b,a,c){this._cache.shader[b]={url:a,data:c};this._resolveURL(a,this._cache.shader[b])},addRenderTexture:function(a,b){this._cache.renderTexture[a]={texture:b,frame:new Phaser.Frame(0,0,0,b.width,b.height,"","")}},addSpriteSheet:function(j,a,g,i,d,c,e,h,b){if(c===undefined){c=-1}if(e===undefined){e=0}if(h===undefined){h=0}var f={key:j,url:a,data:g,frameWidth:i,frameHeight:d,margin:e,spacing:h,base:new PIXI.BaseTexture(g,null,this.game.resolution),frameData:Phaser.AnimationParser.spriteSheet(this.game,g,i,d,c,e,h,b)};this._cache.image[j]=f;this._resolveURL(a,f)},addTextureAtlas:function(c,b,d,a,f){var e={key:c,url:b,data:d,base:new PIXI.BaseTexture(d,null,this.game.resolution)};if(f===Phaser.Loader.TEXTURE_ATLAS_XML_STARLING){e.frameData=Phaser.AnimationParser.XMLData(this.game,a,c)}else{if(f===Phaser.Loader.TEXTURE_ATLAS_JSON_PYXEL){e.frameData=Phaser.AnimationParser.JSONDataPyxel(this.game,a,c)}else{if(Array.isArray(a.frames)){e.frameData=Phaser.AnimationParser.JSONData(this.game,a,c)}else{e.frameData=Phaser.AnimationParser.JSONDataHash(this.game,a,c)}}}this._cache.image[c]=e;this._resolveURL(b,e)},reloadSound:function(a){var c=this;var b=this.getSound(a);if(b){b.data.src=b.url;b.data.addEventListener("canplaythrough",function(){return c.reloadSoundComplete(a)},false);b.data.load()}},reloadSoundComplete:function(a){var b=this.getSound(a);if(b){b.locked=false;this.onSoundUnlock.dispatch(a)}},updateSound:function(a,c,b){var d=this.getSound(a);if(d){d[c]=b}},decodedSound:function(a,b){var c=this.getSound(a);c.data=b;c.decoded=true;c.isDecoding=false},isSoundDecoded:function(a){var b=this.getItem(a,Phaser.Cache.SOUND,"isSoundDecoded");if(b){return b.decoded}},isSoundReady:function(a){var b=this.getItem(a,Phaser.Cache.SOUND,"isSoundDecoded");if(b){return(b.decoded&&!this.game.sound.touchLocked)}},checkKey:function(a,b){if(this._cacheMap[a][b]){return true}return false},checkURL:function(a){if(this._urlMap[this._resolveURL(a)]){return true}return false},checkCanvasKey:function(a){return this.checkKey(Phaser.Cache.CANVAS,a)},checkImageKey:function(a){return this.checkKey(Phaser.Cache.IMAGE,a)},checkTextureKey:function(a){return this.checkKey(Phaser.Cache.TEXTURE,a)},checkSoundKey:function(a){return this.checkKey(Phaser.Cache.SOUND,a)},checkTextKey:function(a){return this.checkKey(Phaser.Cache.TEXT,a)},checkPhysicsKey:function(a){return this.checkKey(Phaser.Cache.PHYSICS,a)},checkTilemapKey:function(a){return this.checkKey(Phaser.Cache.TILEMAP,a)},checkBinaryKey:function(a){return this.checkKey(Phaser.Cache.BINARY,a)},checkBitmapDataKey:function(a){return this.checkKey(Phaser.Cache.BITMAPDATA,a)},checkBitmapFontKey:function(a){return this.checkKey(Phaser.Cache.BITMAPFONT,a)},checkJSONKey:function(a){return this.checkKey(Phaser.Cache.JSON,a)},checkXMLKey:function(a){return this.checkKey(Phaser.Cache.XML,a)},checkVideoKey:function(a){return this.checkKey(Phaser.Cache.VIDEO,a)},checkShaderKey:function(a){return this.checkKey(Phaser.Cache.SHADER,a)},checkRenderTextureKey:function(a){return this.checkKey(Phaser.Cache.RENDER_TEXTURE,a)},getItem:function(b,a,d,c){if(!this.checkKey(a,b)){if(d){console.warn("Phaser.Cache."+d+': Key "'+b+'" not found in Cache.')}}else{if(c===undefined){return this._cacheMap[a][b]}else{return this._cacheMap[a][b][c]}}return null},getCanvas:function(a){return this.getItem(a,Phaser.Cache.CANVAS,"getCanvas","canvas")},getImage:function(c,b){if(c===undefined||c===null){c="__default"}if(b===undefined){b=false}var a=this.getItem(c,Phaser.Cache.IMAGE,"getImage");if(a===null){a=this.getItem("__missing",Phaser.Cache.IMAGE,"getImage")}if(b){return a}else{return a.data}},getTextureFrame:function(a){return this.getItem(a,Phaser.Cache.TEXTURE,"getTextureFrame","frame")},getSound:function(a){return this.getItem(a,Phaser.Cache.SOUND,"getSound")},getSoundData:function(a){return this.getItem(a,Phaser.Cache.SOUND,"getSoundData","data")},getText:function(a){return this.getItem(a,Phaser.Cache.TEXT,"getText","data")},getPhysicsData:function(c,b,a){var f=this.getItem(c,Phaser.Cache.PHYSICS,"getPhysicsData","data");if(f===null||b===undefined||b===null){return f}else{if(f[b]){var d=f[b];if(d&&a){for(var e in d){e=d[e];if(e.fixtureKey===a){return e}}console.warn('Phaser.Cache.getPhysicsData: Could not find given fixtureKey: "'+a+" in "+c+'"')}else{return d}}else{console.warn('Phaser.Cache.getPhysicsData: Invalid key/object: "'+c+" / "+b+'"')}}return null},getTilemapData:function(a){return this.getItem(a,Phaser.Cache.TILEMAP,"getTilemapData")},getBinary:function(a){return this.getItem(a,Phaser.Cache.BINARY,"getBinary")},getBitmapData:function(a){return this.getItem(a,Phaser.Cache.BITMAPDATA,"getBitmapData","data")},getBitmapFont:function(a){return this.getItem(a,Phaser.Cache.BITMAPFONT,"getBitmapFont")},getJSON:function(a,c){var b=this.getItem(a,Phaser.Cache.JSON,"getJSON","data");if(b){if(c){return Phaser.Utils.extend(true,Array.isArray(b)?[]:{},b)}else{return b}}else{return null}},getXML:function(a){return this.getItem(a,Phaser.Cache.XML,"getXML","data")},getVideo:function(a){return this.getItem(a,Phaser.Cache.VIDEO,"getVideo")},getShader:function(a){return this.getItem(a,Phaser.Cache.SHADER,"getShader","data")},getRenderTexture:function(a){return this.getItem(a,Phaser.Cache.RENDER_TEXTURE,"getRenderTexture")},getBaseTexture:function(b,a){if(a===undefined){a=Phaser.Cache.IMAGE}return this.getItem(b,a,"getBaseTexture","base")},getFrame:function(b,a){if(a===undefined){a=Phaser.Cache.IMAGE}return this.getItem(b,a,"getFrame","frame")},getFrameCount:function(b,a){var c=this.getFrameData(b,a);if(c){return c.total}else{return 0}},getFrameData:function(b,a){if(a===undefined){a=Phaser.Cache.IMAGE}return this.getItem(b,a,"getFrameData","frameData")},hasFrameData:function(b,a){if(a===undefined){a=Phaser.Cache.IMAGE}return(this.getItem(b,a,"","frameData")!==null)},updateFrameData:function(b,c,a){if(a===undefined){a=Phaser.Cache.IMAGE}if(this._cacheMap[a][b]){this._cacheMap[a][b].frameData=c}},getFrameByIndex:function(c,b,a){var d=this.getFrameData(c,a);if(d){return d.getFrame(b)}else{return null}},getFrameByName:function(c,b,a){var d=this.getFrameData(c,a);if(d){return d.getFrameByName(b)}else{return null}},getURL:function(a){var a=this._resolveURL(a);if(a){return this._urlMap[a]}else{console.warn('Phaser.Cache.getUrl: Invalid url: "'+a+'" or Cache.autoResolveURL was false');return null}},getKeys:function(a){if(a===undefined){a=Phaser.Cache.IMAGE}var b=[];if(this._cacheMap[a]){for(var c in this._cacheMap[a]){if(c!=="__default"&&c!=="__missing"){b.push(c)}}}return b},removeCanvas:function(a){delete this._cache.canvas[a]},removeImage:function(b,c){if(c===undefined){c=true}var a=this.getImage(b,true);if(c&&a.base){a.base.destroy()}delete this._cache.image[b]},removeSound:function(a){delete this._cache.sound[a]},removeText:function(a){delete this._cache.text[a]},removePhysics:function(a){delete this._cache.physics[a]},removeTilemap:function(a){delete this._cache.tilemap[a]},removeBinary:function(a){delete this._cache.binary[a]},removeBitmapData:function(a){delete this._cache.bitmapData[a]},removeBitmapFont:function(a){delete this._cache.bitmapFont[a]},removeJSON:function(a){delete this._cache.json[a]},removeXML:function(a){delete this._cache.xml[a]},removeVideo:function(a){delete this._cache.video[a]},removeShader:function(a){delete this._cache.shader[a]},removeRenderTexture:function(a){delete this._cache.renderTexture[a]},removeSpriteSheet:function(a){delete this._cache.spriteSheet[a]},removeTextureAtlas:function(a){delete this._cache.image[a]},clearGLTextures:function(){for(var a in this._cache.image){this._cache.image[a].base._glTextures=[]}},_resolveURL:function(a,b){if(!this.autoResolveURL){return null}this._urlResolver.src=this.game.load.baseURL+a;this._urlTemp=this._urlResolver.src;this._urlResolver.src="";if(b){this._urlMap[this._urlTemp]=b}return this._urlTemp},destroy:function(){for(var c=0;c<this._cacheMap.length;c++){var a=this._cacheMap[c];for(var b in a){if(b!=="__default"&&b!=="__missing"){this.destroyItem(a[b]);delete a[b]}}}this._urlMap=null;this._urlResolver=null;this._urlTemp=null},destroyItem:function(a){if(a.destroy){a.destroy()}else{if(a.base&&a.base.destroy){a.base.destroy()}if(a.data&&a.data.destroy){a.data.destroy()}if(a.frameData&&a.frameData.destroy){a.frameData.destroy()}if(a.texture&&a.texture.destroy){a.texture.destroy(true)}}},_addImages:function(){this._pendingCount=0;this.addDefaultImage();this.addMissingImage();var a=this;var b=Phaser.Cache.READY_TIMEOUT;if(Phaser.Cache.READY_TIMEOUT>0){setTimeout(function(){if(!a.isReady){console.warn("Phaser.Cache: Still waiting for images after %s ms.",b);a._ready()}},Phaser.Cache.READY_TIMEOUT)}else{this._ready()}},_addPending:function(){this._pendingCount+=1},_removePending:function(){this._pendingCount-=1;this._checkReady()},_checkReady:function(){if(this.isReady){this._ready()}},_ready:function(){this._pendingCount=0;this.onReady.dispatch(this)}};Phaser.Cache.prototype.constructor=Phaser.Cache;Object.defineProperty(Phaser.Cache.prototype,"isReady",{get:function(){return this._pendingCount<=0}});Phaser.Loader=function(a){this.game=a;this.cache=a.cache;this.resetLocked=false;this.isLoading=false;this.hasLoaded=false;this.preloadSprite=null;this.crossOrigin=false;this.baseURL="";this.path="";this.headers={requestedWith:false,json:"application/json",xml:"application/xml"};this.onLoadStart=new Phaser.Signal();this.onLoadComplete=new Phaser.Signal();this.onPackComplete=new Phaser.Signal();this.onFileStart=new Phaser.Signal();this.onFileComplete=new Phaser.Signal();this.onFileError=new Phaser.Signal();this.useXDomainRequest=false;this._warnedAboutXDomainRequest=false;this.enableParallel=true;this.maxParallelDownloads=4;this._withSyncPointDepth=0;this._fileList=[];this._flightQueue=[];this._processingHead=0;this._fileLoadStarted=false;this._totalPackCount=0;this._totalFileCount=0;this._loadedPackCount=0;this._loadedFileCount=0};Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY=0;Phaser.Loader.TEXTURE_ATLAS_JSON_HASH=1;Phaser.Loader.TEXTURE_ATLAS_XML_STARLING=2;Phaser.Loader.PHYSICS_LIME_CORONA_JSON=3;Phaser.Loader.PHYSICS_PHASER_JSON=4;Phaser.Loader.TEXTURE_ATLAS_JSON_PYXEL=5;Phaser.Loader.prototype={setPreloadSprite:function(a,b){b=b||0;this.preloadSprite={sprite:a,direction:b,width:a.width,height:a.height,rect:null};if(b===0){this.preloadSprite.rect=new Phaser.Rectangle(0,0,1,a.height)}else{this.preloadSprite.rect=new Phaser.Rectangle(0,0,a.width,1)}a.crop(this.preloadSprite.rect);a.visible=true},resize:function(){if(this.preloadSprite&&this.preloadSprite.height!==this.preloadSprite.sprite.height){this.preloadSprite.rect.height=this.preloadSprite.sprite.height}},checkKeyExists:function(b,a){return this.getAssetIndex(b,a)>-1},getAssetIndex:function(d,c){var e=-1;for(var b=0;b<this._fileList.length;b++){var a=this._fileList[b];if(a.type===d&&a.key===c){e=b;if(!a.loaded&&!a.loading){break}}}return e},getAsset:function(b,a){var c=this.getAssetIndex(b,a);if(c>-1){return{index:c,file:this._fileList[c]}}return false},reset:function(b,a){if(a===undefined){a=false}if(this.resetLocked){return}if(b){this.preloadSprite=null}this.isLoading=false;this._processingHead=0;this._fileList.length=0;this._flightQueue.length=0;this._fileLoadStarted=false;this._totalFileCount=0;this._totalPackCount=0;this._loadedPackCount=0;this._loadedFileCount=0;if(a){this.onLoadStart.removeAll();this.onLoadComplete.removeAll();this.onPackComplete.removeAll();this.onFileStart.removeAll();this.onFileComplete.removeAll();this.onFileError.removeAll()}},addToFileList:function(h,j,b,g,f,i){if(f===undefined){f=false}if(j===undefined||j===""){console.warn("Phaser.Loader: Invalid or no key given of type "+h);return this}if(b===undefined||b===null){if(i){b=j+i}else{console.warn("Phaser.Loader: No URL given for file type: "+h+" key: "+j);return this}}var e={type:h,key:j,path:this.path,url:b,syncPoint:this._withSyncPointDepth>0,data:null,loading:false,loaded:false,error:false};if(g){for(var a in g){e[a]=g[a]}}var d=this.getAssetIndex(h,j);if(f&&d>-1){var c=this._fileList[d];if(!c.loading&&!c.loaded){this._fileList[d]=e}else{this._fileList.push(e);this._totalFileCount++}}else{if(d===-1){this._fileList.push(e);this._totalFileCount++}}return this},replaceInFileList:function(d,c,a,b){return this.addToFileList(d,c,a,b,true)},pack:function(f,b,g,a){if(b===undefined){b=null}if(g===undefined){g=null}if(a===undefined){a=null}if(!b&&!g){console.warn("Phaser.Loader.pack - Both url and data are null. One must be set.");return this}var e={type:"packfile",key:f,url:b,path:this.path,syncPoint:true,data:null,loading:false,loaded:false,error:false,callbackContext:a};if(g){if(typeof g==="string"){g=JSON.parse(g)}e.data=g||{};e.loaded=true}for(var d=0;d<this._fileList.length+1;d++){var c=this._fileList[d];if(!c||(!c.loaded&&!c.loading&&c.type!=="packfile")){this._fileList.splice(d,0,e);this._totalPackCount++;break}}return this},image:function(c,b,a){if(typeof b==="object"){return this.texture(c,b,a)}else{return this.addToFileList("image",c,b,undefined,a,".png")}},imageFromBitmapData:function(b,c,a){return this.image(b,c.canvas.toDataURL("image/png"),a)},texture:function(d,c,b){if(this.game.renderType===Phaser.WEBGL){var a=this.game.renderer.extensions.compression;var e;for(e in c){if(e.toUpperCase() in a){return this.addToFileList("texture",d,c[e],undefined,b,".pvr")}}}if(c.truecolor){this.addToFileList("image",d,c.truecolor,undefined,b,".png")}return this},images:function(b,c){if(Array.isArray(c)){for(var a=0;a<b.length;a++){this.image(b[a],c[a])}}else{for(var a=0;a<b.length;a++){this.image(b[a])}}return this},text:function(c,b,a){return this.addToFileList("text",c,b,undefined,a,".txt")},json:function(c,b,a){return this.addToFileList("json",c,b,undefined,a,".json")},shader:function(c,b,a){return this.addToFileList("shader",c,b,undefined,a,".frag")},xml:function(c,b,a){return this.addToFileList("xml",c,b,undefined,a,".xml")},script:function(c,b,d,a){if(d===undefined){d=false}if(d!==false&&a===undefined){a=this}return this.addToFileList("script",c,b,{syncPoint:true,callback:d,callbackContext:a},false,".js")},binary:function(c,b,d,a){if(d===undefined){d=false}if(d!==false&&a===undefined){a=d}return this.addToFileList("binary",c,b,{callback:d,callbackContext:a},false,".bin")},spritesheet:function(d,c,a,b,g,f,h,e){if(g===undefined){g=-1}if(f===undefined){f=0}if(h===undefined){h=0}if(e===undefined){e=0}return this.addToFileList("spritesheet",d,c,{frameWidth:a,frameHeight:b,frameMax:g,margin:f,spacing:h,skipFrames:e},false,".png")},audio:function(b,c,a){if(this.game.sound.noAudio){return this}if(a===undefined){a=true}if(typeof c==="string"){c=[c]}return this.addToFileList("audio",b,c,{buffer:null,autoDecode:a})},audioSprite:function(b,e,d,c,a){if(this.game.sound.noAudio){return this}if(d===undefined){d=null}if(c===undefined){c=null}if(a===undefined){a=true}this.audio(b,e,a);if(d){this.json(b+"-audioatlas",d)}else{if(c){if(typeof c==="string"){c=JSON.parse(c)}this.cache.addJSON(b+"-audioatlas","",c)}else{console.warn("Phaser.Loader.audiosprite - You must specify either a jsonURL or provide a jsonData object")}}return this},audiosprite:function(b,e,d,c,a){return this.audioSprite(b,e,d,c,a)},video:function(b,d,c,a){if(c===undefined){if(this.game.device.firefox){c="loadeddata"}else{c="canplaythrough"}}if(a===undefined){a=false}if(typeof d==="string"){d=[d]}return this.addToFileList("video",b,d,{buffer:null,asBlob:a,loadEvent:c})},tilemap:function(b,a,c,d){if(a===undefined){a=null}if(c===undefined){c=null}if(d===undefined){d=Phaser.Tilemap.CSV}if(!a&&!c){if(d===Phaser.Tilemap.CSV){a=b+".csv"}else{a=b+".json"}}if(c){switch(d){case Phaser.Tilemap.CSV:break;case Phaser.Tilemap.TILED_JSON:if(typeof c==="string"){c=JSON.parse(c)}break}this.cache.addTilemap(b,null,c,d)}else{this.addToFileList("tilemap",b,a,{format:d})}return this},physics:function(b,a,c,d){if(a===undefined){a=null}if(c===undefined){c=null}if(d===undefined){d=Phaser.Physics.LIME_CORONA_JSON}if(!a&&!c){a=b+".json"}if(c){if(typeof c==="string"){c=JSON.parse(c)}this.cache.addPhysicsData(b,null,c,d)}else{this.addToFileList("physics",b,a,{format:d})}return this},bitmapFont:function(h,a,i,b,g,f){if(a===undefined||a===null){a=h+".png"}if(i===undefined){i=null}if(b===undefined){b=null}if(i===null&&b===null){i=h+".xml"}if(g===undefined){g=0}if(f===undefined){f=0}if(i){this.addToFileList("bitmapfont",h,a,{atlasURL:i,xSpacing:g,ySpacing:f})}else{if(typeof b==="string"){var j,c;try{j=JSON.parse(b)}catch(d){c=this.parseXml(b)}if(!c&&!j){throw new Error("Phaser.Loader. Invalid Bitmap Font atlas given")}this.addToFileList("bitmapfont",h,a,{atlasURL:null,atlasData:j||c,atlasType:(!!j?"json":"xml"),xSpacing:g,ySpacing:f})}}return this},atlasJSONArray:function(c,b,d,a){return this.atlas(c,b,d,a,Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY)},atlasJSONHash:function(c,b,d,a){return this.atlas(c,b,d,a,Phaser.Loader.TEXTURE_ATLAS_JSON_HASH)},atlasXML:function(c,b,d,a){if(d===undefined){d=null}if(a===undefined){a=null}if(!d&&!a){d=c+".xml"}return this.atlas(c,b,d,a,Phaser.Loader.TEXTURE_ATLAS_XML_STARLING)},atlas:function(d,c,e,a,f){if(c===undefined||c===null){c=d+".png"}if(e===undefined){e=null}if(a===undefined){a=null}if(f===undefined){f=Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY}if(!e&&!a){if(f===Phaser.Loader.TEXTURE_ATLAS_XML_STARLING){e=d+".xml"}else{e=d+".json"}}if(e){this.addToFileList("textureatlas",d,c,{atlasURL:e,format:f})}else{switch(f){case Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY:if(typeof a==="string"){a=JSON.parse(a)}break;case Phaser.Loader.TEXTURE_ATLAS_XML_STARLING:if(typeof a==="string"){var b=this.parseXml(a);if(!b){throw new Error("Phaser.Loader. Invalid Texture Atlas XML given")}a=b}break}this.addToFileList("textureatlas",d,c,{atlasURL:null,atlasData:a,format:f})}return this},withSyncPoint:function(b,a){this._withSyncPointDepth++;try{b.call(a||this,this)}finally{this._withSyncPointDepth--}return this},addSyncPoint:function(c,a){var b=this.getAsset(c,a);if(b){b.file.syncPoint=true}return this},removeFile:function(c,a){var b=this.getAsset(c,a);if(b){if(!b.loaded&&!b.loading){this._fileList.splice(b.index,1)}}},removeAll:function(){this._fileList.length=0;this._flightQueue.length=0},start:function(){if(this.isLoading){return}this.hasLoaded=false;this.isLoading=true;this.updateProgress();this.processLoadQueue()},processLoadQueue:function(){if(!this.isLoading){console.warn("Phaser.Loader - active loading canceled / reset");this.finishedLoading(true);return}for(var d=0;d<this._flightQueue.length;d++){var c=this._flightQueue[d];if(c.loaded||c.error){this._flightQueue.splice(d,1);d--;c.loading=false;c.requestUrl=null;c.requestObject=null;if(c.error){this.onFileError.dispatch(c.key,c)}if(c.type!=="packfile"){this._loadedFileCount++;this.onFileComplete.dispatch(this.progress,c.key,!c.error,this._loadedFileCount,this._totalFileCount)}else{if(c.type==="packfile"&&c.error){this._loadedPackCount++;this.onPackComplete.dispatch(c.key,!c.error,this._loadedPackCount,this._totalPackCount)}}}}var a=false;var b=this.enableParallel?Math.max(1,this.maxParallelDownloads):1;for(var d=this._processingHead;d<this._fileList.length;d++){var c=this._fileList[d];if(c.type==="packfile"&&!c.error&&c.loaded&&d===this._processingHead){this.processPack(c);this._loadedPackCount++;this.onPackComplete.dispatch(c.key,!c.error,this._loadedPackCount,this._totalPackCount)}if(c.loaded||c.error){if(d===this._processingHead){this._processingHead=d+1}}else{if(!c.loading&&this._flightQueue.length<b){if(c.type==="packfile"&&!c.data){this._flightQueue.push(c);c.loading=true;this.loadFile(c)}else{if(!a){if(!this._fileLoadStarted){this._fileLoadStarted=true;this.onLoadStart.dispatch()}this._flightQueue.push(c);c.loading=true;this.onFileStart.dispatch(this.progress,c.key,c.url);this.loadFile(c)}}}}if(!c.loaded&&c.syncPoint){a=true}if(this._flightQueue.length>=b||(a&&this._loadedPackCount===this._totalPackCount)){break}}this.updateProgress();if(this._processingHead>=this._fileList.length){this.finishedLoading()}else{if(!this._flightQueue.length){console.warn("Phaser.Loader - aborting: processing queue empty, loading may have stalled");var e=this;setTimeout(function(){e.finishedLoading(true)},2000)}}},finishedLoading:function(a){if(this.hasLoaded){return}this.hasLoaded=true;this.isLoading=false;if(!a&&!this._fileLoadStarted){this._fileLoadStarted=true;this.onLoadStart.dispatch()}this.reset();this.onLoadComplete.dispatch();this.game.state.loadComplete()},asyncComplete:function(b,a){if(a===undefined){a=""}b.loaded=true;b.error=!!a;if(a){b.errorMessage=a;console.warn("Phaser.Loader - "+b.type+"["+b.key+"]: "+a)}this.processLoadQueue()},processPack:function(d){var a=d.data[d.key];if(!a){console.warn("Phaser.Loader - "+d.key+": pack has data, but not for pack key");return}for(var c=0;c<a.length;c++){var b=a[c];switch(b.type){case"image":this.image(b.key,b.url,b.overwrite);break;case"text":this.text(b.key,b.url,b.overwrite);break;case"json":this.json(b.key,b.url,b.overwrite);break;case"xml":this.xml(b.key,b.url,b.overwrite);break;case"script":this.script(b.key,b.url,b.callback,d.callbackContext||this);break;case"binary":this.binary(b.key,b.url,b.callback,d.callbackContext||this);break;case"spritesheet":this.spritesheet(b.key,b.url,b.frameWidth,b.frameHeight,b.frameMax,b.margin,b.spacing,b.skipFrames);break;case"video":this.video(b.key,b.urls);break;case"audio":this.audio(b.key,b.urls,b.autoDecode);break;case"audiosprite":this.audiosprite(b.key,b.urls,b.jsonURL,b.jsonData,b.autoDecode);break;case"tilemap":this.tilemap(b.key,b.url,b.data,Phaser.Tilemap[b.format]);break;case"physics":this.physics(b.key,b.url,b.data,Phaser.Loader[b.format]);break;case"bitmapFont":this.bitmapFont(b.key,b.textureURL,b.atlasURL,b.atlasData,b.xSpacing,b.ySpacing);break;case"atlasJSONArray":this.atlasJSONArray(b.key,b.textureURL,b.atlasURL,b.atlasData);break;case"atlasJSONHash":this.atlasJSONHash(b.key,b.textureURL,b.atlasURL,b.atlasData);break;case"atlasXML":this.atlasXML(b.key,b.textureURL,b.atlasURL,b.atlasData);break;case"atlas":this.atlas(b.key,b.textureURL,b.atlasURL,b.atlasData,Phaser.Loader[b.format]);break;case"shader":this.shader(b.key,b.url,b.overwrite);break}}},transformUrl:function(a,b){if(!a){return false}if(a.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)){return a}else{return this.baseURL+b.path+a}},loadFile:function(a){switch(a.type){case"packfile":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.fileComplete);break;case"image":case"spritesheet":case"textureatlas":case"bitmapfont":this.loadImageTag(a);break;case"audio":a.url=this.getAudioURL(a.url);if(a.url){if(this.game.sound.usingWebAudio){this.xhrLoad(a,this.transformUrl(a.url,a),"arraybuffer",this.fileComplete)}else{if(this.game.sound.usingAudioTag){this.loadAudioTag(a)}}}else{this.fileError(a,null,"No supported audio URL specified or device does not have audio playback support")}break;case"video":a.url=this.getVideoURL(a.url);if(a.url){if(a.asBlob){this.xhrLoad(a,this.transformUrl(a.url,a),"blob",this.fileComplete)}else{this.loadVideoTag(a)}}else{this.fileError(a,null,"No supported video URL specified or device does not have video playback support")}break;case"json":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.jsonLoadComplete);break;case"xml":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.xmlLoadComplete);break;case"tilemap":if(a.format===Phaser.Tilemap.TILED_JSON){this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.jsonLoadComplete)}else{if(a.format===Phaser.Tilemap.CSV){this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.csvLoadComplete)}else{this.asyncComplete(a,"invalid Tilemap format: "+a.format)}}break;case"text":case"script":case"shader":case"physics":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.fileComplete);break;case"texture":if(a.key.split("_").pop()==="truecolor"){this.loadImageTag(a)}else{this.xhrLoad(a,this.transformUrl(a.url,a),"arraybuffer",this.fileComplete)}break;case"binary":this.xhrLoad(a,this.transformUrl(a.url,a),"arraybuffer",this.fileComplete);break}},loadImageTag:function(a){var b=this;a.data=new Image();a.data.name=a.key;if(this.crossOrigin){a.data.crossOrigin=this.crossOrigin}a.data.onload=function(){if(a.data.onload){a.data.onload=null;a.data.onerror=null;b.fileComplete(a)}};a.data.onerror=function(){if(a.data.onload){a.data.onload=null;a.data.onerror=null;b.fileError(a)}};a.data.src=this.transformUrl(a.url,a);if(!this.game.device.firefox&&a.data.complete&&a.data.width&&a.data.height){a.data.onload=null;a.data.onerror=null;this.fileComplete(a)}},loadVideoTag:function(a){var c=this;a.data=document.createElement("video");a.data.name=a.key;a.data.controls=false;a.data.autoplay=false;var b=function(){a.data.removeEventListener(a.loadEvent,b,false);a.data.onerror=null;a.data.canplay=true;Phaser.GAMES[c.game.id].load.fileComplete(a)};a.data.onerror=function(){a.data.removeEventListener(a.loadEvent,b,false);a.data.onerror=null;a.data.canplay=false;c.fileError(a)};a.data.addEventListener(a.loadEvent,b,false);a.data.src=this.transformUrl(a.url,a);a.data.load()},loadAudioTag:function(b){var c=this;if(this.game.sound.touchLocked){b.data=new Audio();b.data.name=b.key;b.data.preload="auto";b.data.src=this.transformUrl(b.url,b);this.fileComplete(b)}else{b.data=new Audio();b.data.name=b.key;var a=function(){b.data.removeEventListener("canplaythrough",a,false);b.data.onerror=null;c.fileComplete(b)};b.data.onerror=function(){b.data.removeEventListener("canplaythrough",a,false);b.data.onerror=null;c.fileError(b)};b.data.preload="auto";b.data.src=this.transformUrl(b.url,b);b.data.addEventListener("canplaythrough",a,false);b.data.load()}},xhrLoad:function(c,b,d,e,a){if(this.useXDomainRequest&&window.XDomainRequest){this.xhrLoadWithXDR(c,b,d,e,a);return}var f=new XMLHttpRequest();f.open("GET",b,true);f.responseType=d;if(this.headers.requestedWith!==false){f.setRequestHeader("X-Requested-With",this.headers.requestedWith)}if(this.headers[c.type]){f.setRequestHeader("Accept",this.headers[c.type])}a=a||this.fileError;var g=this;f.onload=function(){try{if(f.readyState===4&&f.status>=400&&f.status<=599){return a.call(g,c,f)}else{return e.call(g,c,f)}}catch(h){if(!g.hasLoaded){g.asyncComplete(c,h.message||"Exception")}else{if(window.console){console.error(h)}}}};f.onerror=function(){try{return a.call(g,c,f)}catch(h){if(!g.hasLoaded){g.asyncComplete(c,h.message||"Exception")}else{if(window.console){console.error(h)}}}};c.requestObject=f;c.requestUrl=b;f.send()},xhrLoadWithXDR:function(c,b,d,e,a){if(!this._warnedAboutXDomainRequest&&(!this.game.device.ie||this.game.device.ieVersion>=10)){this._warnedAboutXDomainRequest=true;console.warn("Phaser.Loader - using XDomainRequest outside of IE 9")}var f=new window.XDomainRequest();f.open("GET",b,true);f.responseType=d;f.timeout=3000;a=a||this.fileError;var g=this;f.onerror=function(){try{return a.call(g,c,f)}catch(h){g.asyncComplete(c,h.message||"Exception")}};f.ontimeout=function(){try{return a.call(g,c,f)}catch(h){g.asyncComplete(c,h.message||"Exception")}};f.onprogress=function(){};f.onload=function(){try{if(f.readyState===4&&f.status>=400&&f.status<=599){return a.call(g,c,f)}else{return e.call(g,c,f)}return e.call(g,c,f)}catch(h){g.asyncComplete(c,h.message||"Exception")}};c.requestObject=f;c.requestUrl=b;setTimeout(function(){f.send()},0)},getVideoURL:function(d){for(var b=0;b<d.length;b++){var a=d[b];var c;if(a.uri){c=a.type;a=a.uri;if(this.game.device.canPlayVideo(c)){return a}}else{if(a.indexOf("blob:")===0||a.indexOf("data:")===0){return a}if(a.indexOf("?")>=0){a=a.substr(0,a.indexOf("?"))}var e=a.substr((Math.max(0,a.lastIndexOf("."))||Infinity)+1);c=e.toLowerCase();if(this.game.device.canPlayVideo(c)){return d[b]}}}return null},getAudioURL:function(d){if(this.game.sound.noAudio){return null}for(var c=0;c<d.length;c++){var b=d[c];var a;if(b.uri){a=b.type;b=b.uri;if(this.game.device.canPlayAudio(a)){return b}}else{if(b.indexOf("blob:")===0||b.indexOf("data:")===0){return b}if(b.indexOf("?")>=0){b=b.substr(0,b.indexOf("?"))}var e=b.substr((Math.max(0,b.lastIndexOf("."))||Infinity)+1);a=e.toLowerCase();if(this.game.device.canPlayAudio(a)){return d[c]}}}return null},fileError:function(b,e,d){var a=b.requestUrl||this.transformUrl(b.url,b);var c="error loading asset from URL "+a;if(!d&&e){d=e.status}if(d){c=c+" ("+d+")"}this.asyncComplete(b,c)},fileComplete:function(a,f){var d=true;switch(a.type){case"packfile":var b=JSON.parse(f.responseText);a.data=b||{};break;case"texture":var g=/\.([^.]+)$/.exec(a.url.split("?",1)[0])[1].toLowerCase();if(a.data!==null){this.cache.addCompressedTextureMetaData(a.key,a.url,g,a.data)}else{this.cache.addCompressedTextureMetaData(a.key,a.url,g,f.response)}break;case"image":this.cache.addImage(a.key,a.url,a.data);break;case"spritesheet":this.cache.addSpriteSheet(a.key,a.url,a.data,a.frameWidth,a.frameHeight,a.frameMax,a.margin,a.spacing,a.skipFrames);break;case"textureatlas":if(a.atlasURL==null){this.cache.addTextureAtlas(a.key,a.url,a.data,a.atlasData,a.format)}else{d=false;if(a.format===Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY||a.format===Phaser.Loader.TEXTURE_ATLAS_JSON_HASH||a.format===Phaser.Loader.TEXTURE_ATLAS_JSON_PYXEL){this.xhrLoad(a,this.transformUrl(a.atlasURL,a),"text",this.jsonLoadComplete)}else{if(a.format===Phaser.Loader.TEXTURE_ATLAS_XML_STARLING){this.xhrLoad(a,this.transformUrl(a.atlasURL,a),"text",this.xmlLoadComplete)}else{throw new Error("Phaser.Loader. Invalid Texture Atlas format: "+a.format)}}}break;case"bitmapfont":if(!a.atlasURL){this.cache.addBitmapFont(a.key,a.url,a.data,a.atlasData,a.atlasType,a.xSpacing,a.ySpacing)}else{d=false;this.xhrLoad(a,this.transformUrl(a.atlasURL,a),"text",function(i,k){var h;try{h=JSON.parse(k.responseText)}catch(j){}if(!!h){i.atlasType="json";this.jsonLoadComplete(i,k)}else{i.atlasType="xml";this.xmlLoadComplete(i,k)}})}break;case"video":if(a.asBlob){try{a.data=f.response}catch(c){throw new Error("Phaser.Loader. Unable to parse video file as Blob: "+a.key)}}this.cache.addVideo(a.key,a.url,a.data,a.asBlob);break;case"audio":if(this.game.sound.usingWebAudio){a.data=f.response;this.cache.addSound(a.key,a.url,a.data,true,false);if(a.autoDecode){this.game.sound.decode(a.key)}}else{this.cache.addSound(a.key,a.url,a.data,false,true)}break;case"text":a.data=f.responseText;this.cache.addText(a.key,a.url,a.data);break;case"shader":a.data=f.responseText;this.cache.addShader(a.key,a.url,a.data);break;case"physics":var b=JSON.parse(f.responseText);this.cache.addPhysicsData(a.key,a.url,b,a.format);break;case"script":a.data=document.createElement("script");a.data.language="javascript";a.data.type="text/javascript";a.data.defer=false;a.data.text=f.responseText;document.head.appendChild(a.data);if(a.callback){a.data=a.callback.call(a.callbackContext,a.key,f.responseText)}break;case"binary":if(a.callback){a.data=a.callback.call(a.callbackContext,a.key,f.response)}else{a.data=f.response}this.cache.addBinary(a.key,a.data);break}if(d){this.asyncComplete(a)}},jsonLoadComplete:function(a,c){var b=JSON.parse(c.responseText);if(a.type==="tilemap"){this.cache.addTilemap(a.key,a.url,b,a.format)}else{if(a.type==="bitmapfont"){this.cache.addBitmapFont(a.key,a.url,a.data,b,a.atlasType,a.xSpacing,a.ySpacing)}else{if(a.type==="json"){this.cache.addJSON(a.key,a.url,b)}else{this.cache.addTextureAtlas(a.key,a.url,a.data,b,a.format)}}}this.asyncComplete(a)},csvLoadComplete:function(a,c){var b=c.responseText;this.cache.addTilemap(a.key,a.url,b,a.format);this.asyncComplete(a)},xmlLoadComplete:function(c,e){var d=e.responseText;var b=this.parseXml(d);if(!b){var a=e.responseType||e.contentType;console.warn("Phaser.Loader - "+c.key+": invalid XML ("+a+")");this.asyncComplete(c,"invalid XML");return}if(c.type==="bitmapfont"){this.cache.addBitmapFont(c.key,c.url,c.data,b,c.atlasType,c.xSpacing,c.ySpacing)}else{if(c.type==="textureatlas"){this.cache.addTextureAtlas(c.key,c.url,c.data,b,c.format)}else{if(c.type==="xml"){this.cache.addXML(c.key,c.url,b)}}}this.asyncComplete(c)},parseXml:function(b){var a;try{if(window.DOMParser){var d=new DOMParser();a=d.parseFromString(b,"text/xml")}else{a=new ActiveXObject("Microsoft.XMLDOM");a.async="false";a.loadXML(b)}}catch(c){a=null}if(!a||!a.documentElement||a.getElementsByTagName("parsererror").length){return null}else{return a}},updateProgress:function(){if(this.preloadSprite){if(this.preloadSprite.direction===0){this.preloadSprite.rect.width=Math.floor((this.preloadSprite.width/100)*this.progress)}else{this.preloadSprite.rect.height=Math.floor((this.preloadSprite.height/100)*this.progress)}if(this.preloadSprite.sprite){this.preloadSprite.sprite.updateCrop()}else{this.preloadSprite=null}}},totalLoadedFiles:function(){return this._loadedFileCount},totalQueuedFiles:function(){return this._totalFileCount-this._loadedFileCount},totalLoadedPacks:function(){return this._totalPackCount},totalQueuedPacks:function(){return this._totalPackCount-this._loadedPackCount}};Object.defineProperty(Phaser.Loader.prototype,"progressFloat",{get:function(){var a=(this._loadedFileCount/this._totalFileCount)*100;return Phaser.Math.clamp(a||0,0,100)}});Object.defineProperty(Phaser.Loader.prototype,"progress",{get:function(){return Math.round(this.progressFloat)}});Phaser.Loader.prototype.constructor=Phaser.Loader;Phaser.LoaderParser={bitmapFont:function(b,e,d,c,f,a){return this.xmlBitmapFont(b,e,d,c,f,a)},xmlBitmapFont:function(b,h,c,m,j,l){if(l==null){l=1}var s={};var o=b.getElementsByTagName("info")[0];var k=b.getElementsByTagName("common")[0];s.font=o.getAttribute("face");s.size=parseInt(o.getAttribute("size"),10);s.lineHeight=parseInt(k.getAttribute("lineHeight"),10)+m;s.chars={};var r=b.getElementsByTagName("char");var g=(j)?j.x:0;var f=(j)?j.y:0;for(var n=0;n<r.length;n++){var a=parseInt(r[n].getAttribute("id"),10);s.chars[a]={x:g+parseInt(r[n].getAttribute("x"),10),y:f+parseInt(r[n].getAttribute("y"),10),width:parseInt(r[n].getAttribute("width"),10),height:parseInt(r[n].getAttribute("height"),10),xOffset:parseInt(r[n].getAttribute("xoffset"),10)/l,yOffset:parseInt(r[n].getAttribute("yoffset"),10)/l,xAdvance:(parseInt(r[n].getAttribute("xadvance"),10)+c)/l,kerning:{}}}var p=b.getElementsByTagName("kerning");for(n=0;n<p.length;n++){var e=parseInt(p[n].getAttribute("first"),10);var q=parseInt(p[n].getAttribute("second"),10);var d=parseInt(p[n].getAttribute("amount"),10)/l;s.chars[q].kerning[e]=d}return this.finalizeBitmapFont(h,s)},jsonBitmapFont:function(k,a,h,f,b,d){if(d==null){d=1}var e={font:k.font.info._face,size:parseInt(k.font.info._size,10),lineHeight:parseInt(k.font.common._lineHeight,10)+f,chars:{}};var i=(b)?b.x:0;var g=(b)?b.y:0;k.font.chars["char"].forEach(function j(m){var l=parseInt(m._id,10);e.chars[l]={x:i+parseInt(m._x,10),y:g+parseInt(m._y,10),width:parseInt(m._width,10),height:parseInt(m._height,10),xOffset:parseInt(m._xoffset,10)/d,yOffset:parseInt(m._yoffset,10)/d,xAdvance:(parseInt(m._xadvance,10)+h)/d,kerning:{}}});if(k.font.kernings&&k.font.kernings.kerning){k.font.kernings.kerning.forEach(function c(l){e.chars[l._second].kerning[l._first]=parseInt(l._amount,10)/d})}return this.finalizeBitmapFont(a,e)},finalizeBitmapFont:function(a,b){Object.keys(b.chars).forEach(function c(d){var e=b.chars[d];e.texture=new PIXI.Texture(a,new Phaser.Rectangle(e.x,e.y,e.width,e.height))});return b},pvr:function(e){var d=new Uint32Array(e.slice(0,52)),c=new Uint8Array(e),a=null,b=(d[3]<<32|d[2]),g,f=0;if(d[0]===55727696&&[0,1,2,3,6,7,9,11].indexOf(b)>=0){if(b>=0&&b<=3){g="PVRTC"}else{if(b>=7&&b<=11){g="S3TC"}else{if(b===6){g="ETC1"}}}switch(b){case 0:f=35841;break;case 1:f=35843;break;case 2:f=35840;break;case 3:f=35842;break;case 6:f=36196;break;case 7:f=33777;break;case 9:f=33778;break;case 11:f=33779;break;default:f=-1}a={complete:true,fileFormat:"PVR",compressionAlgorithm:g,flags:d[1],pixelFormat:b,colorSpace:d[4],channelType:d[5],height:d[6],width:d[7],depth:d[8],numberOfSurfaces:d[9],numberOfFaces:d[10],numberOfMipmaps:d[11],metaDataSize:d[12],textureData:c.subarray(52+d[12],c.byteLength),glExtensionFormat:f}}return a},dds:function(c){var a=new Uint8Array(c),b=new Uint32Array(c),d=null;if(a[0]===68&&a[1]===68&&a[2]===83&&a[3]===32){d={complete:true,fileFormat:"DDS",compressionAlgorithm:"S3TC",size:b[1],flags:b[2],height:b[3],width:b[4],pitch:b[5],depth:b[6],mipmapCount:b[7],formatSize:b[19],formatFlag:b[19],formatFourCC:[String.fromCharCode(a[84]),String.fromCharCode(a[85]),String.fromCharCode(a[86]),String.fromCharCode(a[87])].join(""),formatBitCount:b[21],formatRBitMask:b[22],formatGBitMask:b[23],formatBBitMask:b[24],formatABitMask:b[25],caps1:b[26],caps2:b[27],caps3:b[28],caps4:b[29],reserved2:b[30],DXGIFormat:null,resourceDimension:null,miscFlag:null,arraySize:null,textureData:a.subarray(b[1]+4,a.byteLength)};if(d.formatFourCC==="DX10"){d.DXGIFormat=b[31];d.resourceDimension=b[32];d.miscFlag=b[33];d.arraySize=b[34];d.miscFlag=b[35]}}return d},ktx:function(c){var a=new Uint8Array(c),b=new Uint32Array(c),h=null,e=16+(b[15]/4)|0,f=b[e],d=b[7],g=0;if(a[0]===171&&a[1]===75&&a[2]===84&&a[3]===88&&a[4]===32&&a[5]===49&&a[6]===49&&a[7]===187&&a[8]===13&&a[9]===10&&a[10]===26&&a[11]===10&&[36196,35840,35841,35842,35843,33776,33777,33778,33779].indexOf(d)>=0){switch(d){case 36196:g="ETC1";break;case 35840:case 35841:case 35842:case 35843:g="PVRTC";break;case 33776:case 33777:case 33778:case 33779:g="S3TC";break}h={complete:true,fileFormat:"KTX",compressionAlgorithm:g,endianness:b[3],glType:b[4],glTypeSize:b[5],glFormat:b[6],glInternalFormat:b[7],glBaseInternalFormat:b[8],width:b[9],height:b[10],pixelDepth:b[11],numberOfArrayElements:b[12],numberOfFaces:b[13],numberOfMipmapLevels:b[14],bytesOfKeyValueData:b[15],keyAndValueByteSize:b[16],imageSize:f,textureData:a.subarray((e+1)*4,f+100)}}return h},pkm:function(c){var b=new Uint8Array(c),a=null;if(b[0]===80&&b[1]===75&&b[2]===77&&b[3]===32){a={complete:true,fileFormat:"PKM",compressionAlgorithm:"ETC1",format:((b[6]<<8|b[7]))&65535,width:((b[8]<<8|b[9]))&65535,height:((b[10]<<8|b[11]))&65535,originalWidth:((b[12]<<8|b[13]))&65535,originalHeight:((b[14]<<8|b[15]))&65535,textureData:b.subarray(16,b.length)}}return a}};Phaser.AudioSprite=function(c,d){this.game=c;this.key=d;this.config=this.game.cache.getJSON(d+"-audioatlas");this.autoplayKey=null;this.autoplay=false;this.sounds={};for(var b in this.config.spritemap){var a=this.config.spritemap[b];var e=this.game.add.sound(this.key);e.addMarker(b,a.start,(a.end-a.start),null,a.loop);this.sounds[b]=e}if(this.config.autoplay){this.autoplayKey=this.config.autoplay;this.play(this.autoplayKey);this.autoplay=this.sounds[this.autoplayKey]}};Phaser.AudioSprite.prototype={play:function(a,b){if(b===undefined){b=1}return this.sounds[a].play(a,null,b)},stop:function(a){if(!a){for(var b in this.sounds){this.sounds[b].stop()}}else{this.sounds[a].stop()}},get:function(a){return this.sounds[a]}};Phaser.AudioSprite.prototype.constructor=Phaser.AudioSprite;Phaser.Sound=function(c,d,e,a,b){if(e===undefined){e=1}if(a===undefined){a=false}if(b===undefined){b=c.sound.connectToMaster}this.game=c;this.name=d;this.key=d;this.loop=a;this.markers={};this.context=null;this.autoplay=false;this.totalDuration=0;this.startTime=0;this.currentTime=0;this.duration=0;this.durationMS=0;this.position=0;this.stopTime=0;this.paused=false;this.pausedPosition=0;this.pausedTime=0;this.isPlaying=false;this.currentMarker="";this.fadeTween=null;this.pendingPlayback=false;this.override=false;this.allowMultiple=false;this.usingWebAudio=this.game.sound.usingWebAudio;this.usingAudioTag=this.game.sound.usingAudioTag;this.externalNode=null;this.masterGainNode=null;this.gainNode=null;this._sound=null;this._globalVolume=1;this._markedToDelete=false;this._removeFromSoundManager=false;if(this.usingWebAudio){this.context=this.game.sound.context;this.masterGainNode=this.game.sound.masterGain;if(this.context.createGain===undefined){this.gainNode=this.context.createGainNode()}else{this.gainNode=this.context.createGain()}this.gainNode.gain.value=e*this.game.sound.volume;if(b){this.gainNode.connect(this.masterGainNode)}}else{if(this.usingAudioTag){if(this.game.cache.getSound(d)&&this.game.cache.isSoundReady(d)){this._sound=this.game.cache.getSoundData(d);this.totalDuration=0;if(this._sound.duration){this.totalDuration=this._sound.duration}}else{this.game.cache.onSoundUnlock.add(this.soundHasUnlocked,this)}}}this.onDecoded=new Phaser.Signal();this.onPlay=new Phaser.Signal();this.onPause=new Phaser.Signal();this.onResume=new Phaser.Signal();this.onLoop=new Phaser.Signal();this.onStop=new Phaser.Signal();this.onMute=new Phaser.Signal();this.onMarkerComplete=new Phaser.Signal();this.onFadeComplete=new Phaser.Signal();this._volume=e;this._buffer=null;this._muted=false;this._tempMarker=0;this._tempPosition=0;this._tempVolume=0;this._tempPause=0;this._muteVolume=0;this._tempLoop=0;this._paused=false;this._onDecodedEventDispatched=false};Phaser.Sound.prototype={soundHasUnlocked:function(a){if(a===this.key){this._sound=this.game.cache.getSoundData(this.key);this.totalDuration=this._sound.duration}},addMarker:function(b,e,d,c,a){if(d===undefined||d===null){d=1}if(c===undefined||c===null){c=1}if(a===undefined){a=false}this.markers[b]={name:b,start:e,stop:e+d,volume:c,duration:d,durationMS:d*1000,loop:a}},removeMarker:function(a){delete this.markers[a]},onEndedHandler:function(){this._sound.onended=null;this.isPlaying=false;this.currentTime=this.durationMS;this.stop();if(this._markedToDelete){if(this.externalNode){this._sound.disconnect(this.externalNode)}else{if(this.gainNode){this._sound.disconnect(this.gainNode)}}if(this._removeFromSoundManager){this.game.sound.remove(this)}else{this.markers={};this.context=null;this._buffer=null;this.externalNode=null;this.onDecoded.dispose();this.onPlay.dispose();this.onPause.dispose();this.onResume.dispose();this.onLoop.dispose();this.onStop.dispose();this.onMute.dispose();this.onMarkerComplete.dispose()}}},update:function(){if(!this.game.cache.checkSoundKey(this.key)){this.destroy();return}if(this.isDecoded&&!this._onDecodedEventDispatched){this.onDecoded.dispatch(this);this._onDecodedEventDispatched=true}if(this.pendingPlayback&&this.game.cache.isSoundReady(this.key)){this.pendingPlayback=false;this.play(this._tempMarker,this._tempPosition,this._tempVolume,this._tempLoop)}if(this.isPlaying){this.currentTime=this.game.time.time-this.startTime;if(this.currentTime>=this.durationMS){if(this.usingWebAudio){if(this.loop){this.onLoop.dispatch(this);this.isPlaying=false;if(this.currentMarker===""){this.currentTime=0;this.startTime=this.game.time.time;this.isPlaying=true}else{this.onMarkerComplete.dispatch(this.currentMarker,this);this.play(this.currentMarker,0,this.volume,true,true)}}else{if(this.currentMarker!==""){this.stop()}}}else{if(this.loop){this.onLoop.dispatch(this);if(this.currentMarker===""){this.currentTime=0;this.startTime=this.game.time.time}this.isPlaying=false;this.play(this.currentMarker,0,this.volume,true,true)}else{this.stop()}}}}},loopFull:function(a){return this.play(null,0,a,true)},play:function(c,a,f,b,d){if(c===undefined||c===false||c===null){c=""}if(d===undefined){d=true}if(this.isPlaying&&!this.allowMultiple&&!d&&!this.override){return this}if(this._sound&&this.isPlaying&&!this.allowMultiple&&(this.override||d)){if(this.usingWebAudio){if(this._sound.stop===undefined){this._sound.noteOff(0)}else{try{this._sound.stop(0)}catch(g){}}if(this.externalNode){this._sound.disconnect(this.externalNode)}else{if(this.gainNode){this._sound.disconnect(this.gainNode)}}}else{if(this.usingAudioTag){this._sound.pause();this._sound.currentTime=0}}this.isPlaying=false}if(c===""&&Object.keys(this.markers).length>0){return this}if(c!==""){if(this.markers[c]){this.currentMarker=c;this.position=this.markers[c].start;this.volume=this.markers[c].volume;this.loop=this.markers[c].loop;this.duration=this.markers[c].duration;this.durationMS=this.markers[c].durationMS;if(typeof f!=="undefined"){this.volume=f}if(typeof b!=="undefined"){this.loop=b}this._tempMarker=c;this._tempPosition=this.position;this._tempVolume=this.volume;this._tempLoop=this.loop}else{console.warn("Phaser.Sound.play: audio marker "+c+" doesn't exist");return this}}else{a=a||0;if(f===undefined){f=this._volume}if(b===undefined){b=this.loop}this.position=Math.max(0,a);this.volume=f;this.loop=b;this.duration=0;this.durationMS=0;this._tempMarker=c;this._tempPosition=a;this._tempVolume=f;this._tempLoop=b}if(this.usingWebAudio){if(this.game.cache.isSoundDecoded(this.key)){this._sound=this.context.createBufferSource();if(this.externalNode){this._sound.connect(this.externalNode)}else{this._sound.connect(this.gainNode)}this._buffer=this.game.cache.getSoundData(this.key);this._sound.buffer=this._buffer;if(this.loop&&c===""){this._sound.loop=true}if(!this.loop&&c===""){this._sound.onended=this.onEndedHandler.bind(this)}this.totalDuration=this._sound.buffer.duration;if(this.duration===0){this.duration=this.totalDuration;this.durationMS=Math.ceil(this.totalDuration*1000)}if(this._sound.start===undefined){this._sound.noteGrainOn(0,this.position,this.duration)}else{if(this.loop&&c===""){this._sound.start(0,0)}else{this._sound.start(0,this.position,this.duration)}}this.isPlaying=true;this.startTime=this.game.time.time;this.currentTime=0;this.stopTime=this.startTime+this.durationMS;this.onPlay.dispatch(this)}else{this.pendingPlayback=true;if(this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).isDecoding===false){this.game.sound.decode(this.key,this)}}}else{if(this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).locked){this.game.cache.reloadSound(this.key);this.pendingPlayback=true}else{if(this._sound&&(this.game.device.cocoonJS||this._sound.readyState===4)){this._sound.play();this.totalDuration=this._sound.duration;if(this.duration===0){this.duration=this.totalDuration;this.durationMS=this.totalDuration*1000}this._sound.currentTime=this.position;this._sound.muted=this._muted;if(this._muted||this.game.sound.mute){this._sound.volume=0}else{this._sound.volume=this._volume}this.isPlaying=true;this.startTime=this.game.time.time;this.currentTime=0;this.stopTime=this.startTime+this.durationMS;this.onPlay.dispatch(this)}else{this.pendingPlayback=true}}}return this},restart:function(c,a,d,b){c=c||"";a=a||0;d=d||1;if(b===undefined){b=false}this.play(c,a,d,b,true)},pause:function(){if(this.isPlaying&&this._sound){this.paused=true;this.pausedPosition=this.currentTime;this.pausedTime=this.game.time.time;this._tempPause=this._sound.currentTime;this.onPause.dispatch(this);this.stop()}},resume:function(){if(this.paused&&this._sound){if(this.usingWebAudio){var b=Math.max(0,this.position+(this.pausedPosition/1000));this._sound=this.context.createBufferSource();this._sound.buffer=this._buffer;if(this.externalNode){this._sound.connect(this.externalNode)}else{this._sound.connect(this.gainNode)}if(this.loop){this._sound.loop=true}if(!this.loop&&this.currentMarker===""){this._sound.onended=this.onEndedHandler.bind(this)}var a=this.duration-(this.pausedPosition/1000);if(this._sound.start===undefined){this._sound.noteGrainOn(0,b,a)}else{if(this.loop&&this.game.device.chrome){if(this.game.device.chromeVersion===42){this._sound.start(0)}else{this._sound.start(0,b)}}else{this._sound.start(0,b,a)}}}else{this._sound.currentTime=this._tempPause;this._sound.play()}this.isPlaying=true;this.paused=false;this.startTime+=(this.game.time.time-this.pausedTime);this.onResume.dispatch(this)}},stop:function(){if(this.isPlaying&&this._sound){if(this.usingWebAudio){if(this._sound.stop===undefined){this._sound.noteOff(0)}else{try{this._sound.stop(0)}catch(b){}}if(this.externalNode){this._sound.disconnect(this.externalNode)}else{if(this.gainNode){this._sound.disconnect(this.gainNode)}}}else{if(this.usingAudioTag){this._sound.pause();this._sound.currentTime=0}}}this.pendingPlayback=false;this.isPlaying=false;if(!this.paused){var a=this.currentMarker;if(this.currentMarker!==""){this.onMarkerComplete.dispatch(this.currentMarker,this)}this.currentMarker="";if(this.fadeTween!==null){this.fadeTween.stop()}this.onStop.dispatch(this,a)}},fadeIn:function(c,b,a){if(b===undefined){b=false}if(a===undefined){a=this.currentMarker}if(this.paused){return}this.play(a,0,0,b);this.fadeTo(c,1)},fadeOut:function(a){this.fadeTo(a,0)},fadeTo:function(b,a){if(!this.isPlaying||this.paused||a===this.volume){return}if(b===undefined){b=1000}if(a===undefined){console.warn("Phaser.Sound.fadeTo: No Volume Specified.");return}this.fadeTween=this.game.add.tween(this).to({volume:a},b,Phaser.Easing.Linear.None,true);this.fadeTween.onComplete.add(this.fadeComplete,this)},fadeComplete:function(){this.onFadeComplete.dispatch(this,this.volume);if(this.volume===0){this.stop()}},updateGlobalVolume:function(a){if(this.usingAudioTag&&this._sound){this._globalVolume=a;this._sound.volume=this._globalVolume*this._volume}},destroy:function(a){if(a===undefined){a=true}this._markedToDelete=true;this._removeFromSoundManager=a;this.stop();if(a){this.game.sound.remove(this)}else{this.markers={};this.context=null;this._buffer=null;this.externalNode=null;this.onDecoded.dispose();this.onPlay.dispose();this.onPause.dispose();this.onResume.dispose();this.onLoop.dispose();this.onStop.dispose();this.onMute.dispose();this.onMarkerComplete.dispose()}}};Phaser.Sound.prototype.constructor=Phaser.Sound;Object.defineProperty(Phaser.Sound.prototype,"isDecoding",{get:function(){return this.game.cache.getSound(this.key).isDecoding}});Object.defineProperty(Phaser.Sound.prototype,"isDecoded",{get:function(){return this.game.cache.isSoundDecoded(this.key)}});Object.defineProperty(Phaser.Sound.prototype,"mute",{get:function(){return(this._muted||this.game.sound.mute)},set:function(a){a=a||false;if(a===this._muted){return}if(a){this._muted=true;this._muteVolume=this._tempVolume;if(this.usingWebAudio){this.gainNode.gain.value=0}else{if(this.usingAudioTag&&this._sound){this._sound.volume=0}}}else{this._muted=false;if(this.usingWebAudio){this.gainNode.gain.value=this._muteVolume}else{if(this.usingAudioTag&&this._sound){this._sound.volume=this._muteVolume}}}this.onMute.dispatch(this)}});Object.defineProperty(Phaser.Sound.prototype,"volume",{get:function(){return this._volume},set:function(a){if(this.usingAudioTag){a=this.game.math.clamp(a,0,1)}if(this._muted){this._muteVolume=a;return}this._tempVolume=a;this._volume=a;if(this.usingWebAudio){this.gainNode.gain.value=a}else{if(this.usingAudioTag&&this._sound){this._sound.volume=this._globalVolume*a}}}});Phaser.SoundManager=function(a){this.game=a;this.onSoundDecode=new Phaser.Signal();this.onVolumeChange=new Phaser.Signal();this.onMute=new Phaser.Signal();this.onUnMute=new Phaser.Signal();this.context=null;this.usingWebAudio=false;this.usingAudioTag=false;this.noAudio=false;this.connectToMaster=true;this.touchLocked=false;this.channels=32;this.muteOnPause=true;this._codeMuted=false;this._muted=false;this._unlockSource=null;this._volume=1;this._sounds=[];this._watchList=new Phaser.ArraySet();this._watching=false;this._watchCallback=null;this._watchContext=null};Phaser.SoundManager.prototype={boot:function(){if(this.game.device.iOS&&this.game.device.webAudio===false){this.channels=1}if(window.PhaserGlobal){if(window.PhaserGlobal.disableAudio===true){this.noAudio=true;this.touchLocked=false;return}if(window.PhaserGlobal.disableWebAudio===true){this.usingAudioTag=true;this.touchLocked=false;return}}if(window.PhaserGlobal&&window.PhaserGlobal.audioContext){this.context=window.PhaserGlobal.audioContext}else{if(!!window.AudioContext){try{this.context=new window.AudioContext()}catch(a){this.context=null;this.usingWebAudio=false;this.touchLocked=false}}else{if(!!window.webkitAudioContext){try{this.context=new window.webkitAudioContext()}catch(a){this.context=null;this.usingWebAudio=false;this.touchLocked=false}}}}if(this.context===null){if(window.Audio===undefined){this.noAudio=true;return}else{this.usingAudioTag=true}}else{this.usingWebAudio=true;if(this.context.createGain===undefined){this.masterGain=this.context.createGainNode()}else{this.masterGain=this.context.createGain()}this.masterGain.gain.value=1;this.masterGain.connect(this.context.destination)}if(!this.noAudio){if(this.game.device.needsTouchUnlock()){this.setTouchLock()}}},setTouchLock:function(){if(this.noAudio||(window.PhaserGlobal&&window.PhaserGlobal.disableAudio===true)){return}if(this.game.device.iOSVersion>8||this.game.device.chromeVersion>=55){this.game.input.addTouchLockCallback(this.unlock,this,true)}else{this.game.input.addTouchLockCallback(this.unlock,this)}this.touchLocked=true},unlock:function(){if(this.noAudio||!this.touchLocked||this._unlockSource!==null){return true}if(this.usingAudioTag){this.touchLocked=false;this._unlockSource=null}else{if(this.usingWebAudio){var a=this.context.createBuffer(1,1,22050);this._unlockSource=this.context.createBufferSource();this._unlockSource.buffer=a;this._unlockSource.connect(this.context.destination);if(this._unlockSource.start===undefined){this._unlockSource.noteOn(0)}else{this._unlockSource.start(0)}if(this._unlockSource.context.state==="suspended"){this._unlockSource.context.resume()}}}return true},stopAll:function(){if(this.noAudio){return}for(var a=0;a<this._sounds.length;a++){if(this._sounds[a]){this._sounds[a].stop()}}},pauseAll:function(){if(this.noAudio){return}for(var a=0;a<this._sounds.length;a++){if(this._sounds[a]){this._sounds[a].pause()}}},resumeAll:function(){if(this.noAudio){return}for(var a=0;a<this._sounds.length;a++){if(this._sounds[a]){this._sounds[a].resume()}}},decode:function(b,d){d=d||null;var a=this.game.cache.getSoundData(b);if(a){if(this.game.cache.isSoundDecoded(b)===false){this.game.cache.updateSound(b,"isDecoding",true);var f=this;try{this.context.decodeAudioData(a,function(e){if(e){f.game.cache.decodedSound(b,e);f.onSoundDecode.dispatch(b,d)}})}catch(c){}}}},setDecodedCallback:function(c,d,a){if(typeof c==="string"){c=[c]}this._watchList.reset();for(var b=0;b<c.length;b++){if(c[b] instanceof Phaser.Sound){if(!this.game.cache.isSoundDecoded(c[b].key)){this._watchList.add(c[b].key)}}else{if(!this.game.cache.isSoundDecoded(c[b])){this._watchList.add(c[b])}}}if(this._watchList.total===0){this._watching=false;d.call(a)}else{this._watching=true;this._watchCallback=d;this._watchContext=a}},update:function(){if(this.noAudio){return}if(this.touchLocked&&this._unlockSource!==null&&(this._unlockSource.playbackState===this._unlockSource.PLAYING_STATE||this._unlockSource.playbackState===this._unlockSource.FINISHED_STATE)){this.touchLocked=false;this._unlockSource=null}for(var b=0;b<this._sounds.length;b++){this._sounds[b].update()}if(this._watching){var a=this._watchList.first;while(a){if(this.game.cache.isSoundDecoded(a)){this._watchList.remove(a)}a=this._watchList.next}if(this._watchList.total===0){this._watching=false;this._watchCallback.call(this._watchContext)}}},add:function(c,d,a,b){if(d===undefined){d=1}if(a===undefined){a=false}if(b===undefined){b=this.connectToMaster}var e=new Phaser.Sound(this.game,c,d,a,b);this._sounds.push(e);return e},addSprite:function(b){var a=new Phaser.AudioSprite(this.game,b);return a},remove:function(b){var a=this._sounds.length;while(a--){if(this._sounds[a]===b){this._sounds[a].destroy(false);this._sounds.splice(a,1);return true}}return false},removeByKey:function(b){var a=this._sounds.length;var c=0;while(a--){if(this._sounds[a].key===b){this._sounds[a].destroy(false);this._sounds.splice(a,1);c++}}return c},play:function(b,c,a){if(this.noAudio){return}var d=this.add(b,c,a);d.play();return d},setMute:function(){if(this._muted){return}this._muted=true;if(this.usingWebAudio){this._muteVolume=this.masterGain.gain.value;this.masterGain.gain.value=0}for(var a=0;a<this._sounds.length;a++){if(this._sounds[a].usingAudioTag){this._sounds[a].mute=true}}this.onMute.dispatch()},unsetMute:function(){if(!this._muted||this._codeMuted){return}this._muted=false;if(this.usingWebAudio){this.masterGain.gain.value=this._muteVolume}for(var a=0;a<this._sounds.length;a++){if(this._sounds[a].usingAudioTag){this._sounds[a].mute=false}}this.onUnMute.dispatch()},destroy:function(){this.stopAll();for(var a=0;a<this._sounds.length;a++){if(this._sounds[a]){this._sounds[a].destroy()}}this._sounds=[];this.onSoundDecode.dispose();if(this.context){if(window.PhaserGlobal){window.PhaserGlobal.audioContext=this.context}else{if(this.context.close){this.context.close()}}}}};Phaser.SoundManager.prototype.constructor=Phaser.SoundManager;Object.defineProperty(Phaser.SoundManager.prototype,"mute",{get:function(){return this._muted},set:function(a){a=a||false;if(a){if(this._muted){return}this._codeMuted=true;this.setMute()}else{if(!this._muted){return}this._codeMuted=false;this.unsetMute()}}});Object.defineProperty(Phaser.SoundManager.prototype,"volume",{get:function(){return this._volume},set:function(b){if(b<0){b=0}else{if(b>1){b=1}}if(this._volume!==b){this._volume=b;if(this.usingWebAudio){this.masterGain.gain.value=b}else{for(var a=0;a<this._sounds.length;a++){if(this._sounds[a].usingAudioTag){this._sounds[a].updateGlobalVolume(b)}}}this.onVolumeChange.dispatch(b)}}});Phaser.ScaleManager=function(b,c,a){this.game=b;this.dom=Phaser.DOM;this.grid=null;this.width=0;this.height=0;this.minWidth=null;this.maxWidth=null;this.minHeight=null;this.maxHeight=null;this.offset=new Phaser.Point();this.forceLandscape=false;this.forcePortrait=false;this.incorrectOrientation=false;this._pageAlignHorizontally=false;this._pageAlignVertically=false;this.onOrientationChange=new Phaser.Signal();this.enterIncorrectOrientation=new Phaser.Signal();this.leaveIncorrectOrientation=new Phaser.Signal();this.hasPhaserSetFullScreen=false;this.fullScreenTarget=null;this._createdFullScreenTarget=null;this.onFullScreenInit=new Phaser.Signal();this.onFullScreenChange=new Phaser.Signal();this.onFullScreenError=new Phaser.Signal();this.screenOrientation=this.dom.getScreenOrientation();this.scaleFactor=new Phaser.Point(1,1);this.scaleFactorInversed=new Phaser.Point(1,1);this.margin={left:0,top:0,right:0,bottom:0,x:0,y:0};this.bounds=new Phaser.Rectangle();this.aspectRatio=0;this.sourceAspectRatio=0;this.event=null;this.windowConstraints={right:"layout",bottom:""};this.compatibility={supportsFullScreen:false,orientationFallback:null,noMargins:false,scrollTo:null,forceMinimumDocumentHeight:false,canExpandParent:true,clickTrampoline:""};this._scaleMode=Phaser.ScaleManager.NO_SCALE;this._fullScreenScaleMode=Phaser.ScaleManager.NO_SCALE;this.parentIsWindow=false;this.parentNode=null;this.parentScaleFactor=new Phaser.Point(1,1);this.trackParentInterval=2000;this.onSizeChange=new Phaser.Signal();this.onResize=null;this.onResizeContext=null;this._pendingScaleMode=null;this._fullScreenRestore=null;this._gameSize=new Phaser.Rectangle();this._userScaleFactor=new Phaser.Point(1,1);this._userScaleTrim=new Phaser.Point(0,0);this._lastUpdate=0;this._updateThrottle=0;this._updateThrottleReset=100;this._parentBounds=new Phaser.Rectangle();this._tempBounds=new Phaser.Rectangle();this._lastReportedCanvasSize=new Phaser.Rectangle();this._lastReportedGameSize=new Phaser.Rectangle();this._booted=false;if(b.config){this.parseConfig(b.config)}this.setupScale(c,a)};Phaser.ScaleManager.EXACT_FIT=0;Phaser.ScaleManager.NO_SCALE=1;Phaser.ScaleManager.SHOW_ALL=2;Phaser.ScaleManager.RESIZE=3;Phaser.ScaleManager.USER_SCALE=4;Phaser.ScaleManager.prototype={boot:function(){var a=this.compatibility;a.supportsFullScreen=this.game.device.fullscreen&&!this.game.device.cocoonJS;if(!this.game.device.iPad&&!this.game.device.webApp&&!this.game.device.desktop){if(this.game.device.android&&!this.game.device.chrome){a.scrollTo=new Phaser.Point(0,1)}else{a.scrollTo=new Phaser.Point(0,0)}}if(this.game.device.desktop){a.orientationFallback="screen";a.clickTrampoline="when-not-mouse"}else{a.orientationFallback="";a.clickTrampoline=""}var b=this;this._orientationChange=function(c){return b.orientationChange(c)};this._windowResize=function(c){return b.windowResize(c)};window.addEventListener("orientationchange",this._orientationChange,false);window.addEventListener("resize",this._windowResize,false);if(this.compatibility.supportsFullScreen){this._fullScreenChange=function(c){return b.fullScreenChange(c)};this._fullScreenError=function(c){return b.fullScreenError(c)};document.addEventListener("webkitfullscreenchange",this._fullScreenChange,false);document.addEventListener("mozfullscreenchange",this._fullScreenChange,false);document.addEventListener("MSFullscreenChange",this._fullScreenChange,false);document.addEventListener("fullscreenchange",this._fullScreenChange,false);document.addEventListener("webkitfullscreenerror",this._fullScreenError,false);document.addEventListener("mozfullscreenerror",this._fullScreenError,false);document.addEventListener("MSFullscreenError",this._fullScreenError,false);document.addEventListener("fullscreenerror",this._fullScreenError,false)}this.game.onResume.add(this._gameResumed,this);this.dom.getOffset(this.game.canvas,this.offset);this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height);this.setGameSize(this.game.width,this.game.height);this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback);if(Phaser.FlexGrid){this.grid=new Phaser.FlexGrid(this,this.width,this.height)}this._booted=true;if(this._pendingScaleMode!==null){this.scaleMode=this._pendingScaleMode;this._pendingScaleMode=null}},parseConfig:function(a){if(a.scaleMode!==undefined){if(this._booted){this.scaleMode=a.scaleMode}else{this._pendingScaleMode=a.scaleMode}}if(a.fullScreenScaleMode!==undefined){this.fullScreenScaleMode=a.fullScreenScaleMode}if(a.fullScreenTarget){this.fullScreenTarget=a.fullScreenTarget}},setupScale:function(c,a){var f;var e=new Phaser.Rectangle();if(this.game.parent!==""){if(typeof this.game.parent==="string"){f=document.getElementById(this.game.parent)}else{if(this.game.parent&&this.game.parent.nodeType===1){f=this.game.parent}}}if(!f){this.parentNode=null;this.parentIsWindow=true;e.width=this.dom.visualBounds.width;e.height=this.dom.visualBounds.height;this.offset.set(0,0)}else{this.parentNode=f;this.parentIsWindow=false;this.getParentBounds(this._parentBounds);e.width=this._parentBounds.width;e.height=this._parentBounds.height;this.offset.set(this._parentBounds.x,this._parentBounds.y)}var d=0;var b=0;if(typeof c==="number"){d=c}else{this.parentScaleFactor.x=parseInt(c,10)/100;d=e.width*this.parentScaleFactor.x}if(typeof a==="number"){b=a}else{this.parentScaleFactor.y=parseInt(a,10)/100;b=e.height*this.parentScaleFactor.y}d=Math.floor(d);b=Math.floor(b);this._gameSize.setTo(0,0,d,b);this.updateDimensions(d,b,false)},_gameResumed:function(){this.queueUpdate(true)},setGameSize:function(b,a){this._gameSize.setTo(0,0,b,a);if(this.currentScaleMode!==Phaser.ScaleManager.RESIZE){this.updateDimensions(b,a,true)}this.queueUpdate(true)},setUserScale:function(b,f,d,a,c,e){this._userScaleFactor.setTo(b,f);this._userScaleTrim.setTo(d|0,a|0);if(c===undefined){c=true}if(e===undefined){e=true}if(c){this.queueUpdate(e)}},setResizeCallback:function(b,a){this.onResize=b;this.onResizeContext=a},signalSizeChange:function(){if(!Phaser.Rectangle.sameDimensions(this,this._lastReportedCanvasSize)||!Phaser.Rectangle.sameDimensions(this.game,this._lastReportedGameSize)){var b=this.width;var a=this.height;this._lastReportedCanvasSize.setTo(0,0,b,a);this._lastReportedGameSize.setTo(0,0,this.game.width,this.game.height);if(this.grid){this.grid.onResize(b,a)}this.onSizeChange.dispatch(this,b,a);if(this.currentScaleMode===Phaser.ScaleManager.RESIZE){this.game.state.resize(b,a);this.game.load.resize(b,a)}}},setMinMax:function(a,d,c,b){this.minWidth=a;this.minHeight=d;if(typeof c!=="undefined"){this.maxWidth=c}if(typeof b!=="undefined"){this.maxHeight=b}},preUpdate:function(){if(this.game.time.time<(this._lastUpdate+this._updateThrottle)){return}var b=this._updateThrottle;this._updateThrottleReset=b>=400?0:100;this.dom.getOffset(this.game.canvas,this.offset);var e=this._parentBounds.width;var g=this._parentBounds.height;var d=this.getParentBounds(this._parentBounds);var c=d.width!==e||d.height!==g;var a=this.updateOrientationState();if(c||a){if(this.onResize){this.onResize.call(this.onResizeContext,this,d)}this.updateLayout();this.signalSizeChange()}var f=this._updateThrottle*2;if(this._updateThrottle<b){f=Math.min(b,this._updateThrottleReset)}this._updateThrottle=Phaser.Math.clamp(f,25,this.trackParentInterval);this._lastUpdate=this.game.time.time},pauseUpdate:function(){this.preUpdate();this._updateThrottle=this.trackParentInterval},updateDimensions:function(c,a,b){this.width=c*this.parentScaleFactor.x;this.height=a*this.parentScaleFactor.y;this.game.width=this.width;this.game.height=this.height;this.sourceAspectRatio=this.width/this.height;this.updateScalingAndBounds();if(b){this.game.renderer.resize(this.width,this.height);this.game.camera.setSize(this.width,this.height);this.game.world.resize(this.width,this.height)}},updateScalingAndBounds:function(){this.scaleFactor.x=this.game.width/this.width;this.scaleFactor.y=this.game.height/this.height;this.scaleFactorInversed.x=this.width/this.game.width;this.scaleFactorInversed.y=this.height/this.game.height;this.aspectRatio=this.width/this.height;if(this.game.canvas){this.dom.getOffset(this.game.canvas,this.offset)}this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height);if(this.game.input&&this.game.input.scale){this.game.input.scale.setTo(this.scaleFactor.x,this.scaleFactor.y)}},forceOrientation:function(b,a){if(a===undefined){a=false}if(b===true&&a===true){console.warn("Phaser.ScaleManager: forceLandscape and forcePortrait cannot both be true.");return}this.forceLandscape=b;this.forcePortrait=a;this.queueUpdate(true)},classifyOrientation:function(a){if(a==="portrait-primary"||a==="portrait-secondary"){return"portrait"}else{if(a==="landscape-primary"||a==="landscape-secondary"){return"landscape"}else{return null}}},updateOrientationState:function(){var c=this.screenOrientation;var b=this.incorrectOrientation;this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback);this.incorrectOrientation=(this.forceLandscape&&!this.isLandscape)||(this.forcePortrait&&!this.isPortrait);var d=c!==this.screenOrientation;var a=b!==this.incorrectOrientation;if(a){if(this.incorrectOrientation){this.enterIncorrectOrientation.dispatch()}else{this.leaveIncorrectOrientation.dispatch()}}if(d||a){this.onOrientationChange.dispatch(this,c,b)}return d||a},orientationChange:function(a){this.event=a;this.queueUpdate(true)},windowResize:function(a){this.event=a;this.queueUpdate(true)},scrollTop:function(){var a=this.compatibility.scrollTo;if(a){window.scrollTo(a.x,a.y)}},refresh:function(){this.scrollTop();this.queueUpdate(true)},updateLayout:function(){var a=this.currentScaleMode;if(a===Phaser.ScaleManager.RESIZE){this.reflowGame();return}this.scrollTop();if(this.compatibility.forceMinimumDocumentHeight){document.documentElement.style.minHeight=window.innerHeight+"px"}if(this.incorrectOrientation){this.setMaximum()}else{if(a===Phaser.ScaleManager.EXACT_FIT){this.setExactFit()}else{if(a===Phaser.ScaleManager.SHOW_ALL){if(!this.isFullScreen&&this.boundingParent&&this.compatibility.canExpandParent){this.setShowAll(true);this.resetCanvas();this.setShowAll()}else{this.setShowAll()}}else{if(a===Phaser.ScaleManager.NO_SCALE){this.width=this.game.width;this.height=this.game.height}else{if(a===Phaser.ScaleManager.USER_SCALE){this.width=(this.game.width*this._userScaleFactor.x)-this._userScaleTrim.x;this.height=(this.game.height*this._userScaleFactor.y)-this._userScaleTrim.y}}}}}if(!this.compatibility.canExpandParent&&(a===Phaser.ScaleManager.SHOW_ALL||a===Phaser.ScaleManager.USER_SCALE)){var b=this.getParentBounds(this._tempBounds);this.width=Math.min(this.width,b.width);this.height=Math.min(this.height,b.height)}this.width=this.width|0;this.height=this.height|0;this.reflowCanvas()},getParentBounds:function(g){var a=g||new Phaser.Rectangle();var f=this.boundingParent;var d=this.dom.visualBounds;var i=this.dom.layoutBounds;if(!f){a.setTo(0,0,d.width,d.height)}else{var b=f.getBoundingClientRect();var h=(f.offsetParent)?f.offsetParent.getBoundingClientRect():f.getBoundingClientRect();a.setTo(b.left-h.left,b.top-h.top,b.width,b.height);var e=this.windowConstraints;if(e.right){var c=e.right==="layout"?i:d;a.right=Math.min(a.right,c.width)}if(e.bottom){var c=e.bottom==="layout"?i:d;a.bottom=Math.min(a.bottom,c.height)}}a.setTo(Math.round(a.x),Math.round(a.y),Math.round(a.width),Math.round(a.height));return a},align:function(a,b){if(a!=null){this.pageAlignHorizontally=a}if(b!=null){this.pageAlignVertically=b}},alignCanvas:function(b,d){var i=this.getParentBounds(this._tempBounds);var c=this.game.canvas;var e=this.margin;if(b){e.left=e.right=0;var h=c.getBoundingClientRect();if(this.width<i.width&&!this.incorrectOrientation){var a=h.left-i.x;var g=(i.width/2)-(this.width/2);g=Math.max(g,0);var f=g-a;e.left=Math.round(f)}c.style.marginLeft=e.left+"px";if(e.left!==0){e.right=-(i.width-h.width-e.left);c.style.marginRight=e.right+"px"}}if(d){e.top=e.bottom=0;var h=c.getBoundingClientRect();if(this.height<i.height&&!this.incorrectOrientation){var a=h.top-i.y;var g=(i.height/2)-(this.height/2);g=Math.max(g,0);var f=g-a;e.top=Math.round(f)}c.style.marginTop=e.top+"px";if(e.top!==0){e.bottom=-(i.height-h.height-e.top);c.style.marginBottom=e.bottom+"px"}}e.x=e.left;e.y=e.top},reflowGame:function(){this.resetCanvas("","");var a=this.getParentBounds(this._tempBounds);this.updateDimensions(a.width,a.height,true)},reflowCanvas:function(){if(!this.incorrectOrientation){this.width=Phaser.Math.clamp(this.width,this.minWidth||0,this.maxWidth||this.width);this.height=Phaser.Math.clamp(this.height,this.minHeight||0,this.maxHeight||this.height)}this.resetCanvas();if(!this.compatibility.noMargins){if(this.isFullScreen&&this._createdFullScreenTarget){this.alignCanvas(true,true)}else{this.alignCanvas(this.pageAlignHorizontally,this.pageAlignVertically)}}this.updateScalingAndBounds()},resetCanvas:function(c,b){if(c===undefined){c=this.width+"px"}if(b===undefined){b=this.height+"px"}var a=this.game.canvas;if(!this.compatibility.noMargins){a.style.marginLeft="";a.style.marginTop="";a.style.marginRight="";a.style.marginBottom=""}a.style.width=c;a.style.height=b},queueUpdate:function(a){if(a){this._parentBounds.width=0;this._parentBounds.height=0}this._updateThrottle=this._updateThrottleReset},reset:function(a){if(a&&this.grid){this.grid.reset()}},setMaximum:function(){this.width=this.dom.visualBounds.width;this.height=this.dom.visualBounds.height},setShowAll:function(e){var c=this.getParentBounds(this._tempBounds);var b=c.width;var a=c.height;var d;if(e){d=Math.max((a/this.game.height),(b/this.game.width))}else{d=Math.min((a/this.game.height),(b/this.game.width))}this.width=Math.round(this.game.width*d);this.height=Math.round(this.game.height*d)},setExactFit:function(){var a=this.getParentBounds(this._tempBounds);this.width=a.width;this.height=a.height;if(this.isFullScreen){return}if(this.maxWidth){this.width=Math.min(this.width,this.maxWidth)}if(this.maxHeight){this.height=Math.min(this.height,this.maxHeight)}},createFullScreenTarget:function(){var a=document.createElement("div");a.style.margin="0";a.style.padding="0";a.style.background="#000";return a},startFullScreen:function(b,g){if(this.isFullScreen){return false}if(!this.compatibility.supportsFullScreen){var h=this;setTimeout(function(){h.fullScreenError()},10);return}if(this.compatibility.clickTrampoline==="when-not-mouse"){var c=this.game.input;if(c.activePointer&&c.activePointer!==c.mousePointer&&(g||g!==false)){c.activePointer.addClickTrampoline("startFullScreen",this.startFullScreen,this,[b,false]);return}}if(b!==undefined&&this.game.renderType===Phaser.CANVAS){this.game.stage.smoothed=b}var f=this.fullScreenTarget;if(!f){this.cleanupCreatedTarget();this._createdFullScreenTarget=this.createFullScreenTarget();f=this._createdFullScreenTarget}var a={targetElement:f};this.hasPhaserSetFullScreen=true;this.onFullScreenInit.dispatch(this,a);if(this._createdFullScreenTarget){var d=this.game.canvas;var e=d.parentNode;e.insertBefore(f,d);f.appendChild(d)}if(this.game.device.fullscreenKeyboard){f[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT)}else{f[this.game.device.requestFullscreen]()}return true},stopFullScreen:function(){if(!this.isFullScreen||!this.compatibility.supportsFullScreen){return false}this.hasPhaserSetFullScreen=false;document[this.game.device.cancelFullscreen]();return true},cleanupCreatedTarget:function(){var b=this._createdFullScreenTarget;if(b&&b.parentNode){var a=b.parentNode;a.insertBefore(this.game.canvas,b);a.removeChild(b)}this._createdFullScreenTarget=null},prepScreenMode:function(c){var a=!!this._createdFullScreenTarget;var b=this._createdFullScreenTarget||this.fullScreenTarget;if(c){if(a||this.fullScreenScaleMode===Phaser.ScaleManager.EXACT_FIT){if(b!==this.game.canvas){this._fullScreenRestore={targetWidth:b.style.width,targetHeight:b.style.height};b.style.width="100%";b.style.height="100%"}}}else{if(this._fullScreenRestore){b.style.width=this._fullScreenRestore.targetWidth;b.style.height=this._fullScreenRestore.targetHeight;this._fullScreenRestore=null}this.updateDimensions(this._gameSize.width,this._gameSize.height,true);this.resetCanvas()}},fullScreenChange:function(a){this.event=a;if(this.isFullScreen){this.prepScreenMode(true);this.updateLayout();this.queueUpdate(true)}else{this.prepScreenMode(false);this.cleanupCreatedTarget();this.updateLayout();this.queueUpdate(true)}this.onFullScreenChange.dispatch(this,this.width,this.height)},fullScreenError:function(a){this.event=a;this.cleanupCreatedTarget();console.warn("Phaser.ScaleManager: requestFullscreen failed or device does not support the Fullscreen API");this.onFullScreenError.dispatch(this)},scaleSprite:function(g,b,h,a){if(b===undefined){b=this.width}if(h===undefined){h=this.height}if(a===undefined){a=false}if(!g||!g.scale){return g}g.scale.x=1;g.scale.y=1;if((g.width<=0)||(g.height<=0)||(b<=0)||(h<=0)){return g}var d=b;var i=(g.height*b)/g.width;var c=(g.width*h)/g.height;var f=h;var e=(c>b);if(e){e=a}else{e=!a}if(e){g.width=Math.floor(d);g.height=Math.floor(i)}else{g.width=Math.floor(c);g.height=Math.floor(f)}return g},destroy:function(){this.game.onResume.remove(this._gameResumed,this);window.removeEventListener("orientationchange",this._orientationChange,false);window.removeEventListener("resize",this._windowResize,false);if(this.compatibility.supportsFullScreen){document.removeEventListener("webkitfullscreenchange",this._fullScreenChange,false);document.removeEventListener("mozfullscreenchange",this._fullScreenChange,false);document.removeEventListener("MSFullscreenChange",this._fullScreenChange,false);document.removeEventListener("fullscreenchange",this._fullScreenChange,false);document.removeEventListener("webkitfullscreenerror",this._fullScreenError,false);document.removeEventListener("mozfullscreenerror",this._fullScreenError,false);document.removeEventListener("MSFullscreenError",this._fullScreenError,false);document.removeEventListener("fullscreenerror",this._fullScreenError,false)}}};Phaser.ScaleManager.prototype.constructor=Phaser.ScaleManager;Object.defineProperty(Phaser.ScaleManager.prototype,"boundingParent",{get:function(){if(this.parentIsWindow||(this.isFullScreen&&this.hasPhaserSetFullScreen&&!this._createdFullScreenTarget)){return null}var a=this.game.canvas&&this.game.canvas.parentNode;return a||null}});Object.defineProperty(Phaser.ScaleManager.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(a){if(a!==this._scaleMode){if(!this.isFullScreen){this.updateDimensions(this._gameSize.width,this._gameSize.height,true);this.queueUpdate(true)}this._scaleMode=a}return this._scaleMode}});Object.defineProperty(Phaser.ScaleManager.prototype,"fullScreenScaleMode",{get:function(){return this._fullScreenScaleMode},set:function(a){if(a!==this._fullScreenScaleMode){if(this.isFullScreen){this.prepScreenMode(false);this._fullScreenScaleMode=a;this.prepScreenMode(true);this.queueUpdate(true)}else{this._fullScreenScaleMode=a}}return this._fullScreenScaleMode}});Object.defineProperty(Phaser.ScaleManager.prototype,"currentScaleMode",{get:function(){return this.isFullScreen?this._fullScreenScaleMode:this._scaleMode}});Object.defineProperty(Phaser.ScaleManager.prototype,"pageAlignHorizontally",{get:function(){return this._pageAlignHorizontally},set:function(a){if(a!==this._pageAlignHorizontally){this._pageAlignHorizontally=a;this.queueUpdate(true)}}});Object.defineProperty(Phaser.ScaleManager.prototype,"pageAlignVertically",{get:function(){return this._pageAlignVertically},set:function(a){if(a!==this._pageAlignVertically){this._pageAlignVertically=a;this.queueUpdate(true)}}});Object.defineProperty(Phaser.ScaleManager.prototype,"isFullScreen",{get:function(){return !!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}});Object.defineProperty(Phaser.ScaleManager.prototype,"isPortrait",{get:function(){return this.classifyOrientation(this.screenOrientation)==="portrait"}});Object.defineProperty(Phaser.ScaleManager.prototype,"isLandscape",{get:function(){return this.classifyOrientation(this.screenOrientation)==="landscape"}});Object.defineProperty(Phaser.ScaleManager.prototype,"isGamePortrait",{get:function(){return(this.height>this.width)}});Object.defineProperty(Phaser.ScaleManager.prototype,"isGameLandscape",{get:function(){return(this.width>this.height)}});var debugNoop=function(){};Phaser.Utils.Debug=debugNoop;Phaser.Utils.Debug.prototype={isDisabled:true,boot:debugNoop,preUpdate:debugNoop,reset:debugNoop,start:debugNoop,stop:debugNoop,line:debugNoop,soundInfo:debugNoop,cameraInfo:debugNoop,timer:debugNoop,pointer:debugNoop,spriteInputInfo:debugNoop,key:debugNoop,inputInfo:debugNoop,spriteBounds:debugNoop,ropeSegments:debugNoop,spriteInfo:debugNoop,spriteCoords:debugNoop,lineInfo:debugNoop,pixel:debugNoop,geom:debugNoop,rectangle:debugNoop,text:debugNoop,quadTree:debugNoop,body:debugNoop,bodyInfo:debugNoop,box2dWorld:debugNoop,box2dBody:debugNoop};Phaser.Utils.Debug.prototype.constructor=Phaser.Utils.Debug;Phaser.DOM={getOffset:function(b,a){a=a||new Phaser.Point();var c=b.getBoundingClientRect();var d=Phaser.DOM.scrollY;var e=Phaser.DOM.scrollX;var g=document.documentElement.clientTop;var f=document.documentElement.clientLeft;a.x=c.left+e-f;a.y=c.top+d-g;return a},getBounds:function(b,a){if(a===undefined){a=0}b=b&&!b.nodeType?b[0]:b;if(!b||b.nodeType!==1){return false}else{return this.calibrate(b.getBoundingClientRect(),a)}},calibrate:function(c,b){b=+b||0;var a={width:0,height:0,left:0,right:0,top:0,bottom:0};a.width=(a.right=c.right+b)-(a.left=c.left-b);a.height=(a.bottom=c.bottom+b)-(a.top=c.top-b);return a},getAspectRatio:function(b){b=null==b?this.visualBounds:1===b.nodeType?this.getBounds(b):b;var a=b.width;var c=b.height;if(typeof a==="function"){a=a.call(b)}if(typeof c==="function"){c=c.call(b)}return a/c},inLayoutViewport:function(b,a){var c=this.getBounds(b,a);return !!c&&c.bottom>=0&&c.right>=0&&c.top<=this.layoutBounds.width&&c.left<=this.layoutBounds.height},getScreenOrientation:function(e){var b=window.screen;var a=b.orientation||b.mozOrientation||b.msOrientation;if(a&&typeof a.type==="string"){return a.type}else{if(typeof a==="string"){return a}}var d="portrait-primary";var c="landscape-primary";if(e==="screen"){return(b.height>b.width)?d:c}else{if(e==="viewport"){return(this.visualBounds.height>this.visualBounds.width)?d:c}else{if(e==="window.orientation"&&typeof window.orientation==="number"){return(window.orientation===0||window.orientation===180)?d:c}else{if(window.matchMedia){if(window.matchMedia("(orientation: portrait)").matches){return d}else{if(window.matchMedia("(orientation: landscape)").matches){return c}}}}}}return(this.visualBounds.height>this.visualBounds.width)?d:c},visualBounds:new Phaser.Rectangle(),layoutBounds:new Phaser.Rectangle(),documentBounds:new Phaser.Rectangle()};Phaser.Device.whenReady(function(c){var f=window&&("pageXOffset" in window)?function(){return window.pageXOffset}:function(){return document.documentElement.scrollLeft};var d=window&&("pageYOffset" in window)?function(){return window.pageYOffset}:function(){return document.documentElement.scrollTop};Object.defineProperty(Phaser.DOM,"scrollX",{get:f});Object.defineProperty(Phaser.DOM,"scrollY",{get:d});Object.defineProperty(Phaser.DOM.visualBounds,"x",{get:f});Object.defineProperty(Phaser.DOM.visualBounds,"y",{get:d});Object.defineProperty(Phaser.DOM.layoutBounds,"x",{value:0});Object.defineProperty(Phaser.DOM.layoutBounds,"y",{value:0});var b=c.desktop&&(document.documentElement.clientWidth<=window.innerWidth)&&(document.documentElement.clientHeight<=window.innerHeight);if(b){var e=function(){return Math.max(window.innerWidth,document.documentElement.clientWidth)};var a=function(){return Math.max(window.innerHeight,document.documentElement.clientHeight)};Object.defineProperty(Phaser.DOM.visualBounds,"width",{get:e});Object.defineProperty(Phaser.DOM.visualBounds,"height",{get:a});Object.defineProperty(Phaser.DOM.layoutBounds,"width",{get:e});Object.defineProperty(Phaser.DOM.layoutBounds,"height",{get:a})}else{Object.defineProperty(Phaser.DOM.visualBounds,"width",{get:function(){return window.innerWidth}});Object.defineProperty(Phaser.DOM.visualBounds,"height",{get:function(){return window.innerHeight}});Object.defineProperty(Phaser.DOM.layoutBounds,"width",{get:function(){var h=document.documentElement.clientWidth;var g=window.innerWidth;return h<g?g:h}});Object.defineProperty(Phaser.DOM.layoutBounds,"height",{get:function(){var h=document.documentElement.clientHeight;var g=window.innerHeight;return h<g?g:h}})}Object.defineProperty(Phaser.DOM.documentBounds,"x",{value:0});Object.defineProperty(Phaser.DOM.documentBounds,"y",{value:0});Object.defineProperty(Phaser.DOM.documentBounds,"width",{get:function(){var g=document.documentElement;return Math.max(g.clientWidth,g.offsetWidth,g.scrollWidth)}});Object.defineProperty(Phaser.DOM.documentBounds,"height",{get:function(){var g=document.documentElement;return Math.max(g.clientHeight,g.offsetHeight,g.scrollHeight)}})},null,true);Phaser.ArraySet=function(a){this.position=0;this.list=a||[]};Phaser.ArraySet.prototype={add:function(a){if(!this.exists(a)){this.list.push(a)}return a},getIndex:function(a){return this.list.indexOf(a)},getByKey:function(c,b){var a=this.list.length;while(a--){if(this.list[a][c]===b){return this.list[a]}}return null},exists:function(a){return(this.list.indexOf(a)>-1)},reset:function(){this.list.length=0},remove:function(b){var a=this.list.indexOf(b);if(a>-1){this.list.splice(a,1);return b}},setAll:function(b,c){var a=this.list.length;while(a--){if(this.list[a]){this.list[a][b]=c}}},callAll:function(c){var a=Array.prototype.slice.call(arguments,1);var b=this.list.length;while(b--){if(this.list[b]&&this.list[b][c]){this.list[b][c].apply(this.list[b],a)}}},removeAll:function(b){if(b===undefined){b=false}var a=this.list.length;while(a--){if(this.list[a]){var c=this.remove(this.list[a]);if(b){c.destroy()}}}this.position=0;this.list=[]}};Object.defineProperty(Phaser.ArraySet.prototype,"total",{get:function(){return this.list.length}});Object.defineProperty(Phaser.ArraySet.prototype,"first",{get:function(){this.position=0;if(this.list.length>0){return this.list[0]}else{return null}}});Object.defineProperty(Phaser.ArraySet.prototype,"next",{get:function(){if(this.position<this.list.length){this.position++;return this.list[this.position]}else{return null}}});Phaser.ArraySet.prototype.constructor=Phaser.ArraySet;Phaser.ArrayUtils={getRandomItem:function(c,d,b){if(c===null){return null}if(d===undefined){d=0}if(b===undefined){b=c.length}var a=d+Math.floor(Math.random()*b);return c[a]===undefined?null:c[a]},removeRandomItem:function(c,e,b){if(c==null){return null}if(e===undefined){e=0}if(b===undefined){b=c.length}var a=e+Math.floor(Math.random()*b);if(a<c.length){var d=c.splice(a,1);return d[0]===undefined?null:d[0]}else{return null}},remove:function(f,e,c){var b=f.length;if(e>=b||c===0){return}if(c==null){c=1}var d=b-c;for(var a=e;a<d;++a){f[a]=f[a+c]}f.length=d},shuffle:function(d){for(var c=d.length-1;c>0;c--){var b=Math.floor(Math.random()*(c+1));var a=d[c];d[c]=d[b];d[b]=a}return d},transposeMatrix:function(f){var e=f.length;var b=f[0].length;var a=new Array(b);for(var d=0;d<b;d++){a[d]=new Array(e);for(var c=e-1;c>-1;c--){a[d][c]=f[c][d]}}return a},rotateMatrix:function(a,c){if(typeof c!=="string"){c=((c%360)+360)%360}if(c===90||c===-270||c==="rotateLeft"){a=Phaser.ArrayUtils.transposeMatrix(a);a=a.reverse()}else{if(c===-90||c===270||c==="rotateRight"){a=a.reverse();a=Phaser.ArrayUtils.transposeMatrix(a)}else{if(Math.abs(c)===180||c==="rotate180"){for(var b=0;b<a.length;b++){a[b].reverse()}a=a.reverse()}}}return a},findClosest:function(e,b){if(!b.length){return NaN}else{if(b.length===1||e<b[0]){return b[0]}}var c=1;while(b[c]<e){c++}var a=b[c-1];var d=(c<b.length)?b[c]:Number.POSITIVE_INFINITY;return((d-e)<=(e-a))?d:a},rotateRight:function(b){var a=b.pop();b.unshift(a);return a},rotateLeft:function(b){var a=b.shift();b.push(a);return a},rotate:function(b){var a=b.shift();b.push(a);return a},numberArray:function(d,b){if(b===undefined||b===null){b=d;d=0}var a=[];for(var c=d;c<=b;c++){a.push(c)}return a},numberArrayStep:function(f,b,e){if(f===undefined||f===null){f=0}if(b===undefined||b===null){b=f;f=0}if(e===undefined){e=1}var a=[];var d=Math.max(Phaser.Math.roundAwayFromZero((b-f)/(e||1)),0);for(var c=0;c<d;c++){a.push(f);f+=e}return a}};Phaser.LinkedList=function(){this.next=null;this.prev=null;this.first=null;this.last=null;this.total=0};Phaser.LinkedList.prototype={add:function(a){if(this.total===0&&this.first===null&&this.last===null){this.first=a;this.last=a;this.next=a;a.prev=this;this.total++;return a}this.last.next=a;a.prev=this.last;this.last=a;this.total++;return a},reset:function(){this.first=null;this.last=null;this.next=null;this.prev=null;this.total=0},remove:function(a){if(this.total===1){this.reset();a.next=a.prev=null;return}if(a===this.first){this.first=this.first.next}else{if(a===this.last){this.last=this.last.prev}}if(a.prev){a.prev.next=a.next}if(a.next){a.next.prev=a.prev}a.next=a.prev=null;if(this.first===null){this.last=null}this.total--},callAll:function(b){if(!this.first||!this.last){return}var a=this.first;do{if(a&&a[b]){a[b].call(a)}a=a.next}while(a!==this.last.next)}};Phaser.LinkedList.prototype.constructor=Phaser.LinkedList;Phaser.Create=function(){};Phaser.Color={valueToColor:function(c,b){if(typeof c==="string"){if(c.indexOf("rgb")===0){return Phaser.Color.webToColor(c,b)}else{b.a=1;return Phaser.Color.hexToColor(c,b)}}else{if(typeof c==="number"){var a=Phaser.Color.getRGB(c);b.r=a.r;b.g=a.g;b.b=a.b;b.a=a.a/255;return b}else{return b}}},getRGB:function(a){if(a>16777215){return{alpha:a>>>24,red:a>>16&255,green:a>>8&255,blue:a&255,a:a>>>24,r:a>>16&255,g:a>>8&255,b:a&255}}else{return{alpha:255,red:a>>16&255,green:a>>8&255,blue:a&255,a:255,r:a>>16&255,g:a>>8&255,b:a&255}}},webToColor:function(b,c){var a=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(b);if(a){c.r=parseInt(a[1],10);c.g=parseInt(a[2],10);c.b=parseInt(a[3],10);c.a=a[4]!==undefined?parseFloat(a[4]):1;Phaser.Color.updateColor(c)}return c},hexToColor:function(h,d){h=h.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(j,l,k,i){return l+l+k+k+i+i});var c=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(h);if(c){var f=parseInt(c[1],16);var e=parseInt(c[2],16);var a=parseInt(c[3],16);d.r=f;d.g=e;d.b=a}return d},updateColor:function(a){a.rgba="rgba("+a.r.toString()+","+a.g.toString()+","+a.b.toString()+","+a.a.toString()+")";a.color=Phaser.Color.getColor(a.r,a.g,a.b);a.color32=Phaser.Color.getColor32(a.a,a.r,a.g,a.b);return a},getColor32:function(d,f,e,c){return d<<24|f<<16|e<<8|c},getColor:function(d,c,a){return d<<16|c<<8|a}};Phaser.Physics=function(a,b){b=b||{};this.game=a;this.config=b;this.arcade=null;this.p2=null;this.ninja=null;this.box2d=null;this.chipmunk=null;this.matter=null;this.parseConfig()};Phaser.Physics.ARCADE=0;Phaser.Physics.P2JS=1;Phaser.Physics.NINJA=2;Phaser.Physics.BOX2D=3;Phaser.Physics.CHIPMUNK=4;Phaser.Physics.MATTERJS=5;Phaser.Physics.prototype={parseConfig:function(){if((!this.config.hasOwnProperty("arcade")||this.config.arcade===true)&&Phaser.Physics.hasOwnProperty("Arcade")){this.arcade=new Phaser.Physics.Arcade(this.game)}if(this.config.hasOwnProperty("ninja")&&this.config.ninja===true&&Phaser.Physics.hasOwnProperty("Ninja")){this.ninja=new Phaser.Physics.Ninja(this.game)}if(this.config.hasOwnProperty("p2")&&this.config.p2===true&&Phaser.Physics.hasOwnProperty("P2")){this.p2=new Phaser.Physics.P2(this.game,this.config)}if(this.config.hasOwnProperty("box2d")&&this.config.box2d===true&&Phaser.Physics.hasOwnProperty("BOX2D")){this.box2d=new Phaser.Physics.BOX2D(this.game,this.config)}if(this.config.hasOwnProperty("matter")&&this.config.matter===true&&Phaser.Physics.hasOwnProperty("Matter")){this.matter=new Phaser.Physics.Matter(this.game,this.config)}},startSystem:function(a){if(a===Phaser.Physics.ARCADE){this.arcade=new Phaser.Physics.Arcade(this.game)}else{if(a===Phaser.Physics.P2JS){if(this.p2===null){this.p2=new Phaser.Physics.P2(this.game,this.config)}else{this.p2.reset()}}else{if(a===Phaser.Physics.NINJA){this.ninja=new Phaser.Physics.Ninja(this.game)}else{if(a===Phaser.Physics.BOX2D){if(this.box2d===null){this.box2d=new Phaser.Physics.Box2D(this.game,this.config)}else{this.box2d.reset()}}else{if(a===Phaser.Physics.MATTERJS){if(this.matter===null){this.matter=new Phaser.Physics.Matter(this.game,this.config)}else{this.matter.reset()}}}}}}},enable:function(b,c,a){if(c===undefined){c=Phaser.Physics.ARCADE}if(a===undefined){a=false}if(c===Phaser.Physics.ARCADE){this.arcade.enable(b)}else{if(c===Phaser.Physics.P2JS&&this.p2){this.p2.enable(b,a)}else{if(c===Phaser.Physics.NINJA&&this.ninja){this.ninja.enableAABB(b)}else{if(c===Phaser.Physics.BOX2D&&this.box2d){this.box2d.enable(b)}else{if(c===Phaser.Physics.MATTERJS&&this.matter){this.matter.enable(b)}else{console.warn(b.key+" is attempting to enable a physics body using an unknown physics system.")}}}}}},preUpdate:function(){if(this.p2){this.p2.preUpdate()}if(this.box2d){this.box2d.preUpdate()}if(this.matter){this.matter.preUpdate()}},update:function(){if(this.p2){this.p2.update()}if(this.box2d){this.box2d.update()}if(this.matter){this.matter.update()}},setBoundsToWorld:function(){if(this.arcade){this.arcade.setBoundsToWorld()}if(this.ninja){this.ninja.setBoundsToWorld()}if(this.p2){this.p2.setBoundsToWorld()}if(this.box2d){this.box2d.setBoundsToWorld()}if(this.matter){this.matter.setBoundsToWorld()}},clear:function(){if(this.p2){this.p2.clear()}if(this.box2d){this.box2d.clear()}if(this.matter){this.matter.clear()}},reset:function(){if(this.p2){this.p2.reset()}if(this.box2d){this.box2d.reset()}if(this.matter){this.matter.reset()}},destroy:function(){if(this.p2){this.p2.destroy()}if(this.box2d){this.box2d.destroy()}if(this.matter){this.matter.destroy()}this.arcade=null;this.ninja=null;this.p2=null;this.box2d=null;this.matter=null}};Phaser.Physics.prototype.constructor=Phaser.Physics;Phaser.Physics.Arcade=function(a){this.game=a;this.gravity=new Phaser.Point();this.bounds=new Phaser.Rectangle(0,0,a.world.width,a.world.height);this.checkCollision={up:true,down:true,left:true,right:true};this.maxObjects=10;this.maxLevels=4;this.OVERLAP_BIAS=4;this.forceX=false;this.sortDirection=Phaser.Physics.Arcade.LEFT_RIGHT;this.skipQuadTree=true;this.isPaused=false;this.quadTree=new Phaser.QuadTree(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels);this._total=0;this.setBoundsToWorld()};Phaser.Physics.Arcade.prototype.constructor=Phaser.Physics.Arcade;Phaser.Physics.Arcade.SORT_NONE=0;Phaser.Physics.Arcade.LEFT_RIGHT=1;Phaser.Physics.Arcade.RIGHT_LEFT=2;Phaser.Physics.Arcade.TOP_BOTTOM=3;Phaser.Physics.Arcade.BOTTOM_TOP=4;Phaser.Physics.Arcade.prototype={setBounds:function(b,d,c,a){this.bounds.setTo(b,d,c,a)},setBoundsToWorld:function(){this.bounds.copyFrom(this.game.world.bounds)},enable:function(a,c){if(c===undefined){c=true}var b=1;if(Array.isArray(a)){b=a.length;while(b--){if(a[b] instanceof Phaser.Group){this.enable(a[b].children,c)}else{this.enableBody(a[b]);if(c&&a[b].hasOwnProperty("children")&&a[b].children.length>0){this.enable(a[b],true)}}}}else{if(a instanceof Phaser.Group){this.enable(a.children,c)}else{this.enableBody(a);if(c&&a.hasOwnProperty("children")&&a.children.length>0){this.enable(a.children,true)}}}},enableBody:function(a){if(a.hasOwnProperty("body")&&a.body===null){a.body=new Phaser.Physics.Arcade.Body(a);if(a.parent&&a.parent instanceof Phaser.Group){a.parent.addToHash(a)}}},updateMotion:function(a){if(a.allowRotation){var b=this.computeVelocity(0,a,a.angularVelocity,a.angularAcceleration,a.angularDrag,a.maxAngular)-a.angularVelocity;a.angularVelocity+=b;a.rotation+=(a.angularVelocity*this.game.time.physicsElapsed)}a.velocity.x=this.computeVelocity(1,a,a.velocity.x,a.acceleration.x,a.drag.x,a.maxVelocity.x);a.velocity.y=this.computeVelocity(2,a,a.velocity.y,a.acceleration.y,a.drag.y,a.maxVelocity.y)},computeVelocity:function(d,b,f,e,c,a){if(a===undefined){a=10000}if(d===1&&b.allowGravity){f+=(this.gravity.x+b.gravity.x)*this.game.time.physicsElapsed}else{if(d===2&&b.allowGravity){f+=(this.gravity.y+b.gravity.y)*this.game.time.physicsElapsed}}if(e){f+=e*this.game.time.physicsElapsed}else{if(c&&b.allowDrag){c*=this.game.time.physicsElapsed;if(f-c>0){f-=c}else{if(f+c<0){f+=c}else{f=0}}}}if(f>a){f=a}else{if(f<-a){f=-a}}return f},overlap:function(e,d,a,c,b){a=a||null;c=c||null;b=b||a;this._total=0;this.collideObjects(e,d,a,c,b,true);return(this._total>0)},collide:function(e,d,c,b,a){c=c||null;b=b||null;a=a||c;this._total=0;this.collideObjects(e,d,c,b,a,false);return(this._total>0)},sortLeftRight:function(d,c){if(!d.body||!c.body){return 0}return d.body.x-c.body.x},sortRightLeft:function(d,c){if(!d.body||!c.body){return 0}return c.body.x-d.body.x},sortTopBottom:function(d,c){if(!d.body||!c.body){return 0}return d.body.y-c.body.y},sortBottomTop:function(d,c){if(!d.body||!c.body){return 0}return c.body.y-d.body.y},sort:function(b,a){if(b.physicsSortDirection!==null){a=b.physicsSortDirection}else{if(a===undefined){a=this.sortDirection}}if(a===Phaser.Physics.Arcade.LEFT_RIGHT){b.hash.sort(this.sortLeftRight)}else{if(a===Phaser.Physics.Arcade.RIGHT_LEFT){b.hash.sort(this.sortRightLeft)}else{if(a===Phaser.Physics.Arcade.TOP_BOTTOM){b.hash.sort(this.sortTopBottom)}else{if(a===Phaser.Physics.Arcade.BOTTOM_TOP){b.hash.sort(this.sortBottomTop)}}}}},collideObjects:function(h,g,f,e,a,c){if(!Array.isArray(h)&&Array.isArray(g)){for(var d=0;d<g.length;d++){if(!g[d]){continue}this.collideHandler(h,g[d],f,e,a,c)}}else{if(Array.isArray(h)&&!Array.isArray(g)){for(var d=0;d<h.length;d++){if(!h[d]){continue}this.collideHandler(h[d],g,f,e,a,c)}}else{if(Array.isArray(h)&&Array.isArray(g)){for(var d=0;d<h.length;d++){if(!h[d]){continue}for(var b=0;b<g.length;b++){if(!g[b]){continue}this.collideHandler(h[d],g[b],f,e,a,c)}}}else{this.collideHandler(h,g,f,e,a,c)}}}},collideHandler:function(f,e,d,c,a,b){if(e===undefined&&f.physicsType===Phaser.GROUP){this.sort(f);this.collideGroupVsSelf(f,d,c,a,b);return}if(!f||!e||!f.exists||!e.exists){return}if(this.sortDirection!==Phaser.Physics.Arcade.SORT_NONE){if(f.physicsType===Phaser.GROUP){this.sort(f)}if(e.physicsType===Phaser.GROUP){this.sort(e)}}if(f.physicsType===Phaser.SPRITE){if(e.physicsType===Phaser.SPRITE){this.collideSpriteVsSprite(f,e,d,c,a,b)}else{if(e.physicsType===Phaser.GROUP){this.collideSpriteVsGroup(f,e,d,c,a,b)}else{if(e.physicsType===Phaser.TILEMAPLAYER){this.collideSpriteVsTilemapLayer(f,e,d,c,a,b)}}}}else{if(f.physicsType===Phaser.GROUP){if(e.physicsType===Phaser.SPRITE){this.collideSpriteVsGroup(e,f,d,c,a,b)}else{if(e.physicsType===Phaser.GROUP){this.collideGroupVsGroup(f,e,d,c,a,b)}else{if(e.physicsType===Phaser.TILEMAPLAYER){this.collideGroupVsTilemapLayer(f,e,d,c,a,b)}}}}else{if(f.physicsType===Phaser.TILEMAPLAYER){if(e.physicsType===Phaser.SPRITE){this.collideSpriteVsTilemapLayer(e,f,d,c,a,b)}else{if(e.physicsType===Phaser.GROUP){this.collideGroupVsTilemapLayer(e,f,d,c,a,b)}}}}}},collideSpriteVsSprite:function(f,e,d,c,a,b){if(!f.body||!e.body){return false}if(this.separate(f.body,e.body,c,a,b)){if(d){d.call(a,f,e)}this._total++}return true},collideSpriteVsGroup:function(j,h,k,b,c,f){if(h.length===0||!j.body){return}if(this.skipQuadTree||j.body.skipQuadTree){var a={};for(var d=0;d<h.hash.length;d++){var g=h.hash[d];if(!g||!g.exists||!g.body){continue}a=g.body.getBounds(a);if(this.sortDirection===Phaser.Physics.Arcade.LEFT_RIGHT){if(j.body.right<a.x){break}else{if(a.right<j.body.x){continue}}}else{if(this.sortDirection===Phaser.Physics.Arcade.RIGHT_LEFT){if(j.body.x>a.right){break}else{if(a.x>j.body.right){continue}}}else{if(this.sortDirection===Phaser.Physics.Arcade.TOP_BOTTOM){if(j.body.bottom<a.y){break}else{if(a.bottom<j.body.y){continue}}}else{if(this.sortDirection===Phaser.Physics.Arcade.BOTTOM_TOP){if(j.body.y>a.bottom){break}else{if(a.y>j.body.bottom){continue}}}}}}this.collideSpriteVsSprite(j,g,k,b,c,f)}}else{this.quadTree.clear();this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels);this.quadTree.populate(h);var e=this.quadTree.retrieve(j);for(var d=0;d<e.length;d++){if(this.separate(j.body,e[d],b,c,f)){if(k){k.call(c,j,e[d].sprite)}this._total++}}}},collideGroupVsSelf:function(l,m,c,d,g){if(l.length===0){return}for(var f=0;f<l.hash.length;f++){var b={};var k=l.hash[f];if(!k||!k.exists||!k.body){continue}b=k.body.getBounds(b);for(var e=f+1;e<l.hash.length;e++){var a={};var h=l.hash[e];if(!h||!h.exists||!h.body){continue}a=h.body.getBounds(a);if(this.sortDirection===Phaser.Physics.Arcade.LEFT_RIGHT){if(b.right<a.x){break}else{if(a.right<b.x){continue}}}else{if(this.sortDirection===Phaser.Physics.Arcade.RIGHT_LEFT){if(b.x>a.right){continue}else{if(a.x>b.right){break}}}else{if(this.sortDirection===Phaser.Physics.Arcade.TOP_BOTTOM){if(b.bottom<a.y){continue}else{if(a.bottom<b.y){break}}}else{if(this.sortDirection===Phaser.Physics.Arcade.BOTTOM_TOP){if(b.y>a.bottom){continue}else{if(a.y>k.body.bottom){break}}}}}}this.collideSpriteVsSprite(k,h,m,c,d,g)}}},collideGroupVsGroup:function(a,g,f,e,b,c){if(a.length===0||g.length===0){return}for(var d=0;d<a.children.length;d++){if(a.children[d].exists){if(a.children[d].physicsType===Phaser.GROUP){this.collideGroupVsGroup(a.children[d],g,f,e,b,c)}else{this.collideSpriteVsGroup(a.children[d],g,f,e,b,c)}}}},separate:function(a,l,d,e,h){if(!a.enable||!l.enable||a.checkCollision.none||l.checkCollision.none||!this.intersects(a,l)){return false}if(d&&d.call(e,a.sprite,l.sprite)===false){return false}if(a.isCircle&&l.isCircle){return this.separateCircle(a,l,h)}if(a.isCircle!==l.isCircle){var j=(a.isCircle)?l:a;var c=(a.isCircle)?a:l;var i={x:j.x,y:j.y,right:j.right,bottom:j.bottom};var b=c.center;if(b.y<i.y||b.y>i.bottom){if(b.x<i.x||b.x>i.right){return this.separateCircle(a,l,h)}}}var g=false;var f=false;if(this.forceX||Math.abs(this.gravity.y+a.gravity.y)<Math.abs(this.gravity.x+a.gravity.x)){g=this.separateX(a,l,h);if(this.intersects(a,l)){f=this.separateY(a,l,h)}}else{f=this.separateY(a,l,h);if(this.intersects(a,l)){g=this.separateX(a,l,h)}}var k=(g||f);if(k){if(h){if(a.onOverlap){a.onOverlap.dispatch(a.sprite,l.sprite)}if(l.onOverlap){l.onOverlap.dispatch(l.sprite,a.sprite)}}else{if(a.onCollide){a.onCollide.dispatch(a.sprite,l.sprite)}if(l.onCollide){l.onCollide.dispatch(l.sprite,a.sprite)}}}return k},intersects:function(b,a){if(b===a){return false}if(b.isCircle){if(a.isCircle){return Phaser.Math.distance(b.center.x,b.center.y,a.center.x,a.center.y)<=(b.halfWidth+a.halfWidth)}else{return this.circleBodyIntersects(b,a)}}else{if(a.isCircle){return this.circleBodyIntersects(a,b)}else{if(b.right<=a.position.x){return false}if(b.bottom<=a.position.y){return false}if(b.position.x>=a.right){return false}if(b.position.y>=a.bottom){return false}return true}}},circleBodyIntersects:function(e,b){var a=Phaser.Math.clamp(e.center.x,b.left,b.right);var f=Phaser.Math.clamp(e.center.y,b.top,b.bottom);var d=(e.center.x-a)*(e.center.x-a);var c=(e.center.y-f)*(e.center.y-f);return(d+c)<=(e.halfWidth*e.halfWidth)},separateCircle:function(a,l,f){this.getOverlapX(a,l);this.getOverlapY(a,l);var m=l.center.x-a.center.x;var k=l.center.y-a.center.y;var c=Math.atan2(k,m);var i=0;if(a.isCircle!==l.isCircle){var g={x:(l.isCircle)?a.position.x:l.position.x,y:(l.isCircle)?a.position.y:l.position.y,right:(l.isCircle)?a.right:l.right,bottom:(l.isCircle)?a.bottom:l.bottom};var b={x:(a.isCircle)?a.center.x:l.center.x,y:(a.isCircle)?a.center.y:l.center.y,radius:(a.isCircle)?a.halfWidth:l.halfWidth};if(b.y<g.y){if(b.x<g.x){i=Phaser.Math.distance(b.x,b.y,g.x,g.y)-b.radius}else{if(b.x>g.right){i=Phaser.Math.distance(b.x,b.y,g.right,g.y)-b.radius}}}else{if(b.y>g.bottom){if(b.x<g.x){i=Phaser.Math.distance(b.x,b.y,g.x,g.bottom)-b.radius}else{if(b.x>g.right){i=Phaser.Math.distance(b.x,b.y,g.right,g.bottom)-b.radius}}}}i*=-1}else{i=(a.halfWidth+l.halfWidth)-Phaser.Math.distance(a.center.x,a.center.y,l.center.x,l.center.y)}if(f||i===0||(a.immovable&&l.immovable)||a.customSeparateX||l.customSeparateX){if(i!==0){if(a.onOverlap){a.onOverlap.dispatch(a.sprite,l.sprite)}if(l.onOverlap){l.onOverlap.dispatch(l.sprite,a.sprite)}}return(i!==0)}var j={x:a.velocity.x*Math.cos(c)+a.velocity.y*Math.sin(c),y:a.velocity.x*Math.sin(c)-a.velocity.y*Math.cos(c)};var h={x:l.velocity.x*Math.cos(c)+l.velocity.y*Math.sin(c),y:l.velocity.x*Math.sin(c)-l.velocity.y*Math.cos(c)};var e=((a.mass-l.mass)*j.x+2*l.mass*h.x)/(a.mass+l.mass);var d=(2*a.mass*j.x+(l.mass-a.mass)*h.x)/(a.mass+l.mass);if(!a.immovable){a.velocity.x=(e*Math.cos(c)-j.y*Math.sin(c))*a.bounce.x;a.velocity.y=(j.y*Math.cos(c)+e*Math.sin(c))*a.bounce.y}if(!l.immovable){l.velocity.x=(d*Math.cos(c)-h.y*Math.sin(c))*l.bounce.x;l.velocity.y=(h.y*Math.cos(c)+d*Math.sin(c))*l.bounce.y}if(Math.abs(c)<Math.PI/2){if((a.velocity.x>0)&&!a.immovable&&(l.velocity.x>a.velocity.x)){a.velocity.x*=-1}else{if((l.velocity.x<0)&&!l.immovable&&(a.velocity.x<l.velocity.x)){l.velocity.x*=-1}else{if((a.velocity.y>0)&&!a.immovable&&(l.velocity.y>a.velocity.y)){a.velocity.y*=-1}else{if((l.velocity.y<0)&&!l.immovable&&(a.velocity.y<l.velocity.y)){l.velocity.y*=-1}}}}}else{if(Math.abs(c)>Math.PI/2){if((a.velocity.x<0)&&!a.immovable&&(l.velocity.x<a.velocity.x)){a.velocity.x*=-1}else{if((l.velocity.x>0)&&!l.immovable&&(a.velocity.x>l.velocity.x)){l.velocity.x*=-1}else{if((a.velocity.y<0)&&!a.immovable&&(l.velocity.y<a.velocity.y)){a.velocity.y*=-1}else{if((l.velocity.y>0)&&!l.immovable&&(a.velocity.x>l.velocity.y)){l.velocity.y*=-1}}}}}}if(!a.immovable){a.x+=(a.velocity.x*this.game.time.physicsElapsed)-i*Math.cos(c);a.y+=(a.velocity.y*this.game.time.physicsElapsed)-i*Math.sin(c)}if(!l.immovable){l.x+=(l.velocity.x*this.game.time.physicsElapsed)+i*Math.cos(c);l.y+=(l.velocity.y*this.game.time.physicsElapsed)+i*Math.sin(c)}if(a.onCollide){a.onCollide.dispatch(a.sprite,l.sprite)}if(l.onCollide){l.onCollide.dispatch(l.sprite,a.sprite)}return true},getOverlapX:function(d,b,c){var a=0;var e=d.deltaAbsX()+b.deltaAbsX()+this.OVERLAP_BIAS;if(d.deltaX()===0&&b.deltaX()===0){d.embedded=true;b.embedded=true}else{if(d.deltaX()>b.deltaX()){a=d.right-b.x;if((a>e&&!c)||d.checkCollision.right===false||b.checkCollision.left===false){a=0}else{d.touching.none=false;d.touching.right=true;b.touching.none=false;b.touching.left=true}}else{if(d.deltaX()<b.deltaX()){a=d.x-b.width-b.x;if((-a>e&&!c)||d.checkCollision.left===false||b.checkCollision.right===false){a=0}else{d.touching.none=false;d.touching.left=true;b.touching.none=false;b.touching.right=true}}}}d.overlapX=a;b.overlapX=a;return a},getOverlapY:function(d,b,c){var a=0;var e=d.deltaAbsY()+b.deltaAbsY()+this.OVERLAP_BIAS;if(d.deltaY()===0&&b.deltaY()===0){d.embedded=true;b.embedded=true}else{if(d.deltaY()>b.deltaY()){a=d.bottom-b.y;if((a>e&&!c)||d.checkCollision.down===false||b.checkCollision.up===false){a=0}else{d.touching.none=false;d.touching.down=true;b.touching.none=false;b.touching.up=true}}else{if(d.deltaY()<b.deltaY()){a=d.y-b.bottom;if((-a>e&&!c)||d.checkCollision.up===false||b.checkCollision.down===false){a=0}else{d.touching.none=false;d.touching.up=true;b.touching.none=false;b.touching.down=true}}}}d.overlapY=a;b.overlapY=a;return a},separateX:function(a,i,c){var g=this.getOverlapX(a,i,c);if(c||g===0||(a.immovable&&i.immovable)||a.customSeparateX||i.customSeparateX){return(g!==0)||(a.embedded&&i.embedded)}var h=a.velocity.x;var f=i.velocity.x;if(!a.immovable&&!i.immovable){g*=0.5;a.x-=g;i.x+=g;var e=Math.sqrt((f*f*i.mass)/a.mass)*((f>0)?1:-1);var d=Math.sqrt((h*h*a.mass)/i.mass)*((h>0)?1:-1);var b=(e+d)*0.5;e-=b;d-=b;a.velocity.x=b+e*a.bounce.x;i.velocity.x=b+d*i.bounce.x}else{if(!a.immovable){a.x-=g;a.velocity.x=f-h*a.bounce.x;if(i.moves){a.y+=(i.y-i.prev.y)*i.friction.y}}else{i.x+=g;i.velocity.x=h-f*i.bounce.x;if(a.moves){i.y+=(a.y-a.prev.y)*a.friction.y}}}return true},separateY:function(a,i,c){var g=this.getOverlapY(a,i,c);if(c||g===0||(a.immovable&&i.immovable)||a.customSeparateY||i.customSeparateY){return(g!==0)||(a.embedded&&i.embedded)}var h=a.velocity.y;var f=i.velocity.y;if(!a.immovable&&!i.immovable){g*=0.5;a.y-=g;i.y+=g;var e=Math.sqrt((f*f*i.mass)/a.mass)*((f>0)?1:-1);var d=Math.sqrt((h*h*a.mass)/i.mass)*((h>0)?1:-1);var b=(e+d)*0.5;e-=b;d-=b;a.velocity.y=b+e*a.bounce.y;i.velocity.y=b+d*i.bounce.y}else{if(!a.immovable){a.y-=g;a.velocity.y=f-h*a.bounce.y;if(i.moves){a.x+=(i.x-i.prev.x)*i.friction.x}}else{i.y+=g;i.velocity.y=h-f*i.bounce.y;if(a.moves){i.x+=(a.x-a.prev.x)*a.friction.x}}}return true},getObjectsUnderPointer:function(c,b,d,a){if(b.length===0||!c.exists){return}return this.getObjectsAtLocation(c.x,c.y,b,d,a,c)},getObjectsAtLocation:function(h,f,j,k,b,d){this.quadTree.clear();this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels);this.quadTree.populate(j);var g=new Phaser.Rectangle(h,f,1,1);var a=[];var e=this.quadTree.retrieve(g);for(var c=0;c<e.length;c++){if(e[c].hitTest(h,f)){if(k){k.call(b,d,e[c].sprite)}a.push(e[c].sprite)}}return a},moveToObject:function(e,a,c,b){if(c===undefined){c=60}if(b===undefined){b=0}var d=Math.atan2(a.y-e.y,a.x-e.x);if(b>0){c=this.distanceBetween(e,a)/(b/1000)}e.body.velocity.setToPolar(d,c);return d},moveToPointer:function(e,b,d,a){if(b===undefined){b=60}d=d||this.game.input.activePointer;if(a===undefined){a=0}var c=this.angleToPointer(e,d);if(a>0){b=this.distanceToPointer(e,d)/(a/1000)}e.body.velocity.setToPolar(c,b);return c},moveToXY:function(e,a,f,c,b){if(c===undefined){c=60}if(b===undefined){b=0}var d=Math.atan2(f-e.y,a-e.x);if(b>0){c=this.distanceToXY(e,a,f)/(b/1000)}e.body.velocity.setToPolar(d,c);return d},velocityFromAngle:function(c,b,a){if(b===undefined){b=60}a=a||new Phaser.Point();return a.setToPolar(c,b,true)},velocityFromRotation:function(b,c,a){if(c===undefined){c=60}a=a||new Phaser.Point();return a.setToPolar(b,c)},accelerationFromRotation:function(b,c,a){if(c===undefined){c=60}a=a||new Phaser.Point();return a.setToPolar(b,c)},accelerateToObject:function(e,b,c,a,f){if(c===undefined){c=60}if(a===undefined){a=1000}if(f===undefined){f=1000}var d=this.angleBetween(e,b);e.body.acceleration.setToPolar(d,c);e.body.maxVelocity.setTo(a,f);return d},accelerateToPointer:function(e,d,b,a,f){if(b===undefined){b=60}if(d===undefined){d=this.game.input.activePointer}if(a===undefined){a=1000}if(f===undefined){f=1000}var c=this.angleToPointer(e,d);e.body.acceleration.setToPolar(c,b);e.body.maxVelocity.setTo(a,f);return c},accelerateToXY:function(e,b,g,c,a,f){if(c===undefined){c=60}if(a===undefined){a=1000}if(f===undefined){f=1000}var d=this.angleToXY(e,b,g);e.body.acceleration.setTo(d,c);e.body.maxVelocity.setTo(a,f);return d},distanceBetween:function(d,e,c){if(c===undefined){c=false}var b=(c)?d.world.x-e.world.x:d.x-e.x;var a=(c)?d.world.y-e.world.y:d.y-e.y;return Math.sqrt(b*b+a*a)},distanceToXY:function(e,a,f,d){if(d===undefined){d=false}var c=(d)?e.world.x-a:e.x-a;var b=(d)?e.world.y-f:e.y-f;return Math.sqrt(c*c+b*b)},distanceToPointer:function(e,d,c){if(d===undefined){d=this.game.input.activePointer}if(c===undefined){c=false}var b=(c)?e.world.x-d.worldX:e.x-d.worldX;var a=(c)?e.world.y-d.worldY:e.y-d.worldY;return Math.sqrt(b*b+a*a)},closest:function(a,g,f){var d=Infinity;var c=null;for(var e=0,h=g.length;e<h;e++){var j=g[e];var b=this.distanceBetween(a,j,f);if(b<d){c=j;d=b}}return c},farthest:function(a,e,d){var h=-1;var j=null;for(var c=0,f=e.length;c<f;c++){var g=e[c];var b=this.distanceBetween(a,g,d);if(b>h){j=g;h=b}}return j},angleBetween:function(b,c,a){if(a===undefined){a=false}if(a){return Math.atan2(c.world.y-b.world.y,c.world.x-b.world.x)}else{return Math.atan2(c.y-b.y,c.x-b.x)}},angleBetweenCenters:function(c,d){var b=d.centerX-c.centerX;var a=d.centerY-c.centerY;return Math.atan2(a,b)},angleToXY:function(c,a,d,b){if(b===undefined){b=false}if(b){return Math.atan2(d-c.world.y,a-c.world.x)}else{return Math.atan2(d-c.y,a-c.x)}},angleToPointer:function(c,b,a){if(b===undefined){b=this.game.input.activePointer}if(a===undefined){a=false}if(a){return Math.atan2(b.worldY-c.world.y,b.worldX-c.world.x)}else{return Math.atan2(b.worldY-c.y,b.worldX-c.x)}},worldAngleToPointer:function(b,a){return this.angleToPointer(b,a,true)}};Phaser.Physics.Arcade.Body=function(a){this.sprite=a;this.game=a.game;this.type=Phaser.Physics.ARCADE;this.enable=true;this.isCircle=false;this.radius=0;this.offset=new Phaser.Point();this.position=new Phaser.Point(a.x,a.y);this.prev=new Phaser.Point(this.position.x,this.position.y);this.allowRotation=true;this.rotation=a.angle;this.preRotation=a.angle;this.width=a.width;this.height=a.height;this.sourceWidth=a.width;this.sourceHeight=a.height;if(a.texture){this.sourceWidth=a.texture.frame.width;this.sourceHeight=a.texture.frame.height}this.halfWidth=Math.abs(a.width/2);this.halfHeight=Math.abs(a.height/2);this.center=new Phaser.Point(a.x+this.halfWidth,a.y+this.halfHeight);this.velocity=new Phaser.Point();this.newVelocity=new Phaser.Point();this.deltaMax=new Phaser.Point();this.acceleration=new Phaser.Point();this.allowDrag=true;this.drag=new Phaser.Point();this.allowGravity=true;this.gravity=new Phaser.Point();this.bounce=new Phaser.Point();this.worldBounce=null;this.onWorldBounds=null;this.onCollide=null;this.onOverlap=null;this.maxVelocity=new Phaser.Point(10000,10000);this.friction=new Phaser.Point(1,0);this.angularVelocity=0;this.angularAcceleration=0;this.angularDrag=0;this.maxAngular=1000;this.mass=1;this.angle=0;this.speed=0;this.facing=Phaser.NONE;this.immovable=false;this.moves=true;this.customSeparateX=false;this.customSeparateY=false;this.overlapX=0;this.overlapY=0;this.overlapR=0;this.embedded=false;this.collideWorldBounds=false;this.checkCollision={none:false,up:true,down:true,left:true,right:true};this.touching={none:true,up:false,down:false,left:false,right:false};this.wasTouching={none:true,up:false,down:false,left:false,right:false};this.blocked={none:true,up:false,down:false,left:false,right:false};this.tilePadding=new Phaser.Point();this.dirty=false;this.skipQuadTree=false;this.syncBounds=false;this.isMoving=false;this.stopVelocityOnCollide=true;this.moveTimer=0;this.moveDistance=0;this.moveDuration=0;this.moveTarget=null;this.moveEnd=null;this.onMoveComplete=new Phaser.Signal();this.movementCallback=null;this.movementCallbackContext=null;this._reset=true;this._sx=a.scale.x;this._sy=a.scale.y;this._dx=0;this._dy=0};Phaser.Physics.Arcade.Body.prototype={updateBounds:function(){if(this.syncBounds){var a=this.sprite.getBounds();a.ceilAll();if(a.width!==this.width||a.height!==this.height){this.width=a.width;this.height=a.height;this._reset=true}}else{var d=Math.abs(this.sprite.scale.x);var c=Math.abs(this.sprite.scale.y);if(d!==this._sx||c!==this._sy){this.width=this.sourceWidth*d;this.height=this.sourceHeight*c;this._sx=d;this._sy=c;this._reset=true}}if(this._reset){this.halfWidth=Math.floor(this.width/2);this.halfHeight=Math.floor(this.height/2);this.updateCenter()}},updateCenter:function(){this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},preUpdate:function(){if(!this.enable||this.game.physics.arcade.isPaused){return}this.dirty=true;this.wasTouching.none=this.touching.none;this.wasTouching.up=this.touching.up;this.wasTouching.down=this.touching.down;this.wasTouching.left=this.touching.left;this.wasTouching.right=this.touching.right;this.touching.none=true;this.touching.up=false;this.touching.down=false;this.touching.left=false;this.touching.right=false;this.blocked.none=true;this.blocked.up=false;this.blocked.down=false;this.blocked.left=false;this.blocked.right=false;this.overlapR=0;this.overlapX=0;this.overlapY=0;this.embedded=false;this.updateBounds();this.position.x=(this.sprite.world.x-(this.sprite.anchor.x*this.sprite.width))+this.sprite.scale.x*this.offset.x;this.position.x-=this.sprite.scale.x<0?this.width:0;this.position.y=(this.sprite.world.y-(this.sprite.anchor.y*this.sprite.height))+this.sprite.scale.y*this.offset.y;this.position.y-=this.sprite.scale.y<0?this.height:0;this.updateCenter();this.rotation=this.sprite.angle;this.preRotation=this.rotation;if(this._reset||this.sprite.fresh){this.prev.x=this.position.x;this.prev.y=this.position.y}if(this.moves){this.game.physics.arcade.updateMotion(this);this.newVelocity.set(this.velocity.x*this.game.time.physicsElapsed,this.velocity.y*this.game.time.physicsElapsed);this.position.x+=this.newVelocity.x;this.position.y+=this.newVelocity.y;this.updateCenter();if(this.position.x!==this.prev.x||this.position.y!==this.prev.y){this.angle=Math.atan2(this.velocity.y,this.velocity.x)}this.speed=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y);if(this.collideWorldBounds){if(this.checkWorldBounds()&&this.onWorldBounds){this.onWorldBounds.dispatch(this.sprite,this.blocked.up,this.blocked.down,this.blocked.left,this.blocked.right)}}}this._dx=this.deltaX();this._dy=this.deltaY();this._reset=false},updateMovement:function(){var c=0;var b=(this.overlapX!==0||this.overlapY!==0);if(this.moveDuration>0){this.moveTimer+=this.game.time.elapsedMS;c=this.moveTimer/this.moveDuration}else{this.moveTarget.end.set(this.position.x,this.position.y);c=this.moveTarget.length/this.moveDistance}if(this.movementCallback){var a=this.movementCallback.call(this.movementCallbackContext,this,this.velocity,c)}if(b||c>=1||(a!==undefined&&a!==true)){this.stopMovement((c>=1)||(this.stopVelocityOnCollide&&b));return false}return true},stopMovement:function(a){if(this.isMoving){this.isMoving=false;if(a){this.velocity.set(0)}this.onMoveComplete.dispatch(this.sprite,(this.overlapX!==0||this.overlapY!==0))}},postUpdate:function(){if(!this.enable||!this.dirty){return}if(this.isMoving){this.updateMovement()}this.dirty=false;if(this.deltaX()<0){this.facing=Phaser.LEFT}else{if(this.deltaX()>0){this.facing=Phaser.RIGHT}}if(this.deltaY()<0){this.facing=Phaser.UP}else{if(this.deltaY()>0){this.facing=Phaser.DOWN}}if(this.moves){this._dx=this.deltaX();this._dy=this.deltaY();if(this.deltaMax.x!==0&&this._dx!==0){if(this._dx<0&&this._dx<-this.deltaMax.x){this._dx=-this.deltaMax.x}else{if(this._dx>0&&this._dx>this.deltaMax.x){this._dx=this.deltaMax.x}}}if(this.deltaMax.y!==0&&this._dy!==0){if(this._dy<0&&this._dy<-this.deltaMax.y){this._dy=-this.deltaMax.y}else{if(this._dy>0&&this._dy>this.deltaMax.y){this._dy=this.deltaMax.y}}}this.sprite.position.x+=this._dx;this.sprite.position.y+=this._dy;this._reset=true}this.updateCenter();if(this.allowRotation){this.sprite.angle+=this.deltaZ()}this.prev.x=this.position.x;this.prev.y=this.position.y},checkWorldBounds:function(){var e=this.position;var b=this.game.physics.arcade.bounds;var a=this.game.physics.arcade.checkCollision;var d=(this.worldBounce)?-this.worldBounce.x:-this.bounce.x;var c=(this.worldBounce)?-this.worldBounce.y:-this.bounce.y;if(e.x<b.x&&a.left){e.x=b.x;this.velocity.x*=d;this.blocked.left=true;this.blocked.none=false}else{if(this.right>b.right&&a.right){e.x=b.right-this.width;this.velocity.x*=d;this.blocked.right=true;this.blocked.none=false}}if(e.y<b.y&&a.up){e.y=b.y;this.velocity.y*=c;this.blocked.up=true;this.blocked.none=false}else{if(this.bottom>b.bottom&&a.down){e.y=b.bottom-this.height;this.velocity.y*=c;this.blocked.down=true;this.blocked.none=false}}return !this.blocked.none},moveFrom:function(c,a,b){if(a===undefined){a=this.speed}if(a===0){return false}var d;if(b===undefined){d=this.angle;b=this.game.math.radToDeg(d)}else{d=this.game.math.degToRad(b)}this.moveTimer=0;this.moveDuration=c;if(b===0||b===180){this.velocity.set(Math.cos(d)*a,0)}else{if(b===90||b===270){this.velocity.set(0,Math.sin(d)*a)}else{this.velocity.setToPolar(d,a)}}this.isMoving=true;return true},moveTo:function(c,e,b){var a=e/(c/1000);if(a===0){return false}var d;if(b===undefined){d=this.angle;b=this.game.math.radToDeg(d)}else{d=this.game.math.degToRad(b)}e=Math.abs(e);this.moveDuration=0;this.moveDistance=e;if(this.moveTarget===null){this.moveTarget=new Phaser.Line();this.moveEnd=new Phaser.Point()}this.moveTarget.fromAngle(this.x,this.y,d,e);this.moveEnd.set(this.moveTarget.end.x,this.moveTarget.end.y);this.moveTarget.setTo(this.x,this.y,this.x,this.y);if(b===0||b===180){this.velocity.set(Math.cos(d)*a,0)}else{if(b===90||b===270){this.velocity.set(0,Math.sin(d)*a)}else{this.velocity.setToPolar(d,a)}}this.isMoving=true;return true},setSize:function(c,b,a,d){if(a===undefined){a=this.offset.x}if(d===undefined){d=this.offset.y}this.sourceWidth=c;this.sourceHeight=b;this.width=this.sourceWidth*this._sx;this.height=this.sourceHeight*this._sy;this.halfWidth=Math.floor(this.width/2);this.halfHeight=Math.floor(this.height/2);this.offset.setTo(a,d);this.updateCenter();this.isCircle=false;this.radius=0},setCircle:function(b,a,c){if(a===undefined){a=this.offset.x}if(c===undefined){c=this.offset.y}if(b>0){this.isCircle=true;this.radius=b;this.sourceWidth=b*2;this.sourceHeight=b*2;this.width=this.sourceWidth*this._sx;this.height=this.sourceHeight*this._sy;this.halfWidth=Math.floor(this.width/2);this.halfHeight=Math.floor(this.height/2);this.offset.setTo(a,c);this.updateCenter()}else{this.isCircle=false}},reset:function(a,b){this.stop();this.position.x=(a-(this.sprite.anchor.x*this.sprite.width))+this.sprite.scale.x*this.offset.x;this.position.x-=this.sprite.scale.x<0?this.width:0;this.position.y=(b-(this.sprite.anchor.y*this.sprite.height))+this.sprite.scale.y*this.offset.y;this.position.y-=this.sprite.scale.y<0?this.height:0;this.prev.x=this.position.x;this.prev.y=this.position.y;this.rotation=this.sprite.angle;this.preRotation=this.rotation;this.updateBounds();this.updateCenter()},stop:function(){this.velocity.set(0);this.acceleration.set(0);this.speed=0;this.angularVelocity=0;this.angularAcceleration=0},getBounds:function(a){a.x=this.x;a.y=this.y;a.right=this.right;a.bottom=this.bottom;return a},hitTest:function(a,b){return(this.isCircle)?Phaser.Circle.contains(this,a,b):Phaser.Rectangle.contains(this,a,b)},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return(this.blocked.left||this.blocked.right)},deltaAbsX:function(){return(this.deltaX()>0?this.deltaX():-this.deltaX())},deltaAbsY:function(){return(this.deltaY()>0?this.deltaY():-this.deltaY())},deltaX:function(){return this.position.x-this.prev.x},deltaY:function(){return this.position.y-this.prev.y},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){if(this.sprite.parent&&this.sprite.parent instanceof Phaser.Group){this.sprite.parent.removeFromHash(this.sprite)}this.sprite.body=null;this.sprite=null}};Object.defineProperty(Phaser.Physics.Arcade.Body.prototype,"left",{get:function(){return this.position.x}});Object.defineProperty(Phaser.Physics.Arcade.Body.prototype,"right",{get:function(){return this.position.x+this.width}});Object.defineProperty(Phaser.Physics.Arcade.Body.prototype,"top",{get:function(){return this.position.y}});Object.defineProperty(Phaser.Physics.Arcade.Body.prototype,"bottom",{get:function(){return this.position.y+this.height}});Object.defineProperty(Phaser.Physics.Arcade.Body.prototype,"x",{get:function(){return this.position.x},set:function(a){this.position.x=a}});Object.defineProperty(Phaser.Physics.Arcade.Body.prototype,"y",{get:function(){return this.position.y},set:function(a){this.position.y=a}});Phaser.Physics.Arcade.Body.render=function(d,b,c,e,a){if(e===undefined){e=true}c=c||"rgba(0,255,0,0.4)";d.fillStyle=c;d.strokeStyle=c;d.lineWidth=a||1;if(b.isCircle){d.beginPath();d.arc(b.center.x-b.game.camera.x,b.center.y-b.game.camera.y,b.halfWidth,0,2*Math.PI);if(e){d.fill()}else{d.stroke()}}else{if(e){d.fillRect(b.position.x-b.game.camera.x,b.position.y-b.game.camera.y,b.width,b.height)}else{d.strokeRect(b.position.x-b.game.camera.x,b.position.y-b.game.camera.y,b.width,b.height)}}};Phaser.Physics.Arcade.Body.renderBodyInfo=function(b,a){b.line("x: "+a.x.toFixed(2),"y: "+a.y.toFixed(2),"width: "+a.width,"height: "+a.height);b.line("velocity x: "+a.velocity.x.toFixed(2),"y: "+a.velocity.y.toFixed(2),"deltaX: "+a._dx.toFixed(2),"deltaY: "+a._dy.toFixed(2));b.line("acceleration x: "+a.acceleration.x.toFixed(2),"y: "+a.acceleration.y.toFixed(2),"speed: "+a.speed.toFixed(2),"angle: "+a.angle.toFixed(2));b.line("gravity x: "+a.gravity.x,"y: "+a.gravity.y,"bounce x: "+a.bounce.x.toFixed(2),"y: "+a.bounce.y.toFixed(2));b.line("touching left: "+a.touching.left,"right: "+a.touching.right,"up: "+a.touching.up,"down: "+a.touching.down);b.line("blocked left: "+a.blocked.left,"right: "+a.blocked.right,"up: "+a.blocked.up,"down: "+a.blocked.down)};Phaser.Physics.Arcade.Body.prototype.constructor=Phaser.Physics.Arcade.Body;Phaser.Physics.Arcade.TilemapCollision=function(){};Phaser.Physics.Arcade.TilemapCollision.prototype={TILE_BIAS:16,collideSpriteVsTilemapLayer:function(e,a,g,f,b,c){if(!e.body){return}var h=a.getTiles(e.body.position.x-e.body.tilePadding.x-a.getTileOffsetX(),e.body.position.y-e.body.tilePadding.y-a.getTileOffsetY(),e.body.width+e.body.tilePadding.x,e.body.height+e.body.tilePadding.y,false,false);if(h.length===0){return}for(var d=0;d<h.length;d++){if(f){if(f.call(b,e,h[d])){if(this.separateTile(d,e.body,h[d],a,c)){this._total++;if(g){g.call(b,e,h[d])}}}}else{if(this.separateTile(d,e.body,h[d],a,c)){this._total++;if(g){g.call(b,e,h[d])}}}}},collideGroupVsTilemapLayer:function(g,a,f,e,b,c){if(g.length===0){return}for(var d=0;d<g.children.length;d++){if(g.children[d].exists){this.collideSpriteVsTilemapLayer(g.children[d],a,f,e,b,c)}}},separateTile:function(h,j,k,a,l){if(!j.enable){return false}var d=a.getTileOffsetX();var c=a.getTileOffsetY();if(!k.intersects((j.position.x-d),(j.position.y-c),(j.right-d),(j.bottom-c))){return false}else{if(l){return true}}if(k.collisionCallback&&!k.collisionCallback.call(k.collisionCallbackContext,j.sprite,k)){return false}else{if(typeof k.layer.callbacks!=="undefined"&&k.layer.callbacks[k.index]&&!k.layer.callbacks[k.index].callback.call(k.layer.callbacks[k.index].callbackContext,j.sprite,k)){return false}}if(!k.faceLeft&&!k.faceRight&&!k.faceTop&&!k.faceBottom){return false}var e=0;var b=0;var g=0;var f=1;if(j.deltaAbsX()>j.deltaAbsY()){g=-1}else{if(j.deltaAbsX()<j.deltaAbsY()){f=-1}}if(j.deltaX()!==0&&j.deltaY()!==0&&(k.faceLeft||k.faceRight)&&(k.faceTop||k.faceBottom)){g=Math.min(Math.abs((j.position.x-d)-k.right),Math.abs((j.right-d)-k.left));f=Math.min(Math.abs((j.position.y-c)-k.bottom),Math.abs((j.bottom-c)-k.top))}if(g<f){if(k.faceLeft||k.faceRight){e=this.tileCheckX(j,k,a);if(e!==0&&!k.intersects((j.position.x-d),(j.position.y-c),(j.right-d),(j.bottom-c))){return true}}if(k.faceTop||k.faceBottom){b=this.tileCheckY(j,k,a)}}else{if(k.faceTop||k.faceBottom){b=this.tileCheckY(j,k,a);if(b!==0&&!k.intersects((j.position.x-d),(j.position.y-c),(j.right-d),(j.bottom-c))){return true}}if(k.faceLeft||k.faceRight){e=this.tileCheckX(j,k,a)}}return(e!==0||b!==0)},tileCheckX:function(a,d,b){var c=0;var e=b.getTileOffsetX();if(a.deltaX()<0&&!a.blocked.left&&d.collideRight&&a.checkCollision.left){if(d.faceRight&&(a.x-e)<d.right){c=(a.x-e)-d.right;if(c<-this.TILE_BIAS){c=0}}}else{if(a.deltaX()>0&&!a.blocked.right&&d.collideLeft&&a.checkCollision.right){if(d.faceLeft&&(a.right-e)>d.left){c=(a.right-e)-d.left;if(c>this.TILE_BIAS){c=0}}}}if(c!==0){if(a.customSeparateX){a.overlapX=c}else{this.processTileSeparationX(a,c)}}return c},tileCheckY:function(a,d,c){var b=0;var e=c.getTileOffsetY();if(a.deltaY()<0&&!a.blocked.up&&d.collideDown&&a.checkCollision.up){if(d.faceBottom&&(a.y-e)<d.bottom){b=(a.y-e)-d.bottom;if(b<-this.TILE_BIAS){b=0}}}else{if(a.deltaY()>0&&!a.blocked.down&&d.collideUp&&a.checkCollision.down){if(d.faceTop&&(a.bottom-e)>d.top){b=(a.bottom-e)-d.top;if(b>this.TILE_BIAS){b=0}}}}if(b!==0){if(a.customSeparateY){a.overlapY=b}else{this.processTileSeparationY(a,b)}}return b},processTileSeparationX:function(b,a){if(a<0){b.blocked.left=true;b.blocked.none=false}else{if(a>0){b.blocked.right=true;b.blocked.none=false}}b.position.x-=a;if(b.bounce.x===0){b.velocity.x=0}else{b.velocity.x=-b.velocity.x*b.bounce.x}},processTileSeparationY:function(a,b){if(b<0){a.blocked.up=true;a.blocked.none=false}else{if(b>0){a.blocked.down=true;a.blocked.none=false}}a.position.y-=b;if(a.bounce.y===0){a.velocity.y=0}else{a.velocity.y=-a.velocity.y*a.bounce.y}}};Phaser.Utils.mixinPrototype(Phaser.Physics.Arcade.prototype,Phaser.Physics.Arcade.TilemapCollision.prototype);Phaser.Particles=function(a){this.game=a;this.emitters={};this.ID=0};Phaser.Particles.prototype={add:function(a){this.emitters[a.id]=a;return a},remove:function(a){delete this.emitters[a.id]},update:function(){for(var a in this.emitters){if(this.emitters[a].exists){this.emitters[a].update()}}}};Phaser.Particles.prototype.constructor=Phaser.Particles;if(PIXI.blendModes===undefined){PIXI.blendModes=Phaser.blendModes}if(PIXI.scaleModes===undefined){PIXI.scaleModes=Phaser.scaleModes}if(PIXI.Texture.emptyTexture===undefined){PIXI.Texture.emptyTexture=new PIXI.Texture(new PIXI.BaseTexture())}if(PIXI.DisplayObject._tempMatrix===undefined){PIXI.DisplayObject._tempMatrix=new Phaser.Matrix()}PIXI.TextureSilentFail=true;PIXI.canUseNewCanvasBlendModes=function(){return Phaser.Device.canUseMultiply};